[0m07:28:08.624397 [debug] [MainThread]: Acquiring new vertica connection "_test"
[0m07:28:08.624576 [debug] [MainThread]: Acquiring new vertica connection "_test"
[0m07:28:08.624736 [debug] [MainThread]: Creating schema "_ReferenceKey(database='vmart', schema='test16666828885909043652_test_array_concat', identifier=None)"
[0m07:28:08.631215 [debug] [MainThread]: Using vertica connection "_test"
[0m07:28:08.631377 [debug] [MainThread]: On _test: BEGIN
[0m07:28:08.631479 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:28:08.651303 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m07:28:08.657163 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.03 seconds
[0m07:28:08.657489 [debug] [MainThread]: Using vertica connection "_test"
[0m07:28:08.657703 [debug] [MainThread]: On _test: create schema if not exists "test16666828885909043652_test_array_concat"
  
[0m07:28:08.665939 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m07:28:08.667626 [debug] [MainThread]: On _test: COMMIT
[0m07:28:08.668015 [debug] [MainThread]: Using vertica connection "_test"
[0m07:28:08.668305 [debug] [MainThread]: On _test: COMMIT
[0m07:28:08.676101 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m07:28:08.676699 [debug] [MainThread]: On _test: Close
[0m07:28:08.690594 [debug] [MainThread]: Connection '_test' was properly closed.


============================== 2022-10-25 07:28:08.696119 | a24618ec-2d0d-4f53-86ad-252b1895964f ==============================
[0m07:28:08.696128 [info ] [MainThread]: Running with dbt=1.3.0
[0m07:28:08.696382 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/tmp/pytest-of-sachin/pytest-5/profile0', 'send_anonymous_usage_stats': False, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
[0m07:28:08.696488 [debug] [MainThread]: Tracking: do not track
[0m07:28:08.702146 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
[0m07:28:08.710158 [debug] [MainThread]: Parsing macros/test_assert_equal.sql
[0m07:28:08.710804 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m07:28:08.710991 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m07:28:08.711150 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m07:28:08.715496 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m07:28:08.716436 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m07:28:08.717050 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m07:28:08.719638 [debug] [MainThread]: Parsing macros/materializations/models/incremental/helpers.sql
[0m07:28:08.721347 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m07:28:08.725344 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m07:28:08.726261 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m07:28:08.729939 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m07:28:08.731224 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m07:28:08.738343 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m07:28:08.739376 [debug] [MainThread]: Parsing macros/materializations/snapshots/helper.sql
[0m07:28:08.739526 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m07:28:08.744574 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m07:28:08.748104 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m07:28:08.748657 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m07:28:08.749108 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m07:28:08.751141 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m07:28:08.752710 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m07:28:08.756715 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m07:28:08.757562 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m07:28:08.758240 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m07:28:08.759600 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m07:28:08.761836 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m07:28:08.762776 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m07:28:08.765972 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m07:28:08.767391 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m07:28:08.769357 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m07:28:08.778409 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m07:28:08.783404 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m07:28:08.784337 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m07:28:08.790505 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m07:28:08.794464 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m07:28:08.804449 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m07:28:08.806514 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m07:28:08.809774 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m07:28:08.817469 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m07:28:08.818502 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m07:28:08.825411 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m07:28:08.835034 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m07:28:08.836098 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m07:28:08.837190 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m07:28:08.839855 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m07:28:08.850943 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m07:28:08.855046 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m07:28:08.856030 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m07:28:08.856989 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m07:28:08.858497 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m07:28:08.859719 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m07:28:08.861277 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m07:28:08.869710 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m07:28:08.884183 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m07:28:08.888760 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m07:28:08.897547 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m07:28:08.899100 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m07:28:08.901399 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m07:28:08.904097 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m07:28:08.907842 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m07:28:08.908638 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m07:28:08.909391 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m07:28:08.910044 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m07:28:08.910872 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m07:28:08.911850 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m07:28:08.912492 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m07:28:08.913123 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m07:28:08.913853 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m07:28:08.915241 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m07:28:08.915874 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m07:28:08.916947 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m07:28:08.917895 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m07:28:08.922113 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m07:28:08.922827 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m07:28:08.923697 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m07:28:08.924427 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m07:28:08.925271 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m07:28:08.925979 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m07:28:08.927525 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m07:28:08.928329 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m07:28:08.928916 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m07:28:08.929614 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m07:28:08.930319 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m07:28:08.931512 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m07:28:08.932478 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m07:28:08.933131 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m07:28:08.933615 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m07:28:08.934281 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m07:28:08.937628 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m07:28:08.942673 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m07:28:09.106016 [debug] [MainThread]: 1603: static parser failed on actual.sql
[0m07:28:09.119469 [debug] [MainThread]: 1602: parser fallback to jinja rendering on actual.sql
[0m07:28:09.120367 [debug] [MainThread]: 1603: static parser failed on expected.sql
[0m07:28:09.123398 [debug] [MainThread]: 1602: parser fallback to jinja rendering on expected.sql
[0m07:28:09.149877 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 297 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m07:28:09.150778 [info ] [MainThread]: 
[0m07:28:09.151241 [debug] [MainThread]: Acquiring new vertica connection "master"
[0m07:28:09.152020 [debug] [ThreadPool]: Acquiring new vertica connection "list_VMart"
[0m07:28:09.155509 [debug] [ThreadPool]: Using vertica connection "list_VMart"
[0m07:28:09.155673 [debug] [ThreadPool]: On list_VMart: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "list_VMart"} */

    select schema_name
    from v_catalog.schemata
  
[0m07:28:09.155806 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:28:09.175993 [debug] [ThreadPool]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m07:28:09.195073 [debug] [ThreadPool]: SQL status: Code: [Column(name='schema_name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.04 seconds
[0m07:28:09.197692 [debug] [ThreadPool]: On list_VMart: Close
[0m07:28:09.200730 [debug] [ThreadPool]: Acquiring new vertica connection "list_VMart_test16666828885909043652_test_array_concat"
[0m07:28:09.211997 [debug] [ThreadPool]: Using vertica connection "list_VMart_test16666828885909043652_test_array_concat"
[0m07:28:09.212432 [debug] [ThreadPool]: On list_VMart_test16666828885909043652_test_array_concat: BEGIN
[0m07:28:09.212742 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:28:09.235041 [debug] [ThreadPool]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m07:28:09.240457 [debug] [ThreadPool]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.03 seconds
[0m07:28:09.241017 [debug] [ThreadPool]: Using vertica connection "list_VMart_test16666828885909043652_test_array_concat"
[0m07:28:09.241373 [debug] [ThreadPool]: On list_VMart_test16666828885909043652_test_array_concat: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "list_VMart_test16666828885909043652_test_array_concat"} */
select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'table' as type
    from v_catalog.tables
    where table_schema ilike 'test16666828885909043652_test_array_concat'
    union all
    select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'view' as type
    from v_catalog.views
    where table_schema ilike 'test16666828885909043652_test_array_concat'
  
[0m07:28:09.265850 [debug] [ThreadPool]: SQL status: Code: [Column(name='database', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='schema', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='type', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.02 seconds
[0m07:28:09.268409 [debug] [ThreadPool]: On list_VMart_test16666828885909043652_test_array_concat: ROLLBACK
[0m07:28:09.275151 [debug] [ThreadPool]: On list_VMart_test16666828885909043652_test_array_concat: Close
[0m07:28:09.277671 [debug] [MainThread]: Using vertica connection "master"
[0m07:28:09.278483 [debug] [MainThread]: On master: BEGIN
[0m07:28:09.279138 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:28:09.296169 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m07:28:09.301821 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m07:28:09.302180 [debug] [MainThread]: On master: COMMIT
[0m07:28:09.302389 [debug] [MainThread]: Using vertica connection "master"
[0m07:28:09.302579 [debug] [MainThread]: On master: COMMIT
[0m07:28:09.307457 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.0 seconds
[0m07:28:09.307655 [debug] [MainThread]: On master: Close
[0m07:28:09.308089 [info ] [MainThread]: Concurrency: 4 threads (target='default')
[0m07:28:09.308330 [info ] [MainThread]: 
[0m07:28:09.310824 [debug] [Thread-1 (]: Began running node model.test.actual
[0m07:28:09.311024 [debug] [Thread-2 (]: Began running node model.test.expected
[0m07:28:09.311246 [info ] [Thread-1 (]: 1 of 2 START sql view model test16666828885909043652_test_array_concat.actual .. [RUN]
[0m07:28:09.311518 [info ] [Thread-2 (]: 2 of 2 START sql view model test16666828885909043652_test_array_concat.expected  [RUN]
[0m07:28:09.312031 [debug] [Thread-1 (]: Acquiring new vertica connection "model.test.actual"
[0m07:28:09.312584 [debug] [Thread-2 (]: Acquiring new vertica connection "model.test.expected"
[0m07:28:09.312763 [debug] [Thread-1 (]: Began compiling node model.test.actual
[0m07:28:09.312965 [debug] [Thread-2 (]: Began compiling node model.test.expected
[0m07:28:09.313110 [debug] [Thread-1 (]: Compiling model.test.actual
[0m07:28:09.313366 [debug] [Thread-2 (]: Compiling model.test.expected
[0m07:28:09.318013 [debug] [Thread-1 (]: Writing injected SQL for node "model.test.actual"
[0m07:28:09.321367 [debug] [Thread-2 (]: Writing injected SQL for node "model.test.expected"
[0m07:28:09.321855 [debug] [Thread-1 (]: finished collecting timing info
[0m07:28:09.322112 [debug] [Thread-1 (]: Began executing node model.test.actual
[0m07:28:09.322226 [debug] [Thread-2 (]: finished collecting timing info
[0m07:28:09.344100 [debug] [Thread-1 (]: Writing runtime sql for node "model.test.actual"
[0m07:28:09.344399 [debug] [Thread-2 (]: Began executing node model.test.expected
[0m07:28:09.346959 [debug] [Thread-2 (]: Writing runtime sql for node "model.test.expected"
[0m07:28:09.347253 [debug] [Thread-1 (]: Using vertica connection "model.test.actual"
[0m07:28:09.347410 [debug] [Thread-1 (]: On model.test.actual: BEGIN
[0m07:28:09.347530 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:28:09.347897 [debug] [Thread-2 (]: Using vertica connection "model.test.expected"
[0m07:28:09.348059 [debug] [Thread-2 (]: On model.test.expected: BEGIN
[0m07:28:09.348189 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m07:28:09.364538 [debug] [Thread-1 (]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m07:28:09.364791 [debug] [Thread-2 (]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m07:28:09.370143 [debug] [Thread-1 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m07:28:09.370282 [debug] [Thread-2 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m07:28:09.370463 [debug] [Thread-1 (]: Using vertica connection "model.test.actual"
[0m07:28:09.370655 [debug] [Thread-2 (]: Using vertica connection "model.test.expected"
[0m07:28:09.370834 [debug] [Thread-1 (]: On model.test.actual: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.actual"} */

  create view "VMart"."test16666828885909043652_test_array_concat"."actual__dbt_tmp" as (
    select 1 as id, array_cat(
    array[ 1 , 2 , 3 ]
    , 
    array[ 4 , 5 , 6 ]
    ) as array_col union all
select 2 as id, array_cat(
    array[]::INT[]
    , 
    array[ 2 ]
    ) as array_col union all
select 3 as id, array_cat(
    array[ 3 ]
    , 
    array[]::INT[]
    ) as array_col
  );
[0m07:28:09.371042 [debug] [Thread-2 (]: On model.test.expected: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.expected"} */

  create view "VMart"."test16666828885909043652_test_array_concat"."expected__dbt_tmp" as (
    select 1 as id, 
    array[ 1 , 2 , 3 , 4 , 5 , 6 ]
     as array_col union all
select 2 as id, 
    array[ 2 ]
     as array_col union all
select 3 as id, 
    array[ 3 ]
     as array_col
  );
[0m07:28:09.382857 [debug] [Thread-2 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m07:28:09.387085 [debug] [Thread-2 (]: Using vertica connection "model.test.expected"
[0m07:28:09.387273 [debug] [Thread-2 (]: On model.test.expected: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.expected"} */
alter view "VMart"."test16666828885909043652_test_array_concat"."expected__dbt_tmp" rename to "expected"
[0m07:28:09.388389 [debug] [Thread-1 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m07:28:09.390720 [debug] [Thread-1 (]: Using vertica connection "model.test.actual"
[0m07:28:09.390899 [debug] [Thread-1 (]: On model.test.actual: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.actual"} */
alter view "VMart"."test16666828885909043652_test_array_concat"."actual__dbt_tmp" rename to "actual"
[0m07:28:09.398386 [debug] [Thread-2 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m07:28:09.409457 [debug] [Thread-1 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m07:28:09.409894 [debug] [Thread-2 (]: On model.test.expected: COMMIT
[0m07:28:09.411057 [debug] [Thread-1 (]: On model.test.actual: COMMIT
[0m07:28:09.411298 [debug] [Thread-2 (]: Using vertica connection "model.test.expected"
[0m07:28:09.411505 [debug] [Thread-1 (]: Using vertica connection "model.test.actual"
[0m07:28:09.411643 [debug] [Thread-2 (]: On model.test.expected: COMMIT
[0m07:28:09.411867 [debug] [Thread-1 (]: On model.test.actual: COMMIT
[0m07:28:09.420867 [debug] [Thread-2 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m07:28:09.421109 [debug] [Thread-1 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m07:28:09.424884 [debug] [Thread-2 (]: Using vertica connection "model.test.expected"
[0m07:28:09.426385 [debug] [Thread-1 (]: Using vertica connection "model.test.actual"
[0m07:28:09.426663 [debug] [Thread-2 (]: On model.test.expected: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.expected"} */
drop view if exists "VMart"."test16666828885909043652_test_array_concat"."expected__dbt_backup" cascade
[0m07:28:09.426882 [debug] [Thread-1 (]: On model.test.actual: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.actual"} */
drop view if exists "VMart"."test16666828885909043652_test_array_concat"."actual__dbt_backup" cascade
[0m07:28:09.435556 [debug] [Thread-2 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m07:28:09.437051 [debug] [Thread-2 (]: finished collecting timing info
[0m07:28:09.437439 [debug] [Thread-2 (]: On model.test.expected: Close
[0m07:28:09.438316 [info ] [Thread-2 (]: 2 of 2 OK created sql view model test16666828885909043652_test_array_concat.expected  [[32mCode: None, Rows: -1, Array Size: 1[0m in 0.13s]
[0m07:28:09.438555 [debug] [Thread-1 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m07:28:09.439114 [debug] [Thread-2 (]: Finished running node model.test.expected
[0m07:28:09.439969 [debug] [Thread-1 (]: finished collecting timing info
[0m07:28:09.440339 [debug] [Thread-1 (]: On model.test.actual: Close
[0m07:28:09.441176 [info ] [Thread-1 (]: 1 of 2 OK created sql view model test16666828885909043652_test_array_concat.actual  [[32mCode: None, Rows: -1, Array Size: 1[0m in 0.13s]
[0m07:28:09.441708 [debug] [Thread-1 (]: Finished running node model.test.actual
[0m07:28:09.442616 [debug] [MainThread]: Acquiring new vertica connection "master"
[0m07:28:09.442794 [debug] [MainThread]: Using vertica connection "master"
[0m07:28:09.442909 [debug] [MainThread]: On master: BEGIN
[0m07:28:09.443012 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:28:09.462823 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m07:28:09.468690 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.03 seconds
[0m07:28:09.468935 [debug] [MainThread]: On master: COMMIT
[0m07:28:09.469056 [debug] [MainThread]: Using vertica connection "master"
[0m07:28:09.469176 [debug] [MainThread]: On master: COMMIT
[0m07:28:09.476460 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m07:28:09.476771 [debug] [MainThread]: On master: Close
[0m07:28:09.477302 [info ] [MainThread]: 
[0m07:28:09.477578 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m07:28:09.477780 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:28:09.477883 [debug] [MainThread]: Connection 'model.test.actual' was properly closed.
[0m07:28:09.477987 [debug] [MainThread]: Connection 'model.test.expected' was properly closed.
[0m07:28:09.482108 [info ] [MainThread]: 
[0m07:28:09.482428 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:28:09.482694 [info ] [MainThread]: 
[0m07:28:09.482895 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m07:28:09.483154 [debug] [MainThread]: Flushing usage events


============================== 2022-10-25 07:28:09.498342 | a24618ec-2d0d-4f53-86ad-252b1895964f ==============================
[0m07:28:09.498357 [info ] [MainThread]: Running with dbt=1.3.0
[0m07:28:09.498751 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/tmp/pytest-of-sachin/pytest-5/profile0', 'send_anonymous_usage_stats': False, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
[0m07:28:09.498896 [debug] [MainThread]: Tracking: do not track
[0m07:28:09.537308 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:28:09.537646 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:28:09.548297 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 297 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m07:28:09.549528 [info ] [MainThread]: 
[0m07:28:09.550192 [debug] [MainThread]: Acquiring new vertica connection "master"
[0m07:28:09.551040 [debug] [ThreadPool]: Acquiring new vertica connection "list_VMart"
[0m07:28:09.553843 [debug] [ThreadPool]: Using vertica connection "list_VMart"
[0m07:28:09.554172 [debug] [ThreadPool]: On list_VMart: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "list_VMart"} */

    select schema_name
    from v_catalog.schemata
  
[0m07:28:09.554362 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:28:09.576511 [debug] [ThreadPool]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m07:28:09.596576 [debug] [ThreadPool]: SQL status: Code: [Column(name='schema_name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.04 seconds
[0m07:28:09.598450 [debug] [ThreadPool]: On list_VMart: Close
[0m07:28:09.600301 [debug] [ThreadPool]: Acquiring new vertica connection "list_VMart_test16666828885909043652_test_array_concat"
[0m07:28:09.649769 [debug] [ThreadPool]: Using vertica connection "list_VMart_test16666828885909043652_test_array_concat"
[0m07:28:09.650123 [debug] [ThreadPool]: On list_VMart_test16666828885909043652_test_array_concat: BEGIN
[0m07:28:09.650317 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:28:09.669421 [debug] [ThreadPool]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m07:28:09.674861 [debug] [ThreadPool]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m07:28:09.675264 [debug] [ThreadPool]: Using vertica connection "list_VMart_test16666828885909043652_test_array_concat"
[0m07:28:09.675518 [debug] [ThreadPool]: On list_VMart_test16666828885909043652_test_array_concat: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "list_VMart_test16666828885909043652_test_array_concat"} */
select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'table' as type
    from v_catalog.tables
    where table_schema ilike 'test16666828885909043652_test_array_concat'
    union all
    select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'view' as type
    from v_catalog.views
    where table_schema ilike 'test16666828885909043652_test_array_concat'
  
[0m07:28:09.697834 [debug] [ThreadPool]: SQL status: Code: [Column(name='database', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='schema', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='type', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.02 seconds
[0m07:28:09.699518 [debug] [ThreadPool]: On list_VMart_test16666828885909043652_test_array_concat: ROLLBACK
[0m07:28:09.706169 [debug] [ThreadPool]: On list_VMart_test16666828885909043652_test_array_concat: Close
[0m07:28:09.707413 [debug] [MainThread]: Using vertica connection "master"
[0m07:28:09.707619 [debug] [MainThread]: On master: BEGIN
[0m07:28:09.707742 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:28:09.728224 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m07:28:09.733636 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.03 seconds
[0m07:28:09.733889 [debug] [MainThread]: On master: COMMIT
[0m07:28:09.734005 [debug] [MainThread]: Using vertica connection "master"
[0m07:28:09.734108 [debug] [MainThread]: On master: COMMIT
[0m07:28:09.740343 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m07:28:09.740712 [debug] [MainThread]: On master: Close
[0m07:28:09.741421 [info ] [MainThread]: Concurrency: 4 threads (target='default')
[0m07:28:09.741865 [info ] [MainThread]: 
[0m07:28:09.743377 [debug] [Thread-8 (]: Began running node model.test.actual
[0m07:28:09.743533 [debug] [Thread-9 (]: Began running node model.test.expected
[0m07:28:09.743849 [info ] [Thread-8 (]: 1 of 2 START sql view model test16666828885909043652_test_array_concat.actual .. [RUN]
[0m07:28:09.744093 [info ] [Thread-9 (]: 2 of 2 START sql view model test16666828885909043652_test_array_concat.expected  [RUN]
[0m07:28:09.744622 [debug] [Thread-8 (]: Acquiring new vertica connection "model.test.actual"
[0m07:28:09.745118 [debug] [Thread-9 (]: Acquiring new vertica connection "model.test.expected"
[0m07:28:09.745293 [debug] [Thread-8 (]: Began compiling node model.test.actual
[0m07:28:09.745431 [debug] [Thread-9 (]: Began compiling node model.test.expected
[0m07:28:09.745569 [debug] [Thread-8 (]: Compiling model.test.actual
[0m07:28:09.745698 [debug] [Thread-9 (]: Compiling model.test.expected
[0m07:28:09.750660 [debug] [Thread-8 (]: Writing injected SQL for node "model.test.actual"
[0m07:28:09.753540 [debug] [Thread-9 (]: Writing injected SQL for node "model.test.expected"
[0m07:28:09.753984 [debug] [Thread-8 (]: finished collecting timing info
[0m07:28:09.754123 [debug] [Thread-9 (]: finished collecting timing info
[0m07:28:09.754264 [debug] [Thread-8 (]: Began executing node model.test.actual
[0m07:28:09.754419 [debug] [Thread-9 (]: Began executing node model.test.expected
[0m07:28:09.756813 [debug] [Thread-8 (]: Writing runtime sql for node "model.test.actual"
[0m07:28:09.759509 [debug] [Thread-9 (]: Writing runtime sql for node "model.test.expected"
[0m07:28:09.760091 [debug] [Thread-8 (]: Using vertica connection "model.test.actual"
[0m07:28:09.760243 [debug] [Thread-9 (]: Using vertica connection "model.test.expected"
[0m07:28:09.760367 [debug] [Thread-8 (]: On model.test.actual: BEGIN
[0m07:28:09.760505 [debug] [Thread-9 (]: On model.test.expected: BEGIN
[0m07:28:09.760634 [debug] [Thread-8 (]: Opening a new connection, currently in state closed
[0m07:28:09.760786 [debug] [Thread-9 (]: Opening a new connection, currently in state init
[0m07:28:09.780155 [debug] [Thread-9 (]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m07:28:09.780602 [debug] [Thread-8 (]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m07:28:09.786164 [debug] [Thread-9 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.03 seconds
[0m07:28:09.786334 [debug] [Thread-8 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.03 seconds
[0m07:28:09.786517 [debug] [Thread-9 (]: Using vertica connection "model.test.expected"
[0m07:28:09.786686 [debug] [Thread-8 (]: Using vertica connection "model.test.actual"
[0m07:28:09.786830 [debug] [Thread-9 (]: On model.test.expected: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.expected"} */

  create view "VMart"."test16666828885909043652_test_array_concat"."expected__dbt_tmp" as (
    select 1 as id, 
    array[ 1 , 2 , 3 , 4 , 5 , 6 ]
     as array_col union all
select 2 as id, 
    array[ 2 ]
     as array_col union all
select 3 as id, 
    array[ 3 ]
     as array_col
  );
[0m07:28:09.787025 [debug] [Thread-8 (]: On model.test.actual: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.actual"} */

  create view "VMart"."test16666828885909043652_test_array_concat"."actual__dbt_tmp" as (
    select 1 as id, array_cat(
    array[ 1 , 2 , 3 ]
    , 
    array[ 4 , 5 , 6 ]
    ) as array_col union all
select 2 as id, array_cat(
    array[]::INT[]
    , 
    array[ 2 ]
    ) as array_col union all
select 3 as id, array_cat(
    array[ 3 ]
    , 
    array[]::INT[]
    ) as array_col
  );
[0m07:28:09.799990 [debug] [Thread-9 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m07:28:09.800274 [debug] [Thread-8 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m07:28:09.802646 [debug] [Thread-9 (]: Using vertica connection "model.test.expected"
[0m07:28:09.804484 [debug] [Thread-8 (]: Using vertica connection "model.test.actual"
[0m07:28:09.804787 [debug] [Thread-9 (]: On model.test.expected: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.expected"} */
alter view "VMart"."test16666828885909043652_test_array_concat"."expected" rename to "expected__dbt_backup"
[0m07:28:09.804963 [debug] [Thread-8 (]: On model.test.actual: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.actual"} */
alter view "VMart"."test16666828885909043652_test_array_concat"."actual" rename to "actual__dbt_backup"
[0m07:28:09.814450 [debug] [Thread-9 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m07:28:09.816437 [debug] [Thread-9 (]: Using vertica connection "model.test.expected"
[0m07:28:09.816637 [debug] [Thread-9 (]: On model.test.expected: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.expected"} */
alter view "VMart"."test16666828885909043652_test_array_concat"."expected__dbt_tmp" rename to "expected"
[0m07:28:09.817639 [debug] [Thread-8 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m07:28:09.821052 [debug] [Thread-8 (]: Using vertica connection "model.test.actual"
[0m07:28:09.821301 [debug] [Thread-8 (]: On model.test.actual: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.actual"} */
alter view "VMart"."test16666828885909043652_test_array_concat"."actual__dbt_tmp" rename to "actual"
[0m07:28:09.826117 [debug] [Thread-9 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m07:28:09.829017 [debug] [Thread-9 (]: On model.test.expected: COMMIT
[0m07:28:09.829221 [debug] [Thread-9 (]: Using vertica connection "model.test.expected"
[0m07:28:09.829337 [debug] [Thread-9 (]: On model.test.expected: COMMIT
[0m07:28:09.834874 [debug] [Thread-9 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m07:28:09.836783 [debug] [Thread-9 (]: Using vertica connection "model.test.expected"
[0m07:28:09.836988 [debug] [Thread-9 (]: On model.test.expected: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.expected"} */
drop view if exists "VMart"."test16666828885909043652_test_array_concat"."expected__dbt_backup" cascade
[0m07:28:09.837124 [debug] [Thread-8 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m07:28:09.838349 [debug] [Thread-8 (]: On model.test.actual: COMMIT
[0m07:28:09.838510 [debug] [Thread-8 (]: Using vertica connection "model.test.actual"
[0m07:28:09.838640 [debug] [Thread-8 (]: On model.test.actual: COMMIT
[0m07:28:09.846875 [debug] [Thread-9 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m07:28:09.847160 [debug] [Thread-8 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m07:28:09.848541 [debug] [Thread-9 (]: finished collecting timing info
[0m07:28:09.850289 [debug] [Thread-8 (]: Using vertica connection "model.test.actual"
[0m07:28:09.850562 [debug] [Thread-9 (]: On model.test.expected: Close
[0m07:28:09.850801 [debug] [Thread-8 (]: On model.test.actual: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.actual"} */
drop view if exists "VMart"."test16666828885909043652_test_array_concat"."actual__dbt_backup" cascade
[0m07:28:09.851680 [info ] [Thread-9 (]: 2 of 2 OK created sql view model test16666828885909043652_test_array_concat.expected  [[32mCode: None, Rows: -1, Array Size: 1[0m in 0.11s]
[0m07:28:09.852307 [debug] [Thread-9 (]: Finished running node model.test.expected
[0m07:28:09.861429 [debug] [Thread-8 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m07:28:09.863035 [debug] [Thread-8 (]: finished collecting timing info
[0m07:28:09.863265 [debug] [Thread-8 (]: On model.test.actual: Close
[0m07:28:09.863838 [info ] [Thread-8 (]: 1 of 2 OK created sql view model test16666828885909043652_test_array_concat.actual  [[32mCode: None, Rows: -1, Array Size: 1[0m in 0.12s]
[0m07:28:09.864193 [debug] [Thread-8 (]: Finished running node model.test.actual
[0m07:28:09.865042 [debug] [MainThread]: Acquiring new vertica connection "master"
[0m07:28:09.865237 [debug] [MainThread]: Using vertica connection "master"
[0m07:28:09.865347 [debug] [MainThread]: On master: BEGIN
[0m07:28:09.865482 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:28:09.884433 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m07:28:09.889836 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m07:28:09.890110 [debug] [MainThread]: On master: COMMIT
[0m07:28:09.890230 [debug] [MainThread]: Using vertica connection "master"
[0m07:28:09.890333 [debug] [MainThread]: On master: COMMIT
[0m07:28:09.897365 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m07:28:09.897603 [debug] [MainThread]: On master: Close
[0m07:28:09.898091 [info ] [MainThread]: 
[0m07:28:09.898339 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m07:28:09.898531 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:28:09.898640 [debug] [MainThread]: Connection 'model.test.actual' was properly closed.
[0m07:28:09.898750 [debug] [MainThread]: Connection 'model.test.expected' was properly closed.
[0m07:28:09.902904 [info ] [MainThread]: 
[0m07:28:09.903243 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:28:09.903477 [info ] [MainThread]: 
[0m07:28:09.903668 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m07:28:09.903938 [debug] [MainThread]: Flushing usage events
[0m07:28:09.904435 [debug] [MainThread]: Acquiring new vertica connection "_test"
[0m07:28:09.908280 [debug] [MainThread]: Using vertica connection "_test"
[0m07:28:09.908480 [debug] [MainThread]: On _test: BEGIN
[0m07:28:09.908603 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:28:09.925697 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m07:28:09.932460 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m07:28:09.932758 [debug] [MainThread]: Using vertica connection "_test"
[0m07:28:09.932895 [debug] [MainThread]: On _test: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "_test"} */

    select
    column_name
    , data_type
    , character_maximum_length
    , numeric_precision
    , numeric_scale
    from (
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.columns
        where table_schema = 'test16666828885909043652_test_array_concat'
        and table_name = 'expected'
        union all
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.view_columns
        where table_schema = 'test16666828885909043652_test_array_concat'
        and table_name = 'expected'
    ) t
    order by ordinal_position
  
[0m07:28:09.959774 [debug] [MainThread]: SQL status: Code: [Column(name='column_name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='data_type', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='character_maximum_length', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_precision', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_scale', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.03 seconds
[0m07:28:09.962622 [debug] [MainThread]: Using vertica connection "_test"
[0m07:28:09.962877 [debug] [MainThread]: On _test: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "_test"} */
with diff_count as (
    SELECT
        1 as id,
        COUNT(*) as num_missing FROM (
            (SELECT "array_col", "id" FROM "VMart"."test16666828885909043652_test_array_concat"."expected" EXCEPT
             SELECT "array_col", "id" FROM "VMart"."test16666828885909043652_test_array_concat"."actual")
             UNION ALL
            (SELECT "array_col", "id" FROM "VMart"."test16666828885909043652_test_array_concat"."actual" EXCEPT
             SELECT "array_col", "id" FROM "VMart"."test16666828885909043652_test_array_concat"."expected")
        ) as a
), table_a as (
    SELECT COUNT(*) as num_rows FROM "VMart"."test16666828885909043652_test_array_concat"."expected"
), table_b as (
    SELECT COUNT(*) as num_rows FROM "VMart"."test16666828885909043652_test_array_concat"."actual"
), row_count_diff as (
    select
        1 as id,
        table_a.num_rows - table_b.num_rows as difference
    from table_a, table_b
)
select
    row_count_diff.difference as row_count_difference,
    diff_count.num_missing as num_mismatched
from row_count_diff
join diff_count using (id)
[0m07:28:10.027187 [debug] [MainThread]: SQL status: Code: [Column(name='row_count_difference', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='num_mismatched', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.06 seconds
[0m07:28:10.028111 [debug] [MainThread]: On _test: ROLLBACK
[0m07:28:10.033170 [debug] [MainThread]: On _test: Close
[0m07:28:10.033985 [debug] [MainThread]: Acquiring new vertica connection "_test"
[0m07:28:10.035371 [debug] [MainThread]: Using vertica connection "_test"
[0m07:28:10.035533 [debug] [MainThread]: On _test: BEGIN
[0m07:28:10.035644 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:28:10.051710 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m07:28:10.055715 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m07:28:10.055929 [debug] [MainThread]: Using vertica connection "_test"
[0m07:28:10.056038 [debug] [MainThread]: On _test: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "_test"} */

    select
    column_name
    , data_type
    , character_maximum_length
    , numeric_precision
    , numeric_scale
    from (
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.columns
        where table_schema = 'test16666828885909043652_test_array_concat'
        and table_name = 'expected'
        union all
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.view_columns
        where table_schema = 'test16666828885909043652_test_array_concat'
        and table_name = 'expected'
    ) t
    order by ordinal_position
  
[0m07:28:10.085477 [debug] [MainThread]: SQL status: Code: [Column(name='column_name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='data_type', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='character_maximum_length', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_precision', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_scale', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.03 seconds
[0m07:28:10.086875 [debug] [MainThread]: On _test: ROLLBACK
[0m07:28:10.091207 [debug] [MainThread]: On _test: Close
[0m07:28:10.092068 [debug] [MainThread]: Acquiring new vertica connection "_test"
[0m07:28:10.093506 [debug] [MainThread]: Using vertica connection "_test"
[0m07:28:10.093694 [debug] [MainThread]: On _test: BEGIN
[0m07:28:10.093808 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:28:10.110133 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m07:28:10.115297 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m07:28:10.115594 [debug] [MainThread]: Using vertica connection "_test"
[0m07:28:10.115722 [debug] [MainThread]: On _test: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "_test"} */

    select
    column_name
    , data_type
    , character_maximum_length
    , numeric_precision
    , numeric_scale
    from (
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.columns
        where table_schema = 'test16666828885909043652_test_array_concat'
        and table_name = 'actual'
        union all
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.view_columns
        where table_schema = 'test16666828885909043652_test_array_concat'
        and table_name = 'actual'
    ) t
    order by ordinal_position
  
[0m07:28:10.165420 [debug] [MainThread]: SQL status: Code: [Column(name='column_name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='data_type', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='character_maximum_length', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_precision', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_scale', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.05 seconds
[0m07:28:10.166567 [debug] [MainThread]: On _test: ROLLBACK
[0m07:28:10.171949 [debug] [MainThread]: On _test: Close
[0m07:28:10.173146 [debug] [MainThread]: Acquiring new vertica connection "_test"
[0m07:28:10.173411 [debug] [MainThread]: Dropping schema "_ReferenceKey(database='vmart', schema='test16666828885909043652_test_array_concat', identifier=None)".
[0m07:28:10.178170 [debug] [MainThread]: Using vertica connection "_test"
[0m07:28:10.178453 [debug] [MainThread]: On _test: BEGIN
[0m07:28:10.178579 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:28:10.198959 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m07:28:10.203467 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m07:28:10.203677 [debug] [MainThread]: Using vertica connection "_test"
[0m07:28:10.203803 [debug] [MainThread]: On _test: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "_test"} */
drop schema if exists "test16666828885909043652_test_array_concat" cascade
  
[0m07:28:10.218122 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m07:28:10.218894 [debug] [MainThread]: On _test: COMMIT
[0m07:28:10.219080 [debug] [MainThread]: Using vertica connection "_test"
[0m07:28:10.219219 [debug] [MainThread]: On _test: COMMIT
[0m07:28:10.225163 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m07:28:10.225400 [debug] [MainThread]: On _test: Close
[0m07:28:10.226053 [debug] [MainThread]: Connection '_test' was properly closed.
