[0m05:51:26.645177 [debug] [MainThread]: Acquiring new vertica connection "_test"
[0m05:51:26.645361 [debug] [MainThread]: Acquiring new vertica connection "_test"
[0m05:51:26.645522 [debug] [MainThread]: Creating schema "_ReferenceKey(database='vmart', schema='test16667634867433083450_test_array_concat', identifier=None)"
[0m05:51:26.647125 [debug] [MainThread]: Using vertica connection "_test"
[0m05:51:26.647266 [debug] [MainThread]: On _test: BEGIN
[0m05:51:26.647371 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:51:26.663525 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m05:51:26.668058 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m05:51:26.668210 [debug] [MainThread]: Using vertica connection "_test"
[0m05:51:26.668341 [debug] [MainThread]: On _test: create schema if not exists "test16667634867433083450_test_array_concat"
  
[0m05:51:26.675811 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m05:51:26.677123 [debug] [MainThread]: On _test: COMMIT
[0m05:51:26.677409 [debug] [MainThread]: Using vertica connection "_test"
[0m05:51:26.677635 [debug] [MainThread]: On _test: COMMIT
[0m05:51:26.683310 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m05:51:26.683783 [debug] [MainThread]: On _test: Close
[0m05:51:26.695324 [debug] [MainThread]: Connection '_test' was properly closed.


============================== 2022-10-26 05:51:26.700847 | b0c9e18b-7223-4cd6-9db5-0b5e90260df9 ==============================
[0m05:51:26.700854 [info ] [MainThread]: Running with dbt=1.3.0
[0m05:51:26.701118 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/tmp/pytest-of-sachin/pytest-37/profile11', 'send_anonymous_usage_stats': False, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
[0m05:51:26.701224 [debug] [MainThread]: Tracking: do not track
[0m05:51:26.706955 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
[0m05:51:26.714554 [debug] [MainThread]: Parsing macros/test_assert_equal.sql
[0m05:51:26.715067 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m05:51:26.715228 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m05:51:26.715350 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m05:51:26.719767 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m05:51:26.720609 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m05:51:26.721184 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m05:51:26.723764 [debug] [MainThread]: Parsing macros/materializations/models/incremental/helpers.sql
[0m05:51:26.725475 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m05:51:26.729055 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m05:51:26.729977 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m05:51:26.733652 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m05:51:26.734907 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m05:51:26.741887 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m05:51:26.742897 [debug] [MainThread]: Parsing macros/materializations/snapshots/helper.sql
[0m05:51:26.743044 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m05:51:26.748169 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m05:51:26.751758 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m05:51:26.752306 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m05:51:26.752728 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m05:51:26.754568 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m05:51:26.756129 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m05:51:26.760156 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m05:51:26.760993 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m05:51:26.761676 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m05:51:26.763033 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m05:51:26.765319 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m05:51:26.766187 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m05:51:26.769429 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m05:51:26.770793 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m05:51:26.772775 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m05:51:26.781679 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m05:51:26.786571 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m05:51:26.787496 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m05:51:26.794103 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m05:51:26.798005 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m05:51:26.807995 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m05:51:26.810090 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m05:51:26.813358 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m05:51:26.821048 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m05:51:26.822092 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m05:51:26.829085 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m05:51:26.838611 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m05:51:26.839697 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m05:51:26.840817 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m05:51:26.843510 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m05:51:26.854644 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m05:51:26.859215 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m05:51:26.860216 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m05:51:26.861176 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m05:51:26.862821 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m05:51:26.864119 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m05:51:26.865776 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m05:51:26.871723 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m05:51:26.880645 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m05:51:26.885024 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m05:51:26.893210 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m05:51:26.894584 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m05:51:26.896623 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m05:51:26.899291 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m05:51:26.902947 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m05:51:26.903741 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m05:51:26.904398 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m05:51:26.904969 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m05:51:26.905735 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m05:51:26.906674 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m05:51:26.907297 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m05:51:26.907876 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m05:51:26.908541 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m05:51:26.909764 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m05:51:26.910332 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m05:51:26.911123 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m05:51:26.911809 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m05:51:26.915687 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m05:51:26.916294 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m05:51:26.917057 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m05:51:26.917700 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m05:51:26.918732 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m05:51:26.919389 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m05:51:26.920756 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m05:51:26.921342 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m05:51:26.921849 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m05:51:26.922540 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m05:51:26.923204 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m05:51:26.924293 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m05:51:26.925175 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m05:51:26.925725 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m05:51:26.926181 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m05:51:26.926784 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m05:51:26.929829 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m05:51:26.935076 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m05:51:27.087364 [debug] [MainThread]: 1603: static parser failed on actual.sql
[0m05:51:27.134331 [debug] [MainThread]: 1602: parser fallback to jinja rendering on actual.sql
[0m05:51:27.135449 [debug] [MainThread]: 1603: static parser failed on expected.sql
[0m05:51:27.138390 [debug] [MainThread]: 1602: parser fallback to jinja rendering on expected.sql
[0m05:51:27.159651 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 297 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m05:51:27.160294 [info ] [MainThread]: 
[0m05:51:27.160744 [debug] [MainThread]: Acquiring new vertica connection "master"
[0m05:51:27.161439 [debug] [ThreadPool]: Acquiring new vertica connection "list_VMart"
[0m05:51:27.162698 [debug] [ThreadPool]: Using vertica connection "list_VMart"
[0m05:51:27.162829 [debug] [ThreadPool]: On list_VMart: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "list_VMart"} */

    select schema_name
    from v_catalog.schemata
  
[0m05:51:27.162935 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:51:27.179274 [debug] [ThreadPool]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m05:51:27.190785 [debug] [ThreadPool]: SQL status: Code: [Column(name='schema_name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.03 seconds
[0m05:51:27.193096 [debug] [ThreadPool]: On list_VMart: Close
[0m05:51:27.195952 [debug] [ThreadPool]: Acquiring new vertica connection "list_VMart_test16667634867433083450_test_array_concat"
[0m05:51:27.199401 [debug] [ThreadPool]: Using vertica connection "list_VMart_test16667634867433083450_test_array_concat"
[0m05:51:27.200085 [debug] [ThreadPool]: On list_VMart_test16667634867433083450_test_array_concat: BEGIN
[0m05:51:27.200488 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:51:27.215120 [debug] [ThreadPool]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m05:51:27.220113 [debug] [ThreadPool]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m05:51:27.220512 [debug] [ThreadPool]: Using vertica connection "list_VMart_test16667634867433083450_test_array_concat"
[0m05:51:27.220809 [debug] [ThreadPool]: On list_VMart_test16667634867433083450_test_array_concat: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "list_VMart_test16667634867433083450_test_array_concat"} */
select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'table' as type
    from v_catalog.tables
    where table_schema ilike 'test16667634867433083450_test_array_concat'
    union all
    select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'view' as type
    from v_catalog.views
    where table_schema ilike 'test16667634867433083450_test_array_concat'
  
[0m05:51:27.235062 [debug] [ThreadPool]: SQL status: Code: [Column(name='database', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='schema', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='type', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.01 seconds
[0m05:51:27.237324 [debug] [ThreadPool]: On list_VMart_test16667634867433083450_test_array_concat: ROLLBACK
[0m05:51:27.242295 [debug] [ThreadPool]: On list_VMart_test16667634867433083450_test_array_concat: Close
[0m05:51:27.244086 [debug] [MainThread]: Using vertica connection "master"
[0m05:51:27.244524 [debug] [MainThread]: On master: BEGIN
[0m05:51:27.244853 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:51:27.259787 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m05:51:27.264576 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m05:51:27.265042 [debug] [MainThread]: On master: COMMIT
[0m05:51:27.265349 [debug] [MainThread]: Using vertica connection "master"
[0m05:51:27.265475 [debug] [MainThread]: On master: COMMIT
[0m05:51:27.269467 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.0 seconds
[0m05:51:27.269654 [debug] [MainThread]: On master: Close
[0m05:51:27.270123 [info ] [MainThread]: Concurrency: 4 threads (target='default')
[0m05:51:27.270381 [info ] [MainThread]: 
[0m05:51:27.272077 [debug] [Thread-106]: Began running node model.test.actual
[0m05:51:27.272243 [debug] [Thread-107]: Began running node model.test.expected
[0m05:51:27.272458 [info ] [Thread-106]: 1 of 2 START sql view model test16667634867433083450_test_array_concat.actual .. [RUN]
[0m05:51:27.272689 [info ] [Thread-107]: 2 of 2 START sql view model test16667634867433083450_test_array_concat.expected  [RUN]
[0m05:51:27.273186 [debug] [Thread-106]: Acquiring new vertica connection "model.test.actual"
[0m05:51:27.273659 [debug] [Thread-107]: Acquiring new vertica connection "model.test.expected"
[0m05:51:27.273822 [debug] [Thread-106]: Began compiling node model.test.actual
[0m05:51:27.273967 [debug] [Thread-107]: Began compiling node model.test.expected
[0m05:51:27.274103 [debug] [Thread-106]: Compiling model.test.actual
[0m05:51:27.274230 [debug] [Thread-107]: Compiling model.test.expected
[0m05:51:27.278317 [debug] [Thread-106]: Writing injected SQL for node "model.test.actual"
[0m05:51:27.281305 [debug] [Thread-107]: Writing injected SQL for node "model.test.expected"
[0m05:51:27.281766 [debug] [Thread-107]: finished collecting timing info
[0m05:51:27.281872 [debug] [Thread-106]: finished collecting timing info
[0m05:51:27.282031 [debug] [Thread-107]: Began executing node model.test.expected
[0m05:51:27.282178 [debug] [Thread-106]: Began executing node model.test.actual
[0m05:51:27.284509 [debug] [Thread-107]: Writing runtime sql for node "model.test.expected"
[0m05:51:27.286753 [debug] [Thread-106]: Writing runtime sql for node "model.test.actual"
[0m05:51:27.287158 [debug] [Thread-107]: Using vertica connection "model.test.expected"
[0m05:51:27.287280 [debug] [Thread-106]: Using vertica connection "model.test.actual"
[0m05:51:27.287415 [debug] [Thread-107]: On model.test.expected: BEGIN
[0m05:51:27.287545 [debug] [Thread-106]: On model.test.actual: BEGIN
[0m05:51:27.287666 [debug] [Thread-107]: Opening a new connection, currently in state init
[0m05:51:27.287791 [debug] [Thread-106]: Opening a new connection, currently in state closed
[0m05:51:27.302211 [debug] [Thread-106]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m05:51:27.303500 [debug] [Thread-107]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m05:51:27.306988 [debug] [Thread-106]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m05:51:27.307149 [debug] [Thread-106]: Using vertica connection "model.test.actual"
[0m05:51:27.307265 [debug] [Thread-106]: On model.test.actual: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.actual"} */

  create view "VMart"."test16667634867433083450_test_array_concat"."actual__dbt_tmp" as (
    select 1 as id, array_cat(
    array[ 1 , 2 , 3 ]
    , 
    array[ 4 , 5 , 6 ]
    ) as array_col union all
select 2 as id, array_cat(
    array[]::INT[]
    , 
    array[ 2 ]
    ) as array_col union all
select 3 as id, array_cat(
    array[ 3 ]
    , 
    array[]::INT[]
    ) as array_col
  );
[0m05:51:27.309074 [debug] [Thread-107]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m05:51:27.309206 [debug] [Thread-107]: Using vertica connection "model.test.expected"
[0m05:51:27.309306 [debug] [Thread-107]: On model.test.expected: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.expected"} */

  create view "VMart"."test16667634867433083450_test_array_concat"."expected__dbt_tmp" as (
    select 1 as id, 
    array[ 1 , 2 , 3 , 4 , 5 , 6 ]
     as array_col union all
select 2 as id, 
    array[ 2 ]
     as array_col union all
select 3 as id, 
    array[ 3 ]
     as array_col
  );
[0m05:51:27.316706 [debug] [Thread-106]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m05:51:27.319444 [debug] [Thread-106]: Using vertica connection "model.test.actual"
[0m05:51:27.319609 [debug] [Thread-106]: On model.test.actual: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.actual"} */
alter view "VMart"."test16667634867433083450_test_array_concat"."actual__dbt_tmp" rename to "actual"
[0m05:51:27.322842 [debug] [Thread-107]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m05:51:27.324388 [debug] [Thread-107]: Using vertica connection "model.test.expected"
[0m05:51:27.324535 [debug] [Thread-107]: On model.test.expected: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.expected"} */
alter view "VMart"."test16667634867433083450_test_array_concat"."expected__dbt_tmp" rename to "expected"
[0m05:51:27.327339 [debug] [Thread-106]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m05:51:27.328285 [debug] [Thread-106]: On model.test.actual: COMMIT
[0m05:51:27.328419 [debug] [Thread-106]: Using vertica connection "model.test.actual"
[0m05:51:27.328527 [debug] [Thread-106]: On model.test.actual: COMMIT
[0m05:51:27.333564 [debug] [Thread-106]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.0 seconds
[0m05:51:27.335215 [debug] [Thread-106]: Using vertica connection "model.test.actual"
[0m05:51:27.335381 [debug] [Thread-107]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m05:51:27.335613 [debug] [Thread-106]: On model.test.actual: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.actual"} */
drop view if exists "VMart"."test16667634867433083450_test_array_concat"."actual__dbt_backup" cascade
[0m05:51:27.336642 [debug] [Thread-107]: On model.test.expected: COMMIT
[0m05:51:27.336943 [debug] [Thread-107]: Using vertica connection "model.test.expected"
[0m05:51:27.337053 [debug] [Thread-107]: On model.test.expected: COMMIT
[0m05:51:27.342938 [debug] [Thread-107]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m05:51:27.344263 [debug] [Thread-107]: Using vertica connection "model.test.expected"
[0m05:51:27.344465 [debug] [Thread-107]: On model.test.expected: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.expected"} */
drop view if exists "VMart"."test16667634867433083450_test_array_concat"."expected__dbt_backup" cascade
[0m05:51:27.345304 [debug] [Thread-106]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m05:51:27.346079 [debug] [Thread-106]: finished collecting timing info
[0m05:51:27.346229 [debug] [Thread-106]: On model.test.actual: Close
[0m05:51:27.346730 [info ] [Thread-106]: 1 of 2 OK created sql view model test16667634867433083450_test_array_concat.actual  [[32mCode: None, Rows: -1, Array Size: 1[0m in 0.07s]
[0m05:51:27.347066 [debug] [Thread-106]: Finished running node model.test.actual
[0m05:51:27.352918 [debug] [Thread-107]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m05:51:27.353799 [debug] [Thread-107]: finished collecting timing info
[0m05:51:27.353987 [debug] [Thread-107]: On model.test.expected: Close
[0m05:51:27.354523 [info ] [Thread-107]: 2 of 2 OK created sql view model test16667634867433083450_test_array_concat.expected  [[32mCode: None, Rows: -1, Array Size: 1[0m in 0.08s]
[0m05:51:27.354872 [debug] [Thread-107]: Finished running node model.test.expected
[0m05:51:27.355960 [debug] [MainThread]: Acquiring new vertica connection "master"
[0m05:51:27.356152 [debug] [MainThread]: Using vertica connection "master"
[0m05:51:27.356273 [debug] [MainThread]: On master: BEGIN
[0m05:51:27.356376 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:51:27.372249 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m05:51:27.377587 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m05:51:27.377775 [debug] [MainThread]: On master: COMMIT
[0m05:51:27.377890 [debug] [MainThread]: Using vertica connection "master"
[0m05:51:27.378003 [debug] [MainThread]: On master: COMMIT
[0m05:51:27.382448 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.0 seconds
[0m05:51:27.382624 [debug] [MainThread]: On master: Close
[0m05:51:27.383084 [info ] [MainThread]: 
[0m05:51:27.383318 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.22 seconds (0.22s).
[0m05:51:27.383508 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:51:27.383616 [debug] [MainThread]: Connection 'model.test.actual' was properly closed.
[0m05:51:27.383710 [debug] [MainThread]: Connection 'model.test.expected' was properly closed.
[0m05:51:27.388026 [info ] [MainThread]: 
[0m05:51:27.388338 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:51:27.388565 [info ] [MainThread]: 
[0m05:51:27.388744 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m05:51:27.388989 [debug] [MainThread]: Flushing usage events


============================== 2022-10-26 05:51:27.406340 | b0c9e18b-7223-4cd6-9db5-0b5e90260df9 ==============================
[0m05:51:27.406353 [info ] [MainThread]: Running with dbt=1.3.0
[0m05:51:27.406823 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/tmp/pytest-of-sachin/pytest-37/profile11', 'send_anonymous_usage_stats': False, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
[0m05:51:27.407014 [debug] [MainThread]: Tracking: do not track
[0m05:51:27.430444 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:51:27.430672 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:51:27.439531 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 297 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m05:51:27.440234 [info ] [MainThread]: 
[0m05:51:27.440818 [debug] [MainThread]: Acquiring new vertica connection "master"
[0m05:51:27.441578 [debug] [ThreadPool]: Acquiring new vertica connection "list_VMart"
[0m05:51:27.443019 [debug] [ThreadPool]: Using vertica connection "list_VMart"
[0m05:51:27.443187 [debug] [ThreadPool]: On list_VMart: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "list_VMart"} */

    select schema_name
    from v_catalog.schemata
  
[0m05:51:27.443296 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:51:27.457800 [debug] [ThreadPool]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m05:51:27.474790 [debug] [ThreadPool]: SQL status: Code: [Column(name='schema_name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.03 seconds
[0m05:51:27.475916 [debug] [ThreadPool]: On list_VMart: Close
[0m05:51:27.477124 [debug] [ThreadPool]: Acquiring new vertica connection "list_VMart_test16667634867433083450_test_array_concat"
[0m05:51:27.478483 [debug] [ThreadPool]: Using vertica connection "list_VMart_test16667634867433083450_test_array_concat"
[0m05:51:27.478631 [debug] [ThreadPool]: On list_VMart_test16667634867433083450_test_array_concat: BEGIN
[0m05:51:27.478758 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:51:27.529833 [debug] [ThreadPool]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m05:51:27.546772 [debug] [ThreadPool]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.07 seconds
[0m05:51:27.547184 [debug] [ThreadPool]: Using vertica connection "list_VMart_test16667634867433083450_test_array_concat"
[0m05:51:27.547525 [debug] [ThreadPool]: On list_VMart_test16667634867433083450_test_array_concat: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "list_VMart_test16667634867433083450_test_array_concat"} */
select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'table' as type
    from v_catalog.tables
    where table_schema ilike 'test16667634867433083450_test_array_concat'
    union all
    select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'view' as type
    from v_catalog.views
    where table_schema ilike 'test16667634867433083450_test_array_concat'
  
[0m05:51:27.568966 [debug] [ThreadPool]: SQL status: Code: [Column(name='database', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='schema', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='type', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.02 seconds
[0m05:51:27.570882 [debug] [ThreadPool]: On list_VMart_test16667634867433083450_test_array_concat: ROLLBACK
[0m05:51:27.576977 [debug] [ThreadPool]: On list_VMart_test16667634867433083450_test_array_concat: Close
[0m05:51:27.578247 [debug] [MainThread]: Using vertica connection "master"
[0m05:51:27.578456 [debug] [MainThread]: On master: BEGIN
[0m05:51:27.578587 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:51:27.591351 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m05:51:27.595580 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m05:51:27.595959 [debug] [MainThread]: On master: COMMIT
[0m05:51:27.596116 [debug] [MainThread]: Using vertica connection "master"
[0m05:51:27.596236 [debug] [MainThread]: On master: COMMIT
[0m05:51:27.600887 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.0 seconds
[0m05:51:27.601178 [debug] [MainThread]: On master: Close
[0m05:51:27.601694 [info ] [MainThread]: Concurrency: 4 threads (target='default')
[0m05:51:27.602007 [info ] [MainThread]: 
[0m05:51:27.603368 [debug] [Thread-113]: Began running node model.test.actual
[0m05:51:27.603498 [debug] [Thread-114]: Began running node model.test.expected
[0m05:51:27.603752 [info ] [Thread-113]: 1 of 2 START sql view model test16667634867433083450_test_array_concat.actual .. [RUN]
[0m05:51:27.603994 [info ] [Thread-114]: 2 of 2 START sql view model test16667634867433083450_test_array_concat.expected  [RUN]
[0m05:51:27.604515 [debug] [Thread-113]: Acquiring new vertica connection "model.test.actual"
[0m05:51:27.605043 [debug] [Thread-114]: Acquiring new vertica connection "model.test.expected"
[0m05:51:27.605199 [debug] [Thread-113]: Began compiling node model.test.actual
[0m05:51:27.605347 [debug] [Thread-114]: Began compiling node model.test.expected
[0m05:51:27.605483 [debug] [Thread-113]: Compiling model.test.actual
[0m05:51:27.605621 [debug] [Thread-114]: Compiling model.test.expected
[0m05:51:27.609742 [debug] [Thread-113]: Writing injected SQL for node "model.test.actual"
[0m05:51:27.612673 [debug] [Thread-114]: Writing injected SQL for node "model.test.expected"
[0m05:51:27.613135 [debug] [Thread-113]: finished collecting timing info
[0m05:51:27.613275 [debug] [Thread-114]: finished collecting timing info
[0m05:51:27.613418 [debug] [Thread-113]: Began executing node model.test.actual
[0m05:51:27.613571 [debug] [Thread-114]: Began executing node model.test.expected
[0m05:51:27.616220 [debug] [Thread-113]: Writing runtime sql for node "model.test.actual"
[0m05:51:27.618714 [debug] [Thread-114]: Writing runtime sql for node "model.test.expected"
[0m05:51:27.619171 [debug] [Thread-113]: Using vertica connection "model.test.actual"
[0m05:51:27.619302 [debug] [Thread-114]: Using vertica connection "model.test.expected"
[0m05:51:27.619440 [debug] [Thread-113]: On model.test.actual: BEGIN
[0m05:51:27.619560 [debug] [Thread-114]: On model.test.expected: BEGIN
[0m05:51:27.619674 [debug] [Thread-113]: Opening a new connection, currently in state closed
[0m05:51:27.619793 [debug] [Thread-114]: Opening a new connection, currently in state init
[0m05:51:27.632418 [debug] [Thread-114]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m05:51:27.636723 [debug] [Thread-114]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m05:51:27.636931 [debug] [Thread-114]: Using vertica connection "model.test.expected"
[0m05:51:27.637058 [debug] [Thread-114]: On model.test.expected: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.expected"} */

  create view "VMart"."test16667634867433083450_test_array_concat"."expected__dbt_tmp" as (
    select 1 as id, 
    array[ 1 , 2 , 3 , 4 , 5 , 6 ]
     as array_col union all
select 2 as id, 
    array[ 2 ]
     as array_col union all
select 3 as id, 
    array[ 3 ]
     as array_col
  );
[0m05:51:27.645253 [debug] [Thread-114]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m05:51:27.647628 [debug] [Thread-114]: Using vertica connection "model.test.expected"
[0m05:51:27.647835 [debug] [Thread-114]: On model.test.expected: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.expected"} */
alter view "VMart"."test16667634867433083450_test_array_concat"."expected" rename to "expected__dbt_backup"
[0m05:51:27.649367 [debug] [Thread-113]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m05:51:27.655785 [debug] [Thread-114]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m05:51:27.658658 [debug] [Thread-114]: Using vertica connection "model.test.expected"
[0m05:51:27.658849 [debug] [Thread-114]: On model.test.expected: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.expected"} */
alter view "VMart"."test16667634867433083450_test_array_concat"."expected__dbt_tmp" rename to "expected"
[0m05:51:27.662174 [debug] [Thread-113]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.04 seconds
[0m05:51:27.662391 [debug] [Thread-113]: Using vertica connection "model.test.actual"
[0m05:51:27.662507 [debug] [Thread-113]: On model.test.actual: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.actual"} */

  create view "VMart"."test16667634867433083450_test_array_concat"."actual__dbt_tmp" as (
    select 1 as id, array_cat(
    array[ 1 , 2 , 3 ]
    , 
    array[ 4 , 5 , 6 ]
    ) as array_col union all
select 2 as id, array_cat(
    array[]::INT[]
    , 
    array[ 2 ]
    ) as array_col union all
select 3 as id, array_cat(
    array[ 3 ]
    , 
    array[]::INT[]
    ) as array_col
  );
[0m05:51:27.670024 [debug] [Thread-114]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m05:51:27.672004 [debug] [Thread-114]: On model.test.expected: COMMIT
[0m05:51:27.672244 [debug] [Thread-114]: Using vertica connection "model.test.expected"
[0m05:51:27.672363 [debug] [Thread-114]: On model.test.expected: COMMIT
[0m05:51:27.677200 [debug] [Thread-113]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m05:51:27.679303 [debug] [Thread-113]: Using vertica connection "model.test.actual"
[0m05:51:27.679499 [debug] [Thread-113]: On model.test.actual: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.actual"} */
alter view "VMart"."test16667634867433083450_test_array_concat"."actual" rename to "actual__dbt_backup"
[0m05:51:27.679730 [debug] [Thread-114]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m05:51:27.681107 [debug] [Thread-114]: Using vertica connection "model.test.expected"
[0m05:51:27.681269 [debug] [Thread-114]: On model.test.expected: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.expected"} */
drop view if exists "VMart"."test16667634867433083450_test_array_concat"."expected__dbt_backup" cascade
[0m05:51:27.692113 [debug] [Thread-114]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m05:51:27.693166 [debug] [Thread-114]: finished collecting timing info
[0m05:51:27.693461 [debug] [Thread-114]: On model.test.expected: Close
[0m05:51:27.694331 [info ] [Thread-114]: 2 of 2 OK created sql view model test16667634867433083450_test_array_concat.expected  [[32mCode: None, Rows: -1, Array Size: 1[0m in 0.09s]
[0m05:51:27.694752 [debug] [Thread-114]: Finished running node model.test.expected
[0m05:51:27.695092 [debug] [Thread-113]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m05:51:27.697098 [debug] [Thread-113]: Using vertica connection "model.test.actual"
[0m05:51:27.697259 [debug] [Thread-113]: On model.test.actual: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.actual"} */
alter view "VMart"."test16667634867433083450_test_array_concat"."actual__dbt_tmp" rename to "actual"
[0m05:51:27.713584 [debug] [Thread-113]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m05:51:27.714914 [debug] [Thread-113]: On model.test.actual: COMMIT
[0m05:51:27.715103 [debug] [Thread-113]: Using vertica connection "model.test.actual"
[0m05:51:27.715227 [debug] [Thread-113]: On model.test.actual: COMMIT
[0m05:51:27.729888 [debug] [Thread-113]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m05:51:27.731706 [debug] [Thread-113]: Using vertica connection "model.test.actual"
[0m05:51:27.731912 [debug] [Thread-113]: On model.test.actual: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.actual"} */
drop view if exists "VMart"."test16667634867433083450_test_array_concat"."actual__dbt_backup" cascade
[0m05:51:27.741187 [debug] [Thread-113]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m05:51:27.742342 [debug] [Thread-113]: finished collecting timing info
[0m05:51:27.742552 [debug] [Thread-113]: On model.test.actual: Close
[0m05:51:27.743110 [info ] [Thread-113]: 1 of 2 OK created sql view model test16667634867433083450_test_array_concat.actual  [[32mCode: None, Rows: -1, Array Size: 1[0m in 0.14s]
[0m05:51:27.743508 [debug] [Thread-113]: Finished running node model.test.actual
[0m05:51:27.744688 [debug] [MainThread]: Acquiring new vertica connection "master"
[0m05:51:27.744976 [debug] [MainThread]: Using vertica connection "master"
[0m05:51:27.745165 [debug] [MainThread]: On master: BEGIN
[0m05:51:27.745339 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:51:27.759508 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m05:51:27.765003 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m05:51:27.765392 [debug] [MainThread]: On master: COMMIT
[0m05:51:27.765593 [debug] [MainThread]: Using vertica connection "master"
[0m05:51:27.765773 [debug] [MainThread]: On master: COMMIT
[0m05:51:27.770409 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.0 seconds
[0m05:51:27.770808 [debug] [MainThread]: On master: Close
[0m05:51:27.771574 [info ] [MainThread]: 
[0m05:51:27.772020 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m05:51:27.772364 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:51:27.772544 [debug] [MainThread]: Connection 'model.test.actual' was properly closed.
[0m05:51:27.772694 [debug] [MainThread]: Connection 'model.test.expected' was properly closed.
[0m05:51:27.780301 [info ] [MainThread]: 
[0m05:51:27.780816 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:51:27.781228 [info ] [MainThread]: 
[0m05:51:27.781551 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m05:51:27.781993 [debug] [MainThread]: Flushing usage events
[0m05:51:27.782741 [debug] [MainThread]: Acquiring new vertica connection "_test"
[0m05:51:27.784970 [debug] [MainThread]: Using vertica connection "_test"
[0m05:51:27.785263 [debug] [MainThread]: On _test: BEGIN
[0m05:51:27.785462 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:51:27.800193 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m05:51:27.805723 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m05:51:27.806097 [debug] [MainThread]: Using vertica connection "_test"
[0m05:51:27.806306 [debug] [MainThread]: On _test: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "_test"} */

    select
    column_name
    , data_type
    , character_maximum_length
    , numeric_precision
    , numeric_scale
    from (
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.columns
        where table_schema = 'test16667634867433083450_test_array_concat'
        and table_name = 'expected'
        union all
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.view_columns
        where table_schema = 'test16667634867433083450_test_array_concat'
        and table_name = 'expected'
    ) t
    order by ordinal_position
  
[0m05:51:27.841377 [debug] [MainThread]: SQL status: Code: [Column(name='column_name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='data_type', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='character_maximum_length', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_precision', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_scale', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.03 seconds
[0m05:51:27.843481 [debug] [MainThread]: Using vertica connection "_test"
[0m05:51:27.843803 [debug] [MainThread]: On _test: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "_test"} */
with diff_count as (
    SELECT
        1 as id,
        COUNT(*) as num_missing FROM (
            (SELECT "array_col", "id" FROM "VMart"."test16667634867433083450_test_array_concat"."expected" EXCEPT
             SELECT "array_col", "id" FROM "VMart"."test16667634867433083450_test_array_concat"."actual")
             UNION ALL
            (SELECT "array_col", "id" FROM "VMart"."test16667634867433083450_test_array_concat"."actual" EXCEPT
             SELECT "array_col", "id" FROM "VMart"."test16667634867433083450_test_array_concat"."expected")
        ) as a
), table_a as (
    SELECT COUNT(*) as num_rows FROM "VMart"."test16667634867433083450_test_array_concat"."expected"
), table_b as (
    SELECT COUNT(*) as num_rows FROM "VMart"."test16667634867433083450_test_array_concat"."actual"
), row_count_diff as (
    select
        1 as id,
        table_a.num_rows - table_b.num_rows as difference
    from table_a, table_b
)
select
    row_count_diff.difference as row_count_difference,
    diff_count.num_missing as num_mismatched
from row_count_diff
join diff_count using (id)
[0m05:51:27.901384 [debug] [MainThread]: SQL status: Code: [Column(name='row_count_difference', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='num_mismatched', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.06 seconds
[0m05:51:27.902856 [debug] [MainThread]: On _test: ROLLBACK
[0m05:51:27.908684 [debug] [MainThread]: On _test: Close
[0m05:51:27.909945 [debug] [MainThread]: Acquiring new vertica connection "_test"
[0m05:51:27.912237 [debug] [MainThread]: Using vertica connection "_test"
[0m05:51:27.912536 [debug] [MainThread]: On _test: BEGIN
[0m05:51:27.912723 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:51:27.926769 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m05:51:27.930901 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m05:51:27.931276 [debug] [MainThread]: Using vertica connection "_test"
[0m05:51:27.931482 [debug] [MainThread]: On _test: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "_test"} */

    select
    column_name
    , data_type
    , character_maximum_length
    , numeric_precision
    , numeric_scale
    from (
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.columns
        where table_schema = 'test16667634867433083450_test_array_concat'
        and table_name = 'expected'
        union all
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.view_columns
        where table_schema = 'test16667634867433083450_test_array_concat'
        and table_name = 'expected'
    ) t
    order by ordinal_position
  
[0m05:51:27.959220 [debug] [MainThread]: SQL status: Code: [Column(name='column_name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='data_type', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='character_maximum_length', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_precision', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_scale', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.03 seconds
[0m05:51:27.960946 [debug] [MainThread]: On _test: ROLLBACK
[0m05:51:27.967392 [debug] [MainThread]: On _test: Close
[0m05:51:27.968592 [debug] [MainThread]: Acquiring new vertica connection "_test"
[0m05:51:27.972139 [debug] [MainThread]: Using vertica connection "_test"
[0m05:51:27.972471 [debug] [MainThread]: On _test: BEGIN
[0m05:51:27.972648 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:51:27.989012 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m05:51:27.994226 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m05:51:27.994623 [debug] [MainThread]: Using vertica connection "_test"
[0m05:51:27.994812 [debug] [MainThread]: On _test: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "_test"} */

    select
    column_name
    , data_type
    , character_maximum_length
    , numeric_precision
    , numeric_scale
    from (
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.columns
        where table_schema = 'test16667634867433083450_test_array_concat'
        and table_name = 'actual'
        union all
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.view_columns
        where table_schema = 'test16667634867433083450_test_array_concat'
        and table_name = 'actual'
    ) t
    order by ordinal_position
  
[0m05:51:28.019871 [debug] [MainThread]: SQL status: Code: [Column(name='column_name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='data_type', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='character_maximum_length', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_precision', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_scale', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.02 seconds
[0m05:51:28.021746 [debug] [MainThread]: On _test: ROLLBACK
[0m05:51:28.026038 [debug] [MainThread]: On _test: Close
[0m05:51:28.027818 [debug] [MainThread]: Acquiring new vertica connection "_test"
[0m05:51:28.028216 [debug] [MainThread]: Dropping schema "_ReferenceKey(database='vmart', schema='test16667634867433083450_test_array_concat', identifier=None)".
[0m05:51:28.030488 [debug] [MainThread]: Using vertica connection "_test"
[0m05:51:28.030791 [debug] [MainThread]: On _test: BEGIN
[0m05:51:28.030966 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:51:28.047821 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m05:51:28.055234 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m05:51:28.055614 [debug] [MainThread]: Using vertica connection "_test"
[0m05:51:28.055786 [debug] [MainThread]: On _test: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "_test"} */
drop schema if exists "test16667634867433083450_test_array_concat" cascade
  
[0m05:51:28.068833 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m05:51:28.070197 [debug] [MainThread]: On _test: COMMIT
[0m05:51:28.070474 [debug] [MainThread]: Using vertica connection "_test"
[0m05:51:28.070603 [debug] [MainThread]: On _test: COMMIT
[0m05:51:28.075290 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.0 seconds
[0m05:51:28.075627 [debug] [MainThread]: On _test: Close
[0m05:51:28.076394 [debug] [MainThread]: Connection '_test' was properly closed.
[0m05:51:28.094016 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
[0m05:51:28.094978 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m05:51:28.095224 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m05:51:28.095421 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m05:51:28.100660 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m05:51:28.101890 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m05:51:28.106654 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m05:51:28.111120 [debug] [MainThread]: Parsing macros/materializations/models/incremental/helpers.sql
[0m05:51:28.114326 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m05:51:28.120456 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m05:51:28.122258 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m05:51:28.128756 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m05:51:28.131257 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m05:51:28.143960 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m05:51:28.146180 [debug] [MainThread]: Parsing macros/materializations/snapshots/helper.sql
[0m05:51:28.147065 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m05:51:28.156193 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m05:51:28.162591 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m05:51:28.163828 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m05:51:28.164653 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m05:51:28.168414 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m05:51:28.171451 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m05:51:28.178373 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m05:51:28.179738 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m05:51:28.182462 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m05:51:28.184513 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m05:51:28.187514 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m05:51:28.188669 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m05:51:28.192583 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m05:51:28.194387 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m05:51:28.196871 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m05:51:28.207513 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m05:51:28.213139 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m05:51:28.214520 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m05:51:28.221835 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m05:51:28.226700 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m05:51:28.239248 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m05:51:28.241983 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m05:51:28.245872 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m05:51:28.255160 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m05:51:28.256508 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m05:51:28.264715 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m05:51:28.276114 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m05:51:28.277581 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m05:51:28.278997 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m05:51:28.282285 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m05:51:28.294810 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m05:51:28.299840 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m05:51:28.301202 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m05:51:28.302453 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m05:51:28.304223 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m05:51:28.305712 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m05:51:28.307666 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m05:51:28.314359 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m05:51:28.324274 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m05:51:28.329608 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m05:51:28.339073 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m05:51:28.340818 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m05:51:28.343438 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m05:51:28.346677 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m05:51:28.351079 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m05:51:28.352275 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m05:51:28.353386 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m05:51:28.354235 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m05:51:28.355295 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m05:51:28.356452 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m05:51:28.357251 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m05:51:28.358007 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m05:51:28.358823 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m05:51:28.360338 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m05:51:28.361005 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m05:51:28.361960 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m05:51:28.362800 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m05:51:28.367869 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m05:51:28.368740 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m05:51:28.369716 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m05:51:28.370544 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m05:51:28.371507 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m05:51:28.372323 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m05:51:28.373968 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m05:51:28.374746 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m05:51:28.375406 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m05:51:28.376218 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m05:51:28.377027 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m05:51:28.378360 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m05:51:28.379711 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m05:51:28.380444 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m05:51:28.380992 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m05:51:28.382115 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m05:51:28.385801 [debug] [MainThread]: Parsing macros/etc/datetime.sql
