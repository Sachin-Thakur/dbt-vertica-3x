[0m11:41:39.852180 [debug] [MainThread]: Acquiring new vertica connection "_test"
[0m11:41:39.852337 [debug] [MainThread]: Acquiring new vertica connection "_test"
[0m11:41:39.852522 [debug] [MainThread]: Creating schema "_ReferenceKey(database='vmart', schema='test16666981002150244869_test_array_construct', identifier=None)"
[0m11:41:39.854059 [debug] [MainThread]: Using vertica connection "_test"
[0m11:41:39.854192 [debug] [MainThread]: On _test: BEGIN
[0m11:41:39.854306 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:41:39.875398 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:41:39.882297 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.03 seconds
[0m11:41:39.882622 [debug] [MainThread]: Using vertica connection "_test"
[0m11:41:39.882836 [debug] [MainThread]: On _test: create schema if not exists "test16666981002150244869_test_array_construct"
  
[0m11:41:39.900942 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m11:41:39.902792 [debug] [MainThread]: On _test: COMMIT
[0m11:41:39.903210 [debug] [MainThread]: Using vertica connection "_test"
[0m11:41:39.903570 [debug] [MainThread]: On _test: COMMIT
[0m11:41:39.912322 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:41:39.912946 [debug] [MainThread]: On _test: Close
[0m11:41:39.929087 [debug] [MainThread]: Connection '_test' was properly closed.


============================== 2022-10-25 11:41:39.935038 | 12c916b4-5ca7-4d0b-b674-5d9e6507415e ==============================
[0m11:41:39.935046 [info ] [MainThread]: Running with dbt=1.3.0
[0m11:41:39.935349 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/tmp/pytest-of-sachin/pytest-28/profile2', 'send_anonymous_usage_stats': False, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
[0m11:41:39.935458 [debug] [MainThread]: Tracking: do not track
[0m11:41:39.941047 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
[0m11:41:39.948632 [debug] [MainThread]: Parsing macros/test_assert_equal.sql
[0m11:41:39.949152 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m11:41:39.949312 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m11:41:39.949437 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m11:41:39.953677 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m11:41:39.954503 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m11:41:39.955073 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m11:41:39.957569 [debug] [MainThread]: Parsing macros/materializations/models/incremental/helpers.sql
[0m11:41:39.959302 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m11:41:39.962868 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m11:41:39.963828 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m11:41:39.967548 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m11:41:39.968802 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m11:41:39.975624 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m11:41:39.976610 [debug] [MainThread]: Parsing macros/materializations/snapshots/helper.sql
[0m11:41:39.976757 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m11:41:39.981878 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m11:41:39.985404 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m11:41:39.985960 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m11:41:39.986376 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m11:41:39.988211 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m11:41:39.989769 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m11:41:39.993729 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m11:41:39.994566 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m11:41:39.995236 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m11:41:39.996658 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m11:41:39.998894 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m11:41:39.999772 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m11:41:40.002911 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m11:41:40.004279 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m11:41:40.006288 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m11:41:40.015274 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m11:41:40.020052 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m11:41:40.020950 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m11:41:40.027505 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m11:41:40.031478 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m11:41:40.041388 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m11:41:40.043455 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m11:41:40.046680 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m11:41:40.054215 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m11:41:40.055219 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m11:41:40.062088 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m11:41:40.071575 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m11:41:40.072660 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m11:41:40.073730 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m11:41:40.076362 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m11:41:40.087104 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m11:41:40.091141 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m11:41:40.092047 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m11:41:40.093001 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m11:41:40.094458 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m11:41:40.095677 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m11:41:40.097327 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m11:41:40.103031 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m11:41:40.111621 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m11:41:40.115895 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m11:41:40.123914 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m11:41:40.125221 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m11:41:40.127239 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m11:41:40.129828 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m11:41:40.133396 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m11:41:40.134159 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m11:41:40.134800 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m11:41:40.135385 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m11:41:40.136130 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m11:41:40.137019 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m11:41:40.137626 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m11:41:40.138192 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m11:41:40.138822 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m11:41:40.140045 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m11:41:40.140559 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m11:41:40.141333 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m11:41:40.142050 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m11:41:40.146569 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m11:41:40.147306 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m11:41:40.148117 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m11:41:40.148820 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m11:41:40.149854 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m11:41:40.150546 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m11:41:40.151949 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m11:41:40.152562 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m11:41:40.153082 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m11:41:40.153761 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m11:41:40.154468 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m11:41:40.155661 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m11:41:40.156507 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m11:41:40.157073 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m11:41:40.157524 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m11:41:40.158138 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m11:41:40.161244 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m11:41:40.166287 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m11:41:40.317577 [debug] [MainThread]: 1603: static parser failed on actual.sql
[0m11:41:40.320453 [debug] [MainThread]: 1602: parser fallback to jinja rendering on actual.sql
[0m11:41:40.321244 [debug] [MainThread]: 1603: static parser failed on expected.sql
[0m11:41:40.323826 [debug] [MainThread]: 1602: parser fallback to jinja rendering on expected.sql
[0m11:41:40.344832 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 297 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m11:41:40.345476 [info ] [MainThread]: 
[0m11:41:40.345948 [debug] [MainThread]: Acquiring new vertica connection "master"
[0m11:41:40.346734 [debug] [ThreadPool]: Acquiring new vertica connection "list_VMart"
[0m11:41:40.348014 [debug] [ThreadPool]: Using vertica connection "list_VMart"
[0m11:41:40.348148 [debug] [ThreadPool]: On list_VMart: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "list_VMart"} */

    select schema_name
    from v_catalog.schemata
  
[0m11:41:40.348245 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:41:40.369976 [debug] [ThreadPool]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:41:40.389977 [debug] [ThreadPool]: SQL status: Code: [Column(name='schema_name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.04 seconds
[0m11:41:40.392703 [debug] [ThreadPool]: On list_VMart: Close
[0m11:41:40.395670 [debug] [ThreadPool]: Acquiring new vertica connection "list_VMart_test16666981002150244869_test_array_construct"
[0m11:41:40.399789 [debug] [ThreadPool]: Using vertica connection "list_VMart_test16666981002150244869_test_array_construct"
[0m11:41:40.400246 [debug] [ThreadPool]: On list_VMart_test16666981002150244869_test_array_construct: BEGIN
[0m11:41:40.400579 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:41:40.418753 [debug] [ThreadPool]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:41:40.424287 [debug] [ThreadPool]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m11:41:40.424838 [debug] [ThreadPool]: Using vertica connection "list_VMart_test16666981002150244869_test_array_construct"
[0m11:41:40.425182 [debug] [ThreadPool]: On list_VMart_test16666981002150244869_test_array_construct: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "list_VMart_test16666981002150244869_test_array_construct"} */
select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'table' as type
    from v_catalog.tables
    where table_schema ilike 'test16666981002150244869_test_array_construct'
    union all
    select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'view' as type
    from v_catalog.views
    where table_schema ilike 'test16666981002150244869_test_array_construct'
  
[0m11:41:40.447241 [debug] [ThreadPool]: SQL status: Code: [Column(name='database', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='schema', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='type', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.02 seconds
[0m11:41:40.450046 [debug] [ThreadPool]: On list_VMart_test16666981002150244869_test_array_construct: ROLLBACK
[0m11:41:40.457265 [debug] [ThreadPool]: On list_VMart_test16666981002150244869_test_array_construct: Close
[0m11:41:40.459257 [debug] [MainThread]: Using vertica connection "master"
[0m11:41:40.459768 [debug] [MainThread]: On master: BEGIN
[0m11:41:40.460140 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:41:40.476732 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:41:40.482437 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m11:41:40.483073 [debug] [MainThread]: On master: COMMIT
[0m11:41:40.483558 [debug] [MainThread]: Using vertica connection "master"
[0m11:41:40.483885 [debug] [MainThread]: On master: COMMIT
[0m11:41:40.490355 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:41:40.490955 [debug] [MainThread]: On master: Close
[0m11:41:40.492178 [info ] [MainThread]: Concurrency: 4 threads (target='default')
[0m11:41:40.492933 [info ] [MainThread]: 
[0m11:41:40.495697 [debug] [Thread-29 ]: Began running node model.test.actual
[0m11:41:40.496169 [debug] [Thread-30 ]: Began running node model.test.expected
[0m11:41:40.496422 [info ] [Thread-29 ]: 1 of 2 START sql view model test16666981002150244869_test_array_construct.actual  [RUN]
[0m11:41:40.496757 [info ] [Thread-30 ]: 2 of 2 START sql view model test16666981002150244869_test_array_construct.expected  [RUN]
[0m11:41:40.497333 [debug] [Thread-29 ]: Acquiring new vertica connection "model.test.actual"
[0m11:41:40.497879 [debug] [Thread-30 ]: Acquiring new vertica connection "model.test.expected"
[0m11:41:40.498136 [debug] [Thread-29 ]: Began compiling node model.test.actual
[0m11:41:40.498357 [debug] [Thread-30 ]: Began compiling node model.test.expected
[0m11:41:40.498540 [debug] [Thread-29 ]: Compiling model.test.actual
[0m11:41:40.498709 [debug] [Thread-30 ]: Compiling model.test.expected
[0m11:41:40.501148 [debug] [Thread-29 ]: Writing injected SQL for node "model.test.actual"
[0m11:41:40.503708 [debug] [Thread-30 ]: Writing injected SQL for node "model.test.expected"
[0m11:41:40.504227 [debug] [Thread-29 ]: finished collecting timing info
[0m11:41:40.504398 [debug] [Thread-29 ]: Began executing node model.test.actual
[0m11:41:40.506746 [debug] [Thread-29 ]: Writing runtime sql for node "model.test.actual"
[0m11:41:40.506910 [debug] [Thread-30 ]: finished collecting timing info
[0m11:41:40.507155 [debug] [Thread-30 ]: Began executing node model.test.expected
[0m11:41:40.509428 [debug] [Thread-30 ]: Writing runtime sql for node "model.test.expected"
[0m11:41:40.509698 [debug] [Thread-29 ]: Using vertica connection "model.test.actual"
[0m11:41:40.509818 [debug] [Thread-30 ]: Using vertica connection "model.test.expected"
[0m11:41:40.509953 [debug] [Thread-29 ]: On model.test.actual: BEGIN
[0m11:41:40.510082 [debug] [Thread-30 ]: On model.test.expected: BEGIN
[0m11:41:40.510201 [debug] [Thread-29 ]: Opening a new connection, currently in state closed
[0m11:41:40.510323 [debug] [Thread-30 ]: Opening a new connection, currently in state init
[0m11:41:40.530275 [debug] [Thread-30 ]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:41:40.530515 [debug] [Thread-29 ]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:41:40.535949 [debug] [Thread-29 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.03 seconds
[0m11:41:40.536171 [debug] [Thread-29 ]: Using vertica connection "model.test.actual"
[0m11:41:40.536330 [debug] [Thread-30 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.03 seconds
[0m11:41:40.536493 [debug] [Thread-29 ]: On model.test.actual: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.actual"} */

  create view "VMart"."test16666981002150244869_test_array_construct"."actual__dbt_tmp" as (
    select 1 as id, 
    array[ 1 , 2 , 3 ]
     as array_col union all
select 2 as id, 
    array[]::INT[]
     as array_col
  );
[0m11:41:40.536695 [debug] [Thread-30 ]: Using vertica connection "model.test.expected"
[0m11:41:40.536942 [debug] [Thread-30 ]: On model.test.expected: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.expected"} */

  create view "VMart"."test16666981002150244869_test_array_construct"."expected__dbt_tmp" as (
    select 1 as id, 
    array[ 1 , 2 , 3 ]
     as array_col union all
select 2 as id, 
    array[]::INT[]
     as array_col
  );
[0m11:41:40.549752 [debug] [Thread-30 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:41:40.551680 [debug] [Thread-30 ]: Using vertica connection "model.test.expected"
[0m11:41:40.551831 [debug] [Thread-30 ]: On model.test.expected: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.expected"} */
alter view "VMart"."test16666981002150244869_test_array_construct"."expected__dbt_tmp" rename to "expected"
[0m11:41:40.552700 [debug] [Thread-29 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m11:41:40.556516 [debug] [Thread-29 ]: Using vertica connection "model.test.actual"
[0m11:41:40.556819 [debug] [Thread-29 ]: On model.test.actual: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.actual"} */
alter view "VMart"."test16666981002150244869_test_array_construct"."actual__dbt_tmp" rename to "actual"
[0m11:41:40.563404 [debug] [Thread-30 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:41:40.564538 [debug] [Thread-30 ]: On model.test.expected: COMMIT
[0m11:41:40.564694 [debug] [Thread-30 ]: Using vertica connection "model.test.expected"
[0m11:41:40.564808 [debug] [Thread-30 ]: On model.test.expected: COMMIT
[0m11:41:40.569695 [debug] [Thread-29 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:41:40.569905 [debug] [Thread-30 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.0 seconds
[0m11:41:40.571340 [debug] [Thread-29 ]: On model.test.actual: COMMIT
[0m11:41:40.572725 [debug] [Thread-30 ]: Using vertica connection "model.test.expected"
[0m11:41:40.572972 [debug] [Thread-29 ]: Using vertica connection "model.test.actual"
[0m11:41:40.573206 [debug] [Thread-30 ]: On model.test.expected: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.expected"} */
drop view if exists "VMart"."test16666981002150244869_test_array_construct"."expected__dbt_backup" cascade
[0m11:41:40.573433 [debug] [Thread-29 ]: On model.test.actual: COMMIT
[0m11:41:40.581941 [debug] [Thread-29 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:41:40.582184 [debug] [Thread-30 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:41:40.584298 [debug] [Thread-29 ]: Using vertica connection "model.test.actual"
[0m11:41:40.585175 [debug] [Thread-30 ]: finished collecting timing info
[0m11:41:40.585371 [debug] [Thread-29 ]: On model.test.actual: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.actual"} */
drop view if exists "VMart"."test16666981002150244869_test_array_construct"."actual__dbt_backup" cascade
[0m11:41:40.585584 [debug] [Thread-30 ]: On model.test.expected: Close
[0m11:41:40.586327 [info ] [Thread-30 ]: 2 of 2 OK created sql view model test16666981002150244869_test_array_construct.expected  [[32mCode: None, Rows: -1, Array Size: 1[0m in 0.09s]
[0m11:41:40.586663 [debug] [Thread-30 ]: Finished running node model.test.expected
[0m11:41:40.593671 [debug] [Thread-29 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:41:40.594807 [debug] [Thread-29 ]: finished collecting timing info
[0m11:41:40.595058 [debug] [Thread-29 ]: On model.test.actual: Close
[0m11:41:40.595796 [info ] [Thread-29 ]: 1 of 2 OK created sql view model test16666981002150244869_test_array_construct.actual  [[32mCode: None, Rows: -1, Array Size: 1[0m in 0.10s]
[0m11:41:40.596308 [debug] [Thread-29 ]: Finished running node model.test.actual
[0m11:41:40.597434 [debug] [MainThread]: Acquiring new vertica connection "master"
[0m11:41:40.597599 [debug] [MainThread]: Using vertica connection "master"
[0m11:41:40.597713 [debug] [MainThread]: On master: BEGIN
[0m11:41:40.597816 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:41:40.612822 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:41:40.618469 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m11:41:40.618687 [debug] [MainThread]: On master: COMMIT
[0m11:41:40.618820 [debug] [MainThread]: Using vertica connection "master"
[0m11:41:40.618928 [debug] [MainThread]: On master: COMMIT
[0m11:41:40.624272 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:41:40.624476 [debug] [MainThread]: On master: Close
[0m11:41:40.624984 [info ] [MainThread]: 
[0m11:41:40.625240 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m11:41:40.625446 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:41:40.625538 [debug] [MainThread]: Connection 'model.test.actual' was properly closed.
[0m11:41:40.625653 [debug] [MainThread]: Connection 'model.test.expected' was properly closed.
[0m11:41:40.629774 [info ] [MainThread]: 
[0m11:41:40.630066 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:41:40.630295 [info ] [MainThread]: 
[0m11:41:40.630469 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m11:41:40.630712 [debug] [MainThread]: Flushing usage events


============================== 2022-10-25 11:41:40.651672 | 12c916b4-5ca7-4d0b-b674-5d9e6507415e ==============================
[0m11:41:40.651689 [info ] [MainThread]: Running with dbt=1.3.0
[0m11:41:40.652272 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/tmp/pytest-of-sachin/pytest-28/profile2', 'send_anonymous_usage_stats': False, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
[0m11:41:40.652544 [debug] [MainThread]: Tracking: do not track
[0m11:41:40.674485 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:41:40.674704 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:41:40.682435 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 297 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m11:41:40.683159 [info ] [MainThread]: 
[0m11:41:40.683683 [debug] [MainThread]: Acquiring new vertica connection "master"
[0m11:41:40.684426 [debug] [ThreadPool]: Acquiring new vertica connection "list_VMart"
[0m11:41:40.686328 [debug] [ThreadPool]: Using vertica connection "list_VMart"
[0m11:41:40.686723 [debug] [ThreadPool]: On list_VMart: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "list_VMart"} */

    select schema_name
    from v_catalog.schemata
  
[0m11:41:40.686851 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:41:40.708155 [debug] [ThreadPool]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:41:40.728410 [debug] [ThreadPool]: SQL status: Code: [Column(name='schema_name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.04 seconds
[0m11:41:40.729486 [debug] [ThreadPool]: On list_VMart: Close
[0m11:41:40.730682 [debug] [ThreadPool]: Acquiring new vertica connection "list_VMart_test16666981002150244869_test_array_construct"
[0m11:41:40.732302 [debug] [ThreadPool]: Using vertica connection "list_VMart_test16666981002150244869_test_array_construct"
[0m11:41:40.732520 [debug] [ThreadPool]: On list_VMart_test16666981002150244869_test_array_construct: BEGIN
[0m11:41:40.732637 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:41:40.751308 [debug] [ThreadPool]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:41:40.756780 [debug] [ThreadPool]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m11:41:40.757078 [debug] [ThreadPool]: Using vertica connection "list_VMart_test16666981002150244869_test_array_construct"
[0m11:41:40.757260 [debug] [ThreadPool]: On list_VMart_test16666981002150244869_test_array_construct: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "list_VMart_test16666981002150244869_test_array_construct"} */
select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'table' as type
    from v_catalog.tables
    where table_schema ilike 'test16666981002150244869_test_array_construct'
    union all
    select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'view' as type
    from v_catalog.views
    where table_schema ilike 'test16666981002150244869_test_array_construct'
  
[0m11:41:40.782386 [debug] [ThreadPool]: SQL status: Code: [Column(name='database', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='schema', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='type', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.02 seconds
[0m11:41:40.783509 [debug] [ThreadPool]: On list_VMart_test16666981002150244869_test_array_construct: ROLLBACK
[0m11:41:40.790214 [debug] [ThreadPool]: On list_VMart_test16666981002150244869_test_array_construct: Close
[0m11:41:40.791029 [debug] [MainThread]: Using vertica connection "master"
[0m11:41:40.791231 [debug] [MainThread]: On master: BEGIN
[0m11:41:40.791346 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:41:40.806175 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:41:40.811104 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m11:41:40.811337 [debug] [MainThread]: On master: COMMIT
[0m11:41:40.811481 [debug] [MainThread]: Using vertica connection "master"
[0m11:41:40.811595 [debug] [MainThread]: On master: COMMIT
[0m11:41:40.816230 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.0 seconds
[0m11:41:40.816473 [debug] [MainThread]: On master: Close
[0m11:41:40.816929 [info ] [MainThread]: Concurrency: 4 threads (target='default')
[0m11:41:40.817206 [info ] [MainThread]: 
[0m11:41:40.818439 [debug] [Thread-36 ]: Began running node model.test.actual
[0m11:41:40.818575 [debug] [Thread-37 ]: Began running node model.test.expected
[0m11:41:40.818815 [info ] [Thread-36 ]: 1 of 2 START sql view model test16666981002150244869_test_array_construct.actual  [RUN]
[0m11:41:40.819028 [info ] [Thread-37 ]: 2 of 2 START sql view model test16666981002150244869_test_array_construct.expected  [RUN]
[0m11:41:40.819548 [debug] [Thread-36 ]: Acquiring new vertica connection "model.test.actual"
[0m11:41:40.820157 [debug] [Thread-37 ]: Acquiring new vertica connection "model.test.expected"
[0m11:41:40.820411 [debug] [Thread-36 ]: Began compiling node model.test.actual
[0m11:41:40.820639 [debug] [Thread-37 ]: Began compiling node model.test.expected
[0m11:41:40.820845 [debug] [Thread-36 ]: Compiling model.test.actual
[0m11:41:40.821040 [debug] [Thread-37 ]: Compiling model.test.expected
[0m11:41:40.824028 [debug] [Thread-36 ]: Writing injected SQL for node "model.test.actual"
[0m11:41:40.826645 [debug] [Thread-37 ]: Writing injected SQL for node "model.test.expected"
[0m11:41:40.827082 [debug] [Thread-36 ]: finished collecting timing info
[0m11:41:40.827229 [debug] [Thread-37 ]: finished collecting timing info
[0m11:41:40.827385 [debug] [Thread-36 ]: Began executing node model.test.actual
[0m11:41:40.827538 [debug] [Thread-37 ]: Began executing node model.test.expected
[0m11:41:40.829981 [debug] [Thread-36 ]: Writing runtime sql for node "model.test.actual"
[0m11:41:40.832366 [debug] [Thread-37 ]: Writing runtime sql for node "model.test.expected"
[0m11:41:40.832880 [debug] [Thread-36 ]: Using vertica connection "model.test.actual"
[0m11:41:40.833001 [debug] [Thread-37 ]: Using vertica connection "model.test.expected"
[0m11:41:40.833140 [debug] [Thread-36 ]: On model.test.actual: BEGIN
[0m11:41:40.833276 [debug] [Thread-37 ]: On model.test.expected: BEGIN
[0m11:41:40.833398 [debug] [Thread-36 ]: Opening a new connection, currently in state closed
[0m11:41:40.833528 [debug] [Thread-37 ]: Opening a new connection, currently in state init
[0m11:41:40.850496 [debug] [Thread-37 ]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:41:40.850718 [debug] [Thread-36 ]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:41:40.856223 [debug] [Thread-37 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m11:41:40.856463 [debug] [Thread-36 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m11:41:40.856684 [debug] [Thread-37 ]: Using vertica connection "model.test.expected"
[0m11:41:40.856933 [debug] [Thread-36 ]: Using vertica connection "model.test.actual"
[0m11:41:40.857151 [debug] [Thread-37 ]: On model.test.expected: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.expected"} */

  create view "VMart"."test16666981002150244869_test_array_construct"."expected__dbt_tmp" as (
    select 1 as id, 
    array[ 1 , 2 , 3 ]
     as array_col union all
select 2 as id, 
    array[]::INT[]
     as array_col
  );
[0m11:41:40.857290 [debug] [Thread-36 ]: On model.test.actual: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.actual"} */

  create view "VMart"."test16666981002150244869_test_array_construct"."actual__dbt_tmp" as (
    select 1 as id, 
    array[ 1 , 2 , 3 ]
     as array_col union all
select 2 as id, 
    array[]::INT[]
     as array_col
  );
[0m11:41:40.870384 [debug] [Thread-36 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:41:40.872666 [debug] [Thread-36 ]: Using vertica connection "model.test.actual"
[0m11:41:40.872869 [debug] [Thread-36 ]: On model.test.actual: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.actual"} */
alter view "VMart"."test16666981002150244869_test_array_construct"."actual" rename to "actual__dbt_backup"
[0m11:41:40.874263 [debug] [Thread-37 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m11:41:40.876083 [debug] [Thread-37 ]: Using vertica connection "model.test.expected"
[0m11:41:40.876263 [debug] [Thread-37 ]: On model.test.expected: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.expected"} */
alter view "VMart"."test16666981002150244869_test_array_construct"."expected" rename to "expected__dbt_backup"
[0m11:41:40.887626 [debug] [Thread-36 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:41:40.890380 [debug] [Thread-36 ]: Using vertica connection "model.test.actual"
[0m11:41:40.890606 [debug] [Thread-36 ]: On model.test.actual: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.actual"} */
alter view "VMart"."test16666981002150244869_test_array_construct"."actual__dbt_tmp" rename to "actual"
[0m11:41:40.890765 [debug] [Thread-37 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:41:40.932773 [debug] [Thread-37 ]: Using vertica connection "model.test.expected"
[0m11:41:40.932975 [debug] [Thread-36 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.04 seconds
[0m11:41:40.933216 [debug] [Thread-37 ]: On model.test.expected: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.expected"} */
alter view "VMart"."test16666981002150244869_test_array_construct"."expected__dbt_tmp" rename to "expected"
[0m11:41:40.934436 [debug] [Thread-36 ]: On model.test.actual: COMMIT
[0m11:41:40.934818 [debug] [Thread-36 ]: Using vertica connection "model.test.actual"
[0m11:41:40.934945 [debug] [Thread-36 ]: On model.test.actual: COMMIT
[0m11:41:40.940637 [debug] [Thread-36 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:41:40.942176 [debug] [Thread-36 ]: Using vertica connection "model.test.actual"
[0m11:41:40.942373 [debug] [Thread-36 ]: On model.test.actual: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.actual"} */
drop view if exists "VMart"."test16666981002150244869_test_array_construct"."actual__dbt_backup" cascade
[0m11:41:40.948328 [debug] [Thread-37 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:41:40.949844 [debug] [Thread-37 ]: On model.test.expected: COMMIT
[0m11:41:40.950047 [debug] [Thread-37 ]: Using vertica connection "model.test.expected"
[0m11:41:40.950170 [debug] [Thread-37 ]: On model.test.expected: COMMIT
[0m11:41:40.951736 [debug] [Thread-36 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:41:40.952566 [debug] [Thread-36 ]: finished collecting timing info
[0m11:41:40.952735 [debug] [Thread-36 ]: On model.test.actual: Close
[0m11:41:40.953320 [info ] [Thread-36 ]: 1 of 2 OK created sql view model test16666981002150244869_test_array_construct.actual  [[32mCode: None, Rows: -1, Array Size: 1[0m in 0.13s]
[0m11:41:40.953676 [debug] [Thread-36 ]: Finished running node model.test.actual
[0m11:41:40.957440 [debug] [Thread-37 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:41:40.959005 [debug] [Thread-37 ]: Using vertica connection "model.test.expected"
[0m11:41:40.959195 [debug] [Thread-37 ]: On model.test.expected: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.expected"} */
drop view if exists "VMart"."test16666981002150244869_test_array_construct"."expected__dbt_backup" cascade
[0m11:41:40.968918 [debug] [Thread-37 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:41:40.970164 [debug] [Thread-37 ]: finished collecting timing info
[0m11:41:40.970406 [debug] [Thread-37 ]: On model.test.expected: Close
[0m11:41:40.970981 [info ] [Thread-37 ]: 2 of 2 OK created sql view model test16666981002150244869_test_array_construct.expected  [[32mCode: None, Rows: -1, Array Size: 1[0m in 0.15s]
[0m11:41:40.971361 [debug] [Thread-37 ]: Finished running node model.test.expected
[0m11:41:40.972541 [debug] [MainThread]: Acquiring new vertica connection "master"
[0m11:41:40.972739 [debug] [MainThread]: Using vertica connection "master"
[0m11:41:40.972858 [debug] [MainThread]: On master: BEGIN
[0m11:41:40.972966 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:41:40.990159 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:41:40.999432 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.03 seconds
[0m11:41:40.999702 [debug] [MainThread]: On master: COMMIT
[0m11:41:40.999829 [debug] [MainThread]: Using vertica connection "master"
[0m11:41:40.999932 [debug] [MainThread]: On master: COMMIT
[0m11:41:41.005813 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:41:41.006131 [debug] [MainThread]: On master: Close
[0m11:41:41.006721 [info ] [MainThread]: 
[0m11:41:41.007030 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.32 seconds (0.32s).
[0m11:41:41.007240 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:41:41.007337 [debug] [MainThread]: Connection 'model.test.actual' was properly closed.
[0m11:41:41.007428 [debug] [MainThread]: Connection 'model.test.expected' was properly closed.
[0m11:41:41.011428 [info ] [MainThread]: 
[0m11:41:41.011759 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:41:41.011981 [info ] [MainThread]: 
[0m11:41:41.012161 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m11:41:41.012433 [debug] [MainThread]: Flushing usage events
[0m11:41:41.012904 [debug] [MainThread]: Acquiring new vertica connection "_test"
[0m11:41:41.014148 [debug] [MainThread]: Using vertica connection "_test"
[0m11:41:41.014310 [debug] [MainThread]: On _test: BEGIN
[0m11:41:41.014418 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:41:41.031354 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:41:41.037757 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m11:41:41.038058 [debug] [MainThread]: Using vertica connection "_test"
[0m11:41:41.038212 [debug] [MainThread]: On _test: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "_test"} */

    select
    column_name
    , data_type
    , character_maximum_length
    , numeric_precision
    , numeric_scale
    from (
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.columns
        where table_schema = 'test16666981002150244869_test_array_construct'
        and table_name = 'expected'
        union all
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.view_columns
        where table_schema = 'test16666981002150244869_test_array_construct'
        and table_name = 'expected'
    ) t
    order by ordinal_position
  
[0m11:41:41.081823 [debug] [MainThread]: SQL status: Code: [Column(name='column_name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='data_type', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='character_maximum_length', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_precision', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_scale', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.04 seconds
[0m11:41:41.083152 [debug] [MainThread]: Using vertica connection "_test"
[0m11:41:41.083370 [debug] [MainThread]: On _test: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "_test"} */
with diff_count as (
    SELECT
        1 as id,
        COUNT(*) as num_missing FROM (
            (SELECT "array_col", "id" FROM "VMart"."test16666981002150244869_test_array_construct"."expected" EXCEPT
             SELECT "array_col", "id" FROM "VMart"."test16666981002150244869_test_array_construct"."actual")
             UNION ALL
            (SELECT "array_col", "id" FROM "VMart"."test16666981002150244869_test_array_construct"."actual" EXCEPT
             SELECT "array_col", "id" FROM "VMart"."test16666981002150244869_test_array_construct"."expected")
        ) as a
), table_a as (
    SELECT COUNT(*) as num_rows FROM "VMart"."test16666981002150244869_test_array_construct"."expected"
), table_b as (
    SELECT COUNT(*) as num_rows FROM "VMart"."test16666981002150244869_test_array_construct"."actual"
), row_count_diff as (
    select
        1 as id,
        table_a.num_rows - table_b.num_rows as difference
    from table_a, table_b
)
select
    row_count_diff.difference as row_count_difference,
    diff_count.num_missing as num_mismatched
from row_count_diff
join diff_count using (id)
[0m11:41:41.131850 [debug] [MainThread]: SQL status: Code: [Column(name='row_count_difference', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='num_mismatched', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.05 seconds
[0m11:41:41.133255 [debug] [MainThread]: On _test: ROLLBACK
[0m11:41:41.139588 [debug] [MainThread]: On _test: Close
[0m11:41:41.140783 [debug] [MainThread]: Acquiring new vertica connection "_test"
[0m11:41:41.142980 [debug] [MainThread]: Using vertica connection "_test"
[0m11:41:41.143315 [debug] [MainThread]: On _test: BEGIN
[0m11:41:41.143492 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:41:41.160732 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:41:41.166427 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m11:41:41.166741 [debug] [MainThread]: Using vertica connection "_test"
[0m11:41:41.166921 [debug] [MainThread]: On _test: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "_test"} */

    select
    column_name
    , data_type
    , character_maximum_length
    , numeric_precision
    , numeric_scale
    from (
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.columns
        where table_schema = 'test16666981002150244869_test_array_construct'
        and table_name = 'expected'
        union all
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.view_columns
        where table_schema = 'test16666981002150244869_test_array_construct'
        and table_name = 'expected'
    ) t
    order by ordinal_position
  
[0m11:41:41.194875 [debug] [MainThread]: SQL status: Code: [Column(name='column_name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='data_type', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='character_maximum_length', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_precision', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_scale', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.03 seconds
[0m11:41:41.195970 [debug] [MainThread]: On _test: ROLLBACK
[0m11:41:41.200689 [debug] [MainThread]: On _test: Close
[0m11:41:41.201360 [debug] [MainThread]: Acquiring new vertica connection "_test"
[0m11:41:41.202563 [debug] [MainThread]: Using vertica connection "_test"
[0m11:41:41.202685 [debug] [MainThread]: On _test: BEGIN
[0m11:41:41.202786 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:41:41.216136 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:41:41.221782 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m11:41:41.222231 [debug] [MainThread]: Using vertica connection "_test"
[0m11:41:41.222586 [debug] [MainThread]: On _test: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "_test"} */

    select
    column_name
    , data_type
    , character_maximum_length
    , numeric_precision
    , numeric_scale
    from (
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.columns
        where table_schema = 'test16666981002150244869_test_array_construct'
        and table_name = 'actual'
        union all
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.view_columns
        where table_schema = 'test16666981002150244869_test_array_construct'
        and table_name = 'actual'
    ) t
    order by ordinal_position
  
[0m11:41:41.250097 [debug] [MainThread]: SQL status: Code: [Column(name='column_name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='data_type', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='character_maximum_length', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_precision', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_scale', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.03 seconds
[0m11:41:41.252054 [debug] [MainThread]: On _test: ROLLBACK
[0m11:41:41.258308 [debug] [MainThread]: On _test: Close
[0m11:41:41.259410 [debug] [MainThread]: Acquiring new vertica connection "_test"
[0m11:41:41.259682 [debug] [MainThread]: Dropping schema "_ReferenceKey(database='vmart', schema='test16666981002150244869_test_array_construct', identifier=None)".
[0m11:41:41.261006 [debug] [MainThread]: Using vertica connection "_test"
[0m11:41:41.261169 [debug] [MainThread]: On _test: BEGIN
[0m11:41:41.261271 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:41:41.277444 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:41:41.281823 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m11:41:41.282046 [debug] [MainThread]: Using vertica connection "_test"
[0m11:41:41.282166 [debug] [MainThread]: On _test: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "_test"} */
drop schema if exists "test16666981002150244869_test_array_construct" cascade
  
[0m11:41:41.298646 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m11:41:41.299411 [debug] [MainThread]: On _test: COMMIT
[0m11:41:41.299577 [debug] [MainThread]: Using vertica connection "_test"
[0m11:41:41.299688 [debug] [MainThread]: On _test: COMMIT
[0m11:41:41.306597 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:41:41.306958 [debug] [MainThread]: On _test: Close
[0m11:41:41.307847 [debug] [MainThread]: Connection '_test' was properly closed.
