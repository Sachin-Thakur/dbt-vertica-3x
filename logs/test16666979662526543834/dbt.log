[0m11:39:25.875870 [debug] [MainThread]: Acquiring new vertica connection "_test"
[0m11:39:25.876029 [debug] [MainThread]: Acquiring new vertica connection "_test"
[0m11:39:25.876209 [debug] [MainThread]: Creating schema "_ReferenceKey(database='vmart', schema='test16666979662526543834_test_array_construct', identifier=None)"
[0m11:39:25.877675 [debug] [MainThread]: Using vertica connection "_test"
[0m11:39:25.877805 [debug] [MainThread]: On _test: BEGIN
[0m11:39:25.877916 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:39:25.896106 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:39:25.903556 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.03 seconds
[0m11:39:25.903852 [debug] [MainThread]: Using vertica connection "_test"
[0m11:39:25.904008 [debug] [MainThread]: On _test: create schema if not exists "test16666979662526543834_test_array_construct"
  
[0m11:39:25.915268 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:39:25.916995 [debug] [MainThread]: On _test: COMMIT
[0m11:39:25.917414 [debug] [MainThread]: Using vertica connection "_test"
[0m11:39:25.917756 [debug] [MainThread]: On _test: COMMIT
[0m11:39:25.924910 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:39:25.925470 [debug] [MainThread]: On _test: Close
[0m11:39:25.939354 [debug] [MainThread]: Connection '_test' was properly closed.


============================== 2022-10-25 11:39:25.944998 | 085e4380-0fd0-4f58-81a6-2d730d8d1797 ==============================
[0m11:39:25.945007 [info ] [MainThread]: Running with dbt=1.3.0
[0m11:39:25.945287 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/tmp/pytest-of-sachin/pytest-27/profile2', 'send_anonymous_usage_stats': False, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
[0m11:39:25.945397 [debug] [MainThread]: Tracking: do not track
[0m11:39:25.951143 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
[0m11:39:25.958668 [debug] [MainThread]: Parsing macros/test_assert_equal.sql
[0m11:39:25.959225 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m11:39:25.959384 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m11:39:25.959528 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m11:39:25.963820 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m11:39:25.964685 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m11:39:25.965275 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m11:39:25.967853 [debug] [MainThread]: Parsing macros/materializations/models/incremental/helpers.sql
[0m11:39:25.969551 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m11:39:25.973078 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m11:39:25.973981 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m11:39:25.977703 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m11:39:25.978982 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m11:39:25.985946 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m11:39:25.986964 [debug] [MainThread]: Parsing macros/materializations/snapshots/helper.sql
[0m11:39:25.987110 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m11:39:25.992262 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m11:39:25.995836 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m11:39:25.996393 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m11:39:25.996835 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m11:39:25.998727 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m11:39:26.000349 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m11:39:26.004413 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m11:39:26.005276 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m11:39:26.005977 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m11:39:26.007371 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m11:39:26.009627 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m11:39:26.010539 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m11:39:26.013749 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m11:39:26.015186 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m11:39:26.017204 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m11:39:26.026213 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m11:39:26.031086 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m11:39:26.032063 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m11:39:26.038729 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m11:39:26.042612 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m11:39:26.052690 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m11:39:26.054762 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m11:39:26.057993 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m11:39:26.065709 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m11:39:26.066723 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m11:39:26.073658 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m11:39:26.083129 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m11:39:26.084250 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m11:39:26.085328 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m11:39:26.087977 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m11:39:26.098769 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m11:39:26.102845 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m11:39:26.103787 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m11:39:26.104737 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m11:39:26.106191 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m11:39:26.107425 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m11:39:26.109079 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m11:39:26.114835 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m11:39:26.123420 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m11:39:26.127659 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m11:39:26.135716 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m11:39:26.137079 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m11:39:26.139123 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m11:39:26.141708 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m11:39:26.145260 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m11:39:26.146033 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m11:39:26.146690 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m11:39:26.147339 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m11:39:26.148122 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m11:39:26.149042 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m11:39:26.149640 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m11:39:26.150227 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m11:39:26.150876 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m11:39:26.152133 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m11:39:26.152668 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m11:39:26.153468 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m11:39:26.154161 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m11:39:26.158102 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m11:39:26.158722 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m11:39:26.159515 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m11:39:26.160186 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m11:39:26.161135 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m11:39:26.161775 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m11:39:26.163163 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m11:39:26.163772 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m11:39:26.164332 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m11:39:26.165082 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m11:39:26.165742 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m11:39:26.166830 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m11:39:26.167690 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m11:39:26.168256 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m11:39:26.168702 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m11:39:26.169290 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m11:39:26.172383 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m11:39:26.177441 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m11:39:26.328186 [debug] [MainThread]: 1603: static parser failed on actual.sql
[0m11:39:26.331051 [debug] [MainThread]: 1602: parser fallback to jinja rendering on actual.sql
[0m11:39:26.331920 [debug] [MainThread]: 1603: static parser failed on expected.sql
[0m11:39:26.334455 [debug] [MainThread]: 1602: parser fallback to jinja rendering on expected.sql
[0m11:39:26.355569 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 297 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m11:39:26.356197 [info ] [MainThread]: 
[0m11:39:26.356655 [debug] [MainThread]: Acquiring new vertica connection "master"
[0m11:39:26.357272 [debug] [ThreadPool]: Acquiring new vertica connection "list_VMart"
[0m11:39:26.358400 [debug] [ThreadPool]: Using vertica connection "list_VMart"
[0m11:39:26.358543 [debug] [ThreadPool]: On list_VMart: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "list_VMart"} */

    select schema_name
    from v_catalog.schemata
  
[0m11:39:26.358740 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:39:26.376510 [debug] [ThreadPool]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:39:26.406449 [debug] [ThreadPool]: SQL status: Code: [Column(name='schema_name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.05 seconds
[0m11:39:26.409220 [debug] [ThreadPool]: On list_VMart: Close
[0m11:39:26.412177 [debug] [ThreadPool]: Acquiring new vertica connection "list_VMart_test16666979662526543834_test_array_construct"
[0m11:39:26.416115 [debug] [ThreadPool]: Using vertica connection "list_VMart_test16666979662526543834_test_array_construct"
[0m11:39:26.416595 [debug] [ThreadPool]: On list_VMart_test16666979662526543834_test_array_construct: BEGIN
[0m11:39:26.416957 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:39:26.431762 [debug] [ThreadPool]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:39:26.437064 [debug] [ThreadPool]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m11:39:26.437642 [debug] [ThreadPool]: Using vertica connection "list_VMart_test16666979662526543834_test_array_construct"
[0m11:39:26.438009 [debug] [ThreadPool]: On list_VMart_test16666979662526543834_test_array_construct: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "list_VMart_test16666979662526543834_test_array_construct"} */
select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'table' as type
    from v_catalog.tables
    where table_schema ilike 'test16666979662526543834_test_array_construct'
    union all
    select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'view' as type
    from v_catalog.views
    where table_schema ilike 'test16666979662526543834_test_array_construct'
  
[0m11:39:26.457324 [debug] [ThreadPool]: SQL status: Code: [Column(name='database', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='schema', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='type', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.02 seconds
[0m11:39:26.459985 [debug] [ThreadPool]: On list_VMart_test16666979662526543834_test_array_construct: ROLLBACK
[0m11:39:26.465399 [debug] [ThreadPool]: On list_VMart_test16666979662526543834_test_array_construct: Close
[0m11:39:26.467171 [debug] [MainThread]: Using vertica connection "master"
[0m11:39:26.467659 [debug] [MainThread]: On master: BEGIN
[0m11:39:26.467989 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:39:26.482996 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:39:26.488601 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m11:39:26.489173 [debug] [MainThread]: On master: COMMIT
[0m11:39:26.489569 [debug] [MainThread]: Using vertica connection "master"
[0m11:39:26.489889 [debug] [MainThread]: On master: COMMIT
[0m11:39:26.495463 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:39:26.496021 [debug] [MainThread]: On master: Close
[0m11:39:26.497219 [info ] [MainThread]: Concurrency: 4 threads (target='default')
[0m11:39:26.497962 [info ] [MainThread]: 
[0m11:39:26.501669 [debug] [Thread-29 ]: Began running node model.test.actual
[0m11:39:26.502433 [info ] [Thread-29 ]: 1 of 2 START sql view model test16666979662526543834_test_array_construct.actual  [RUN]
[0m11:39:26.502867 [debug] [Thread-30 ]: Began running node model.test.expected
[0m11:39:26.504328 [debug] [Thread-29 ]: Acquiring new vertica connection "model.test.actual"
[0m11:39:26.505086 [info ] [Thread-30 ]: 2 of 2 START sql view model test16666979662526543834_test_array_construct.expected  [RUN]
[0m11:39:26.505588 [debug] [Thread-29 ]: Began compiling node model.test.actual
[0m11:39:26.507237 [debug] [Thread-30 ]: Acquiring new vertica connection "model.test.expected"
[0m11:39:26.507385 [debug] [Thread-29 ]: Compiling model.test.actual
[0m11:39:26.507586 [debug] [Thread-30 ]: Began compiling node model.test.expected
[0m11:39:26.510096 [debug] [Thread-29 ]: Writing injected SQL for node "model.test.actual"
[0m11:39:26.510334 [debug] [Thread-30 ]: Compiling model.test.expected
[0m11:39:26.512812 [debug] [Thread-30 ]: Writing injected SQL for node "model.test.expected"
[0m11:39:26.513106 [debug] [Thread-29 ]: finished collecting timing info
[0m11:39:26.513217 [debug] [Thread-30 ]: finished collecting timing info
[0m11:39:26.513372 [debug] [Thread-29 ]: Began executing node model.test.actual
[0m11:39:26.513526 [debug] [Thread-30 ]: Began executing node model.test.expected
[0m11:39:26.515844 [debug] [Thread-29 ]: Writing runtime sql for node "model.test.actual"
[0m11:39:26.518208 [debug] [Thread-30 ]: Writing runtime sql for node "model.test.expected"
[0m11:39:26.518663 [debug] [Thread-29 ]: Using vertica connection "model.test.actual"
[0m11:39:26.518784 [debug] [Thread-30 ]: Using vertica connection "model.test.expected"
[0m11:39:26.518921 [debug] [Thread-29 ]: On model.test.actual: BEGIN
[0m11:39:26.519052 [debug] [Thread-30 ]: On model.test.expected: BEGIN
[0m11:39:26.519174 [debug] [Thread-29 ]: Opening a new connection, currently in state closed
[0m11:39:26.519312 [debug] [Thread-30 ]: Opening a new connection, currently in state init
[0m11:39:26.534608 [debug] [Thread-29 ]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:39:26.535592 [debug] [Thread-30 ]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:39:26.539142 [debug] [Thread-29 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m11:39:26.539364 [debug] [Thread-29 ]: Using vertica connection "model.test.actual"
[0m11:39:26.539537 [debug] [Thread-29 ]: On model.test.actual: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.actual"} */

  create view "VMart"."test16666979662526543834_test_array_construct"."actual__dbt_tmp" as (
    select 1 as id, 
    array[ 1 , 2 , 3 ]
     as array_col union all
select 2 as id, 
    array[]::INT[]
     as array_col
  );
[0m11:39:26.541493 [debug] [Thread-30 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m11:39:26.541741 [debug] [Thread-30 ]: Using vertica connection "model.test.expected"
[0m11:39:26.541927 [debug] [Thread-30 ]: On model.test.expected: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.expected"} */

  create view "VMart"."test16666979662526543834_test_array_construct"."expected__dbt_tmp" as (
    select 1 as id, 
    array[ 1 , 2 , 3 ]
     as array_col union all
select 2 as id, 
    array[]::INT[]
     as array_col
  );
[0m11:39:26.551375 [debug] [Thread-29 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:39:26.553182 [debug] [Thread-29 ]: Using vertica connection "model.test.actual"
[0m11:39:26.553337 [debug] [Thread-29 ]: On model.test.actual: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.actual"} */
alter view "VMart"."test16666979662526543834_test_array_construct"."actual__dbt_tmp" rename to "actual"
[0m11:39:26.555488 [debug] [Thread-30 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:39:26.559005 [debug] [Thread-30 ]: Using vertica connection "model.test.expected"
[0m11:39:26.559249 [debug] [Thread-30 ]: On model.test.expected: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.expected"} */
alter view "VMart"."test16666979662526543834_test_array_construct"."expected__dbt_tmp" rename to "expected"
[0m11:39:26.564119 [debug] [Thread-29 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:39:26.565216 [debug] [Thread-29 ]: On model.test.actual: COMMIT
[0m11:39:26.565365 [debug] [Thread-29 ]: Using vertica connection "model.test.actual"
[0m11:39:26.565494 [debug] [Thread-29 ]: On model.test.actual: COMMIT
[0m11:39:26.570276 [debug] [Thread-30 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:39:26.570542 [debug] [Thread-29 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.0 seconds
[0m11:39:26.571869 [debug] [Thread-30 ]: On model.test.expected: COMMIT
[0m11:39:26.573244 [debug] [Thread-29 ]: Using vertica connection "model.test.actual"
[0m11:39:26.573428 [debug] [Thread-30 ]: Using vertica connection "model.test.expected"
[0m11:39:26.573664 [debug] [Thread-29 ]: On model.test.actual: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.actual"} */
drop view if exists "VMart"."test16666979662526543834_test_array_construct"."actual__dbt_backup" cascade
[0m11:39:26.573832 [debug] [Thread-30 ]: On model.test.expected: COMMIT
[0m11:39:26.578732 [debug] [Thread-30 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.0 seconds
[0m11:39:26.581120 [debug] [Thread-30 ]: Using vertica connection "model.test.expected"
[0m11:39:26.581384 [debug] [Thread-30 ]: On model.test.expected: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.expected"} */
drop view if exists "VMart"."test16666979662526543834_test_array_construct"."expected__dbt_backup" cascade
[0m11:39:26.582117 [debug] [Thread-29 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:39:26.582980 [debug] [Thread-29 ]: finished collecting timing info
[0m11:39:26.583137 [debug] [Thread-29 ]: On model.test.actual: Close
[0m11:39:26.583691 [info ] [Thread-29 ]: 1 of 2 OK created sql view model test16666979662526543834_test_array_construct.actual  [[32mCode: None, Rows: -1, Array Size: 1[0m in 0.08s]
[0m11:39:26.584034 [debug] [Thread-29 ]: Finished running node model.test.actual
[0m11:39:26.588475 [debug] [Thread-30 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:39:26.589639 [debug] [Thread-30 ]: finished collecting timing info
[0m11:39:26.589872 [debug] [Thread-30 ]: On model.test.expected: Close
[0m11:39:26.590588 [info ] [Thread-30 ]: 2 of 2 OK created sql view model test16666979662526543834_test_array_construct.expected  [[32mCode: None, Rows: -1, Array Size: 1[0m in 0.08s]
[0m11:39:26.591079 [debug] [Thread-30 ]: Finished running node model.test.expected
[0m11:39:26.592316 [debug] [MainThread]: Acquiring new vertica connection "master"
[0m11:39:26.592495 [debug] [MainThread]: Using vertica connection "master"
[0m11:39:26.592612 [debug] [MainThread]: On master: BEGIN
[0m11:39:26.592719 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:39:26.606856 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:39:26.612020 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m11:39:26.612301 [debug] [MainThread]: On master: COMMIT
[0m11:39:26.612428 [debug] [MainThread]: Using vertica connection "master"
[0m11:39:26.612538 [debug] [MainThread]: On master: COMMIT
[0m11:39:26.617509 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.0 seconds
[0m11:39:26.617703 [debug] [MainThread]: On master: Close
[0m11:39:26.618173 [info ] [MainThread]: 
[0m11:39:26.618412 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.26 seconds (0.26s).
[0m11:39:26.618605 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:39:26.618706 [debug] [MainThread]: Connection 'model.test.actual' was properly closed.
[0m11:39:26.618803 [debug] [MainThread]: Connection 'model.test.expected' was properly closed.
[0m11:39:26.622646 [info ] [MainThread]: 
[0m11:39:26.622936 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:39:26.623168 [info ] [MainThread]: 
[0m11:39:26.623382 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m11:39:26.623615 [debug] [MainThread]: Flushing usage events


============================== 2022-10-25 11:39:26.641639 | 085e4380-0fd0-4f58-81a6-2d730d8d1797 ==============================
[0m11:39:26.641657 [info ] [MainThread]: Running with dbt=1.3.0
[0m11:39:26.642156 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/tmp/pytest-of-sachin/pytest-27/profile2', 'send_anonymous_usage_stats': False, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
[0m11:39:26.642415 [debug] [MainThread]: Tracking: do not track
[0m11:39:26.664032 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:39:26.664270 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:39:26.672059 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 297 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m11:39:26.672780 [info ] [MainThread]: 
[0m11:39:26.673312 [debug] [MainThread]: Acquiring new vertica connection "master"
[0m11:39:26.674026 [debug] [ThreadPool]: Acquiring new vertica connection "list_VMart"
[0m11:39:26.675822 [debug] [ThreadPool]: Using vertica connection "list_VMart"
[0m11:39:26.676005 [debug] [ThreadPool]: On list_VMart: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "list_VMart"} */

    select schema_name
    from v_catalog.schemata
  
[0m11:39:26.676117 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:39:26.690560 [debug] [ThreadPool]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:39:26.706203 [debug] [ThreadPool]: SQL status: Code: [Column(name='schema_name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.03 seconds
[0m11:39:26.707273 [debug] [ThreadPool]: On list_VMart: Close
[0m11:39:26.708600 [debug] [ThreadPool]: Acquiring new vertica connection "list_VMart_test16666979662526543834_test_array_construct"
[0m11:39:26.709979 [debug] [ThreadPool]: Using vertica connection "list_VMart_test16666979662526543834_test_array_construct"
[0m11:39:26.710201 [debug] [ThreadPool]: On list_VMart_test16666979662526543834_test_array_construct: BEGIN
[0m11:39:26.710317 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:39:26.724028 [debug] [ThreadPool]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:39:26.728443 [debug] [ThreadPool]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m11:39:26.728774 [debug] [ThreadPool]: Using vertica connection "list_VMart_test16666979662526543834_test_array_construct"
[0m11:39:26.728984 [debug] [ThreadPool]: On list_VMart_test16666979662526543834_test_array_construct: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "list_VMart_test16666979662526543834_test_array_construct"} */
select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'table' as type
    from v_catalog.tables
    where table_schema ilike 'test16666979662526543834_test_array_construct'
    union all
    select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'view' as type
    from v_catalog.views
    where table_schema ilike 'test16666979662526543834_test_array_construct'
  
[0m11:39:26.744200 [debug] [ThreadPool]: SQL status: Code: [Column(name='database', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='schema', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='type', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.02 seconds
[0m11:39:26.746003 [debug] [ThreadPool]: On list_VMart_test16666979662526543834_test_array_construct: ROLLBACK
[0m11:39:26.750450 [debug] [ThreadPool]: On list_VMart_test16666979662526543834_test_array_construct: Close
[0m11:39:26.751723 [debug] [MainThread]: Using vertica connection "master"
[0m11:39:26.752011 [debug] [MainThread]: On master: BEGIN
[0m11:39:26.752150 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:39:26.766882 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:39:26.771065 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m11:39:26.771458 [debug] [MainThread]: On master: COMMIT
[0m11:39:26.771699 [debug] [MainThread]: Using vertica connection "master"
[0m11:39:26.771894 [debug] [MainThread]: On master: COMMIT
[0m11:39:26.776608 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.0 seconds
[0m11:39:26.777021 [debug] [MainThread]: On master: Close
[0m11:39:26.777776 [info ] [MainThread]: Concurrency: 4 threads (target='default')
[0m11:39:26.778193 [info ] [MainThread]: 
[0m11:39:26.779700 [debug] [Thread-36 ]: Began running node model.test.actual
[0m11:39:26.779926 [debug] [Thread-37 ]: Began running node model.test.expected
[0m11:39:26.780168 [info ] [Thread-36 ]: 1 of 2 START sql view model test16666979662526543834_test_array_construct.actual  [RUN]
[0m11:39:26.780388 [info ] [Thread-37 ]: 2 of 2 START sql view model test16666979662526543834_test_array_construct.expected  [RUN]
[0m11:39:26.781161 [debug] [Thread-36 ]: Acquiring new vertica connection "model.test.actual"
[0m11:39:26.781677 [debug] [Thread-37 ]: Acquiring new vertica connection "model.test.expected"
[0m11:39:26.781858 [debug] [Thread-36 ]: Began compiling node model.test.actual
[0m11:39:26.782052 [debug] [Thread-37 ]: Began compiling node model.test.expected
[0m11:39:26.782217 [debug] [Thread-36 ]: Compiling model.test.actual
[0m11:39:26.782395 [debug] [Thread-37 ]: Compiling model.test.expected
[0m11:39:26.786337 [debug] [Thread-36 ]: Writing injected SQL for node "model.test.actual"
[0m11:39:26.788873 [debug] [Thread-37 ]: Writing injected SQL for node "model.test.expected"
[0m11:39:26.789419 [debug] [Thread-37 ]: finished collecting timing info
[0m11:39:26.789581 [debug] [Thread-36 ]: finished collecting timing info
[0m11:39:26.789833 [debug] [Thread-37 ]: Began executing node model.test.expected
[0m11:39:26.790068 [debug] [Thread-36 ]: Began executing node model.test.actual
[0m11:39:26.793220 [debug] [Thread-37 ]: Writing runtime sql for node "model.test.expected"
[0m11:39:26.797346 [debug] [Thread-36 ]: Writing runtime sql for node "model.test.actual"
[0m11:39:26.797895 [debug] [Thread-37 ]: Using vertica connection "model.test.expected"
[0m11:39:26.798066 [debug] [Thread-37 ]: On model.test.expected: BEGIN
[0m11:39:26.798219 [debug] [Thread-36 ]: Using vertica connection "model.test.actual"
[0m11:39:26.798340 [debug] [Thread-37 ]: Opening a new connection, currently in state init
[0m11:39:26.798485 [debug] [Thread-36 ]: On model.test.actual: BEGIN
[0m11:39:26.798858 [debug] [Thread-36 ]: Opening a new connection, currently in state closed
[0m11:39:26.813114 [debug] [Thread-36 ]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:39:26.814173 [debug] [Thread-37 ]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:39:26.818473 [debug] [Thread-36 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m11:39:26.818845 [debug] [Thread-37 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m11:39:26.819046 [debug] [Thread-36 ]: Using vertica connection "model.test.actual"
[0m11:39:26.819287 [debug] [Thread-37 ]: Using vertica connection "model.test.expected"
[0m11:39:26.819465 [debug] [Thread-36 ]: On model.test.actual: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.actual"} */

  create view "VMart"."test16666979662526543834_test_array_construct"."actual__dbt_tmp" as (
    select 1 as id, 
    array[ 1 , 2 , 3 ]
     as array_col union all
select 2 as id, 
    array[]::INT[]
     as array_col
  );
[0m11:39:26.819691 [debug] [Thread-37 ]: On model.test.expected: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.expected"} */

  create view "VMart"."test16666979662526543834_test_array_construct"."expected__dbt_tmp" as (
    select 1 as id, 
    array[ 1 , 2 , 3 ]
     as array_col union all
select 2 as id, 
    array[]::INT[]
     as array_col
  );
[0m11:39:26.829018 [debug] [Thread-37 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:39:26.831222 [debug] [Thread-37 ]: Using vertica connection "model.test.expected"
[0m11:39:26.831433 [debug] [Thread-37 ]: On model.test.expected: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.expected"} */
alter view "VMart"."test16666979662526543834_test_array_construct"."expected" rename to "expected__dbt_backup"
[0m11:39:26.833686 [debug] [Thread-36 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:39:26.836711 [debug] [Thread-36 ]: Using vertica connection "model.test.actual"
[0m11:39:26.836976 [debug] [Thread-36 ]: On model.test.actual: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.actual"} */
alter view "VMart"."test16666979662526543834_test_array_construct"."actual" rename to "actual__dbt_backup"
[0m11:39:26.839130 [debug] [Thread-37 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:39:26.842141 [debug] [Thread-37 ]: Using vertica connection "model.test.expected"
[0m11:39:26.842397 [debug] [Thread-37 ]: On model.test.expected: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.expected"} */
alter view "VMart"."test16666979662526543834_test_array_construct"."expected__dbt_tmp" rename to "expected"
[0m11:39:26.850163 [debug] [Thread-36 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:39:26.897937 [debug] [Thread-37 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.06 seconds
[0m11:39:26.899254 [debug] [Thread-37 ]: On model.test.expected: COMMIT
[0m11:39:26.899513 [debug] [Thread-37 ]: Using vertica connection "model.test.expected"
[0m11:39:26.899661 [debug] [Thread-37 ]: On model.test.expected: COMMIT
[0m11:39:26.903870 [debug] [Thread-36 ]: Using vertica connection "model.test.actual"
[0m11:39:26.904101 [debug] [Thread-36 ]: On model.test.actual: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.actual"} */
alter view "VMart"."test16666979662526543834_test_array_construct"."actual__dbt_tmp" rename to "actual"
[0m11:39:26.904691 [debug] [Thread-37 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.0 seconds
[0m11:39:26.906165 [debug] [Thread-37 ]: Using vertica connection "model.test.expected"
[0m11:39:26.906344 [debug] [Thread-37 ]: On model.test.expected: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.expected"} */
drop view if exists "VMart"."test16666979662526543834_test_array_construct"."expected__dbt_backup" cascade
[0m11:39:26.917324 [debug] [Thread-36 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:39:26.918720 [debug] [Thread-36 ]: On model.test.actual: COMMIT
[0m11:39:26.918925 [debug] [Thread-37 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:39:26.919077 [debug] [Thread-36 ]: Using vertica connection "model.test.actual"
[0m11:39:26.920272 [debug] [Thread-37 ]: finished collecting timing info
[0m11:39:26.920581 [debug] [Thread-36 ]: On model.test.actual: COMMIT
[0m11:39:26.920840 [debug] [Thread-37 ]: On model.test.expected: Close
[0m11:39:26.921613 [info ] [Thread-37 ]: 2 of 2 OK created sql view model test16666979662526543834_test_array_construct.expected  [[32mCode: None, Rows: -1, Array Size: 1[0m in 0.14s]
[0m11:39:26.921973 [debug] [Thread-37 ]: Finished running node model.test.expected
[0m11:39:26.926022 [debug] [Thread-36 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:39:26.927580 [debug] [Thread-36 ]: Using vertica connection "model.test.actual"
[0m11:39:26.927762 [debug] [Thread-36 ]: On model.test.actual: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.actual"} */
drop view if exists "VMart"."test16666979662526543834_test_array_construct"."actual__dbt_backup" cascade
[0m11:39:26.935413 [debug] [Thread-36 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:39:26.936444 [debug] [Thread-36 ]: finished collecting timing info
[0m11:39:26.936670 [debug] [Thread-36 ]: On model.test.actual: Close
[0m11:39:26.937311 [info ] [Thread-36 ]: 1 of 2 OK created sql view model test16666979662526543834_test_array_construct.actual  [[32mCode: None, Rows: -1, Array Size: 1[0m in 0.16s]
[0m11:39:26.937710 [debug] [Thread-36 ]: Finished running node model.test.actual
[0m11:39:26.938778 [debug] [MainThread]: Acquiring new vertica connection "master"
[0m11:39:26.939055 [debug] [MainThread]: Using vertica connection "master"
[0m11:39:26.939263 [debug] [MainThread]: On master: BEGIN
[0m11:39:26.939473 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:39:26.954235 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:39:26.959834 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m11:39:26.960223 [debug] [MainThread]: On master: COMMIT
[0m11:39:26.960423 [debug] [MainThread]: Using vertica connection "master"
[0m11:39:26.960602 [debug] [MainThread]: On master: COMMIT
[0m11:39:26.964663 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.0 seconds
[0m11:39:26.964965 [debug] [MainThread]: On master: Close
[0m11:39:26.965735 [info ] [MainThread]: 
[0m11:39:26.966159 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.29 seconds (0.29s).
[0m11:39:26.966509 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:39:26.966687 [debug] [MainThread]: Connection 'model.test.actual' was properly closed.
[0m11:39:26.966858 [debug] [MainThread]: Connection 'model.test.expected' was properly closed.
[0m11:39:26.973537 [info ] [MainThread]: 
[0m11:39:26.973961 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:39:26.974344 [info ] [MainThread]: 
[0m11:39:26.974650 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m11:39:26.975017 [debug] [MainThread]: Flushing usage events
[0m11:39:26.975699 [debug] [MainThread]: Acquiring new vertica connection "_test"
[0m11:39:26.977568 [debug] [MainThread]: Using vertica connection "_test"
[0m11:39:26.977823 [debug] [MainThread]: On _test: BEGIN
[0m11:39:26.978011 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:39:26.994627 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:39:27.001161 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m11:39:27.001491 [debug] [MainThread]: Using vertica connection "_test"
[0m11:39:27.001687 [debug] [MainThread]: On _test: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "_test"} */

    select
    column_name
    , data_type
    , character_maximum_length
    , numeric_precision
    , numeric_scale
    from (
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.columns
        where table_schema = 'test16666979662526543834_test_array_construct'
        and table_name = 'expected'
        union all
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.view_columns
        where table_schema = 'test16666979662526543834_test_array_construct'
        and table_name = 'expected'
    ) t
    order by ordinal_position
  
[0m11:39:27.031640 [debug] [MainThread]: SQL status: Code: [Column(name='column_name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='data_type', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='character_maximum_length', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_precision', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_scale', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.03 seconds
[0m11:39:27.033444 [debug] [MainThread]: Using vertica connection "_test"
[0m11:39:27.033696 [debug] [MainThread]: On _test: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "_test"} */
with diff_count as (
    SELECT
        1 as id,
        COUNT(*) as num_missing FROM (
            (SELECT "array_col", "id" FROM "VMart"."test16666979662526543834_test_array_construct"."expected" EXCEPT
             SELECT "array_col", "id" FROM "VMart"."test16666979662526543834_test_array_construct"."actual")
             UNION ALL
            (SELECT "array_col", "id" FROM "VMart"."test16666979662526543834_test_array_construct"."actual" EXCEPT
             SELECT "array_col", "id" FROM "VMart"."test16666979662526543834_test_array_construct"."expected")
        ) as a
), table_a as (
    SELECT COUNT(*) as num_rows FROM "VMart"."test16666979662526543834_test_array_construct"."expected"
), table_b as (
    SELECT COUNT(*) as num_rows FROM "VMart"."test16666979662526543834_test_array_construct"."actual"
), row_count_diff as (
    select
        1 as id,
        table_a.num_rows - table_b.num_rows as difference
    from table_a, table_b
)
select
    row_count_diff.difference as row_count_difference,
    diff_count.num_missing as num_mismatched
from row_count_diff
join diff_count using (id)
[0m11:39:27.084181 [debug] [MainThread]: SQL status: Code: [Column(name='row_count_difference', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='num_mismatched', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.05 seconds
[0m11:39:27.085622 [debug] [MainThread]: On _test: ROLLBACK
[0m11:39:27.090308 [debug] [MainThread]: On _test: Close
[0m11:39:27.091476 [debug] [MainThread]: Acquiring new vertica connection "_test"
[0m11:39:27.093532 [debug] [MainThread]: Using vertica connection "_test"
[0m11:39:27.093812 [debug] [MainThread]: On _test: BEGIN
[0m11:39:27.093988 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:39:27.109125 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:39:27.113236 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m11:39:27.113595 [debug] [MainThread]: Using vertica connection "_test"
[0m11:39:27.113775 [debug] [MainThread]: On _test: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "_test"} */

    select
    column_name
    , data_type
    , character_maximum_length
    , numeric_precision
    , numeric_scale
    from (
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.columns
        where table_schema = 'test16666979662526543834_test_array_construct'
        and table_name = 'expected'
        union all
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.view_columns
        where table_schema = 'test16666979662526543834_test_array_construct'
        and table_name = 'expected'
    ) t
    order by ordinal_position
  
[0m11:39:27.140824 [debug] [MainThread]: SQL status: Code: [Column(name='column_name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='data_type', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='character_maximum_length', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_precision', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_scale', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.03 seconds
[0m11:39:27.142510 [debug] [MainThread]: On _test: ROLLBACK
[0m11:39:27.146919 [debug] [MainThread]: On _test: Close
[0m11:39:27.148072 [debug] [MainThread]: Acquiring new vertica connection "_test"
[0m11:39:27.150243 [debug] [MainThread]: Using vertica connection "_test"
[0m11:39:27.150541 [debug] [MainThread]: On _test: BEGIN
[0m11:39:27.150717 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:39:27.164745 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:39:27.168892 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m11:39:27.169253 [debug] [MainThread]: Using vertica connection "_test"
[0m11:39:27.169442 [debug] [MainThread]: On _test: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "_test"} */

    select
    column_name
    , data_type
    , character_maximum_length
    , numeric_precision
    , numeric_scale
    from (
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.columns
        where table_schema = 'test16666979662526543834_test_array_construct'
        and table_name = 'actual'
        union all
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.view_columns
        where table_schema = 'test16666979662526543834_test_array_construct'
        and table_name = 'actual'
    ) t
    order by ordinal_position
  
[0m11:39:27.197312 [debug] [MainThread]: SQL status: Code: [Column(name='column_name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='data_type', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='character_maximum_length', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_precision', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_scale', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.03 seconds
[0m11:39:27.198611 [debug] [MainThread]: On _test: ROLLBACK
[0m11:39:27.204025 [debug] [MainThread]: On _test: Close
[0m11:39:27.205064 [debug] [MainThread]: Acquiring new vertica connection "_test"
[0m11:39:27.205328 [debug] [MainThread]: Dropping schema "_ReferenceKey(database='vmart', schema='test16666979662526543834_test_array_construct', identifier=None)".
[0m11:39:27.206776 [debug] [MainThread]: Using vertica connection "_test"
[0m11:39:27.206947 [debug] [MainThread]: On _test: BEGIN
[0m11:39:27.207096 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:39:27.227459 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:39:27.231581 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m11:39:27.231808 [debug] [MainThread]: Using vertica connection "_test"
[0m11:39:27.231924 [debug] [MainThread]: On _test: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "_test"} */
drop schema if exists "test16666979662526543834_test_array_construct" cascade
  
[0m11:39:27.242157 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:39:27.243006 [debug] [MainThread]: On _test: COMMIT
[0m11:39:27.243198 [debug] [MainThread]: Using vertica connection "_test"
[0m11:39:27.243312 [debug] [MainThread]: On _test: COMMIT
[0m11:39:27.247379 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.0 seconds
[0m11:39:27.247680 [debug] [MainThread]: On _test: Close
[0m11:39:27.248508 [debug] [MainThread]: Connection '_test' was properly closed.
