[0m05:46:47.189783 [debug] [MainThread]: Acquiring new vertica connection "_test"
[0m05:46:47.189977 [debug] [MainThread]: Acquiring new vertica connection "_test"
[0m05:46:47.190164 [debug] [MainThread]: Creating schema "_ReferenceKey(database='vmart', schema='test16667632077883365037_test_array_concat', identifier=None)"
[0m05:46:47.191490 [debug] [MainThread]: Using vertica connection "_test"
[0m05:46:47.191616 [debug] [MainThread]: On _test: BEGIN
[0m05:46:47.191725 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:46:47.209200 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m05:46:47.214285 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m05:46:47.214553 [debug] [MainThread]: Using vertica connection "_test"
[0m05:46:47.214691 [debug] [MainThread]: On _test: create schema if not exists "test16667632077883365037_test_array_concat"
  
[0m05:46:47.224489 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m05:46:47.226038 [debug] [MainThread]: On _test: COMMIT
[0m05:46:47.226381 [debug] [MainThread]: Using vertica connection "_test"
[0m05:46:47.226660 [debug] [MainThread]: On _test: COMMIT
[0m05:46:47.232585 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m05:46:47.233183 [debug] [MainThread]: On _test: Close
[0m05:46:47.246678 [debug] [MainThread]: Connection '_test' was properly closed.


============================== 2022-10-26 05:46:47.252256 | 69f7b787-6712-4c81-9526-768e1583cb30 ==============================
[0m05:46:47.252265 [info ] [MainThread]: Running with dbt=1.3.0
[0m05:46:47.252532 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/tmp/pytest-of-sachin/pytest-36/profile11', 'send_anonymous_usage_stats': False, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
[0m05:46:47.252639 [debug] [MainThread]: Tracking: do not track
[0m05:46:47.258355 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
[0m05:46:47.266025 [debug] [MainThread]: Parsing macros/test_assert_equal.sql
[0m05:46:47.266664 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m05:46:47.266832 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m05:46:47.266962 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m05:46:47.271280 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m05:46:47.272124 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m05:46:47.272700 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m05:46:47.275307 [debug] [MainThread]: Parsing macros/materializations/models/incremental/helpers.sql
[0m05:46:47.277033 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m05:46:47.280585 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m05:46:47.281540 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m05:46:47.285256 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m05:46:47.286602 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m05:46:47.293507 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m05:46:47.294521 [debug] [MainThread]: Parsing macros/materializations/snapshots/helper.sql
[0m05:46:47.294671 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m05:46:47.299782 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m05:46:47.303304 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m05:46:47.303829 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m05:46:47.304243 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m05:46:47.306097 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m05:46:47.307655 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m05:46:47.311647 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m05:46:47.312508 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m05:46:47.313175 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m05:46:47.314532 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m05:46:47.316788 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m05:46:47.317648 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m05:46:47.320835 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m05:46:47.322181 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m05:46:47.324151 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m05:46:47.333045 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m05:46:47.337839 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m05:46:47.338756 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m05:46:47.344839 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m05:46:47.348852 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m05:46:47.358775 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m05:46:47.360852 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m05:46:47.364093 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m05:46:47.372039 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m05:46:47.373051 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m05:46:47.379993 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m05:46:47.389442 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m05:46:47.390514 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m05:46:47.391587 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m05:46:47.394219 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m05:46:47.404951 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m05:46:47.409028 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m05:46:47.409950 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m05:46:47.410879 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m05:46:47.412305 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m05:46:47.413476 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m05:46:47.415068 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m05:46:47.420712 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m05:46:47.429213 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m05:46:47.433385 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m05:46:47.441291 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m05:46:47.442599 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m05:46:47.444658 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m05:46:47.447243 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m05:46:47.450797 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m05:46:47.451549 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m05:46:47.452191 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m05:46:47.452785 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m05:46:47.453528 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m05:46:47.454435 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m05:46:47.455050 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m05:46:47.455624 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m05:46:47.456318 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m05:46:47.457676 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m05:46:47.458229 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m05:46:47.458971 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m05:46:47.459628 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m05:46:47.463517 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m05:46:47.464118 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m05:46:47.464910 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m05:46:47.465543 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m05:46:47.466299 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m05:46:47.466955 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m05:46:47.468325 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m05:46:47.468918 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m05:46:47.469423 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m05:46:47.470141 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m05:46:47.470823 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m05:46:47.471894 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m05:46:47.472733 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m05:46:47.473270 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m05:46:47.473698 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m05:46:47.474305 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m05:46:47.477380 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m05:46:47.482309 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m05:46:47.632782 [debug] [MainThread]: 1603: static parser failed on actual.sql
[0m05:46:47.638614 [debug] [MainThread]: 1602: parser fallback to jinja rendering on actual.sql
[0m05:46:47.639452 [debug] [MainThread]: 1603: static parser failed on expected.sql
[0m05:46:47.642460 [debug] [MainThread]: 1602: parser fallback to jinja rendering on expected.sql
[0m05:46:47.663568 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 297 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m05:46:47.664244 [info ] [MainThread]: 
[0m05:46:47.664696 [debug] [MainThread]: Acquiring new vertica connection "master"
[0m05:46:47.665333 [debug] [ThreadPool]: Acquiring new vertica connection "list_VMart"
[0m05:46:47.666668 [debug] [ThreadPool]: Using vertica connection "list_VMart"
[0m05:46:47.666800 [debug] [ThreadPool]: On list_VMart: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "list_VMart"} */

    select schema_name
    from v_catalog.schemata
  
[0m05:46:47.666896 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:46:47.685257 [debug] [ThreadPool]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m05:46:47.706969 [debug] [ThreadPool]: SQL status: Code: [Column(name='schema_name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.04 seconds
[0m05:46:47.709695 [debug] [ThreadPool]: On list_VMart: Close
[0m05:46:47.712711 [debug] [ThreadPool]: Acquiring new vertica connection "list_VMart_test16667632077883365037_test_array_concat"
[0m05:46:47.716762 [debug] [ThreadPool]: Using vertica connection "list_VMart_test16667632077883365037_test_array_concat"
[0m05:46:47.717231 [debug] [ThreadPool]: On list_VMart_test16667632077883365037_test_array_concat: BEGIN
[0m05:46:47.717462 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:46:47.733925 [debug] [ThreadPool]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m05:46:47.742065 [debug] [ThreadPool]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m05:46:47.742613 [debug] [ThreadPool]: Using vertica connection "list_VMart_test16667632077883365037_test_array_concat"
[0m05:46:47.742952 [debug] [ThreadPool]: On list_VMart_test16667632077883365037_test_array_concat: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "list_VMart_test16667632077883365037_test_array_concat"} */
select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'table' as type
    from v_catalog.tables
    where table_schema ilike 'test16667632077883365037_test_array_concat'
    union all
    select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'view' as type
    from v_catalog.views
    where table_schema ilike 'test16667632077883365037_test_array_concat'
  
[0m05:46:47.761679 [debug] [ThreadPool]: SQL status: Code: [Column(name='database', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='schema', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='type', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.02 seconds
[0m05:46:47.764241 [debug] [ThreadPool]: On list_VMart_test16667632077883365037_test_array_concat: ROLLBACK
[0m05:46:47.769470 [debug] [ThreadPool]: On list_VMart_test16667632077883365037_test_array_concat: Close
[0m05:46:47.771505 [debug] [MainThread]: Using vertica connection "master"
[0m05:46:47.772030 [debug] [MainThread]: On master: BEGIN
[0m05:46:47.772405 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:46:47.790287 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m05:46:47.795602 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m05:46:47.796191 [debug] [MainThread]: On master: COMMIT
[0m05:46:47.796583 [debug] [MainThread]: Using vertica connection "master"
[0m05:46:47.796932 [debug] [MainThread]: On master: COMMIT
[0m05:46:47.802296 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m05:46:47.802897 [debug] [MainThread]: On master: Close
[0m05:46:47.804087 [info ] [MainThread]: Concurrency: 4 threads (target='default')
[0m05:46:47.804795 [info ] [MainThread]: 
[0m05:46:47.808742 [debug] [Thread-113]: Began running node model.test.actual
[0m05:46:47.809247 [debug] [Thread-114]: Began running node model.test.expected
[0m05:46:47.809922 [info ] [Thread-113]: 1 of 2 START sql view model test16667632077883365037_test_array_concat.actual .. [RUN]
[0m05:46:47.810649 [info ] [Thread-114]: 2 of 2 START sql view model test16667632077883365037_test_array_concat.expected  [RUN]
[0m05:46:47.812166 [debug] [Thread-113]: Acquiring new vertica connection "model.test.actual"
[0m05:46:47.812782 [debug] [Thread-114]: Acquiring new vertica connection "model.test.expected"
[0m05:46:47.813034 [debug] [Thread-113]: Began compiling node model.test.actual
[0m05:46:47.813177 [debug] [Thread-114]: Began compiling node model.test.expected
[0m05:46:47.813335 [debug] [Thread-113]: Compiling model.test.actual
[0m05:46:47.813473 [debug] [Thread-114]: Compiling model.test.expected
[0m05:46:47.817507 [debug] [Thread-113]: Writing injected SQL for node "model.test.actual"
[0m05:46:47.820056 [debug] [Thread-114]: Writing injected SQL for node "model.test.expected"
[0m05:46:47.820687 [debug] [Thread-114]: finished collecting timing info
[0m05:46:47.820848 [debug] [Thread-114]: Began executing node model.test.expected
[0m05:46:47.822886 [debug] [Thread-114]: Writing runtime sql for node "model.test.expected"
[0m05:46:47.823142 [debug] [Thread-113]: finished collecting timing info
[0m05:46:47.823299 [debug] [Thread-113]: Began executing node model.test.actual
[0m05:46:47.825555 [debug] [Thread-113]: Writing runtime sql for node "model.test.actual"
[0m05:46:47.831162 [debug] [Thread-114]: Using vertica connection "model.test.expected"
[0m05:46:47.831355 [debug] [Thread-113]: Using vertica connection "model.test.actual"
[0m05:46:47.831544 [debug] [Thread-114]: On model.test.expected: BEGIN
[0m05:46:47.831687 [debug] [Thread-113]: On model.test.actual: BEGIN
[0m05:46:47.831812 [debug] [Thread-114]: Opening a new connection, currently in state init
[0m05:46:47.831943 [debug] [Thread-113]: Opening a new connection, currently in state closed
[0m05:46:47.848045 [debug] [Thread-114]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m05:46:47.848455 [debug] [Thread-113]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m05:46:47.854010 [debug] [Thread-114]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m05:46:47.854165 [debug] [Thread-114]: Using vertica connection "model.test.expected"
[0m05:46:47.854276 [debug] [Thread-114]: On model.test.expected: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.expected"} */

  create view "VMart"."test16667632077883365037_test_array_concat"."expected__dbt_tmp" as (
    select 1 as id, 
    array[ 1 , 2 , 3 , 4 , 5 , 6 ]
     as array_col union all
select 2 as id, 
    array[ 2 ]
     as array_col union all
select 3 as id, 
    array[ 3 ]
     as array_col
  );
[0m05:46:47.855149 [debug] [Thread-113]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m05:46:47.855293 [debug] [Thread-113]: Using vertica connection "model.test.actual"
[0m05:46:47.855400 [debug] [Thread-113]: On model.test.actual: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.actual"} */

  create view "VMart"."test16667632077883365037_test_array_concat"."actual__dbt_tmp" as (
    select 1 as id, array_cat(
    array[ 1 , 2 , 3 ]
    , 
    array[ 4 , 5 , 6 ]
    ) as array_col union all
select 2 as id, array_cat(
    array[]::INT[]
    , 
    array[ 2 ]
    ) as array_col union all
select 3 as id, array_cat(
    array[ 3 ]
    , 
    array[]::INT[]
    ) as array_col
  );
[0m05:46:47.865263 [debug] [Thread-114]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m05:46:47.867144 [debug] [Thread-114]: Using vertica connection "model.test.expected"
[0m05:46:47.867291 [debug] [Thread-114]: On model.test.expected: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.expected"} */
alter view "VMart"."test16667632077883365037_test_array_concat"."expected__dbt_tmp" rename to "expected"
[0m05:46:47.868538 [debug] [Thread-113]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m05:46:47.870179 [debug] [Thread-113]: Using vertica connection "model.test.actual"
[0m05:46:47.870386 [debug] [Thread-113]: On model.test.actual: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.actual"} */
alter view "VMart"."test16667632077883365037_test_array_concat"."actual__dbt_tmp" rename to "actual"
[0m05:46:47.879781 [debug] [Thread-114]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m05:46:47.880995 [debug] [Thread-114]: On model.test.expected: COMMIT
[0m05:46:47.881148 [debug] [Thread-113]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m05:46:47.881305 [debug] [Thread-114]: Using vertica connection "model.test.expected"
[0m05:46:47.882248 [debug] [Thread-113]: On model.test.actual: COMMIT
[0m05:46:47.882425 [debug] [Thread-114]: On model.test.expected: COMMIT
[0m05:46:47.882557 [debug] [Thread-113]: Using vertica connection "model.test.actual"
[0m05:46:47.882758 [debug] [Thread-113]: On model.test.actual: COMMIT
[0m05:46:47.889194 [debug] [Thread-113]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m05:46:47.889382 [debug] [Thread-114]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m05:46:47.892044 [debug] [Thread-113]: Using vertica connection "model.test.actual"
[0m05:46:47.936037 [debug] [Thread-113]: On model.test.actual: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.actual"} */
drop view if exists "VMart"."test16667632077883365037_test_array_concat"."actual__dbt_backup" cascade
[0m05:46:47.940974 [debug] [Thread-114]: Using vertica connection "model.test.expected"
[0m05:46:47.941233 [debug] [Thread-114]: On model.test.expected: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.expected"} */
drop view if exists "VMart"."test16667632077883365037_test_array_concat"."expected__dbt_backup" cascade
[0m05:46:47.950763 [debug] [Thread-114]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m05:46:47.951807 [debug] [Thread-114]: finished collecting timing info
[0m05:46:47.952022 [debug] [Thread-114]: On model.test.expected: Close
[0m05:46:47.952181 [debug] [Thread-113]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m05:46:47.953050 [debug] [Thread-113]: finished collecting timing info
[0m05:46:47.953573 [info ] [Thread-114]: 2 of 2 OK created sql view model test16667632077883365037_test_array_concat.expected  [[32mCode: None, Rows: -1, Array Size: 1[0m in 0.14s]
[0m05:46:47.953795 [debug] [Thread-113]: On model.test.actual: Close
[0m05:46:47.954176 [debug] [Thread-114]: Finished running node model.test.expected
[0m05:46:47.955025 [info ] [Thread-113]: 1 of 2 OK created sql view model test16667632077883365037_test_array_concat.actual  [[32mCode: None, Rows: -1, Array Size: 1[0m in 0.14s]
[0m05:46:47.955535 [debug] [Thread-113]: Finished running node model.test.actual
[0m05:46:47.956411 [debug] [MainThread]: Acquiring new vertica connection "master"
[0m05:46:47.956582 [debug] [MainThread]: Using vertica connection "master"
[0m05:46:47.956691 [debug] [MainThread]: On master: BEGIN
[0m05:46:47.956789 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:46:47.969786 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m05:46:47.974654 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m05:46:47.974885 [debug] [MainThread]: On master: COMMIT
[0m05:46:47.975004 [debug] [MainThread]: Using vertica connection "master"
[0m05:46:47.975107 [debug] [MainThread]: On master: COMMIT
[0m05:46:47.979414 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.0 seconds
[0m05:46:47.979681 [debug] [MainThread]: On master: Close
[0m05:46:47.980188 [info ] [MainThread]: 
[0m05:46:47.980433 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.32 seconds (0.32s).
[0m05:46:47.980643 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:46:47.980742 [debug] [MainThread]: Connection 'model.test.actual' was properly closed.
[0m05:46:47.980834 [debug] [MainThread]: Connection 'model.test.expected' was properly closed.
[0m05:46:47.985366 [info ] [MainThread]: 
[0m05:46:47.985652 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:46:47.985874 [info ] [MainThread]: 
[0m05:46:47.986066 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m05:46:47.986302 [debug] [MainThread]: Flushing usage events


============================== 2022-10-26 05:46:48.002809 | 69f7b787-6712-4c81-9526-768e1583cb30 ==============================
[0m05:46:48.002822 [info ] [MainThread]: Running with dbt=1.3.0
[0m05:46:48.003266 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/tmp/pytest-of-sachin/pytest-36/profile11', 'send_anonymous_usage_stats': False, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
[0m05:46:48.003439 [debug] [MainThread]: Tracking: do not track
[0m05:46:48.029994 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:46:48.030244 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:46:48.038969 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 297 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m05:46:48.039766 [info ] [MainThread]: 
[0m05:46:48.040346 [debug] [MainThread]: Acquiring new vertica connection "master"
[0m05:46:48.041053 [debug] [ThreadPool]: Acquiring new vertica connection "list_VMart"
[0m05:46:48.042492 [debug] [ThreadPool]: Using vertica connection "list_VMart"
[0m05:46:48.042644 [debug] [ThreadPool]: On list_VMart: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "list_VMart"} */

    select schema_name
    from v_catalog.schemata
  
[0m05:46:48.042752 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:46:48.057238 [debug] [ThreadPool]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m05:46:48.080071 [debug] [ThreadPool]: SQL status: Code: [Column(name='schema_name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.04 seconds
[0m05:46:48.081136 [debug] [ThreadPool]: On list_VMart: Close
[0m05:46:48.082294 [debug] [ThreadPool]: Acquiring new vertica connection "list_VMart_test16667632077883365037_test_array_concat"
[0m05:46:48.083774 [debug] [ThreadPool]: Using vertica connection "list_VMart_test16667632077883365037_test_array_concat"
[0m05:46:48.083989 [debug] [ThreadPool]: On list_VMart_test16667632077883365037_test_array_concat: BEGIN
[0m05:46:48.084259 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:46:48.097768 [debug] [ThreadPool]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m05:46:48.103245 [debug] [ThreadPool]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m05:46:48.103472 [debug] [ThreadPool]: Using vertica connection "list_VMart_test16667632077883365037_test_array_concat"
[0m05:46:48.103618 [debug] [ThreadPool]: On list_VMart_test16667632077883365037_test_array_concat: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "list_VMart_test16667632077883365037_test_array_concat"} */
select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'table' as type
    from v_catalog.tables
    where table_schema ilike 'test16667632077883365037_test_array_concat'
    union all
    select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'view' as type
    from v_catalog.views
    where table_schema ilike 'test16667632077883365037_test_array_concat'
  
[0m05:46:48.126086 [debug] [ThreadPool]: SQL status: Code: [Column(name='database', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='schema', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='type', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.02 seconds
[0m05:46:48.127167 [debug] [ThreadPool]: On list_VMart_test16667632077883365037_test_array_concat: ROLLBACK
[0m05:46:48.132260 [debug] [ThreadPool]: On list_VMart_test16667632077883365037_test_array_concat: Close
[0m05:46:48.133049 [debug] [MainThread]: Using vertica connection "master"
[0m05:46:48.133237 [debug] [MainThread]: On master: BEGIN
[0m05:46:48.133369 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:46:48.147294 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m05:46:48.152147 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m05:46:48.152436 [debug] [MainThread]: On master: COMMIT
[0m05:46:48.152570 [debug] [MainThread]: Using vertica connection "master"
[0m05:46:48.152683 [debug] [MainThread]: On master: COMMIT
[0m05:46:48.156619 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.0 seconds
[0m05:46:48.156862 [debug] [MainThread]: On master: Close
[0m05:46:48.157361 [info ] [MainThread]: Concurrency: 4 threads (target='default')
[0m05:46:48.157616 [info ] [MainThread]: 
[0m05:46:48.158687 [debug] [Thread-120]: Began running node model.test.actual
[0m05:46:48.158819 [debug] [Thread-121]: Began running node model.test.expected
[0m05:46:48.159077 [info ] [Thread-120]: 1 of 2 START sql view model test16667632077883365037_test_array_concat.actual .. [RUN]
[0m05:46:48.159289 [info ] [Thread-121]: 2 of 2 START sql view model test16667632077883365037_test_array_concat.expected  [RUN]
[0m05:46:48.159779 [debug] [Thread-120]: Acquiring new vertica connection "model.test.actual"
[0m05:46:48.160287 [debug] [Thread-121]: Acquiring new vertica connection "model.test.expected"
[0m05:46:48.160454 [debug] [Thread-120]: Began compiling node model.test.actual
[0m05:46:48.160594 [debug] [Thread-121]: Began compiling node model.test.expected
[0m05:46:48.160733 [debug] [Thread-120]: Compiling model.test.actual
[0m05:46:48.160859 [debug] [Thread-121]: Compiling model.test.expected
[0m05:46:48.165649 [debug] [Thread-120]: Writing injected SQL for node "model.test.actual"
[0m05:46:48.168649 [debug] [Thread-121]: Writing injected SQL for node "model.test.expected"
[0m05:46:48.169119 [debug] [Thread-120]: finished collecting timing info
[0m05:46:48.169434 [debug] [Thread-120]: Began executing node model.test.actual
[0m05:46:48.171873 [debug] [Thread-120]: Writing runtime sql for node "model.test.actual"
[0m05:46:48.172235 [debug] [Thread-121]: finished collecting timing info
[0m05:46:48.172453 [debug] [Thread-120]: Using vertica connection "model.test.actual"
[0m05:46:48.172737 [debug] [Thread-121]: Began executing node model.test.expected
[0m05:46:48.172986 [debug] [Thread-120]: On model.test.actual: BEGIN
[0m05:46:48.175831 [debug] [Thread-121]: Writing runtime sql for node "model.test.expected"
[0m05:46:48.176075 [debug] [Thread-120]: Opening a new connection, currently in state closed
[0m05:46:48.176614 [debug] [Thread-121]: Using vertica connection "model.test.expected"
[0m05:46:48.176749 [debug] [Thread-121]: On model.test.expected: BEGIN
[0m05:46:48.176854 [debug] [Thread-121]: Opening a new connection, currently in state init
[0m05:46:48.190829 [debug] [Thread-120]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m05:46:48.191217 [debug] [Thread-121]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m05:46:48.195131 [debug] [Thread-120]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m05:46:48.195426 [debug] [Thread-120]: Using vertica connection "model.test.actual"
[0m05:46:48.195605 [debug] [Thread-121]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m05:46:48.195781 [debug] [Thread-120]: On model.test.actual: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.actual"} */

  create view "VMart"."test16667632077883365037_test_array_concat"."actual__dbt_tmp" as (
    select 1 as id, array_cat(
    array[ 1 , 2 , 3 ]
    , 
    array[ 4 , 5 , 6 ]
    ) as array_col union all
select 2 as id, array_cat(
    array[]::INT[]
    , 
    array[ 2 ]
    ) as array_col union all
select 3 as id, array_cat(
    array[ 3 ]
    , 
    array[]::INT[]
    ) as array_col
  );
[0m05:46:48.195979 [debug] [Thread-121]: Using vertica connection "model.test.expected"
[0m05:46:48.196226 [debug] [Thread-121]: On model.test.expected: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.expected"} */

  create view "VMart"."test16667632077883365037_test_array_concat"."expected__dbt_tmp" as (
    select 1 as id, 
    array[ 1 , 2 , 3 , 4 , 5 , 6 ]
     as array_col union all
select 2 as id, 
    array[ 2 ]
     as array_col union all
select 3 as id, 
    array[ 3 ]
     as array_col
  );
[0m05:46:48.206391 [debug] [Thread-120]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m05:46:48.208578 [debug] [Thread-120]: Using vertica connection "model.test.actual"
[0m05:46:48.208785 [debug] [Thread-120]: On model.test.actual: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.actual"} */
alter view "VMart"."test16667632077883365037_test_array_concat"."actual" rename to "actual__dbt_backup"
[0m05:46:48.210796 [debug] [Thread-121]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m05:46:48.212771 [debug] [Thread-121]: Using vertica connection "model.test.expected"
[0m05:46:48.212956 [debug] [Thread-121]: On model.test.expected: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.expected"} */
alter view "VMart"."test16667632077883365037_test_array_concat"."expected" rename to "expected__dbt_backup"
[0m05:46:48.216503 [debug] [Thread-120]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m05:46:48.219993 [debug] [Thread-120]: Using vertica connection "model.test.actual"
[0m05:46:48.220285 [debug] [Thread-120]: On model.test.actual: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.actual"} */
alter view "VMart"."test16667632077883365037_test_array_concat"."actual__dbt_tmp" rename to "actual"
[0m05:46:48.224288 [debug] [Thread-121]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m05:46:48.226275 [debug] [Thread-121]: Using vertica connection "model.test.expected"
[0m05:46:48.226487 [debug] [Thread-121]: On model.test.expected: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.expected"} */
alter view "VMart"."test16667632077883365037_test_array_concat"."expected__dbt_tmp" rename to "expected"
[0m05:46:48.227491 [debug] [Thread-120]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m05:46:48.228619 [debug] [Thread-120]: On model.test.actual: COMMIT
[0m05:46:48.228775 [debug] [Thread-120]: Using vertica connection "model.test.actual"
[0m05:46:48.228911 [debug] [Thread-120]: On model.test.actual: COMMIT
[0m05:46:48.235115 [debug] [Thread-121]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m05:46:48.236462 [debug] [Thread-121]: On model.test.expected: COMMIT
[0m05:46:48.236674 [debug] [Thread-121]: Using vertica connection "model.test.expected"
[0m05:46:48.236810 [debug] [Thread-121]: On model.test.expected: COMMIT
[0m05:46:48.237062 [debug] [Thread-120]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m05:46:48.239533 [debug] [Thread-120]: Using vertica connection "model.test.actual"
[0m05:46:48.239708 [debug] [Thread-120]: On model.test.actual: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.actual"} */
drop view if exists "VMart"."test16667632077883365037_test_array_concat"."actual__dbt_backup" cascade
[0m05:46:48.240894 [debug] [Thread-121]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.0 seconds
[0m05:46:48.242193 [debug] [Thread-121]: Using vertica connection "model.test.expected"
[0m05:46:48.242374 [debug] [Thread-121]: On model.test.expected: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.expected"} */
drop view if exists "VMart"."test16667632077883365037_test_array_concat"."expected__dbt_backup" cascade
[0m05:46:48.250830 [debug] [Thread-120]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m05:46:48.251968 [debug] [Thread-120]: finished collecting timing info
[0m05:46:48.252212 [debug] [Thread-120]: On model.test.actual: Close
[0m05:46:48.252782 [info ] [Thread-120]: 1 of 2 OK created sql view model test16667632077883365037_test_array_concat.actual  [[32mCode: None, Rows: -1, Array Size: 1[0m in 0.09s]
[0m05:46:48.253062 [debug] [Thread-121]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m05:46:48.253292 [debug] [Thread-120]: Finished running node model.test.actual
[0m05:46:48.254103 [debug] [Thread-121]: finished collecting timing info
[0m05:46:48.254501 [debug] [Thread-121]: On model.test.expected: Close
[0m05:46:48.255048 [info ] [Thread-121]: 2 of 2 OK created sql view model test16667632077883365037_test_array_concat.expected  [[32mCode: None, Rows: -1, Array Size: 1[0m in 0.09s]
[0m05:46:48.255399 [debug] [Thread-121]: Finished running node model.test.expected
[0m05:46:48.256211 [debug] [MainThread]: Acquiring new vertica connection "master"
[0m05:46:48.256418 [debug] [MainThread]: Using vertica connection "master"
[0m05:46:48.256532 [debug] [MainThread]: On master: BEGIN
[0m05:46:48.256636 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:46:48.272041 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m05:46:48.277349 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m05:46:48.277574 [debug] [MainThread]: On master: COMMIT
[0m05:46:48.277686 [debug] [MainThread]: Using vertica connection "master"
[0m05:46:48.277788 [debug] [MainThread]: On master: COMMIT
[0m05:46:48.283203 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m05:46:48.283508 [debug] [MainThread]: On master: Close
[0m05:46:48.284112 [info ] [MainThread]: 
[0m05:46:48.284374 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.24 seconds (0.24s).
[0m05:46:48.284584 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:46:48.284683 [debug] [MainThread]: Connection 'model.test.actual' was properly closed.
[0m05:46:48.284777 [debug] [MainThread]: Connection 'model.test.expected' was properly closed.
[0m05:46:48.290044 [info ] [MainThread]: 
[0m05:46:48.290386 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:46:48.290607 [info ] [MainThread]: 
[0m05:46:48.290796 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m05:46:48.291052 [debug] [MainThread]: Flushing usage events
[0m05:46:48.291526 [debug] [MainThread]: Acquiring new vertica connection "_test"
[0m05:46:48.292769 [debug] [MainThread]: Using vertica connection "_test"
[0m05:46:48.292927 [debug] [MainThread]: On _test: BEGIN
[0m05:46:48.293037 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:46:48.307730 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m05:46:48.313249 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m05:46:48.313551 [debug] [MainThread]: Using vertica connection "_test"
[0m05:46:48.313703 [debug] [MainThread]: On _test: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "_test"} */

    select
    column_name
    , data_type
    , character_maximum_length
    , numeric_precision
    , numeric_scale
    from (
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.columns
        where table_schema = 'test16667632077883365037_test_array_concat'
        and table_name = 'expected'
        union all
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.view_columns
        where table_schema = 'test16667632077883365037_test_array_concat'
        and table_name = 'expected'
    ) t
    order by ordinal_position
  
[0m05:46:48.350206 [debug] [MainThread]: SQL status: Code: [Column(name='column_name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='data_type', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='character_maximum_length', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_precision', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_scale', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.04 seconds
[0m05:46:48.351332 [debug] [MainThread]: Using vertica connection "_test"
[0m05:46:48.351513 [debug] [MainThread]: On _test: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "_test"} */
with diff_count as (
    SELECT
        1 as id,
        COUNT(*) as num_missing FROM (
            (SELECT "array_col", "id" FROM "VMart"."test16667632077883365037_test_array_concat"."expected" EXCEPT
             SELECT "array_col", "id" FROM "VMart"."test16667632077883365037_test_array_concat"."actual")
             UNION ALL
            (SELECT "array_col", "id" FROM "VMart"."test16667632077883365037_test_array_concat"."actual" EXCEPT
             SELECT "array_col", "id" FROM "VMart"."test16667632077883365037_test_array_concat"."expected")
        ) as a
), table_a as (
    SELECT COUNT(*) as num_rows FROM "VMart"."test16667632077883365037_test_array_concat"."expected"
), table_b as (
    SELECT COUNT(*) as num_rows FROM "VMart"."test16667632077883365037_test_array_concat"."actual"
), row_count_diff as (
    select
        1 as id,
        table_a.num_rows - table_b.num_rows as difference
    from table_a, table_b
)
select
    row_count_diff.difference as row_count_difference,
    diff_count.num_missing as num_mismatched
from row_count_diff
join diff_count using (id)
[0m05:46:48.409079 [debug] [MainThread]: SQL status: Code: [Column(name='row_count_difference', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='num_mismatched', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.06 seconds
[0m05:46:48.410058 [debug] [MainThread]: On _test: ROLLBACK
[0m05:46:48.414880 [debug] [MainThread]: On _test: Close
[0m05:46:48.415674 [debug] [MainThread]: Acquiring new vertica connection "_test"
[0m05:46:48.416944 [debug] [MainThread]: Using vertica connection "_test"
[0m05:46:48.417069 [debug] [MainThread]: On _test: BEGIN
[0m05:46:48.417179 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:46:48.431848 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m05:46:48.437141 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m05:46:48.437672 [debug] [MainThread]: Using vertica connection "_test"
[0m05:46:48.438046 [debug] [MainThread]: On _test: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "_test"} */

    select
    column_name
    , data_type
    , character_maximum_length
    , numeric_precision
    , numeric_scale
    from (
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.columns
        where table_schema = 'test16667632077883365037_test_array_concat'
        and table_name = 'expected'
        union all
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.view_columns
        where table_schema = 'test16667632077883365037_test_array_concat'
        and table_name = 'expected'
    ) t
    order by ordinal_position
  
[0m05:46:48.475357 [debug] [MainThread]: SQL status: Code: [Column(name='column_name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='data_type', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='character_maximum_length', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_precision', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_scale', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.04 seconds
[0m05:46:48.478229 [debug] [MainThread]: On _test: ROLLBACK
[0m05:46:48.483088 [debug] [MainThread]: On _test: Close
[0m05:46:48.485196 [debug] [MainThread]: Acquiring new vertica connection "_test"
[0m05:46:48.488862 [debug] [MainThread]: Using vertica connection "_test"
[0m05:46:48.489287 [debug] [MainThread]: On _test: BEGIN
[0m05:46:48.489614 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:46:48.505154 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m05:46:48.511611 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m05:46:48.512177 [debug] [MainThread]: Using vertica connection "_test"
[0m05:46:48.512533 [debug] [MainThread]: On _test: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "_test"} */

    select
    column_name
    , data_type
    , character_maximum_length
    , numeric_precision
    , numeric_scale
    from (
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.columns
        where table_schema = 'test16667632077883365037_test_array_concat'
        and table_name = 'actual'
        union all
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.view_columns
        where table_schema = 'test16667632077883365037_test_array_concat'
        and table_name = 'actual'
    ) t
    order by ordinal_position
  
[0m05:46:48.541361 [debug] [MainThread]: SQL status: Code: [Column(name='column_name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='data_type', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='character_maximum_length', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_precision', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_scale', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.03 seconds
[0m05:46:48.544750 [debug] [MainThread]: On _test: ROLLBACK
[0m05:46:48.550483 [debug] [MainThread]: On _test: Close
[0m05:46:48.553390 [debug] [MainThread]: Acquiring new vertica connection "_test"
[0m05:46:48.554072 [debug] [MainThread]: Dropping schema "_ReferenceKey(database='vmart', schema='test16667632077883365037_test_array_concat', identifier=None)".
[0m05:46:48.558252 [debug] [MainThread]: Using vertica connection "_test"
[0m05:46:48.558758 [debug] [MainThread]: On _test: BEGIN
[0m05:46:48.559122 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:46:48.582384 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m05:46:48.587415 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.03 seconds
[0m05:46:48.587626 [debug] [MainThread]: Using vertica connection "_test"
[0m05:46:48.587748 [debug] [MainThread]: On _test: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "_test"} */
drop schema if exists "test16667632077883365037_test_array_concat" cascade
  
[0m05:46:48.599951 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m05:46:48.600736 [debug] [MainThread]: On _test: COMMIT
[0m05:46:48.600919 [debug] [MainThread]: Using vertica connection "_test"
[0m05:46:48.601055 [debug] [MainThread]: On _test: COMMIT
[0m05:46:48.605947 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.0 seconds
[0m05:46:48.606291 [debug] [MainThread]: On _test: Close
[0m05:46:48.607259 [debug] [MainThread]: Connection '_test' was properly closed.
[0m05:46:48.628687 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
[0m05:46:48.629867 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m05:46:48.630159 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m05:46:48.630409 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m05:46:48.638476 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m05:46:48.640139 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m05:46:48.641181 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m05:46:48.645148 [debug] [MainThread]: Parsing macros/materializations/models/incremental/helpers.sql
[0m05:46:48.647922 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m05:46:48.653660 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m05:46:48.655117 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m05:46:48.660783 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m05:46:48.663142 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m05:46:48.674387 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m05:46:48.676094 [debug] [MainThread]: Parsing macros/materializations/snapshots/helper.sql
[0m05:46:48.676382 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m05:46:48.684234 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m05:46:48.688106 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m05:46:48.688789 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m05:46:48.689291 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m05:46:48.691277 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m05:46:48.693058 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m05:46:48.697248 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m05:46:48.698206 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m05:46:48.700058 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m05:46:48.701525 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m05:46:48.703993 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m05:46:48.704820 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m05:46:48.708074 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m05:46:48.709525 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m05:46:48.711665 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m05:46:48.720826 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m05:46:48.725603 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m05:46:48.726624 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m05:46:48.732899 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m05:46:48.736939 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m05:46:48.747046 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m05:46:48.749171 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m05:46:48.752514 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m05:46:48.760169 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m05:46:48.761200 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m05:46:48.768159 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m05:46:48.777634 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m05:46:48.778762 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m05:46:48.779961 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m05:46:48.782682 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m05:46:48.793441 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m05:46:48.797645 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m05:46:48.798643 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m05:46:48.799642 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m05:46:48.801140 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m05:46:48.802404 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m05:46:48.804044 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m05:46:48.809955 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m05:46:48.818591 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m05:46:48.822825 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m05:46:48.830864 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m05:46:48.832200 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m05:46:48.834300 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m05:46:48.836883 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m05:46:48.840486 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m05:46:48.841299 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m05:46:48.842055 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m05:46:48.842703 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m05:46:48.843509 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m05:46:48.844462 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m05:46:48.845133 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m05:46:48.845797 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m05:46:48.846570 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m05:46:48.847844 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m05:46:48.848437 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m05:46:48.849321 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m05:46:48.850121 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m05:46:48.854124 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m05:46:48.854748 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m05:46:48.855557 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m05:46:48.856261 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m05:46:48.857126 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m05:46:48.857927 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m05:46:48.859448 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m05:46:48.860105 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m05:46:48.860704 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m05:46:48.861486 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m05:46:48.862266 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m05:46:48.863526 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m05:46:48.864397 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m05:46:48.864985 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m05:46:48.865473 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m05:46:48.866167 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m05:46:48.869250 [debug] [MainThread]: Parsing macros/etc/datetime.sql
