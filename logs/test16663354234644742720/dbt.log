[0m06:57:03.031218 [debug] [MainThread]: Acquiring new vertica connection "_test"
[0m06:57:03.031398 [debug] [MainThread]: Acquiring new vertica connection "_test"
[0m06:57:03.031561 [debug] [MainThread]: Creating schema "_ReferenceKey(database='vmart', schema='test16663354234644742720_test_basic', identifier=None)"
[0m06:57:03.037978 [debug] [MainThread]: Using vertica connection "_test"
[0m06:57:03.038135 [debug] [MainThread]: On _test: BEGIN
[0m06:57:03.038239 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:57:03.060414 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m06:57:03.066862 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.03 seconds
[0m06:57:03.067259 [debug] [MainThread]: Using vertica connection "_test"
[0m06:57:03.067496 [debug] [MainThread]: On _test: create schema if not exists "test16663354234644742720_test_basic"
  
[0m06:57:03.077118 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m06:57:03.079050 [debug] [MainThread]: On _test: COMMIT
[0m06:57:03.079523 [debug] [MainThread]: Using vertica connection "_test"
[0m06:57:03.079877 [debug] [MainThread]: On _test: COMMIT
[0m06:57:03.085841 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m06:57:03.086433 [debug] [MainThread]: On _test: Close
[0m06:57:03.100796 [debug] [MainThread]: Connection '_test' was properly closed.


============================== 2022-10-21 06:57:03.106290 | dc54a967-87af-47b3-8f41-53d6a5dcee54 ==============================
[0m06:57:03.106298 [info ] [MainThread]: Running with dbt=1.3.0
[0m06:57:03.106607 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/tmp/pytest-of-sachin/pytest-112/profile0', 'send_anonymous_usage_stats': False, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'parse_only': False, 'which': 'compile', 'rpc_method': 'compile', 'indirect_selection': 'eager'}
[0m06:57:03.106711 [debug] [MainThread]: Tracking: do not track
[0m06:57:03.112227 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
[0m06:57:03.120283 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m06:57:03.120462 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m06:57:03.121073 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m06:57:03.125412 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m06:57:03.126277 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m06:57:03.126860 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m06:57:03.129411 [debug] [MainThread]: Parsing macros/materializations/models/incremental/helpers.sql
[0m06:57:03.131100 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m06:57:03.134610 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m06:57:03.135483 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m06:57:03.139148 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m06:57:03.140402 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m06:57:03.147427 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m06:57:03.148442 [debug] [MainThread]: Parsing macros/materializations/snapshots/helper.sql
[0m06:57:03.148589 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m06:57:03.153658 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m06:57:03.157186 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m06:57:03.157923 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m06:57:03.158501 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m06:57:03.160378 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m06:57:03.162066 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m06:57:03.166160 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m06:57:03.167011 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m06:57:03.167711 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m06:57:03.169077 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m06:57:03.171352 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m06:57:03.172239 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m06:57:03.175449 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m06:57:03.176831 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m06:57:03.178819 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m06:57:03.187774 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m06:57:03.192625 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m06:57:03.193575 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m06:57:03.199674 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m06:57:03.203653 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m06:57:03.213626 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m06:57:03.215721 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m06:57:03.218942 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m06:57:03.226532 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m06:57:03.227538 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m06:57:03.234450 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m06:57:03.243834 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m06:57:03.244903 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m06:57:03.246024 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m06:57:03.248671 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m06:57:03.259360 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m06:57:03.263481 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m06:57:03.264402 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m06:57:03.265361 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m06:57:03.266817 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m06:57:03.267989 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m06:57:03.269577 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m06:57:03.275466 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m06:57:03.284061 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m06:57:03.288239 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m06:57:03.296189 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m06:57:03.297489 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m06:57:03.299541 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m06:57:03.302132 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m06:57:03.305677 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m06:57:03.306442 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m06:57:03.307092 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m06:57:03.307665 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m06:57:03.308418 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m06:57:03.309354 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m06:57:03.309958 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m06:57:03.310577 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m06:57:03.311275 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m06:57:03.312529 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m06:57:03.313042 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m06:57:03.313799 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m06:57:03.314485 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m06:57:03.318401 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m06:57:03.318998 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m06:57:03.319767 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m06:57:03.320418 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m06:57:03.321178 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m06:57:03.321842 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m06:57:03.323214 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m06:57:03.323824 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m06:57:03.324338 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m06:57:03.324989 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m06:57:03.325660 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m06:57:03.326736 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m06:57:03.327578 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m06:57:03.328132 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m06:57:03.328558 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m06:57:03.329165 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m06:57:03.332243 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m06:57:03.337118 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m06:57:03.501261 [debug] [MainThread]: 1699: static parser successfully parsed expected.sql
[0m06:57:03.508957 [debug] [MainThread]: 1699: static parser successfully parsed upstream.sql
[0m06:57:03.510665 [debug] [MainThread]: 1603: static parser failed on model.sql
[0m06:57:03.514869 [debug] [MainThread]: 1602: parser fallback to jinja rendering on model.sql
[0m06:57:03.550564 [info ] [MainThread]: Found 3 models, 1 test, 0 snapshots, 0 analyses, 296 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m06:57:03.551443 [info ] [MainThread]: 
[0m06:57:03.551912 [debug] [MainThread]: Acquiring new vertica connection "master"
[0m06:57:03.552579 [debug] [ThreadPool]: Acquiring new vertica connection "list_VMart_test16663354234644742720_test_basic"
[0m06:57:03.556435 [debug] [ThreadPool]: Using vertica connection "list_VMart_test16663354234644742720_test_basic"
[0m06:57:03.556576 [debug] [ThreadPool]: On list_VMart_test16663354234644742720_test_basic: BEGIN
[0m06:57:03.556692 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:57:03.581487 [debug] [ThreadPool]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m06:57:03.591188 [debug] [ThreadPool]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.03 seconds
[0m06:57:03.591760 [debug] [ThreadPool]: Using vertica connection "list_VMart_test16663354234644742720_test_basic"
[0m06:57:03.592114 [debug] [ThreadPool]: On list_VMart_test16663354234644742720_test_basic: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "list_VMart_test16663354234644742720_test_basic"} */
select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'table' as type
    from v_catalog.tables
    where table_schema ilike 'test16663354234644742720_test_basic'
    union all
    select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'view' as type
    from v_catalog.views
    where table_schema ilike 'test16663354234644742720_test_basic'
  
[0m06:57:03.644938 [debug] [ThreadPool]: SQL status: Code: [Column(name='database', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='schema', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='type', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.05 seconds
[0m06:57:03.647801 [debug] [ThreadPool]: On list_VMart_test16663354234644742720_test_basic: ROLLBACK
[0m06:57:03.655032 [debug] [ThreadPool]: On list_VMart_test16663354234644742720_test_basic: Close
[0m06:57:03.657498 [info ] [MainThread]: Concurrency: 4 threads (target='default')
[0m06:57:03.658322 [info ] [MainThread]: 
[0m06:57:03.664901 [debug] [Thread-1 (]: Began running node model.adapter_methods.upstream
[0m06:57:03.666082 [debug] [Thread-1 (]: Acquiring new vertica connection "model.adapter_methods.upstream"
[0m06:57:03.666385 [debug] [Thread-1 (]: Began compiling node model.adapter_methods.upstream
[0m06:57:03.666524 [debug] [Thread-1 (]: Compiling model.adapter_methods.upstream
[0m06:57:03.667629 [debug] [Thread-1 (]: Writing injected SQL for node "model.adapter_methods.upstream"
[0m06:57:03.667930 [debug] [Thread-1 (]: finished collecting timing info
[0m06:57:03.668069 [debug] [Thread-1 (]: Began executing node model.adapter_methods.upstream
[0m06:57:03.668198 [debug] [Thread-1 (]: finished collecting timing info
[0m06:57:03.668593 [debug] [Thread-1 (]: Finished running node model.adapter_methods.upstream
[0m06:57:03.669045 [debug] [Thread-3 (]: Began running node model.adapter_methods.model
[0m06:57:03.669472 [debug] [Thread-3 (]: Acquiring new vertica connection "model.adapter_methods.model"
[0m06:57:03.669607 [debug] [Thread-3 (]: Began compiling node model.adapter_methods.model
[0m06:57:03.669717 [debug] [Thread-3 (]: Compiling model.adapter_methods.model
[0m06:57:03.673657 [debug] [Thread-3 (]: Dropping schema "_ReferenceKey(database='vmart', schema='test16663354234644742720_test_basic', identifier=None)".
[0m06:57:03.677052 [debug] [Thread-3 (]: Using vertica connection "model.adapter_methods.model"
[0m06:57:03.677252 [debug] [Thread-3 (]: On model.adapter_methods.model: BEGIN
[0m06:57:03.677372 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m06:57:03.699755 [debug] [Thread-3 (]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m06:57:03.706282 [debug] [Thread-3 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.03 seconds
[0m06:57:03.706502 [debug] [Thread-3 (]: Using vertica connection "model.adapter_methods.model"
[0m06:57:03.706651 [debug] [Thread-3 (]: On model.adapter_methods.model: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.adapter_methods.model"} */
drop schema if exists "test16663354234644742720_test_basic" cascade
  
[0m06:57:03.719438 [debug] [Thread-3 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m06:57:03.720113 [debug] [Thread-3 (]: On model.adapter_methods.model: COMMIT
[0m06:57:03.720259 [debug] [Thread-3 (]: Using vertica connection "model.adapter_methods.model"
[0m06:57:03.720373 [debug] [Thread-3 (]: On model.adapter_methods.model: COMMIT
[0m06:57:03.725996 [debug] [Thread-3 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m06:57:03.726204 [debug] [Thread-3 (]: On "model.adapter_methods.model": cache miss for schema "{self.database}.{self.schema}", this is inefficient
[0m06:57:03.727624 [debug] [Thread-3 (]: Using vertica connection "model.adapter_methods.model"
[0m06:57:03.727755 [debug] [Thread-3 (]: On model.adapter_methods.model: BEGIN
[0m06:57:03.733363 [debug] [Thread-3 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m06:57:03.733533 [debug] [Thread-3 (]: Using vertica connection "model.adapter_methods.model"
[0m06:57:03.733658 [debug] [Thread-3 (]: On model.adapter_methods.model: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.adapter_methods.model"} */
select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'table' as type
    from v_catalog.tables
    where table_schema ilike 'test16663354234644742720_test_basic'
    union all
    select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'view' as type
    from v_catalog.views
    where table_schema ilike 'test16663354234644742720_test_basic'
  
[0m06:57:03.747365 [debug] [Thread-3 (]: SQL status: Code: [Column(name='database', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='schema', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='type', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.01 seconds
[0m06:57:03.748107 [debug] [Thread-3 (]: with database=VMart, schema=test16663354234644742720_test_basic, relations=[]
[0m06:57:03.748310 [debug] [Thread-3 (]: Creating schema "_ReferenceKey(database='vmart', schema='test16663354234644742720_test_basic', identifier=None)"
[0m06:57:03.749690 [debug] [Thread-3 (]: Using vertica connection "model.adapter_methods.model"
[0m06:57:03.749829 [debug] [Thread-3 (]: On model.adapter_methods.model: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.adapter_methods.model"} */
create schema if not exists "test16663354234644742720_test_basic"
  
[0m06:57:03.758116 [debug] [Thread-3 (]: SQL status: Code: [Column(name='database', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='schema', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='type', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.01 seconds
[0m06:57:03.759469 [debug] [Thread-3 (]: On model.adapter_methods.model: COMMIT
[0m06:57:03.759622 [debug] [Thread-3 (]: Using vertica connection "model.adapter_methods.model"
[0m06:57:03.759741 [debug] [Thread-3 (]: On model.adapter_methods.model: COMMIT
[0m06:57:03.764737 [debug] [Thread-3 (]: SQL status: Code: [Column(name='database', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='schema', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='type', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.0 seconds
[0m06:57:03.768608 [debug] [Thread-3 (]: Using vertica connection "model.adapter_methods.model"
[0m06:57:03.768783 [debug] [Thread-3 (]: On model.adapter_methods.model: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.adapter_methods.model"} */

    
  create view "VMart"."test16663354234644742720_test_basic"."upstream" as (
    select 2 as id
  );
  
[0m06:57:03.777513 [debug] [Thread-3 (]: SQL status: Code: [Column(name='database', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='schema', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='type', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.01 seconds
[0m06:57:03.778517 [debug] [Thread-3 (]: Writing injected SQL for node "model.adapter_methods.model"
[0m06:57:03.778822 [debug] [Thread-3 (]: finished collecting timing info
[0m06:57:03.778971 [debug] [Thread-3 (]: Began executing node model.adapter_methods.model
[0m06:57:03.779095 [debug] [Thread-3 (]: finished collecting timing info
[0m06:57:03.779217 [debug] [Thread-3 (]: On model.adapter_methods.model: Close
[0m06:57:03.779736 [debug] [Thread-3 (]: Finished running node model.adapter_methods.model
[0m06:57:03.780243 [debug] [Thread-2 (]: Began running node model.adapter_methods.expected
[0m06:57:03.780388 [debug] [Thread-1 (]: Began running node test.adapter_methods.get_columns_in_relation
[0m06:57:03.780846 [debug] [Thread-2 (]: Acquiring new vertica connection "model.adapter_methods.expected"
[0m06:57:03.781249 [debug] [Thread-1 (]: Acquiring new vertica connection "test.adapter_methods.get_columns_in_relation"
[0m06:57:03.781406 [debug] [Thread-2 (]: Began compiling node model.adapter_methods.expected
[0m06:57:03.781540 [debug] [Thread-1 (]: Began compiling node test.adapter_methods.get_columns_in_relation
[0m06:57:03.781666 [debug] [Thread-2 (]: Compiling model.adapter_methods.expected
[0m06:57:03.781790 [debug] [Thread-1 (]: Compiling test.adapter_methods.get_columns_in_relation
[0m06:57:03.783969 [debug] [Thread-2 (]: Writing injected SQL for node "model.adapter_methods.expected"
[0m06:57:03.790871 [debug] [Thread-1 (]: Using vertica connection "test.adapter_methods.get_columns_in_relation"
[0m06:57:03.791181 [debug] [Thread-1 (]: On test.adapter_methods.get_columns_in_relation: BEGIN
[0m06:57:03.791342 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:57:03.791465 [debug] [Thread-2 (]: finished collecting timing info
[0m06:57:03.791876 [debug] [Thread-2 (]: Began executing node model.adapter_methods.expected
[0m06:57:03.792049 [debug] [Thread-2 (]: finished collecting timing info
[0m06:57:03.792491 [debug] [Thread-2 (]: Finished running node model.adapter_methods.expected
[0m06:57:03.808634 [debug] [Thread-1 (]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m06:57:03.814006 [debug] [Thread-1 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m06:57:03.814358 [debug] [Thread-1 (]: Using vertica connection "test.adapter_methods.get_columns_in_relation"
[0m06:57:03.814561 [debug] [Thread-1 (]: On test.adapter_methods.get_columns_in_relation: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "test.adapter_methods.get_columns_in_relation"} */

    select
    column_name
    , data_type
    , character_maximum_length
    , numeric_precision
    , numeric_scale
    from (
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.columns
        where table_schema = 'test16663354234644742720_test_basic'
        and table_name = 'model'
        union all
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.view_columns
        where table_schema = 'test16663354234644742720_test_basic'
        and table_name = 'model'
    ) t
    order by ordinal_position
  
[0m06:57:03.842037 [debug] [Thread-1 (]: SQL status: Code: [Column(name='column_name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='data_type', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='character_maximum_length', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_precision', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_scale', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.03 seconds
[0m06:57:03.844709 [debug] [Thread-1 (]: Writing injected SQL for node "test.adapter_methods.get_columns_in_relation"
[0m06:57:03.845113 [debug] [Thread-1 (]: finished collecting timing info
[0m06:57:03.845335 [debug] [Thread-1 (]: Began executing node test.adapter_methods.get_columns_in_relation
[0m06:57:03.845475 [debug] [Thread-1 (]: finished collecting timing info
[0m06:57:03.845618 [debug] [Thread-1 (]: On test.adapter_methods.get_columns_in_relation: ROLLBACK
[0m06:57:03.850675 [debug] [Thread-1 (]: On test.adapter_methods.get_columns_in_relation: Close
[0m06:57:03.851323 [debug] [Thread-1 (]: Finished running node test.adapter_methods.get_columns_in_relation
[0m06:57:03.852053 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:57:03.852222 [debug] [MainThread]: Connection 'test.adapter_methods.get_columns_in_relation' was properly closed.
[0m06:57:03.852335 [debug] [MainThread]: Connection 'model.adapter_methods.model' was properly closed.
[0m06:57:03.852437 [debug] [MainThread]: Connection 'model.adapter_methods.expected' was properly closed.
[0m06:57:03.856681 [info ] [MainThread]: Done.
[0m06:57:03.857078 [debug] [MainThread]: Flushing usage events


============================== 2022-10-21 06:57:03.869990 | dc54a967-87af-47b3-8f41-53d6a5dcee54 ==============================
[0m06:57:03.870002 [info ] [MainThread]: Running with dbt=1.3.0
[0m06:57:03.870334 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/tmp/pytest-of-sachin/pytest-112/profile0', 'send_anonymous_usage_stats': False, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m06:57:03.870464 [debug] [MainThread]: Tracking: do not track
[0m06:57:03.899604 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:57:03.899832 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:57:03.907519 [info ] [MainThread]: Found 3 models, 1 test, 0 snapshots, 0 analyses, 296 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m06:57:03.908222 [info ] [MainThread]: 
[0m06:57:03.908656 [debug] [MainThread]: Acquiring new vertica connection "master"
[0m06:57:03.909389 [debug] [ThreadPool]: Acquiring new vertica connection "list_VMart"
[0m06:57:03.943710 [debug] [ThreadPool]: Using vertica connection "list_VMart"
[0m06:57:03.943903 [debug] [ThreadPool]: On list_VMart: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "list_VMart"} */

    select schema_name
    from v_catalog.schemata
  
[0m06:57:03.944087 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:57:03.963554 [debug] [ThreadPool]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m06:57:03.977645 [debug] [ThreadPool]: SQL status: Code: [Column(name='schema_name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.03 seconds
[0m06:57:03.980646 [debug] [ThreadPool]: On list_VMart: Close
[0m06:57:03.984034 [debug] [ThreadPool]: Acquiring new vertica connection "list_VMart_test16663354234644742720_test_basic"
[0m06:57:03.988492 [debug] [ThreadPool]: Using vertica connection "list_VMart_test16663354234644742720_test_basic"
[0m06:57:03.988929 [debug] [ThreadPool]: On list_VMart_test16663354234644742720_test_basic: BEGIN
[0m06:57:03.989272 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:57:04.008938 [debug] [ThreadPool]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m06:57:04.018877 [debug] [ThreadPool]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.03 seconds
[0m06:57:04.019492 [debug] [ThreadPool]: Using vertica connection "list_VMart_test16663354234644742720_test_basic"
[0m06:57:04.019860 [debug] [ThreadPool]: On list_VMart_test16663354234644742720_test_basic: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "list_VMart_test16663354234644742720_test_basic"} */
select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'table' as type
    from v_catalog.tables
    where table_schema ilike 'test16663354234644742720_test_basic'
    union all
    select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'view' as type
    from v_catalog.views
    where table_schema ilike 'test16663354234644742720_test_basic'
  
[0m06:57:04.035062 [debug] [ThreadPool]: SQL status: Code: [Column(name='database', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='schema', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='type', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.01 seconds
[0m06:57:04.037513 [debug] [ThreadPool]: On list_VMart_test16663354234644742720_test_basic: ROLLBACK
[0m06:57:04.043587 [debug] [ThreadPool]: On list_VMart_test16663354234644742720_test_basic: Close
[0m06:57:04.045526 [debug] [MainThread]: Using vertica connection "master"
[0m06:57:04.046005 [debug] [MainThread]: On master: BEGIN
[0m06:57:04.046346 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:57:04.064917 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m06:57:04.070873 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m06:57:04.071436 [debug] [MainThread]: On master: COMMIT
[0m06:57:04.071786 [debug] [MainThread]: Using vertica connection "master"
[0m06:57:04.072100 [debug] [MainThread]: On master: COMMIT
[0m06:57:04.078313 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m06:57:04.078915 [debug] [MainThread]: On master: Close
[0m06:57:04.080095 [info ] [MainThread]: Concurrency: 4 threads (target='default')
[0m06:57:04.080788 [info ] [MainThread]: 
[0m06:57:04.084466 [debug] [Thread-8 (]: Began running node model.adapter_methods.upstream
[0m06:57:04.085196 [info ] [Thread-8 (]: 1 of 3 START sql view model test16663354234644742720_test_basic.upstream ....... [RUN]
[0m06:57:04.086533 [debug] [Thread-8 (]: Acquiring new vertica connection "model.adapter_methods.upstream"
[0m06:57:04.086941 [debug] [Thread-8 (]: Began compiling node model.adapter_methods.upstream
[0m06:57:04.087309 [debug] [Thread-8 (]: Compiling model.adapter_methods.upstream
[0m06:57:04.090442 [debug] [Thread-8 (]: Writing injected SQL for node "model.adapter_methods.upstream"
[0m06:57:04.091086 [debug] [Thread-8 (]: finished collecting timing info
[0m06:57:04.091482 [debug] [Thread-8 (]: Began executing node model.adapter_methods.upstream
[0m06:57:04.119735 [debug] [Thread-8 (]: Writing runtime sql for node "model.adapter_methods.upstream"
[0m06:57:04.120158 [debug] [Thread-8 (]: Using vertica connection "model.adapter_methods.upstream"
[0m06:57:04.120306 [debug] [Thread-8 (]: On model.adapter_methods.upstream: BEGIN
[0m06:57:04.120459 [debug] [Thread-8 (]: Opening a new connection, currently in state closed
[0m06:57:04.139892 [debug] [Thread-8 (]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m06:57:04.146741 [debug] [Thread-8 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.03 seconds
[0m06:57:04.146930 [debug] [Thread-8 (]: Using vertica connection "model.adapter_methods.upstream"
[0m06:57:04.147058 [debug] [Thread-8 (]: On model.adapter_methods.upstream: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.adapter_methods.upstream"} */

  create view "VMart"."test16663354234644742720_test_basic"."upstream__dbt_tmp" as (
    select 1 as id
  );
[0m06:57:04.161538 [debug] [Thread-8 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m06:57:04.165803 [debug] [Thread-8 (]: Using vertica connection "model.adapter_methods.upstream"
[0m06:57:04.166001 [debug] [Thread-8 (]: On model.adapter_methods.upstream: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.adapter_methods.upstream"} */
alter view "VMart"."test16663354234644742720_test_basic"."upstream" rename to "upstream__dbt_backup"
[0m06:57:04.176849 [debug] [Thread-8 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m06:57:04.178997 [debug] [Thread-8 (]: Using vertica connection "model.adapter_methods.upstream"
[0m06:57:04.179192 [debug] [Thread-8 (]: On model.adapter_methods.upstream: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.adapter_methods.upstream"} */
alter view "VMart"."test16663354234644742720_test_basic"."upstream__dbt_tmp" rename to "upstream"
[0m06:57:04.189701 [debug] [Thread-8 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m06:57:04.211151 [debug] [Thread-8 (]: On model.adapter_methods.upstream: COMMIT
[0m06:57:04.211489 [debug] [Thread-8 (]: Using vertica connection "model.adapter_methods.upstream"
[0m06:57:04.211717 [debug] [Thread-8 (]: On model.adapter_methods.upstream: COMMIT
[0m06:57:04.219240 [debug] [Thread-8 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m06:57:04.226063 [debug] [Thread-8 (]: Using vertica connection "model.adapter_methods.upstream"
[0m06:57:04.226393 [debug] [Thread-8 (]: On model.adapter_methods.upstream: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.adapter_methods.upstream"} */
drop view if exists "VMart"."test16663354234644742720_test_basic"."upstream__dbt_backup" cascade
[0m06:57:04.239450 [debug] [Thread-8 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m06:57:04.240517 [debug] [Thread-8 (]: finished collecting timing info
[0m06:57:04.240731 [debug] [Thread-8 (]: On model.adapter_methods.upstream: Close
[0m06:57:04.241319 [info ] [Thread-8 (]: 1 of 3 OK created sql view model test16663354234644742720_test_basic.upstream .. [[32mCode: None, Rows: -1, Array Size: 1[0m in 0.16s]
[0m06:57:04.241682 [debug] [Thread-8 (]: Finished running node model.adapter_methods.upstream
[0m06:57:04.242114 [debug] [Thread-10 ]: Began running node model.adapter_methods.model
[0m06:57:04.242554 [info ] [Thread-10 ]: 2 of 3 START sql view model test16663354234644742720_test_basic.model .......... [RUN]
[0m06:57:04.243034 [debug] [Thread-10 ]: Acquiring new vertica connection "model.adapter_methods.model"
[0m06:57:04.243166 [debug] [Thread-10 ]: Began compiling node model.adapter_methods.model
[0m06:57:04.243285 [debug] [Thread-10 ]: Compiling model.adapter_methods.model
[0m06:57:04.247097 [debug] [Thread-10 ]: Dropping schema "_ReferenceKey(database='vmart', schema='test16663354234644742720_test_basic', identifier=None)".
[0m06:57:04.248422 [debug] [Thread-10 ]: Using vertica connection "model.adapter_methods.model"
[0m06:57:04.248562 [debug] [Thread-10 ]: On model.adapter_methods.model: BEGIN
[0m06:57:04.248666 [debug] [Thread-10 ]: Opening a new connection, currently in state init
[0m06:57:04.269444 [debug] [Thread-10 ]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m06:57:04.276339 [debug] [Thread-10 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.03 seconds
[0m06:57:04.276777 [debug] [Thread-10 ]: Using vertica connection "model.adapter_methods.model"
[0m06:57:04.277042 [debug] [Thread-10 ]: On model.adapter_methods.model: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.adapter_methods.model"} */
drop schema if exists "test16663354234644742720_test_basic" cascade
  
[0m06:57:04.290669 [debug] [Thread-10 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m06:57:04.292459 [debug] [Thread-10 ]: On model.adapter_methods.model: COMMIT
[0m06:57:04.292849 [debug] [Thread-10 ]: Using vertica connection "model.adapter_methods.model"
[0m06:57:04.293169 [debug] [Thread-10 ]: On model.adapter_methods.model: COMMIT
[0m06:57:04.300563 [debug] [Thread-10 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m06:57:04.301349 [debug] [Thread-10 ]: On "model.adapter_methods.model": cache miss for schema "{self.database}.{self.schema}", this is inefficient
[0m06:57:04.305159 [debug] [Thread-10 ]: Using vertica connection "model.adapter_methods.model"
[0m06:57:04.305618 [debug] [Thread-10 ]: On model.adapter_methods.model: BEGIN
[0m06:57:04.312883 [debug] [Thread-10 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m06:57:04.313512 [debug] [Thread-10 ]: Using vertica connection "model.adapter_methods.model"
[0m06:57:04.313874 [debug] [Thread-10 ]: On model.adapter_methods.model: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.adapter_methods.model"} */
select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'table' as type
    from v_catalog.tables
    where table_schema ilike 'test16663354234644742720_test_basic'
    union all
    select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'view' as type
    from v_catalog.views
    where table_schema ilike 'test16663354234644742720_test_basic'
  
[0m06:57:04.343445 [debug] [Thread-10 ]: SQL status: Code: [Column(name='database', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='schema', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='type', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.03 seconds
[0m06:57:04.345878 [debug] [Thread-10 ]: with database=VMart, schema=test16663354234644742720_test_basic, relations=[]
[0m06:57:04.346537 [debug] [Thread-10 ]: Creating schema "_ReferenceKey(database='vmart', schema='test16663354234644742720_test_basic', identifier=None)"
[0m06:57:04.350492 [debug] [Thread-10 ]: Using vertica connection "model.adapter_methods.model"
[0m06:57:04.350936 [debug] [Thread-10 ]: On model.adapter_methods.model: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.adapter_methods.model"} */
create schema if not exists "test16663354234644742720_test_basic"
  
[0m06:57:04.363070 [debug] [Thread-10 ]: SQL status: Code: [Column(name='database', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='schema', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='type', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.01 seconds
[0m06:57:04.364917 [debug] [Thread-10 ]: On model.adapter_methods.model: COMMIT
[0m06:57:04.365390 [debug] [Thread-10 ]: Using vertica connection "model.adapter_methods.model"
[0m06:57:04.365747 [debug] [Thread-10 ]: On model.adapter_methods.model: COMMIT
[0m06:57:04.372762 [debug] [Thread-10 ]: SQL status: Code: [Column(name='database', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='schema', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='type', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.01 seconds
[0m06:57:04.374723 [debug] [Thread-10 ]: Using vertica connection "model.adapter_methods.model"
[0m06:57:04.375140 [debug] [Thread-10 ]: On model.adapter_methods.model: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.adapter_methods.model"} */

    
  create view "VMart"."test16663354234644742720_test_basic"."upstream" as (
    select 2 as id
  );
  
[0m06:57:04.387411 [debug] [Thread-10 ]: SQL status: Code: [Column(name='database', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='schema', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='type', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.01 seconds
[0m06:57:04.390015 [debug] [Thread-10 ]: Writing injected SQL for node "model.adapter_methods.model"
[0m06:57:04.390725 [debug] [Thread-10 ]: finished collecting timing info
[0m06:57:04.391157 [debug] [Thread-10 ]: Began executing node model.adapter_methods.model
[0m06:57:04.394776 [debug] [Thread-10 ]: On "model.adapter_methods.model": cache miss for schema "{self.database}.{self.schema}", this is inefficient
[0m06:57:04.398479 [debug] [Thread-10 ]: Using vertica connection "model.adapter_methods.model"
[0m06:57:04.398929 [debug] [Thread-10 ]: On model.adapter_methods.model: BEGIN
[0m06:57:04.406129 [debug] [Thread-10 ]: SQL status: Code: [Column(name='database', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='schema', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='type', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.01 seconds
[0m06:57:04.406684 [debug] [Thread-10 ]: Using vertica connection "model.adapter_methods.model"
[0m06:57:04.407052 [debug] [Thread-10 ]: On model.adapter_methods.model: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.adapter_methods.model"} */
select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'table' as type
    from v_catalog.tables
    where table_schema ilike 'test16663354234644742720_test_basic'
    union all
    select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'view' as type
    from v_catalog.views
    where table_schema ilike 'test16663354234644742720_test_basic'
  
[0m06:57:04.436368 [debug] [Thread-10 ]: SQL status: Code: [Column(name='database', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='schema', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='type', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.03 seconds
[0m06:57:04.439261 [debug] [Thread-10 ]: with database=VMart, schema=test16663354234644742720_test_basic, relations=[_ReferenceKey(database='vmart', schema='test16663354234644742720_test_basic', identifier='upstream')]
[0m06:57:04.441508 [debug] [Thread-10 ]: On "model.adapter_methods.model": cache miss for schema "{self.database}.{self.schema}", this is inefficient
[0m06:57:04.445347 [debug] [Thread-10 ]: Using vertica connection "model.adapter_methods.model"
[0m06:57:04.445808 [debug] [Thread-10 ]: On model.adapter_methods.model: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.adapter_methods.model"} */
select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'table' as type
    from v_catalog.tables
    where table_schema ilike 'test16663354234644742720_test_basic'
    union all
    select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'view' as type
    from v_catalog.views
    where table_schema ilike 'test16663354234644742720_test_basic'
  
[0m06:57:04.463364 [debug] [Thread-10 ]: SQL status: Code: [Column(name='database', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='schema', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='type', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.02 seconds
[0m06:57:04.465834 [debug] [Thread-10 ]: with database=VMart, schema=test16663354234644742720_test_basic, relations=[_ReferenceKey(database='vmart', schema='test16663354234644742720_test_basic', identifier='upstream')]
[0m06:57:04.467614 [debug] [Thread-10 ]: On "model.adapter_methods.model": cache miss for schema "{self.database}.{self.schema}", this is inefficient
[0m06:57:04.471367 [debug] [Thread-10 ]: Using vertica connection "model.adapter_methods.model"
[0m06:57:04.471783 [debug] [Thread-10 ]: On model.adapter_methods.model: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.adapter_methods.model"} */
select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'table' as type
    from v_catalog.tables
    where table_schema ilike 'test16663354234644742720_test_basic'
    union all
    select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'view' as type
    from v_catalog.views
    where table_schema ilike 'test16663354234644742720_test_basic'
  
[0m06:57:04.487888 [debug] [Thread-10 ]: SQL status: Code: [Column(name='database', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='schema', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='type', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.02 seconds
[0m06:57:04.490449 [debug] [Thread-10 ]: with database=VMart, schema=test16663354234644742720_test_basic, relations=[_ReferenceKey(database='vmart', schema='test16663354234644742720_test_basic', identifier='upstream')]
[0m06:57:04.493342 [debug] [Thread-10 ]: Writing runtime sql for node "model.adapter_methods.model"
[0m06:57:04.494038 [debug] [Thread-10 ]: Using vertica connection "model.adapter_methods.model"
[0m06:57:04.494399 [debug] [Thread-10 ]: On model.adapter_methods.model: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.adapter_methods.model"} */

  create view "VMart"."test16663354234644742720_test_basic"."model__dbt_tmp" as (
    


    
    
    



select * from "VMart"."test16663354234644742720_test_basic"."upstream"
  );
[0m06:57:04.505706 [debug] [Thread-10 ]: SQL status: Code: [Column(name='database', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='schema', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='type', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.01 seconds
[0m06:57:04.511116 [debug] [Thread-10 ]: Using vertica connection "model.adapter_methods.model"
[0m06:57:04.511598 [debug] [Thread-10 ]: On model.adapter_methods.model: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.adapter_methods.model"} */
alter view "VMart"."test16663354234644742720_test_basic"."model__dbt_tmp" rename to "model"
[0m06:57:04.525925 [debug] [Thread-10 ]: SQL status: Code: [Column(name='database', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='schema', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='type', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.01 seconds
[0m06:57:04.529620 [debug] [Thread-10 ]: On model.adapter_methods.model: COMMIT
[0m06:57:04.530051 [debug] [Thread-10 ]: Using vertica connection "model.adapter_methods.model"
[0m06:57:04.530380 [debug] [Thread-10 ]: On model.adapter_methods.model: COMMIT
[0m06:57:04.537015 [debug] [Thread-10 ]: SQL status: Code: [Column(name='database', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='schema', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='type', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.01 seconds
[0m06:57:04.541203 [debug] [Thread-10 ]: Using vertica connection "model.adapter_methods.model"
[0m06:57:04.541593 [debug] [Thread-10 ]: On model.adapter_methods.model: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.adapter_methods.model"} */
drop view if exists "VMart"."test16663354234644742720_test_basic"."model__dbt_backup" cascade
[0m06:57:04.549635 [debug] [Thread-10 ]: SQL status: Code: [Column(name='database', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='schema', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='type', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.01 seconds
[0m06:57:04.551869 [debug] [Thread-10 ]: finished collecting timing info
[0m06:57:04.552302 [debug] [Thread-10 ]: On model.adapter_methods.model: Close
[0m06:57:04.553604 [info ] [Thread-10 ]: 2 of 3 OK created sql view model test16663354234644742720_test_basic.model ..... [[32mCode: [Column(name='database', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='schema', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='type', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1[0m in 0.31s]
[0m06:57:04.554490 [debug] [Thread-10 ]: Finished running node model.adapter_methods.model
[0m06:57:04.555686 [debug] [Thread-9 (]: Began running node model.adapter_methods.expected
[0m06:57:04.556206 [info ] [Thread-9 (]: 3 of 3 START sql view model test16663354234644742720_test_basic.expected ....... [RUN]
[0m06:57:04.557332 [debug] [Thread-9 (]: Acquiring new vertica connection "model.adapter_methods.expected"
[0m06:57:04.557660 [debug] [Thread-9 (]: Began compiling node model.adapter_methods.expected
[0m06:57:04.557954 [debug] [Thread-9 (]: Compiling model.adapter_methods.expected
[0m06:57:04.562654 [debug] [Thread-9 (]: Writing injected SQL for node "model.adapter_methods.expected"
[0m06:57:04.563321 [debug] [Thread-9 (]: finished collecting timing info
[0m06:57:04.563696 [debug] [Thread-9 (]: Began executing node model.adapter_methods.expected
[0m06:57:04.570922 [debug] [Thread-9 (]: Writing runtime sql for node "model.adapter_methods.expected"
[0m06:57:04.571447 [debug] [Thread-9 (]: Using vertica connection "model.adapter_methods.expected"
[0m06:57:04.571720 [debug] [Thread-9 (]: On model.adapter_methods.expected: BEGIN
[0m06:57:04.571950 [debug] [Thread-9 (]: Opening a new connection, currently in state init
[0m06:57:04.595502 [debug] [Thread-9 (]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m06:57:04.601968 [debug] [Thread-9 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.03 seconds
[0m06:57:04.602488 [debug] [Thread-9 (]: Using vertica connection "model.adapter_methods.expected"
[0m06:57:04.602798 [debug] [Thread-9 (]: On model.adapter_methods.expected: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.adapter_methods.expected"} */

  create view "VMart"."test16663354234644742720_test_basic"."expected__dbt_tmp" as (
    -- make sure this runs after 'model'
-- "VMart"."test16663354234644742720_test_basic"."model"
select 2 as id
  );
[0m06:57:04.613479 [debug] [Thread-9 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m06:57:04.618770 [debug] [Thread-9 (]: Using vertica connection "model.adapter_methods.expected"
[0m06:57:04.619266 [debug] [Thread-9 (]: On model.adapter_methods.expected: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.adapter_methods.expected"} */
alter view "VMart"."test16663354234644742720_test_basic"."expected__dbt_tmp" rename to "expected"
[0m06:57:04.629065 [debug] [Thread-9 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m06:57:04.632720 [debug] [Thread-9 (]: On model.adapter_methods.expected: COMMIT
[0m06:57:04.633144 [debug] [Thread-9 (]: Using vertica connection "model.adapter_methods.expected"
[0m06:57:04.633493 [debug] [Thread-9 (]: On model.adapter_methods.expected: COMMIT
[0m06:57:04.639696 [debug] [Thread-9 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m06:57:04.644069 [debug] [Thread-9 (]: Using vertica connection "model.adapter_methods.expected"
[0m06:57:04.644483 [debug] [Thread-9 (]: On model.adapter_methods.expected: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.adapter_methods.expected"} */
drop view if exists "VMart"."test16663354234644742720_test_basic"."expected__dbt_backup" cascade
[0m06:57:04.652868 [debug] [Thread-9 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m06:57:04.654772 [debug] [Thread-9 (]: finished collecting timing info
[0m06:57:04.655222 [debug] [Thread-9 (]: On model.adapter_methods.expected: Close
[0m06:57:04.656669 [info ] [Thread-9 (]: 3 of 3 OK created sql view model test16663354234644742720_test_basic.expected .. [[32mCode: None, Rows: -1, Array Size: 1[0m in 0.10s]
[0m06:57:04.657101 [debug] [Thread-9 (]: Finished running node model.adapter_methods.expected
[0m06:57:04.658213 [debug] [MainThread]: Acquiring new vertica connection "master"
[0m06:57:04.658428 [debug] [MainThread]: Using vertica connection "master"
[0m06:57:04.658547 [debug] [MainThread]: On master: BEGIN
[0m06:57:04.658650 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:57:04.675659 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m06:57:04.681530 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m06:57:04.681721 [debug] [MainThread]: On master: COMMIT
[0m06:57:04.681860 [debug] [MainThread]: Using vertica connection "master"
[0m06:57:04.681987 [debug] [MainThread]: On master: COMMIT
[0m06:57:04.687276 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m06:57:04.687435 [debug] [MainThread]: On master: Close
[0m06:57:04.687896 [info ] [MainThread]: 
[0m06:57:04.688126 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.78 seconds (0.78s).
[0m06:57:04.688317 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:57:04.688405 [debug] [MainThread]: Connection 'model.adapter_methods.upstream' was properly closed.
[0m06:57:04.688501 [debug] [MainThread]: Connection 'model.adapter_methods.model' was properly closed.
[0m06:57:04.688606 [debug] [MainThread]: Connection 'model.adapter_methods.expected' was properly closed.
[0m06:57:04.692534 [info ] [MainThread]: 
[0m06:57:04.692792 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:57:04.693009 [info ] [MainThread]: 
[0m06:57:04.693187 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m06:57:04.693422 [debug] [MainThread]: Flushing usage events
[0m06:57:04.693862 [debug] [MainThread]: Acquiring new vertica connection "_test"
[0m06:57:04.695140 [debug] [MainThread]: Using vertica connection "_test"
[0m06:57:04.695280 [debug] [MainThread]: On _test: BEGIN
[0m06:57:04.695387 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:57:04.712893 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m06:57:04.720426 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.03 seconds
[0m06:57:04.720729 [debug] [MainThread]: Using vertica connection "_test"
[0m06:57:04.720868 [debug] [MainThread]: On _test: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "_test"} */

    select
    column_name
    , data_type
    , character_maximum_length
    , numeric_precision
    , numeric_scale
    from (
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.columns
        where table_schema = 'test16663354234644742720_test_basic'
        and table_name = 'model'
        union all
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.view_columns
        where table_schema = 'test16663354234644742720_test_basic'
        and table_name = 'model'
    ) t
    order by ordinal_position
  
[0m06:57:04.783320 [debug] [MainThread]: SQL status: Code: [Column(name='column_name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='data_type', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='character_maximum_length', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_precision', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_scale', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.06 seconds
[0m06:57:04.786439 [debug] [MainThread]: Using vertica connection "_test"
[0m06:57:04.786927 [debug] [MainThread]: On _test: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "_test"} */
with diff_count as (
    SELECT
        1 as id,
        COUNT(*) as num_missing FROM (
            (SELECT "id" FROM "VMart"."test16663354234644742720_test_basic"."model" EXCEPT
             SELECT "id" FROM "VMart"."test16663354234644742720_test_basic"."expected")
             UNION ALL
            (SELECT "id" FROM "VMart"."test16663354234644742720_test_basic"."expected" EXCEPT
             SELECT "id" FROM "VMart"."test16663354234644742720_test_basic"."model")
        ) as a
), table_a as (
    SELECT COUNT(*) as num_rows FROM "VMart"."test16663354234644742720_test_basic"."model"
), table_b as (
    SELECT COUNT(*) as num_rows FROM "VMart"."test16663354234644742720_test_basic"."expected"
), row_count_diff as (
    select
        1 as id,
        table_a.num_rows - table_b.num_rows as difference
    from table_a, table_b
)
select
    row_count_diff.difference as row_count_difference,
    diff_count.num_missing as num_mismatched
from row_count_diff
join diff_count using (id)
[0m06:57:04.843121 [debug] [MainThread]: SQL status: Code: [Column(name='row_count_difference', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='num_mismatched', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.06 seconds
[0m06:57:04.845775 [debug] [MainThread]: On _test: ROLLBACK
[0m06:57:04.850719 [debug] [MainThread]: On _test: Close
[0m06:57:04.853669 [debug] [MainThread]: Acquiring new vertica connection "_test"
[0m06:57:04.854339 [debug] [MainThread]: Dropping schema "_ReferenceKey(database='vmart', schema='test16663354234644742720_test_basic', identifier=None)".
[0m06:57:04.859468 [debug] [MainThread]: Using vertica connection "_test"
[0m06:57:04.860049 [debug] [MainThread]: On _test: BEGIN
[0m06:57:04.860512 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:57:04.885012 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m06:57:04.891330 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.03 seconds
[0m06:57:04.891780 [debug] [MainThread]: Using vertica connection "_test"
[0m06:57:04.892040 [debug] [MainThread]: On _test: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "_test"} */
drop schema if exists "test16663354234644742720_test_basic" cascade
  
[0m06:57:04.903090 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m06:57:04.904677 [debug] [MainThread]: On _test: COMMIT
[0m06:57:04.905056 [debug] [MainThread]: Using vertica connection "_test"
[0m06:57:04.905429 [debug] [MainThread]: On _test: COMMIT
[0m06:57:04.911651 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m06:57:04.912238 [debug] [MainThread]: On _test: Close
[0m06:57:04.913746 [debug] [MainThread]: Connection '_test' was properly closed.
