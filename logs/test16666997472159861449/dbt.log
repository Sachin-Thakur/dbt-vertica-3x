[0m12:09:06.928671 [debug] [MainThread]: Acquiring new vertica connection "_test"
[0m12:09:06.928853 [debug] [MainThread]: Acquiring new vertica connection "_test"
[0m12:09:06.929020 [debug] [MainThread]: Creating schema "_ReferenceKey(database='vmart', schema='test16666997472159861449_test_array_concat', identifier=None)"
[0m12:09:06.935465 [debug] [MainThread]: Using vertica connection "_test"
[0m12:09:06.935633 [debug] [MainThread]: On _test: BEGIN
[0m12:09:06.935745 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:09:06.956619 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m12:09:06.963614 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.03 seconds
[0m12:09:06.963967 [debug] [MainThread]: Using vertica connection "_test"
[0m12:09:06.964199 [debug] [MainThread]: On _test: create schema if not exists "test16666997472159861449_test_array_concat"
  
[0m12:09:06.976911 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m12:09:06.978808 [debug] [MainThread]: On _test: COMMIT
[0m12:09:06.979250 [debug] [MainThread]: Using vertica connection "_test"
[0m12:09:06.979631 [debug] [MainThread]: On _test: COMMIT
[0m12:09:06.986993 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m12:09:06.987609 [debug] [MainThread]: On _test: Close
[0m12:09:07.002762 [debug] [MainThread]: Connection '_test' was properly closed.


============================== 2022-10-25 12:09:07.008399 | be5097c8-edd9-4f0e-b303-731892739e61 ==============================
[0m12:09:07.008408 [info ] [MainThread]: Running with dbt=1.3.0
[0m12:09:07.008667 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/tmp/pytest-of-sachin/pytest-32/profile0', 'send_anonymous_usage_stats': False, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
[0m12:09:07.008784 [debug] [MainThread]: Tracking: do not track
[0m12:09:07.014472 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
[0m12:09:07.022474 [debug] [MainThread]: Parsing macros/test_assert_equal.sql
[0m12:09:07.023041 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m12:09:07.023205 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m12:09:07.023369 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m12:09:07.027604 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m12:09:07.028514 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m12:09:07.029082 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m12:09:07.031611 [debug] [MainThread]: Parsing macros/materializations/models/incremental/helpers.sql
[0m12:09:07.033284 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m12:09:07.037286 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m12:09:07.038200 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m12:09:07.041947 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m12:09:07.043250 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m12:09:07.050407 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m12:09:07.051409 [debug] [MainThread]: Parsing macros/materializations/snapshots/helper.sql
[0m12:09:07.051559 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m12:09:07.056622 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m12:09:07.060156 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m12:09:07.060691 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m12:09:07.061133 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m12:09:07.063039 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m12:09:07.064627 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m12:09:07.068653 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m12:09:07.069487 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m12:09:07.070183 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m12:09:07.071551 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m12:09:07.073798 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m12:09:07.074673 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m12:09:07.077870 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m12:09:07.079285 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m12:09:07.081258 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m12:09:07.090149 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m12:09:07.094965 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m12:09:07.095938 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m12:09:07.102051 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m12:09:07.105968 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m12:09:07.115969 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m12:09:07.118080 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m12:09:07.121309 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m12:09:07.128935 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m12:09:07.129950 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m12:09:07.136809 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m12:09:07.146170 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m12:09:07.147272 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m12:09:07.148375 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m12:09:07.150965 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m12:09:07.161597 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m12:09:07.165703 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m12:09:07.166605 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m12:09:07.167562 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m12:09:07.169010 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m12:09:07.170217 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m12:09:07.171832 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m12:09:07.177486 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m12:09:07.186154 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m12:09:07.190285 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m12:09:07.198241 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m12:09:07.199559 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m12:09:07.201588 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m12:09:07.204114 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m12:09:07.207659 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m12:09:07.208446 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m12:09:07.209101 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m12:09:07.209681 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m12:09:07.210424 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m12:09:07.211373 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m12:09:07.211996 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m12:09:07.212560 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m12:09:07.213206 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m12:09:07.214410 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m12:09:07.214939 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m12:09:07.215695 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m12:09:07.216387 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m12:09:07.220224 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m12:09:07.220827 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m12:09:07.221589 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m12:09:07.222253 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m12:09:07.222997 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m12:09:07.223641 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m12:09:07.225190 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m12:09:07.225851 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m12:09:07.226393 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m12:09:07.227059 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m12:09:07.227798 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m12:09:07.228956 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m12:09:07.229790 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m12:09:07.230339 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m12:09:07.230774 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m12:09:07.231376 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m12:09:07.234406 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m12:09:07.239412 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m12:09:07.393779 [debug] [MainThread]: 1603: static parser failed on actual.sql
[0m12:09:07.407047 [debug] [MainThread]: 1602: parser fallback to jinja rendering on actual.sql
[0m12:09:07.407922 [debug] [MainThread]: 1603: static parser failed on expected.sql
[0m12:09:07.410923 [debug] [MainThread]: 1602: parser fallback to jinja rendering on expected.sql
[0m12:09:07.437286 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 297 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m12:09:07.438135 [info ] [MainThread]: 
[0m12:09:07.438610 [debug] [MainThread]: Acquiring new vertica connection "master"
[0m12:09:07.439388 [debug] [ThreadPool]: Acquiring new vertica connection "list_VMart"
[0m12:09:07.443389 [debug] [ThreadPool]: Using vertica connection "list_VMart"
[0m12:09:07.443810 [debug] [ThreadPool]: On list_VMart: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "list_VMart"} */

    select schema_name
    from v_catalog.schemata
  
[0m12:09:07.443962 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:09:07.465510 [debug] [ThreadPool]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m12:09:07.485599 [debug] [ThreadPool]: SQL status: Code: [Column(name='schema_name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.04 seconds
[0m12:09:07.488336 [debug] [ThreadPool]: On list_VMart: Close
[0m12:09:07.491511 [debug] [ThreadPool]: Acquiring new vertica connection "list_VMart_test16666997472159861449_test_array_concat"
[0m12:09:07.498435 [debug] [ThreadPool]: Using vertica connection "list_VMart_test16666997472159861449_test_array_concat"
[0m12:09:07.498604 [debug] [ThreadPool]: On list_VMart_test16666997472159861449_test_array_concat: BEGIN
[0m12:09:07.498714 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:09:07.516864 [debug] [ThreadPool]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m12:09:07.522147 [debug] [ThreadPool]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m12:09:07.522676 [debug] [ThreadPool]: Using vertica connection "list_VMart_test16666997472159861449_test_array_concat"
[0m12:09:07.523036 [debug] [ThreadPool]: On list_VMart_test16666997472159861449_test_array_concat: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "list_VMart_test16666997472159861449_test_array_concat"} */
select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'table' as type
    from v_catalog.tables
    where table_schema ilike 'test16666997472159861449_test_array_concat'
    union all
    select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'view' as type
    from v_catalog.views
    where table_schema ilike 'test16666997472159861449_test_array_concat'
  
[0m12:09:07.544449 [debug] [ThreadPool]: SQL status: Code: [Column(name='database', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='schema', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='type', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.02 seconds
[0m12:09:07.546812 [debug] [ThreadPool]: On list_VMart_test16666997472159861449_test_array_concat: ROLLBACK
[0m12:09:07.554741 [debug] [ThreadPool]: On list_VMart_test16666997472159861449_test_array_concat: Close
[0m12:09:07.556597 [debug] [MainThread]: Using vertica connection "master"
[0m12:09:07.557053 [debug] [MainThread]: On master: BEGIN
[0m12:09:07.557420 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:09:07.573947 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m12:09:07.580024 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m12:09:07.580296 [debug] [MainThread]: On master: COMMIT
[0m12:09:07.580423 [debug] [MainThread]: Using vertica connection "master"
[0m12:09:07.580530 [debug] [MainThread]: On master: COMMIT
[0m12:09:07.585587 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.0 seconds
[0m12:09:07.585841 [debug] [MainThread]: On master: Close
[0m12:09:07.586299 [info ] [MainThread]: Concurrency: 4 threads (target='default')
[0m12:09:07.586557 [info ] [MainThread]: 
[0m12:09:07.589148 [debug] [Thread-1 (]: Began running node model.test.actual
[0m12:09:07.589359 [debug] [Thread-2 (]: Began running node model.test.expected
[0m12:09:07.589700 [info ] [Thread-1 (]: 1 of 2 START sql view model test16666997472159861449_test_array_concat.actual .. [RUN]
[0m12:09:07.590035 [info ] [Thread-2 (]: 2 of 2 START sql view model test16666997472159861449_test_array_concat.expected  [RUN]
[0m12:09:07.590645 [debug] [Thread-1 (]: Acquiring new vertica connection "model.test.actual"
[0m12:09:07.591161 [debug] [Thread-2 (]: Acquiring new vertica connection "model.test.expected"
[0m12:09:07.591337 [debug] [Thread-1 (]: Began compiling node model.test.actual
[0m12:09:07.591493 [debug] [Thread-2 (]: Began compiling node model.test.expected
[0m12:09:07.591663 [debug] [Thread-1 (]: Compiling model.test.actual
[0m12:09:07.591973 [debug] [Thread-2 (]: Compiling model.test.expected
[0m12:09:07.596163 [debug] [Thread-1 (]: Writing injected SQL for node "model.test.actual"
[0m12:09:07.599277 [debug] [Thread-2 (]: Writing injected SQL for node "model.test.expected"
[0m12:09:07.599776 [debug] [Thread-1 (]: finished collecting timing info
[0m12:09:07.599965 [debug] [Thread-1 (]: Began executing node model.test.actual
[0m12:09:07.600094 [debug] [Thread-2 (]: finished collecting timing info
[0m12:09:07.625711 [debug] [Thread-1 (]: Writing runtime sql for node "model.test.actual"
[0m12:09:07.626028 [debug] [Thread-2 (]: Began executing node model.test.expected
[0m12:09:07.628691 [debug] [Thread-2 (]: Writing runtime sql for node "model.test.expected"
[0m12:09:07.629008 [debug] [Thread-1 (]: Using vertica connection "model.test.actual"
[0m12:09:07.629152 [debug] [Thread-2 (]: Using vertica connection "model.test.expected"
[0m12:09:07.629285 [debug] [Thread-1 (]: On model.test.actual: BEGIN
[0m12:09:07.629420 [debug] [Thread-2 (]: On model.test.expected: BEGIN
[0m12:09:07.629546 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:09:07.629674 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:09:07.645323 [debug] [Thread-1 (]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m12:09:07.645649 [debug] [Thread-2 (]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m12:09:07.653351 [debug] [Thread-1 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m12:09:07.653526 [debug] [Thread-1 (]: Using vertica connection "model.test.actual"
[0m12:09:07.653641 [debug] [Thread-1 (]: On model.test.actual: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.actual"} */

  create view "VMart"."test16666997472159861449_test_array_concat"."actual__dbt_tmp" as (
    select 1 as id, array_cat(
    array[ 1 , 2 , 3 ]
    , 
    array[ 4 , 5 , 6 ]
    ) as array_col union all
select 2 as id, array_cat(
    array[]::INT[]
    , 
    array[ 2 ]
    ) as array_col union all
select 3 as id, array_cat(
    array[ 3 ]
    , 
    array[]::INT[]
    ) as array_col
  );
[0m12:09:07.653852 [debug] [Thread-2 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m12:09:07.654001 [debug] [Thread-2 (]: Using vertica connection "model.test.expected"
[0m12:09:07.654114 [debug] [Thread-2 (]: On model.test.expected: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.expected"} */

  create view "VMart"."test16666997472159861449_test_array_concat"."expected__dbt_tmp" as (
    select 1 as id, 
    array[ 1 , 2 , 3 , 4 , 5 , 6 ]
     as array_col union all
select 2 as id, 
    array[ 2 ]
     as array_col union all
select 3 as id, 
    array[ 3 ]
     as array_col
  );
[0m12:09:07.666390 [debug] [Thread-2 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m12:09:07.670654 [debug] [Thread-2 (]: Using vertica connection "model.test.expected"
[0m12:09:07.670842 [debug] [Thread-2 (]: On model.test.expected: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.expected"} */
alter view "VMart"."test16666997472159861449_test_array_concat"."expected__dbt_tmp" rename to "expected"
[0m12:09:07.670976 [debug] [Thread-1 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m12:09:07.673313 [debug] [Thread-1 (]: Using vertica connection "model.test.actual"
[0m12:09:07.673476 [debug] [Thread-1 (]: On model.test.actual: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.actual"} */
alter view "VMart"."test16666997472159861449_test_array_concat"."actual__dbt_tmp" rename to "actual"
[0m12:09:07.684266 [debug] [Thread-1 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m12:09:07.684488 [debug] [Thread-2 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m12:09:07.695416 [debug] [Thread-1 (]: On model.test.actual: COMMIT
[0m12:09:07.696598 [debug] [Thread-2 (]: On model.test.expected: COMMIT
[0m12:09:07.696883 [debug] [Thread-1 (]: Using vertica connection "model.test.actual"
[0m12:09:07.697106 [debug] [Thread-2 (]: Using vertica connection "model.test.expected"
[0m12:09:07.697329 [debug] [Thread-1 (]: On model.test.actual: COMMIT
[0m12:09:07.697560 [debug] [Thread-2 (]: On model.test.expected: COMMIT
[0m12:09:07.705127 [debug] [Thread-1 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m12:09:07.709155 [debug] [Thread-1 (]: Using vertica connection "model.test.actual"
[0m12:09:07.709387 [debug] [Thread-1 (]: On model.test.actual: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.actual"} */
drop view if exists "VMart"."test16666997472159861449_test_array_concat"."actual__dbt_backup" cascade
[0m12:09:07.709703 [debug] [Thread-2 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m12:09:07.711057 [debug] [Thread-2 (]: Using vertica connection "model.test.expected"
[0m12:09:07.711225 [debug] [Thread-2 (]: On model.test.expected: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.expected"} */
drop view if exists "VMart"."test16666997472159861449_test_array_concat"."expected__dbt_backup" cascade
[0m12:09:07.717269 [debug] [Thread-1 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m12:09:07.718282 [debug] [Thread-1 (]: finished collecting timing info
[0m12:09:07.718491 [debug] [Thread-1 (]: On model.test.actual: Close
[0m12:09:07.718674 [debug] [Thread-2 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m12:09:07.719252 [info ] [Thread-1 (]: 1 of 2 OK created sql view model test16666997472159861449_test_array_concat.actual  [[32mCode: None, Rows: -1, Array Size: 1[0m in 0.13s]
[0m12:09:07.720086 [debug] [Thread-2 (]: finished collecting timing info
[0m12:09:07.720446 [debug] [Thread-2 (]: On model.test.expected: Close
[0m12:09:07.720662 [debug] [Thread-1 (]: Finished running node model.test.actual
[0m12:09:07.721311 [info ] [Thread-2 (]: 2 of 2 OK created sql view model test16666997472159861449_test_array_concat.expected  [[32mCode: None, Rows: -1, Array Size: 1[0m in 0.13s]
[0m12:09:07.721662 [debug] [Thread-2 (]: Finished running node model.test.expected
[0m12:09:07.722482 [debug] [MainThread]: Acquiring new vertica connection "master"
[0m12:09:07.722641 [debug] [MainThread]: Using vertica connection "master"
[0m12:09:07.722750 [debug] [MainThread]: On master: BEGIN
[0m12:09:07.722850 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:09:07.739230 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m12:09:07.744708 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m12:09:07.744937 [debug] [MainThread]: On master: COMMIT
[0m12:09:07.745055 [debug] [MainThread]: Using vertica connection "master"
[0m12:09:07.745159 [debug] [MainThread]: On master: COMMIT
[0m12:09:07.750515 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m12:09:07.750765 [debug] [MainThread]: On master: Close
[0m12:09:07.751341 [info ] [MainThread]: 
[0m12:09:07.751591 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.31 seconds (0.31s).
[0m12:09:07.751783 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:09:07.751879 [debug] [MainThread]: Connection 'model.test.actual' was properly closed.
[0m12:09:07.751971 [debug] [MainThread]: Connection 'model.test.expected' was properly closed.
[0m12:09:07.756042 [info ] [MainThread]: 
[0m12:09:07.756506 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:09:07.756769 [info ] [MainThread]: 
[0m12:09:07.756954 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m12:09:07.757195 [debug] [MainThread]: Flushing usage events


============================== 2022-10-25 12:09:07.777009 | be5097c8-edd9-4f0e-b303-731892739e61 ==============================
[0m12:09:07.777023 [info ] [MainThread]: Running with dbt=1.3.0
[0m12:09:07.777431 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/tmp/pytest-of-sachin/pytest-32/profile0', 'send_anonymous_usage_stats': False, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
[0m12:09:07.777556 [debug] [MainThread]: Tracking: do not track
[0m12:09:07.819203 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:09:07.819568 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:09:07.832979 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 297 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m12:09:07.834070 [info ] [MainThread]: 
[0m12:09:07.834869 [debug] [MainThread]: Acquiring new vertica connection "master"
[0m12:09:07.835833 [debug] [ThreadPool]: Acquiring new vertica connection "list_VMart"
[0m12:09:07.838530 [debug] [ThreadPool]: Using vertica connection "list_VMart"
[0m12:09:07.838875 [debug] [ThreadPool]: On list_VMart: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "list_VMart"} */

    select schema_name
    from v_catalog.schemata
  
[0m12:09:07.839070 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:09:07.861504 [debug] [ThreadPool]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m12:09:07.883971 [debug] [ThreadPool]: SQL status: Code: [Column(name='schema_name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.04 seconds
[0m12:09:07.885193 [debug] [ThreadPool]: On list_VMart: Close
[0m12:09:07.886321 [debug] [ThreadPool]: Acquiring new vertica connection "list_VMart_test16666997472159861449_test_array_concat"
[0m12:09:07.923688 [debug] [ThreadPool]: Using vertica connection "list_VMart_test16666997472159861449_test_array_concat"
[0m12:09:07.923948 [debug] [ThreadPool]: On list_VMart_test16666997472159861449_test_array_concat: BEGIN
[0m12:09:07.924078 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:09:07.952822 [debug] [ThreadPool]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m12:09:07.960597 [debug] [ThreadPool]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.04 seconds
[0m12:09:07.960888 [debug] [ThreadPool]: Using vertica connection "list_VMart_test16666997472159861449_test_array_concat"
[0m12:09:07.961042 [debug] [ThreadPool]: On list_VMart_test16666997472159861449_test_array_concat: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "list_VMart_test16666997472159861449_test_array_concat"} */
select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'table' as type
    from v_catalog.tables
    where table_schema ilike 'test16666997472159861449_test_array_concat'
    union all
    select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'view' as type
    from v_catalog.views
    where table_schema ilike 'test16666997472159861449_test_array_concat'
  
[0m12:09:07.978286 [debug] [ThreadPool]: SQL status: Code: [Column(name='database', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='schema', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='type', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.02 seconds
[0m12:09:07.979406 [debug] [ThreadPool]: On list_VMart_test16666997472159861449_test_array_concat: ROLLBACK
[0m12:09:07.985848 [debug] [ThreadPool]: On list_VMart_test16666997472159861449_test_array_concat: Close
[0m12:09:07.986703 [debug] [MainThread]: Using vertica connection "master"
[0m12:09:07.986904 [debug] [MainThread]: On master: BEGIN
[0m12:09:07.987020 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:09:08.002773 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m12:09:08.008167 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m12:09:08.008440 [debug] [MainThread]: On master: COMMIT
[0m12:09:08.008564 [debug] [MainThread]: Using vertica connection "master"
[0m12:09:08.008667 [debug] [MainThread]: On master: COMMIT
[0m12:09:08.013898 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m12:09:08.014177 [debug] [MainThread]: On master: Close
[0m12:09:08.014655 [info ] [MainThread]: Concurrency: 4 threads (target='default')
[0m12:09:08.014921 [info ] [MainThread]: 
[0m12:09:08.015842 [debug] [Thread-8 (]: Began running node model.test.actual
[0m12:09:08.015973 [debug] [Thread-9 (]: Began running node model.test.expected
[0m12:09:08.016218 [info ] [Thread-8 (]: 1 of 2 START sql view model test16666997472159861449_test_array_concat.actual .. [RUN]
[0m12:09:08.016440 [info ] [Thread-9 (]: 2 of 2 START sql view model test16666997472159861449_test_array_concat.expected  [RUN]
[0m12:09:08.016957 [debug] [Thread-8 (]: Acquiring new vertica connection "model.test.actual"
[0m12:09:08.017440 [debug] [Thread-9 (]: Acquiring new vertica connection "model.test.expected"
[0m12:09:08.017598 [debug] [Thread-8 (]: Began compiling node model.test.actual
[0m12:09:08.017725 [debug] [Thread-9 (]: Began compiling node model.test.expected
[0m12:09:08.017858 [debug] [Thread-8 (]: Compiling model.test.actual
[0m12:09:08.017974 [debug] [Thread-9 (]: Compiling model.test.expected
[0m12:09:08.022248 [debug] [Thread-8 (]: Writing injected SQL for node "model.test.actual"
[0m12:09:08.025279 [debug] [Thread-9 (]: Writing injected SQL for node "model.test.expected"
[0m12:09:08.025746 [debug] [Thread-9 (]: finished collecting timing info
[0m12:09:08.025877 [debug] [Thread-8 (]: finished collecting timing info
[0m12:09:08.026048 [debug] [Thread-9 (]: Began executing node model.test.expected
[0m12:09:08.026179 [debug] [Thread-8 (]: Began executing node model.test.actual
[0m12:09:08.028783 [debug] [Thread-9 (]: Writing runtime sql for node "model.test.expected"
[0m12:09:08.031401 [debug] [Thread-8 (]: Writing runtime sql for node "model.test.actual"
[0m12:09:08.031880 [debug] [Thread-8 (]: Using vertica connection "model.test.actual"
[0m12:09:08.032017 [debug] [Thread-9 (]: Using vertica connection "model.test.expected"
[0m12:09:08.032159 [debug] [Thread-8 (]: On model.test.actual: BEGIN
[0m12:09:08.032285 [debug] [Thread-9 (]: On model.test.expected: BEGIN
[0m12:09:08.032402 [debug] [Thread-8 (]: Opening a new connection, currently in state closed
[0m12:09:08.032522 [debug] [Thread-9 (]: Opening a new connection, currently in state init
[0m12:09:08.052398 [debug] [Thread-9 (]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m12:09:08.055898 [debug] [Thread-8 (]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m12:09:08.059429 [debug] [Thread-9 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.03 seconds
[0m12:09:08.059695 [debug] [Thread-9 (]: Using vertica connection "model.test.expected"
[0m12:09:08.059829 [debug] [Thread-9 (]: On model.test.expected: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.expected"} */

  create view "VMart"."test16666997472159861449_test_array_concat"."expected__dbt_tmp" as (
    select 1 as id, 
    array[ 1 , 2 , 3 , 4 , 5 , 6 ]
     as array_col union all
select 2 as id, 
    array[ 2 ]
     as array_col union all
select 3 as id, 
    array[ 3 ]
     as array_col
  );
[0m12:09:08.062618 [debug] [Thread-8 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.03 seconds
[0m12:09:08.062871 [debug] [Thread-8 (]: Using vertica connection "model.test.actual"
[0m12:09:08.062989 [debug] [Thread-8 (]: On model.test.actual: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.actual"} */

  create view "VMart"."test16666997472159861449_test_array_concat"."actual__dbt_tmp" as (
    select 1 as id, array_cat(
    array[ 1 , 2 , 3 ]
    , 
    array[ 4 , 5 , 6 ]
    ) as array_col union all
select 2 as id, array_cat(
    array[]::INT[]
    , 
    array[ 2 ]
    ) as array_col union all
select 3 as id, array_cat(
    array[ 3 ]
    , 
    array[]::INT[]
    ) as array_col
  );
[0m12:09:08.071417 [debug] [Thread-9 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m12:09:08.073580 [debug] [Thread-9 (]: Using vertica connection "model.test.expected"
[0m12:09:08.073803 [debug] [Thread-9 (]: On model.test.expected: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.expected"} */
alter view "VMart"."test16666997472159861449_test_array_concat"."expected" rename to "expected__dbt_backup"
[0m12:09:08.077008 [debug] [Thread-8 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m12:09:08.079075 [debug] [Thread-8 (]: Using vertica connection "model.test.actual"
[0m12:09:08.079319 [debug] [Thread-8 (]: On model.test.actual: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.actual"} */
alter view "VMart"."test16666997472159861449_test_array_concat"."actual" rename to "actual__dbt_backup"
[0m12:09:08.087051 [debug] [Thread-9 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m12:09:08.089165 [debug] [Thread-9 (]: Using vertica connection "model.test.expected"
[0m12:09:08.089367 [debug] [Thread-9 (]: On model.test.expected: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.expected"} */
alter view "VMart"."test16666997472159861449_test_array_concat"."expected__dbt_tmp" rename to "expected"
[0m12:09:08.090274 [debug] [Thread-8 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m12:09:08.093038 [debug] [Thread-8 (]: Using vertica connection "model.test.actual"
[0m12:09:08.093243 [debug] [Thread-8 (]: On model.test.actual: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.actual"} */
alter view "VMart"."test16666997472159861449_test_array_concat"."actual__dbt_tmp" rename to "actual"
[0m12:09:08.102661 [debug] [Thread-9 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m12:09:08.105812 [debug] [Thread-9 (]: On model.test.expected: COMMIT
[0m12:09:08.106000 [debug] [Thread-8 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m12:09:08.106193 [debug] [Thread-9 (]: Using vertica connection "model.test.expected"
[0m12:09:08.107284 [debug] [Thread-8 (]: On model.test.actual: COMMIT
[0m12:09:08.107490 [debug] [Thread-9 (]: On model.test.expected: COMMIT
[0m12:09:08.107628 [debug] [Thread-8 (]: Using vertica connection "model.test.actual"
[0m12:09:08.107839 [debug] [Thread-8 (]: On model.test.actual: COMMIT
[0m12:09:08.116171 [debug] [Thread-9 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m12:09:08.116351 [debug] [Thread-8 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m12:09:08.117961 [debug] [Thread-9 (]: Using vertica connection "model.test.expected"
[0m12:09:08.119394 [debug] [Thread-8 (]: Using vertica connection "model.test.actual"
[0m12:09:08.119583 [debug] [Thread-9 (]: On model.test.expected: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.expected"} */
drop view if exists "VMart"."test16666997472159861449_test_array_concat"."expected__dbt_backup" cascade
[0m12:09:08.119718 [debug] [Thread-8 (]: On model.test.actual: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.actual"} */
drop view if exists "VMart"."test16666997472159861449_test_array_concat"."actual__dbt_backup" cascade
[0m12:09:08.135063 [debug] [Thread-9 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m12:09:08.135264 [debug] [Thread-8 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m12:09:08.136194 [debug] [Thread-9 (]: finished collecting timing info
[0m12:09:08.137008 [debug] [Thread-8 (]: finished collecting timing info
[0m12:09:08.137202 [debug] [Thread-9 (]: On model.test.expected: Close
[0m12:09:08.137366 [debug] [Thread-8 (]: On model.test.actual: Close
[0m12:09:08.138004 [info ] [Thread-9 (]: 2 of 2 OK created sql view model test16666997472159861449_test_array_concat.expected  [[32mCode: None, Rows: -1, Array Size: 1[0m in 0.12s]
[0m12:09:08.138424 [info ] [Thread-8 (]: 1 of 2 OK created sql view model test16666997472159861449_test_array_concat.actual  [[32mCode: None, Rows: -1, Array Size: 1[0m in 0.12s]
[0m12:09:08.138823 [debug] [Thread-9 (]: Finished running node model.test.expected
[0m12:09:08.139099 [debug] [Thread-8 (]: Finished running node model.test.actual
[0m12:09:08.140190 [debug] [MainThread]: Acquiring new vertica connection "master"
[0m12:09:08.140384 [debug] [MainThread]: Using vertica connection "master"
[0m12:09:08.140507 [debug] [MainThread]: On master: BEGIN
[0m12:09:08.140615 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:09:08.161913 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m12:09:08.170658 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.03 seconds
[0m12:09:08.170939 [debug] [MainThread]: On master: COMMIT
[0m12:09:08.171077 [debug] [MainThread]: Using vertica connection "master"
[0m12:09:08.171189 [debug] [MainThread]: On master: COMMIT
[0m12:09:08.178391 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m12:09:08.178691 [debug] [MainThread]: On master: Close
[0m12:09:08.179255 [info ] [MainThread]: 
[0m12:09:08.179557 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m12:09:08.179797 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:09:08.179912 [debug] [MainThread]: Connection 'model.test.actual' was properly closed.
[0m12:09:08.180014 [debug] [MainThread]: Connection 'model.test.expected' was properly closed.
[0m12:09:08.184051 [info ] [MainThread]: 
[0m12:09:08.184358 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:09:08.184587 [info ] [MainThread]: 
[0m12:09:08.184772 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m12:09:08.185020 [debug] [MainThread]: Flushing usage events
[0m12:09:08.185512 [debug] [MainThread]: Acquiring new vertica connection "_test"
[0m12:09:08.189742 [debug] [MainThread]: Using vertica connection "_test"
[0m12:09:08.189972 [debug] [MainThread]: On _test: BEGIN
[0m12:09:08.190097 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:09:08.210875 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m12:09:08.216726 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.03 seconds
[0m12:09:08.216973 [debug] [MainThread]: Using vertica connection "_test"
[0m12:09:08.217124 [debug] [MainThread]: On _test: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "_test"} */

    select
    column_name
    , data_type
    , character_maximum_length
    , numeric_precision
    , numeric_scale
    from (
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.columns
        where table_schema = 'test16666997472159861449_test_array_concat'
        and table_name = 'expected'
        union all
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.view_columns
        where table_schema = 'test16666997472159861449_test_array_concat'
        and table_name = 'expected'
    ) t
    order by ordinal_position
  
[0m12:09:08.255259 [debug] [MainThread]: SQL status: Code: [Column(name='column_name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='data_type', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='character_maximum_length', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_precision', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_scale', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.04 seconds
[0m12:09:08.257939 [debug] [MainThread]: Using vertica connection "_test"
[0m12:09:08.258142 [debug] [MainThread]: On _test: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "_test"} */
with diff_count as (
    SELECT
        1 as id,
        COUNT(*) as num_missing FROM (
            (SELECT "array_col", "id" FROM "VMart"."test16666997472159861449_test_array_concat"."expected" EXCEPT
             SELECT "array_col", "id" FROM "VMart"."test16666997472159861449_test_array_concat"."actual")
             UNION ALL
            (SELECT "array_col", "id" FROM "VMart"."test16666997472159861449_test_array_concat"."actual" EXCEPT
             SELECT "array_col", "id" FROM "VMart"."test16666997472159861449_test_array_concat"."expected")
        ) as a
), table_a as (
    SELECT COUNT(*) as num_rows FROM "VMart"."test16666997472159861449_test_array_concat"."expected"
), table_b as (
    SELECT COUNT(*) as num_rows FROM "VMart"."test16666997472159861449_test_array_concat"."actual"
), row_count_diff as (
    select
        1 as id,
        table_a.num_rows - table_b.num_rows as difference
    from table_a, table_b
)
select
    row_count_diff.difference as row_count_difference,
    diff_count.num_missing as num_mismatched
from row_count_diff
join diff_count using (id)
[0m12:09:08.328514 [debug] [MainThread]: SQL status: Code: [Column(name='row_count_difference', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='num_mismatched', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.07 seconds
[0m12:09:08.329480 [debug] [MainThread]: On _test: ROLLBACK
[0m12:09:08.336109 [debug] [MainThread]: On _test: Close
[0m12:09:08.336750 [debug] [MainThread]: Acquiring new vertica connection "_test"
[0m12:09:08.337976 [debug] [MainThread]: Using vertica connection "_test"
[0m12:09:08.338117 [debug] [MainThread]: On _test: BEGIN
[0m12:09:08.338223 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:09:08.355435 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m12:09:08.360880 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m12:09:08.361143 [debug] [MainThread]: Using vertica connection "_test"
[0m12:09:08.361279 [debug] [MainThread]: On _test: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "_test"} */

    select
    column_name
    , data_type
    , character_maximum_length
    , numeric_precision
    , numeric_scale
    from (
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.columns
        where table_schema = 'test16666997472159861449_test_array_concat'
        and table_name = 'expected'
        union all
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.view_columns
        where table_schema = 'test16666997472159861449_test_array_concat'
        and table_name = 'expected'
    ) t
    order by ordinal_position
  
[0m12:09:08.400552 [debug] [MainThread]: SQL status: Code: [Column(name='column_name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='data_type', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='character_maximum_length', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_precision', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_scale', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.04 seconds
[0m12:09:08.402268 [debug] [MainThread]: On _test: ROLLBACK
[0m12:09:08.408596 [debug] [MainThread]: On _test: Close
[0m12:09:08.410039 [debug] [MainThread]: Acquiring new vertica connection "_test"
[0m12:09:08.413045 [debug] [MainThread]: Using vertica connection "_test"
[0m12:09:08.413413 [debug] [MainThread]: On _test: BEGIN
[0m12:09:08.413689 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:09:08.431847 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m12:09:08.437548 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m12:09:08.438109 [debug] [MainThread]: Using vertica connection "_test"
[0m12:09:08.438458 [debug] [MainThread]: On _test: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "_test"} */

    select
    column_name
    , data_type
    , character_maximum_length
    , numeric_precision
    , numeric_scale
    from (
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.columns
        where table_schema = 'test16666997472159861449_test_array_concat'
        and table_name = 'actual'
        union all
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.view_columns
        where table_schema = 'test16666997472159861449_test_array_concat'
        and table_name = 'actual'
    ) t
    order by ordinal_position
  
[0m12:09:08.483727 [debug] [MainThread]: SQL status: Code: [Column(name='column_name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='data_type', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='character_maximum_length', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_precision', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_scale', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.04 seconds
[0m12:09:08.486509 [debug] [MainThread]: On _test: ROLLBACK
[0m12:09:08.492967 [debug] [MainThread]: On _test: Close
[0m12:09:08.496566 [debug] [MainThread]: Acquiring new vertica connection "_test"
[0m12:09:08.497373 [debug] [MainThread]: Dropping schema "_ReferenceKey(database='vmart', schema='test16666997472159861449_test_array_concat', identifier=None)".
[0m12:09:08.505987 [debug] [MainThread]: Using vertica connection "_test"
[0m12:09:08.506355 [debug] [MainThread]: On _test: BEGIN
[0m12:09:08.506572 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:09:08.524285 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m12:09:08.529968 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m12:09:08.530248 [debug] [MainThread]: Using vertica connection "_test"
[0m12:09:08.530417 [debug] [MainThread]: On _test: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "_test"} */
drop schema if exists "test16666997472159861449_test_array_concat" cascade
  
[0m12:09:08.542916 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m12:09:08.543760 [debug] [MainThread]: On _test: COMMIT
[0m12:09:08.543990 [debug] [MainThread]: Using vertica connection "_test"
[0m12:09:08.544103 [debug] [MainThread]: On _test: COMMIT
[0m12:09:08.551076 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m12:09:08.551411 [debug] [MainThread]: On _test: Close
[0m12:09:08.552069 [debug] [MainThread]: Connection '_test' was properly closed.
