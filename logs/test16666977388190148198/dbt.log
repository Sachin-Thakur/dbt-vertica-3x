[0m11:35:38.658795 [debug] [MainThread]: Acquiring new vertica connection "_test"
[0m11:35:38.658987 [debug] [MainThread]: Acquiring new vertica connection "_test"
[0m11:35:38.659168 [debug] [MainThread]: Creating schema "_ReferenceKey(database='vmart', schema='test16666977388190148198_test_array_concat', identifier=None)"
[0m11:35:38.660662 [debug] [MainThread]: Using vertica connection "_test"
[0m11:35:38.660793 [debug] [MainThread]: On _test: BEGIN
[0m11:35:38.660890 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:35:38.681505 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:35:38.688471 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.03 seconds
[0m11:35:38.688839 [debug] [MainThread]: Using vertica connection "_test"
[0m11:35:38.689049 [debug] [MainThread]: On _test: create schema if not exists "test16666977388190148198_test_array_concat"
  
[0m11:35:38.703355 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:35:38.705345 [debug] [MainThread]: On _test: COMMIT
[0m11:35:38.705808 [debug] [MainThread]: Using vertica connection "_test"
[0m11:35:38.706177 [debug] [MainThread]: On _test: COMMIT
[0m11:35:38.715740 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:35:38.716342 [debug] [MainThread]: On _test: Close
[0m11:35:38.732199 [debug] [MainThread]: Connection '_test' was properly closed.


============================== 2022-10-25 11:35:38.738037 | 4c46ffb8-78e4-40ce-8c33-537f87f69c3d ==============================
[0m11:35:38.738046 [info ] [MainThread]: Running with dbt=1.3.0
[0m11:35:38.738314 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/tmp/pytest-of-sachin/pytest-26/profile1', 'send_anonymous_usage_stats': False, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
[0m11:35:38.738435 [debug] [MainThread]: Tracking: do not track
[0m11:35:38.743991 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
[0m11:35:38.751937 [debug] [MainThread]: Parsing macros/test_assert_equal.sql
[0m11:35:38.752492 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m11:35:38.752650 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m11:35:38.752801 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m11:35:38.757112 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m11:35:38.757987 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m11:35:38.758584 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m11:35:38.761213 [debug] [MainThread]: Parsing macros/materializations/models/incremental/helpers.sql
[0m11:35:38.762935 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m11:35:38.766644 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m11:35:38.767608 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m11:35:38.771337 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m11:35:38.772618 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m11:35:38.779614 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m11:35:38.780658 [debug] [MainThread]: Parsing macros/materializations/snapshots/helper.sql
[0m11:35:38.780810 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m11:35:38.785996 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m11:35:38.789567 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m11:35:38.790124 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m11:35:38.790549 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m11:35:38.792435 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m11:35:38.794019 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m11:35:38.798141 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m11:35:38.799018 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m11:35:38.799713 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m11:35:38.801084 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m11:35:38.803358 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m11:35:38.804223 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m11:35:38.807466 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m11:35:38.808861 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m11:35:38.810865 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m11:35:38.820067 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m11:35:38.824947 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m11:35:38.825890 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m11:35:38.832568 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m11:35:38.836516 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m11:35:38.846588 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m11:35:38.848771 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m11:35:38.852050 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m11:35:38.859753 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m11:35:38.860771 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m11:35:38.867842 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m11:35:38.877444 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m11:35:38.878534 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m11:35:38.879636 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m11:35:38.882351 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m11:35:38.893140 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m11:35:38.897309 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m11:35:38.898292 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m11:35:38.899268 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m11:35:38.900817 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m11:35:38.902036 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m11:35:38.903665 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m11:35:38.909430 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m11:35:38.918193 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m11:35:38.922449 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m11:35:38.930519 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m11:35:38.931915 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m11:35:38.933987 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m11:35:38.936610 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m11:35:38.940215 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m11:35:38.940985 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m11:35:38.941639 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m11:35:38.942245 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m11:35:38.942994 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m11:35:38.943910 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m11:35:38.944538 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m11:35:38.945129 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m11:35:38.945811 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m11:35:38.947094 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m11:35:38.947653 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m11:35:38.948461 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m11:35:38.949154 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m11:35:38.953300 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m11:35:38.954110 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m11:35:38.955139 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m11:35:38.955954 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m11:35:38.957191 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m11:35:38.957972 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m11:35:38.959456 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m11:35:38.960091 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m11:35:38.960642 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m11:35:38.961358 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m11:35:38.962112 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m11:35:38.963340 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m11:35:38.964293 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m11:35:38.964879 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m11:35:38.965351 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m11:35:38.965986 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m11:35:38.969323 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m11:35:38.974517 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m11:35:39.132502 [debug] [MainThread]: 1603: static parser failed on actual.sql
[0m11:35:39.138684 [debug] [MainThread]: 1602: parser fallback to jinja rendering on actual.sql
[0m11:35:39.139822 [debug] [MainThread]: 1603: static parser failed on expected.sql
[0m11:35:39.143652 [debug] [MainThread]: 1602: parser fallback to jinja rendering on expected.sql
[0m11:35:39.166838 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 297 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m11:35:39.167542 [info ] [MainThread]: 
[0m11:35:39.168030 [debug] [MainThread]: Acquiring new vertica connection "master"
[0m11:35:39.168687 [debug] [ThreadPool]: Acquiring new vertica connection "list_VMart"
[0m11:35:39.169836 [debug] [ThreadPool]: Using vertica connection "list_VMart"
[0m11:35:39.169962 [debug] [ThreadPool]: On list_VMart: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "list_VMart"} */

    select schema_name
    from v_catalog.schemata
  
[0m11:35:39.170126 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:35:39.187386 [debug] [ThreadPool]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:35:39.204407 [debug] [ThreadPool]: SQL status: Code: [Column(name='schema_name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.03 seconds
[0m11:35:39.207037 [debug] [ThreadPool]: On list_VMart: Close
[0m11:35:39.209904 [debug] [ThreadPool]: Acquiring new vertica connection "list_VMart_test16666977388190148198_test_array_concat"
[0m11:35:39.213515 [debug] [ThreadPool]: Using vertica connection "list_VMart_test16666977388190148198_test_array_concat"
[0m11:35:39.213934 [debug] [ThreadPool]: On list_VMart_test16666977388190148198_test_array_concat: BEGIN
[0m11:35:39.214256 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:35:39.233296 [debug] [ThreadPool]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:35:39.238079 [debug] [ThreadPool]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m11:35:39.238586 [debug] [ThreadPool]: Using vertica connection "list_VMart_test16666977388190148198_test_array_concat"
[0m11:35:39.238983 [debug] [ThreadPool]: On list_VMart_test16666977388190148198_test_array_concat: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "list_VMart_test16666977388190148198_test_array_concat"} */
select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'table' as type
    from v_catalog.tables
    where table_schema ilike 'test16666977388190148198_test_array_concat'
    union all
    select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'view' as type
    from v_catalog.views
    where table_schema ilike 'test16666977388190148198_test_array_concat'
  
[0m11:35:39.257342 [debug] [ThreadPool]: SQL status: Code: [Column(name='database', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='schema', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='type', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.02 seconds
[0m11:35:39.260238 [debug] [ThreadPool]: On list_VMart_test16666977388190148198_test_array_concat: ROLLBACK
[0m11:35:39.267348 [debug] [ThreadPool]: On list_VMart_test16666977388190148198_test_array_concat: Close
[0m11:35:39.269250 [debug] [MainThread]: Using vertica connection "master"
[0m11:35:39.269729 [debug] [MainThread]: On master: BEGIN
[0m11:35:39.270082 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:35:39.288388 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:35:39.293970 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m11:35:39.294593 [debug] [MainThread]: On master: COMMIT
[0m11:35:39.294953 [debug] [MainThread]: Using vertica connection "master"
[0m11:35:39.295304 [debug] [MainThread]: On master: COMMIT
[0m11:35:39.305815 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:35:39.306637 [debug] [MainThread]: On master: Close
[0m11:35:39.308402 [info ] [MainThread]: Concurrency: 4 threads (target='default')
[0m11:35:39.309550 [info ] [MainThread]: 
[0m11:35:39.312728 [debug] [Thread-15 ]: Began running node model.test.actual
[0m11:35:39.313101 [debug] [Thread-16 ]: Began running node model.test.expected
[0m11:35:39.313559 [info ] [Thread-15 ]: 1 of 2 START sql view model test16666977388190148198_test_array_concat.actual .. [RUN]
[0m11:35:39.314011 [info ] [Thread-16 ]: 2 of 2 START sql view model test16666977388190148198_test_array_concat.expected  [RUN]
[0m11:35:39.314832 [debug] [Thread-15 ]: Acquiring new vertica connection "model.test.actual"
[0m11:35:39.315573 [debug] [Thread-16 ]: Acquiring new vertica connection "model.test.expected"
[0m11:35:39.315877 [debug] [Thread-15 ]: Began compiling node model.test.actual
[0m11:35:39.316104 [debug] [Thread-16 ]: Began compiling node model.test.expected
[0m11:35:39.316391 [debug] [Thread-15 ]: Compiling model.test.actual
[0m11:35:39.316540 [debug] [Thread-16 ]: Compiling model.test.expected
[0m11:35:39.320938 [debug] [Thread-15 ]: Writing injected SQL for node "model.test.actual"
[0m11:35:39.323830 [debug] [Thread-16 ]: Writing injected SQL for node "model.test.expected"
[0m11:35:39.324360 [debug] [Thread-16 ]: finished collecting timing info
[0m11:35:39.324528 [debug] [Thread-16 ]: Began executing node model.test.expected
[0m11:35:39.326935 [debug] [Thread-16 ]: Writing runtime sql for node "model.test.expected"
[0m11:35:39.327180 [debug] [Thread-15 ]: finished collecting timing info
[0m11:35:39.327381 [debug] [Thread-15 ]: Began executing node model.test.actual
[0m11:35:39.329540 [debug] [Thread-15 ]: Writing runtime sql for node "model.test.actual"
[0m11:35:39.329813 [debug] [Thread-15 ]: Using vertica connection "model.test.actual"
[0m11:35:39.329948 [debug] [Thread-15 ]: On model.test.actual: BEGIN
[0m11:35:39.330090 [debug] [Thread-16 ]: Using vertica connection "model.test.expected"
[0m11:35:39.330207 [debug] [Thread-15 ]: Opening a new connection, currently in state closed
[0m11:35:39.330344 [debug] [Thread-16 ]: On model.test.expected: BEGIN
[0m11:35:39.330706 [debug] [Thread-16 ]: Opening a new connection, currently in state init
[0m11:35:39.346466 [debug] [Thread-15 ]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:35:39.346772 [debug] [Thread-16 ]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:35:39.352097 [debug] [Thread-15 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m11:35:39.352491 [debug] [Thread-15 ]: Using vertica connection "model.test.actual"
[0m11:35:39.352680 [debug] [Thread-16 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m11:35:39.352831 [debug] [Thread-15 ]: On model.test.actual: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.actual"} */

  create view "VMart"."test16666977388190148198_test_array_concat"."actual__dbt_tmp" as (
    select 1 as id, array_cat(
    array[ 1 , 2 , 3 ]
    , 
    array[ 4 , 5 , 6 ]
    ) as array_col union all
select 2 as id, array_cat(
    array[]::INT[]
    , 
    array[ 2 ]
    ) as array_col union all
select 3 as id, array_cat(
    array[ 3 ]
    , 
    array[]::INT[]
    ) as array_col
  );
[0m11:35:39.352976 [debug] [Thread-16 ]: Using vertica connection "model.test.expected"
[0m11:35:39.353184 [debug] [Thread-16 ]: On model.test.expected: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.expected"} */

  create view "VMart"."test16666977388190148198_test_array_concat"."expected__dbt_tmp" as (
    select 1 as id, 
    array[ 1 , 2 , 3 , 4 , 5 , 6 ]
     as array_col union all
select 2 as id, 
    array[ 2 ]
     as array_col union all
select 3 as id, 
    array[ 3 ]
     as array_col
  );
[0m11:35:39.365023 [debug] [Thread-15 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:35:39.367877 [debug] [Thread-15 ]: Using vertica connection "model.test.actual"
[0m11:35:39.368054 [debug] [Thread-15 ]: On model.test.actual: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.actual"} */
alter view "VMart"."test16666977388190148198_test_array_concat"."actual__dbt_tmp" rename to "actual"
[0m11:35:39.368322 [debug] [Thread-16 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m11:35:39.369936 [debug] [Thread-16 ]: Using vertica connection "model.test.expected"
[0m11:35:39.370076 [debug] [Thread-16 ]: On model.test.expected: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.expected"} */
alter view "VMart"."test16666977388190148198_test_array_concat"."expected__dbt_tmp" rename to "expected"
[0m11:35:39.376099 [debug] [Thread-15 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:35:39.377620 [debug] [Thread-15 ]: On model.test.actual: COMMIT
[0m11:35:39.377859 [debug] [Thread-15 ]: Using vertica connection "model.test.actual"
[0m11:35:39.378026 [debug] [Thread-15 ]: On model.test.actual: COMMIT
[0m11:35:39.383859 [debug] [Thread-15 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:35:39.384254 [debug] [Thread-16 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:35:39.386847 [debug] [Thread-15 ]: Using vertica connection "model.test.actual"
[0m11:35:39.388634 [debug] [Thread-16 ]: On model.test.expected: COMMIT
[0m11:35:39.389038 [debug] [Thread-15 ]: On model.test.actual: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.actual"} */
drop view if exists "VMart"."test16666977388190148198_test_array_concat"."actual__dbt_backup" cascade
[0m11:35:39.389386 [debug] [Thread-16 ]: Using vertica connection "model.test.expected"
[0m11:35:39.389960 [debug] [Thread-16 ]: On model.test.expected: COMMIT
[0m11:35:39.395767 [debug] [Thread-15 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:35:39.397826 [debug] [Thread-15 ]: finished collecting timing info
[0m11:35:39.398257 [debug] [Thread-15 ]: On model.test.actual: Close
[0m11:35:39.399439 [info ] [Thread-15 ]: 1 of 2 OK created sql view model test16666977388190148198_test_array_concat.actual  [[32mCode: None, Rows: -1, Array Size: 1[0m in 0.08s]
[0m11:35:39.400128 [debug] [Thread-15 ]: Finished running node model.test.actual
[0m11:35:39.400734 [debug] [Thread-16 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:35:39.403569 [debug] [Thread-16 ]: Using vertica connection "model.test.expected"
[0m11:35:39.403863 [debug] [Thread-16 ]: On model.test.expected: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.expected"} */
drop view if exists "VMart"."test16666977388190148198_test_array_concat"."expected__dbt_backup" cascade
[0m11:35:39.413685 [debug] [Thread-16 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:35:39.416168 [debug] [Thread-16 ]: finished collecting timing info
[0m11:35:39.416681 [debug] [Thread-16 ]: On model.test.expected: Close
[0m11:35:39.418076 [info ] [Thread-16 ]: 2 of 2 OK created sql view model test16666977388190148198_test_array_concat.expected  [[32mCode: None, Rows: -1, Array Size: 1[0m in 0.10s]
[0m11:35:39.419022 [debug] [Thread-16 ]: Finished running node model.test.expected
[0m11:35:39.421532 [debug] [MainThread]: Acquiring new vertica connection "master"
[0m11:35:39.422100 [debug] [MainThread]: Using vertica connection "master"
[0m11:35:39.422432 [debug] [MainThread]: On master: BEGIN
[0m11:35:39.422730 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:35:39.440760 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:35:39.448761 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.03 seconds
[0m11:35:39.449353 [debug] [MainThread]: On master: COMMIT
[0m11:35:39.449710 [debug] [MainThread]: Using vertica connection "master"
[0m11:35:39.450030 [debug] [MainThread]: On master: COMMIT
[0m11:35:39.456730 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:35:39.457341 [debug] [MainThread]: On master: Close
[0m11:35:39.458603 [info ] [MainThread]: 
[0m11:35:39.459331 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.29 seconds (0.29s).
[0m11:35:39.459929 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:35:39.460228 [debug] [MainThread]: Connection 'model.test.actual' was properly closed.
[0m11:35:39.460505 [debug] [MainThread]: Connection 'model.test.expected' was properly closed.
[0m11:35:39.470433 [info ] [MainThread]: 
[0m11:35:39.470943 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:35:39.471409 [info ] [MainThread]: 
[0m11:35:39.471793 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m11:35:39.472263 [debug] [MainThread]: Flushing usage events


============================== 2022-10-25 11:35:39.490425 | 4c46ffb8-78e4-40ce-8c33-537f87f69c3d ==============================
[0m11:35:39.490437 [info ] [MainThread]: Running with dbt=1.3.0
[0m11:35:39.490859 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/tmp/pytest-of-sachin/pytest-26/profile1', 'send_anonymous_usage_stats': False, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
[0m11:35:39.491029 [debug] [MainThread]: Tracking: do not track
[0m11:35:39.511004 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:35:39.511247 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:35:39.518369 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 297 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m11:35:39.519032 [info ] [MainThread]: 
[0m11:35:39.519532 [debug] [MainThread]: Acquiring new vertica connection "master"
[0m11:35:39.520193 [debug] [ThreadPool]: Acquiring new vertica connection "list_VMart"
[0m11:35:39.521560 [debug] [ThreadPool]: Using vertica connection "list_VMart"
[0m11:35:39.521703 [debug] [ThreadPool]: On list_VMart: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "list_VMart"} */

    select schema_name
    from v_catalog.schemata
  
[0m11:35:39.521922 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:35:39.540418 [debug] [ThreadPool]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:35:39.558289 [debug] [ThreadPool]: SQL status: Code: [Column(name='schema_name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.04 seconds
[0m11:35:39.559322 [debug] [ThreadPool]: On list_VMart: Close
[0m11:35:39.560384 [debug] [ThreadPool]: Acquiring new vertica connection "list_VMart_test16666977388190148198_test_array_concat"
[0m11:35:39.600771 [debug] [ThreadPool]: Using vertica connection "list_VMart_test16666977388190148198_test_array_concat"
[0m11:35:39.601021 [debug] [ThreadPool]: On list_VMart_test16666977388190148198_test_array_concat: BEGIN
[0m11:35:39.601144 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:35:39.619610 [debug] [ThreadPool]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:35:39.625085 [debug] [ThreadPool]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m11:35:39.625360 [debug] [ThreadPool]: Using vertica connection "list_VMart_test16666977388190148198_test_array_concat"
[0m11:35:39.625483 [debug] [ThreadPool]: On list_VMart_test16666977388190148198_test_array_concat: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "list_VMart_test16666977388190148198_test_array_concat"} */
select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'table' as type
    from v_catalog.tables
    where table_schema ilike 'test16666977388190148198_test_array_concat'
    union all
    select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'view' as type
    from v_catalog.views
    where table_schema ilike 'test16666977388190148198_test_array_concat'
  
[0m11:35:39.647266 [debug] [ThreadPool]: SQL status: Code: [Column(name='database', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='schema', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='type', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.02 seconds
[0m11:35:39.649227 [debug] [ThreadPool]: On list_VMart_test16666977388190148198_test_array_concat: ROLLBACK
[0m11:35:39.657244 [debug] [ThreadPool]: On list_VMart_test16666977388190148198_test_array_concat: Close
[0m11:35:39.659204 [debug] [MainThread]: Using vertica connection "master"
[0m11:35:39.659954 [debug] [MainThread]: On master: BEGIN
[0m11:35:39.660553 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:35:39.679361 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:35:39.684899 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m11:35:39.685488 [debug] [MainThread]: On master: COMMIT
[0m11:35:39.685841 [debug] [MainThread]: Using vertica connection "master"
[0m11:35:39.686160 [debug] [MainThread]: On master: COMMIT
[0m11:35:39.692528 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:35:39.693022 [debug] [MainThread]: On master: Close
[0m11:35:39.694152 [info ] [MainThread]: Concurrency: 4 threads (target='default')
[0m11:35:39.694956 [info ] [MainThread]: 
[0m11:35:39.698411 [debug] [Thread-22 ]: Began running node model.test.actual
[0m11:35:39.698930 [debug] [Thread-23 ]: Began running node model.test.expected
[0m11:35:39.699530 [info ] [Thread-22 ]: 1 of 2 START sql view model test16666977388190148198_test_array_concat.actual .. [RUN]
[0m11:35:39.700271 [info ] [Thread-23 ]: 2 of 2 START sql view model test16666977388190148198_test_array_concat.expected  [RUN]
[0m11:35:39.701667 [debug] [Thread-22 ]: Acquiring new vertica connection "model.test.actual"
[0m11:35:39.703205 [debug] [Thread-23 ]: Acquiring new vertica connection "model.test.expected"
[0m11:35:39.703756 [debug] [Thread-22 ]: Began compiling node model.test.actual
[0m11:35:39.704254 [debug] [Thread-23 ]: Began compiling node model.test.expected
[0m11:35:39.704701 [debug] [Thread-22 ]: Compiling model.test.actual
[0m11:35:39.705155 [debug] [Thread-23 ]: Compiling model.test.expected
[0m11:35:39.716266 [debug] [Thread-22 ]: Writing injected SQL for node "model.test.actual"
[0m11:35:39.722779 [debug] [Thread-23 ]: Writing injected SQL for node "model.test.expected"
[0m11:35:39.723880 [debug] [Thread-22 ]: finished collecting timing info
[0m11:35:39.724206 [debug] [Thread-23 ]: finished collecting timing info
[0m11:35:39.724745 [debug] [Thread-22 ]: Began executing node model.test.actual
[0m11:35:39.725214 [debug] [Thread-23 ]: Began executing node model.test.expected
[0m11:35:39.731156 [debug] [Thread-22 ]: Writing runtime sql for node "model.test.actual"
[0m11:35:39.735977 [debug] [Thread-23 ]: Writing runtime sql for node "model.test.expected"
[0m11:35:39.736913 [debug] [Thread-22 ]: Using vertica connection "model.test.actual"
[0m11:35:39.737340 [debug] [Thread-22 ]: On model.test.actual: BEGIN
[0m11:35:39.737685 [debug] [Thread-23 ]: Using vertica connection "model.test.expected"
[0m11:35:39.738029 [debug] [Thread-22 ]: Opening a new connection, currently in state closed
[0m11:35:39.738410 [debug] [Thread-23 ]: On model.test.expected: BEGIN
[0m11:35:39.739237 [debug] [Thread-23 ]: Opening a new connection, currently in state init
[0m11:35:39.759033 [debug] [Thread-23 ]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:35:39.759874 [debug] [Thread-22 ]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:35:39.766666 [debug] [Thread-23 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.03 seconds
[0m11:35:39.767041 [debug] [Thread-22 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.03 seconds
[0m11:35:39.767571 [debug] [Thread-23 ]: Using vertica connection "model.test.expected"
[0m11:35:39.768083 [debug] [Thread-22 ]: Using vertica connection "model.test.actual"
[0m11:35:39.768581 [debug] [Thread-23 ]: On model.test.expected: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.expected"} */

  create view "VMart"."test16666977388190148198_test_array_concat"."expected__dbt_tmp" as (
    select 1 as id, 
    array[ 1 , 2 , 3 , 4 , 5 , 6 ]
     as array_col union all
select 2 as id, 
    array[ 2 ]
     as array_col union all
select 3 as id, 
    array[ 3 ]
     as array_col
  );
[0m11:35:39.768997 [debug] [Thread-22 ]: On model.test.actual: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.actual"} */

  create view "VMart"."test16666977388190148198_test_array_concat"."actual__dbt_tmp" as (
    select 1 as id, array_cat(
    array[ 1 , 2 , 3 ]
    , 
    array[ 4 , 5 , 6 ]
    ) as array_col union all
select 2 as id, array_cat(
    array[]::INT[]
    , 
    array[ 2 ]
    ) as array_col union all
select 3 as id, array_cat(
    array[ 3 ]
    , 
    array[]::INT[]
    ) as array_col
  );
[0m11:35:39.781812 [debug] [Thread-23 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:35:39.785141 [debug] [Thread-23 ]: Using vertica connection "model.test.expected"
[0m11:35:39.785487 [debug] [Thread-22 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m11:35:39.785866 [debug] [Thread-23 ]: On model.test.expected: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.expected"} */
alter view "VMart"."test16666977388190148198_test_array_concat"."expected" rename to "expected__dbt_backup"
[0m11:35:39.789092 [debug] [Thread-22 ]: Using vertica connection "model.test.actual"
[0m11:35:39.789762 [debug] [Thread-22 ]: On model.test.actual: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.actual"} */
alter view "VMart"."test16666977388190148198_test_array_concat"."actual" rename to "actual__dbt_backup"
[0m11:35:39.800693 [debug] [Thread-23 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:35:39.805069 [debug] [Thread-23 ]: Using vertica connection "model.test.expected"
[0m11:35:39.805503 [debug] [Thread-22 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m11:35:39.805994 [debug] [Thread-23 ]: On model.test.expected: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.expected"} */
alter view "VMart"."test16666977388190148198_test_array_concat"."expected__dbt_tmp" rename to "expected"
[0m11:35:39.812629 [debug] [Thread-22 ]: Using vertica connection "model.test.actual"
[0m11:35:39.813070 [debug] [Thread-22 ]: On model.test.actual: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.actual"} */
alter view "VMart"."test16666977388190148198_test_array_concat"."actual__dbt_tmp" rename to "actual"
[0m11:35:39.824068 [debug] [Thread-23 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:35:39.827175 [debug] [Thread-23 ]: On model.test.expected: COMMIT
[0m11:35:39.827610 [debug] [Thread-22 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:35:39.828085 [debug] [Thread-23 ]: Using vertica connection "model.test.expected"
[0m11:35:39.831068 [debug] [Thread-22 ]: On model.test.actual: COMMIT
[0m11:35:39.831591 [debug] [Thread-23 ]: On model.test.expected: COMMIT
[0m11:35:39.832125 [debug] [Thread-22 ]: Using vertica connection "model.test.actual"
[0m11:35:39.832993 [debug] [Thread-22 ]: On model.test.actual: COMMIT
[0m11:35:39.839980 [debug] [Thread-23 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:35:39.843746 [debug] [Thread-23 ]: Using vertica connection "model.test.expected"
[0m11:35:39.844271 [debug] [Thread-22 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:35:39.844749 [debug] [Thread-23 ]: On model.test.expected: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.expected"} */
drop view if exists "VMart"."test16666977388190148198_test_array_concat"."expected__dbt_backup" cascade
[0m11:35:39.848320 [debug] [Thread-22 ]: Using vertica connection "model.test.actual"
[0m11:35:39.849163 [debug] [Thread-22 ]: On model.test.actual: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.actual"} */
drop view if exists "VMart"."test16666977388190148198_test_array_concat"."actual__dbt_backup" cascade
[0m11:35:39.861349 [debug] [Thread-23 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:35:39.861896 [debug] [Thread-22 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:35:39.864287 [debug] [Thread-23 ]: finished collecting timing info
[0m11:35:39.866369 [debug] [Thread-22 ]: finished collecting timing info
[0m11:35:39.866973 [debug] [Thread-23 ]: On model.test.expected: Close
[0m11:35:39.867587 [debug] [Thread-22 ]: On model.test.actual: Close
[0m11:35:39.869115 [info ] [Thread-23 ]: 2 of 2 OK created sql view model test16666977388190148198_test_array_concat.expected  [[32mCode: None, Rows: -1, Array Size: 1[0m in 0.17s]
[0m11:35:39.870724 [info ] [Thread-22 ]: 1 of 2 OK created sql view model test16666977388190148198_test_array_concat.actual  [[32mCode: None, Rows: -1, Array Size: 1[0m in 0.17s]
[0m11:35:39.871596 [debug] [Thread-23 ]: Finished running node model.test.expected
[0m11:35:39.872579 [debug] [Thread-22 ]: Finished running node model.test.actual
[0m11:35:39.875069 [debug] [MainThread]: Acquiring new vertica connection "master"
[0m11:35:39.875532 [debug] [MainThread]: Using vertica connection "master"
[0m11:35:39.875844 [debug] [MainThread]: On master: BEGIN
[0m11:35:39.876125 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:35:39.893640 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:35:39.898999 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m11:35:39.899471 [debug] [MainThread]: On master: COMMIT
[0m11:35:39.899797 [debug] [MainThread]: Using vertica connection "master"
[0m11:35:39.900089 [debug] [MainThread]: On master: COMMIT
[0m11:35:39.905765 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:35:39.906333 [debug] [MainThread]: On master: Close
[0m11:35:39.907508 [info ] [MainThread]: 
[0m11:35:39.908155 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.39 seconds (0.39s).
[0m11:35:39.908696 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:35:39.908969 [debug] [MainThread]: Connection 'model.test.actual' was properly closed.
[0m11:35:39.909234 [debug] [MainThread]: Connection 'model.test.expected' was properly closed.
[0m11:35:39.919041 [info ] [MainThread]: 
[0m11:35:39.919591 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:35:39.920065 [info ] [MainThread]: 
[0m11:35:39.920425 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m11:35:39.920771 [debug] [MainThread]: Flushing usage events
[0m11:35:39.921413 [debug] [MainThread]: Acquiring new vertica connection "_test"
[0m11:35:39.926222 [debug] [MainThread]: Using vertica connection "_test"
[0m11:35:39.926381 [debug] [MainThread]: On _test: BEGIN
[0m11:35:39.926478 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:35:39.942379 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:35:39.948860 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m11:35:39.949422 [debug] [MainThread]: Using vertica connection "_test"
[0m11:35:39.949775 [debug] [MainThread]: On _test: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "_test"} */

    select
    column_name
    , data_type
    , character_maximum_length
    , numeric_precision
    , numeric_scale
    from (
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.columns
        where table_schema = 'test16666977388190148198_test_array_concat'
        and table_name = 'expected'
        union all
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.view_columns
        where table_schema = 'test16666977388190148198_test_array_concat'
        and table_name = 'expected'
    ) t
    order by ordinal_position
  
[0m11:35:39.987911 [debug] [MainThread]: SQL status: Code: [Column(name='column_name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='data_type', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='character_maximum_length', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_precision', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_scale', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.04 seconds
[0m11:35:39.995227 [debug] [MainThread]: Using vertica connection "_test"
[0m11:35:39.995685 [debug] [MainThread]: On _test: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "_test"} */
with diff_count as (
    SELECT
        1 as id,
        COUNT(*) as num_missing FROM (
            (SELECT "array_col", "id" FROM "VMart"."test16666977388190148198_test_array_concat"."expected" EXCEPT
             SELECT "array_col", "id" FROM "VMart"."test16666977388190148198_test_array_concat"."actual")
             UNION ALL
            (SELECT "array_col", "id" FROM "VMart"."test16666977388190148198_test_array_concat"."actual" EXCEPT
             SELECT "array_col", "id" FROM "VMart"."test16666977388190148198_test_array_concat"."expected")
        ) as a
), table_a as (
    SELECT COUNT(*) as num_rows FROM "VMart"."test16666977388190148198_test_array_concat"."expected"
), table_b as (
    SELECT COUNT(*) as num_rows FROM "VMart"."test16666977388190148198_test_array_concat"."actual"
), row_count_diff as (
    select
        1 as id,
        table_a.num_rows - table_b.num_rows as difference
    from table_a, table_b
)
select
    row_count_diff.difference as row_count_difference,
    diff_count.num_missing as num_mismatched
from row_count_diff
join diff_count using (id)
[0m11:35:40.058864 [debug] [MainThread]: SQL status: Code: [Column(name='row_count_difference', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='num_mismatched', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.06 seconds
[0m11:35:40.061417 [debug] [MainThread]: On _test: ROLLBACK
[0m11:35:40.068851 [debug] [MainThread]: On _test: Close
[0m11:35:40.071024 [debug] [MainThread]: Acquiring new vertica connection "_test"
[0m11:35:40.074703 [debug] [MainThread]: Using vertica connection "_test"
[0m11:35:40.075137 [debug] [MainThread]: On _test: BEGIN
[0m11:35:40.075507 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:35:40.093207 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:35:40.098938 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m11:35:40.099422 [debug] [MainThread]: Using vertica connection "_test"
[0m11:35:40.099719 [debug] [MainThread]: On _test: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "_test"} */

    select
    column_name
    , data_type
    , character_maximum_length
    , numeric_precision
    , numeric_scale
    from (
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.columns
        where table_schema = 'test16666977388190148198_test_array_concat'
        and table_name = 'expected'
        union all
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.view_columns
        where table_schema = 'test16666977388190148198_test_array_concat'
        and table_name = 'expected'
    ) t
    order by ordinal_position
  
[0m11:35:40.138911 [debug] [MainThread]: SQL status: Code: [Column(name='column_name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='data_type', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='character_maximum_length', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_precision', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_scale', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.04 seconds
[0m11:35:40.142058 [debug] [MainThread]: On _test: ROLLBACK
[0m11:35:40.148783 [debug] [MainThread]: On _test: Close
[0m11:35:40.150752 [debug] [MainThread]: Acquiring new vertica connection "_test"
[0m11:35:40.154309 [debug] [MainThread]: Using vertica connection "_test"
[0m11:35:40.154755 [debug] [MainThread]: On _test: BEGIN
[0m11:35:40.155116 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:35:40.171053 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:35:40.176428 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m11:35:40.177170 [debug] [MainThread]: Using vertica connection "_test"
[0m11:35:40.177552 [debug] [MainThread]: On _test: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "_test"} */

    select
    column_name
    , data_type
    , character_maximum_length
    , numeric_precision
    , numeric_scale
    from (
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.columns
        where table_schema = 'test16666977388190148198_test_array_concat'
        and table_name = 'actual'
        union all
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.view_columns
        where table_schema = 'test16666977388190148198_test_array_concat'
        and table_name = 'actual'
    ) t
    order by ordinal_position
  
[0m11:35:40.208930 [debug] [MainThread]: SQL status: Code: [Column(name='column_name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='data_type', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='character_maximum_length', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_precision', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_scale', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.03 seconds
[0m11:35:40.212028 [debug] [MainThread]: On _test: ROLLBACK
[0m11:35:40.217465 [debug] [MainThread]: On _test: Close
[0m11:35:40.220517 [debug] [MainThread]: Acquiring new vertica connection "_test"
[0m11:35:40.221209 [debug] [MainThread]: Dropping schema "_ReferenceKey(database='vmart', schema='test16666977388190148198_test_array_concat', identifier=None)".
[0m11:35:40.227860 [debug] [MainThread]: Using vertica connection "_test"
[0m11:35:40.228347 [debug] [MainThread]: On _test: BEGIN
[0m11:35:40.228680 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:35:40.248333 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:35:40.254879 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.03 seconds
[0m11:35:40.255092 [debug] [MainThread]: Using vertica connection "_test"
[0m11:35:40.255204 [debug] [MainThread]: On _test: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "_test"} */
drop schema if exists "test16666977388190148198_test_array_concat" cascade
  
[0m11:35:40.273161 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m11:35:40.274855 [debug] [MainThread]: On _test: COMMIT
[0m11:35:40.275267 [debug] [MainThread]: Using vertica connection "_test"
[0m11:35:40.275586 [debug] [MainThread]: On _test: COMMIT
[0m11:35:40.284691 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:35:40.285388 [debug] [MainThread]: On _test: Close
[0m11:35:40.287277 [debug] [MainThread]: Connection '_test' was properly closed.
[0m11:35:40.308828 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
[0m11:35:40.309870 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m11:35:40.310114 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m11:35:40.310309 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m11:35:40.317420 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m11:35:40.318869 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m11:35:40.319828 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m11:35:40.323974 [debug] [MainThread]: Parsing macros/materializations/models/incremental/helpers.sql
[0m11:35:40.326457 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m11:35:40.331671 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m11:35:40.333336 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m11:35:40.339098 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m11:35:40.341071 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m11:35:40.350012 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m11:35:40.351345 [debug] [MainThread]: Parsing macros/materializations/snapshots/helper.sql
[0m11:35:40.351599 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m11:35:40.364920 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m11:35:40.368621 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m11:35:40.369205 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m11:35:40.369680 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m11:35:40.371737 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m11:35:40.373377 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m11:35:40.377448 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m11:35:40.378366 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m11:35:40.380284 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m11:35:40.381753 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m11:35:40.384173 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m11:35:40.385011 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m11:35:40.388261 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m11:35:40.389765 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m11:35:40.391838 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m11:35:40.401059 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m11:35:40.405888 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m11:35:40.406876 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m11:35:40.413156 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m11:35:40.417207 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m11:35:40.427269 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m11:35:40.429418 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m11:35:40.432764 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m11:35:40.440922 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m11:35:40.442019 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m11:35:40.449366 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m11:35:40.458912 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m11:35:40.460073 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m11:35:40.461210 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m11:35:40.463945 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m11:35:40.474805 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m11:35:40.478989 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m11:35:40.479999 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m11:35:40.480978 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m11:35:40.482485 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m11:35:40.483756 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m11:35:40.485512 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m11:35:40.491431 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m11:35:40.500091 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m11:35:40.504365 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m11:35:40.512435 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m11:35:40.513885 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m11:35:40.515997 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m11:35:40.518582 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m11:35:40.522204 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m11:35:40.523037 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m11:35:40.523770 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m11:35:40.524405 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m11:35:40.525208 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m11:35:40.526156 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m11:35:40.526817 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m11:35:40.527448 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m11:35:40.528135 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m11:35:40.529514 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m11:35:40.530104 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m11:35:40.530926 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m11:35:40.531692 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m11:35:40.535663 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m11:35:40.536291 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m11:35:40.537128 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m11:35:40.537821 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m11:35:40.538613 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m11:35:40.539330 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m11:35:40.540744 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m11:35:40.541379 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m11:35:40.541934 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m11:35:40.542642 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m11:35:40.543406 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m11:35:40.544590 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m11:35:40.545501 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m11:35:40.546123 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m11:35:40.546651 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m11:35:40.547376 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m11:35:40.550566 [debug] [MainThread]: Parsing macros/etc/datetime.sql
