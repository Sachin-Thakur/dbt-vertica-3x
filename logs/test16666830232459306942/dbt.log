[0m07:30:22.924685 [debug] [MainThread]: Acquiring new vertica connection "_test"
[0m07:30:22.924866 [debug] [MainThread]: Acquiring new vertica connection "_test"
[0m07:30:22.925033 [debug] [MainThread]: Creating schema "_ReferenceKey(database='vmart', schema='test16666830232459306942_test_array_construct', identifier=None)"
[0m07:30:22.931510 [debug] [MainThread]: Using vertica connection "_test"
[0m07:30:22.931726 [debug] [MainThread]: On _test: BEGIN
[0m07:30:22.931838 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:30:22.952502 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m07:30:22.958987 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.03 seconds
[0m07:30:22.959264 [debug] [MainThread]: Using vertica connection "_test"
[0m07:30:22.959428 [debug] [MainThread]: On _test: create schema if not exists "test16666830232459306942_test_array_construct"
  
[0m07:30:22.973507 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m07:30:22.975449 [debug] [MainThread]: On _test: COMMIT
[0m07:30:22.975885 [debug] [MainThread]: Using vertica connection "_test"
[0m07:30:22.976242 [debug] [MainThread]: On _test: COMMIT
[0m07:30:22.982711 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m07:30:22.983319 [debug] [MainThread]: On _test: Close
[0m07:30:22.997698 [debug] [MainThread]: Connection '_test' was properly closed.


============================== 2022-10-25 07:30:23.003166 | bd20052f-34a1-474b-8462-9bcc7d20c1ed ==============================
[0m07:30:23.003174 [info ] [MainThread]: Running with dbt=1.3.0
[0m07:30:23.003453 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/tmp/pytest-of-sachin/pytest-8/profile0', 'send_anonymous_usage_stats': False, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
[0m07:30:23.003557 [debug] [MainThread]: Tracking: do not track
[0m07:30:23.009203 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
[0m07:30:23.017371 [debug] [MainThread]: Parsing macros/test_assert_equal.sql
[0m07:30:23.017958 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m07:30:23.018137 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m07:30:23.018277 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m07:30:23.022523 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m07:30:23.023377 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m07:30:23.023954 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m07:30:23.026441 [debug] [MainThread]: Parsing macros/materializations/models/incremental/helpers.sql
[0m07:30:23.028151 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m07:30:23.032258 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m07:30:23.033171 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m07:30:23.036909 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m07:30:23.038238 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m07:30:23.045184 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m07:30:23.046199 [debug] [MainThread]: Parsing macros/materializations/snapshots/helper.sql
[0m07:30:23.046350 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m07:30:23.051628 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m07:30:23.055249 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m07:30:23.055804 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m07:30:23.056276 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m07:30:23.058192 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m07:30:23.059790 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m07:30:23.063803 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m07:30:23.064675 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m07:30:23.065381 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m07:30:23.066750 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m07:30:23.069030 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m07:30:23.069889 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m07:30:23.073094 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m07:30:23.074461 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m07:30:23.076453 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m07:30:23.085455 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m07:30:23.090267 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m07:30:23.091225 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m07:30:23.097319 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m07:30:23.101360 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m07:30:23.111344 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m07:30:23.113454 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m07:30:23.116749 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m07:30:23.124392 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m07:30:23.125407 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m07:30:23.132426 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m07:30:23.141856 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m07:30:23.142986 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m07:30:23.144097 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m07:30:23.146757 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m07:30:23.157476 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m07:30:23.161588 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m07:30:23.162505 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m07:30:23.163687 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m07:30:23.165708 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m07:30:23.167837 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m07:30:23.170676 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m07:30:23.179110 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m07:30:23.189293 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m07:30:23.193784 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m07:30:23.202563 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m07:30:23.204129 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m07:30:23.206769 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m07:30:23.209609 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m07:30:23.213403 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m07:30:23.214296 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m07:30:23.215054 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m07:30:23.215665 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m07:30:23.216463 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m07:30:23.217476 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m07:30:23.218142 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m07:30:23.218778 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m07:30:23.219420 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m07:30:23.220637 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m07:30:23.221157 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m07:30:23.221911 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m07:30:23.222578 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m07:30:23.226848 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m07:30:23.227682 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m07:30:23.228566 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m07:30:23.229273 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m07:30:23.230106 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m07:30:23.230844 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m07:30:23.232357 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m07:30:23.232978 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m07:30:23.233514 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m07:30:23.234194 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m07:30:23.234969 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m07:30:23.236054 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m07:30:23.236908 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m07:30:23.237474 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m07:30:23.237905 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m07:30:23.238537 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m07:30:23.241995 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m07:30:23.247391 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m07:30:23.408530 [debug] [MainThread]: 1603: static parser failed on actual.sql
[0m07:30:23.419887 [debug] [MainThread]: 1602: parser fallback to jinja rendering on actual.sql
[0m07:30:23.420858 [debug] [MainThread]: 1603: static parser failed on expected.sql
[0m07:30:23.423665 [debug] [MainThread]: 1602: parser fallback to jinja rendering on expected.sql
[0m07:30:23.450657 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 297 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m07:30:23.451531 [info ] [MainThread]: 
[0m07:30:23.452007 [debug] [MainThread]: Acquiring new vertica connection "master"
[0m07:30:23.452712 [debug] [ThreadPool]: Acquiring new vertica connection "list_VMart"
[0m07:30:23.456130 [debug] [ThreadPool]: Using vertica connection "list_VMart"
[0m07:30:23.456305 [debug] [ThreadPool]: On list_VMart: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "list_VMart"} */

    select schema_name
    from v_catalog.schemata
  
[0m07:30:23.456412 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:30:23.474661 [debug] [ThreadPool]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m07:30:23.494168 [debug] [ThreadPool]: SQL status: Code: [Column(name='schema_name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.04 seconds
[0m07:30:23.496966 [debug] [ThreadPool]: On list_VMart: Close
[0m07:30:23.499989 [debug] [ThreadPool]: Acquiring new vertica connection "list_VMart_test16666830232459306942_test_array_construct"
[0m07:30:23.512144 [debug] [ThreadPool]: Using vertica connection "list_VMart_test16666830232459306942_test_array_construct"
[0m07:30:23.512608 [debug] [ThreadPool]: On list_VMart_test16666830232459306942_test_array_construct: BEGIN
[0m07:30:23.512956 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:30:23.528073 [debug] [ThreadPool]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m07:30:23.534900 [debug] [ThreadPool]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m07:30:23.535471 [debug] [ThreadPool]: Using vertica connection "list_VMart_test16666830232459306942_test_array_construct"
[0m07:30:23.535846 [debug] [ThreadPool]: On list_VMart_test16666830232459306942_test_array_construct: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "list_VMart_test16666830232459306942_test_array_construct"} */
select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'table' as type
    from v_catalog.tables
    where table_schema ilike 'test16666830232459306942_test_array_construct'
    union all
    select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'view' as type
    from v_catalog.views
    where table_schema ilike 'test16666830232459306942_test_array_construct'
  
[0m07:30:23.554921 [debug] [ThreadPool]: SQL status: Code: [Column(name='database', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='schema', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='type', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.02 seconds
[0m07:30:23.557328 [debug] [ThreadPool]: On list_VMart_test16666830232459306942_test_array_construct: ROLLBACK
[0m07:30:23.562741 [debug] [ThreadPool]: On list_VMart_test16666830232459306942_test_array_construct: Close
[0m07:30:23.564544 [debug] [MainThread]: Using vertica connection "master"
[0m07:30:23.565020 [debug] [MainThread]: On master: BEGIN
[0m07:30:23.565368 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:30:23.585969 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m07:30:23.593663 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.03 seconds
[0m07:30:23.593848 [debug] [MainThread]: On master: COMMIT
[0m07:30:23.593965 [debug] [MainThread]: Using vertica connection "master"
[0m07:30:23.594066 [debug] [MainThread]: On master: COMMIT
[0m07:30:23.598622 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.0 seconds
[0m07:30:23.598815 [debug] [MainThread]: On master: Close
[0m07:30:23.599265 [info ] [MainThread]: Concurrency: 4 threads (target='default')
[0m07:30:23.599502 [info ] [MainThread]: 
[0m07:30:23.601938 [debug] [Thread-1 (]: Began running node model.test.actual
[0m07:30:23.602077 [debug] [Thread-2 (]: Began running node model.test.expected
[0m07:30:23.602339 [info ] [Thread-1 (]: 1 of 2 START sql view model test16666830232459306942_test_array_construct.actual  [RUN]
[0m07:30:23.602565 [info ] [Thread-2 (]: 2 of 2 START sql view model test16666830232459306942_test_array_construct.expected  [RUN]
[0m07:30:23.603162 [debug] [Thread-1 (]: Acquiring new vertica connection "model.test.actual"
[0m07:30:23.603651 [debug] [Thread-2 (]: Acquiring new vertica connection "model.test.expected"
[0m07:30:23.603825 [debug] [Thread-1 (]: Began compiling node model.test.actual
[0m07:30:23.603967 [debug] [Thread-2 (]: Began compiling node model.test.expected
[0m07:30:23.604108 [debug] [Thread-1 (]: Compiling model.test.actual
[0m07:30:23.604238 [debug] [Thread-2 (]: Compiling model.test.expected
[0m07:30:23.607694 [debug] [Thread-1 (]: Writing injected SQL for node "model.test.actual"
[0m07:30:23.610235 [debug] [Thread-2 (]: Writing injected SQL for node "model.test.expected"
[0m07:30:23.610794 [debug] [Thread-2 (]: finished collecting timing info
[0m07:30:23.610905 [debug] [Thread-1 (]: finished collecting timing info
[0m07:30:23.611062 [debug] [Thread-2 (]: Began executing node model.test.expected
[0m07:30:23.611217 [debug] [Thread-1 (]: Began executing node model.test.actual
[0m07:30:23.636543 [debug] [Thread-1 (]: Writing runtime sql for node "model.test.actual"
[0m07:30:23.637279 [debug] [Thread-2 (]: Writing runtime sql for node "model.test.expected"
[0m07:30:23.637839 [debug] [Thread-1 (]: Using vertica connection "model.test.actual"
[0m07:30:23.637969 [debug] [Thread-2 (]: Using vertica connection "model.test.expected"
[0m07:30:23.638116 [debug] [Thread-1 (]: On model.test.actual: BEGIN
[0m07:30:23.638248 [debug] [Thread-2 (]: On model.test.expected: BEGIN
[0m07:30:23.638377 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:30:23.638502 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m07:30:23.653925 [debug] [Thread-2 (]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m07:30:23.654145 [debug] [Thread-1 (]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m07:30:23.659863 [debug] [Thread-1 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m07:30:23.660061 [debug] [Thread-2 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m07:30:23.660301 [debug] [Thread-1 (]: Using vertica connection "model.test.actual"
[0m07:30:23.660502 [debug] [Thread-2 (]: Using vertica connection "model.test.expected"
[0m07:30:23.660662 [debug] [Thread-1 (]: On model.test.actual: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.actual"} */

  create view "VMart"."test16666830232459306942_test_array_construct"."actual__dbt_tmp" as (
    select 1 as id, 
    array[ 1 , 2 , 3 ]
     as array_col union all
select 2 as id, 
    array[]::INT[]
     as array_col
  );
[0m07:30:23.660858 [debug] [Thread-2 (]: On model.test.expected: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.expected"} */

  create view "VMart"."test16666830232459306942_test_array_construct"."expected__dbt_tmp" as (
    select 1 as id, 
    array[ 1 , 2 , 3 ]
     as array_col union all
select 2 as id, 
    array[]::INT[]
     as array_col
  );
[0m07:30:23.669963 [debug] [Thread-1 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m07:30:23.674225 [debug] [Thread-1 (]: Using vertica connection "model.test.actual"
[0m07:30:23.674407 [debug] [Thread-1 (]: On model.test.actual: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.actual"} */
alter view "VMart"."test16666830232459306942_test_array_construct"."actual__dbt_tmp" rename to "actual"
[0m07:30:23.674540 [debug] [Thread-2 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m07:30:23.677207 [debug] [Thread-2 (]: Using vertica connection "model.test.expected"
[0m07:30:23.677374 [debug] [Thread-2 (]: On model.test.expected: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.expected"} */
alter view "VMart"."test16666830232459306942_test_array_construct"."expected__dbt_tmp" rename to "expected"
[0m07:30:23.684509 [debug] [Thread-1 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m07:30:23.692262 [debug] [Thread-2 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m07:30:23.696081 [debug] [Thread-1 (]: On model.test.actual: COMMIT
[0m07:30:23.697263 [debug] [Thread-2 (]: On model.test.expected: COMMIT
[0m07:30:23.697604 [debug] [Thread-1 (]: Using vertica connection "model.test.actual"
[0m07:30:23.697776 [debug] [Thread-2 (]: Using vertica connection "model.test.expected"
[0m07:30:23.697922 [debug] [Thread-1 (]: On model.test.actual: COMMIT
[0m07:30:23.698056 [debug] [Thread-2 (]: On model.test.expected: COMMIT
[0m07:30:23.702294 [debug] [Thread-1 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.0 seconds
[0m07:30:23.705987 [debug] [Thread-1 (]: Using vertica connection "model.test.actual"
[0m07:30:23.706211 [debug] [Thread-1 (]: On model.test.actual: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.actual"} */
drop view if exists "VMart"."test16666830232459306942_test_array_construct"."actual__dbt_backup" cascade
[0m07:30:23.706578 [debug] [Thread-2 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m07:30:23.707973 [debug] [Thread-2 (]: Using vertica connection "model.test.expected"
[0m07:30:23.708129 [debug] [Thread-2 (]: On model.test.expected: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.expected"} */
drop view if exists "VMart"."test16666830232459306942_test_array_construct"."expected__dbt_backup" cascade
[0m07:30:23.713982 [debug] [Thread-1 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m07:30:23.714966 [debug] [Thread-1 (]: finished collecting timing info
[0m07:30:23.715169 [debug] [Thread-1 (]: On model.test.actual: Close
[0m07:30:23.715764 [info ] [Thread-1 (]: 1 of 2 OK created sql view model test16666830232459306942_test_array_construct.actual  [[32mCode: None, Rows: -1, Array Size: 1[0m in 0.11s]
[0m07:30:23.716151 [debug] [Thread-1 (]: Finished running node model.test.actual
[0m07:30:23.716292 [debug] [Thread-2 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m07:30:23.717265 [debug] [Thread-2 (]: finished collecting timing info
[0m07:30:23.717495 [debug] [Thread-2 (]: On model.test.expected: Close
[0m07:30:23.718132 [info ] [Thread-2 (]: 2 of 2 OK created sql view model test16666830232459306942_test_array_construct.expected  [[32mCode: None, Rows: -1, Array Size: 1[0m in 0.11s]
[0m07:30:23.718473 [debug] [Thread-2 (]: Finished running node model.test.expected
[0m07:30:23.719429 [debug] [MainThread]: Acquiring new vertica connection "master"
[0m07:30:23.719607 [debug] [MainThread]: Using vertica connection "master"
[0m07:30:23.719716 [debug] [MainThread]: On master: BEGIN
[0m07:30:23.719823 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:30:23.737320 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m07:30:23.741884 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m07:30:23.742117 [debug] [MainThread]: On master: COMMIT
[0m07:30:23.742257 [debug] [MainThread]: Using vertica connection "master"
[0m07:30:23.742361 [debug] [MainThread]: On master: COMMIT
[0m07:30:23.746379 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.0 seconds
[0m07:30:23.746625 [debug] [MainThread]: On master: Close
[0m07:30:23.747116 [info ] [MainThread]: 
[0m07:30:23.747368 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.30 seconds (0.30s).
[0m07:30:23.747553 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:30:23.747650 [debug] [MainThread]: Connection 'model.test.actual' was properly closed.
[0m07:30:23.747751 [debug] [MainThread]: Connection 'model.test.expected' was properly closed.
[0m07:30:23.751825 [info ] [MainThread]: 
[0m07:30:23.752120 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:30:23.752369 [info ] [MainThread]: 
[0m07:30:23.752667 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m07:30:23.752974 [debug] [MainThread]: Flushing usage events


============================== 2022-10-25 07:30:23.770565 | bd20052f-34a1-474b-8462-9bcc7d20c1ed ==============================
[0m07:30:23.770579 [info ] [MainThread]: Running with dbt=1.3.0
[0m07:30:23.771036 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/tmp/pytest-of-sachin/pytest-8/profile0', 'send_anonymous_usage_stats': False, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
[0m07:30:23.771212 [debug] [MainThread]: Tracking: do not track
[0m07:30:23.854443 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:30:23.854740 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:30:23.862925 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 297 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m07:30:23.863620 [info ] [MainThread]: 
[0m07:30:23.864115 [debug] [MainThread]: Acquiring new vertica connection "master"
[0m07:30:23.864732 [debug] [ThreadPool]: Acquiring new vertica connection "list_VMart"
[0m07:30:23.866690 [debug] [ThreadPool]: Using vertica connection "list_VMart"
[0m07:30:23.866889 [debug] [ThreadPool]: On list_VMart: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "list_VMart"} */

    select schema_name
    from v_catalog.schemata
  
[0m07:30:23.867040 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:30:23.881786 [debug] [ThreadPool]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m07:30:23.895204 [debug] [ThreadPool]: SQL status: Code: [Column(name='schema_name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.03 seconds
[0m07:30:23.896339 [debug] [ThreadPool]: On list_VMart: Close
[0m07:30:23.897605 [debug] [ThreadPool]: Acquiring new vertica connection "list_VMart_test16666830232459306942_test_array_construct"
[0m07:30:23.899026 [debug] [ThreadPool]: Using vertica connection "list_VMart_test16666830232459306942_test_array_construct"
[0m07:30:23.899180 [debug] [ThreadPool]: On list_VMart_test16666830232459306942_test_array_construct: BEGIN
[0m07:30:23.899308 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:30:23.913839 [debug] [ThreadPool]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m07:30:23.919193 [debug] [ThreadPool]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m07:30:23.919584 [debug] [ThreadPool]: Using vertica connection "list_VMart_test16666830232459306942_test_array_construct"
[0m07:30:23.919741 [debug] [ThreadPool]: On list_VMart_test16666830232459306942_test_array_construct: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "list_VMart_test16666830232459306942_test_array_construct"} */
select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'table' as type
    from v_catalog.tables
    where table_schema ilike 'test16666830232459306942_test_array_construct'
    union all
    select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'view' as type
    from v_catalog.views
    where table_schema ilike 'test16666830232459306942_test_array_construct'
  
[0m07:30:23.934936 [debug] [ThreadPool]: SQL status: Code: [Column(name='database', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='schema', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='type', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.02 seconds
[0m07:30:23.936048 [debug] [ThreadPool]: On list_VMart_test16666830232459306942_test_array_construct: ROLLBACK
[0m07:30:23.941607 [debug] [ThreadPool]: On list_VMart_test16666830232459306942_test_array_construct: Close
[0m07:30:23.942472 [debug] [MainThread]: Using vertica connection "master"
[0m07:30:23.942709 [debug] [MainThread]: On master: BEGIN
[0m07:30:23.942856 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:30:23.964714 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m07:30:23.971747 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.03 seconds
[0m07:30:23.972126 [debug] [MainThread]: On master: COMMIT
[0m07:30:23.972316 [debug] [MainThread]: Using vertica connection "master"
[0m07:30:23.972486 [debug] [MainThread]: On master: COMMIT
[0m07:30:23.977175 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.0 seconds
[0m07:30:23.977565 [debug] [MainThread]: On master: Close
[0m07:30:23.978254 [info ] [MainThread]: Concurrency: 4 threads (target='default')
[0m07:30:23.978706 [info ] [MainThread]: 
[0m07:30:23.980160 [debug] [Thread-8 (]: Began running node model.test.actual
[0m07:30:23.980378 [debug] [Thread-9 (]: Began running node model.test.expected
[0m07:30:23.980778 [info ] [Thread-8 (]: 1 of 2 START sql view model test16666830232459306942_test_array_construct.actual  [RUN]
[0m07:30:23.981121 [info ] [Thread-9 (]: 2 of 2 START sql view model test16666830232459306942_test_array_construct.expected  [RUN]
[0m07:30:23.981902 [debug] [Thread-8 (]: Acquiring new vertica connection "model.test.actual"
[0m07:30:23.982643 [debug] [Thread-9 (]: Acquiring new vertica connection "model.test.expected"
[0m07:30:23.982877 [debug] [Thread-8 (]: Began compiling node model.test.actual
[0m07:30:23.983096 [debug] [Thread-9 (]: Began compiling node model.test.expected
[0m07:30:23.983317 [debug] [Thread-8 (]: Compiling model.test.actual
[0m07:30:23.983536 [debug] [Thread-9 (]: Compiling model.test.expected
[0m07:30:23.987763 [debug] [Thread-8 (]: Writing injected SQL for node "model.test.actual"
[0m07:30:23.991652 [debug] [Thread-9 (]: Writing injected SQL for node "model.test.expected"
[0m07:30:23.992307 [debug] [Thread-8 (]: finished collecting timing info
[0m07:30:23.992515 [debug] [Thread-9 (]: finished collecting timing info
[0m07:30:23.992770 [debug] [Thread-8 (]: Began executing node model.test.actual
[0m07:30:23.993002 [debug] [Thread-9 (]: Began executing node model.test.expected
[0m07:30:23.997387 [debug] [Thread-8 (]: Writing runtime sql for node "model.test.actual"
[0m07:30:24.001490 [debug] [Thread-9 (]: Writing runtime sql for node "model.test.expected"
[0m07:30:24.002201 [debug] [Thread-8 (]: Using vertica connection "model.test.actual"
[0m07:30:24.002468 [debug] [Thread-9 (]: Using vertica connection "model.test.expected"
[0m07:30:24.002683 [debug] [Thread-8 (]: On model.test.actual: BEGIN
[0m07:30:24.002913 [debug] [Thread-9 (]: On model.test.expected: BEGIN
[0m07:30:24.003119 [debug] [Thread-8 (]: Opening a new connection, currently in state closed
[0m07:30:24.003337 [debug] [Thread-9 (]: Opening a new connection, currently in state init
[0m07:30:24.023081 [debug] [Thread-8 (]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m07:30:24.023455 [debug] [Thread-9 (]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m07:30:24.028712 [debug] [Thread-8 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.03 seconds
[0m07:30:24.028982 [debug] [Thread-9 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.03 seconds
[0m07:30:24.029272 [debug] [Thread-8 (]: Using vertica connection "model.test.actual"
[0m07:30:24.029510 [debug] [Thread-9 (]: Using vertica connection "model.test.expected"
[0m07:30:24.029756 [debug] [Thread-8 (]: On model.test.actual: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.actual"} */

  create view "VMart"."test16666830232459306942_test_array_construct"."actual__dbt_tmp" as (
    select 1 as id, 
    array[ 1 , 2 , 3 ]
     as array_col union all
select 2 as id, 
    array[]::INT[]
     as array_col
  );
[0m07:30:24.029973 [debug] [Thread-9 (]: On model.test.expected: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.expected"} */

  create view "VMart"."test16666830232459306942_test_array_construct"."expected__dbt_tmp" as (
    select 1 as id, 
    array[ 1 , 2 , 3 ]
     as array_col union all
select 2 as id, 
    array[]::INT[]
     as array_col
  );
[0m07:30:24.041867 [debug] [Thread-9 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m07:30:24.044718 [debug] [Thread-9 (]: Using vertica connection "model.test.expected"
[0m07:30:24.044947 [debug] [Thread-9 (]: On model.test.expected: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.expected"} */
alter view "VMart"."test16666830232459306942_test_array_construct"."expected" rename to "expected__dbt_backup"
[0m07:30:24.045156 [debug] [Thread-8 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m07:30:24.047113 [debug] [Thread-8 (]: Using vertica connection "model.test.actual"
[0m07:30:24.047298 [debug] [Thread-8 (]: On model.test.actual: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.actual"} */
alter view "VMart"."test16666830232459306942_test_array_construct"."actual" rename to "actual__dbt_backup"
[0m07:30:24.057585 [debug] [Thread-9 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m07:30:24.060317 [debug] [Thread-9 (]: Using vertica connection "model.test.expected"
[0m07:30:24.060523 [debug] [Thread-9 (]: On model.test.expected: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.expected"} */
alter view "VMart"."test16666830232459306942_test_array_construct"."expected__dbt_tmp" rename to "expected"
[0m07:30:24.060775 [debug] [Thread-8 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m07:30:24.062496 [debug] [Thread-8 (]: Using vertica connection "model.test.actual"
[0m07:30:24.062668 [debug] [Thread-8 (]: On model.test.actual: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.actual"} */
alter view "VMart"."test16666830232459306942_test_array_construct"."actual__dbt_tmp" rename to "actual"
[0m07:30:24.069598 [debug] [Thread-9 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m07:30:24.073285 [debug] [Thread-9 (]: On model.test.expected: COMMIT
[0m07:30:24.073555 [debug] [Thread-9 (]: Using vertica connection "model.test.expected"
[0m07:30:24.073717 [debug] [Thread-9 (]: On model.test.expected: COMMIT
[0m07:30:24.075193 [debug] [Thread-8 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m07:30:24.076403 [debug] [Thread-8 (]: On model.test.actual: COMMIT
[0m07:30:24.076559 [debug] [Thread-8 (]: Using vertica connection "model.test.actual"
[0m07:30:24.076669 [debug] [Thread-8 (]: On model.test.actual: COMMIT
[0m07:30:24.080657 [debug] [Thread-9 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m07:30:24.083342 [debug] [Thread-9 (]: Using vertica connection "model.test.expected"
[0m07:30:24.083638 [debug] [Thread-9 (]: On model.test.expected: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.expected"} */
drop view if exists "VMart"."test16666830232459306942_test_array_construct"."expected__dbt_backup" cascade
[0m07:30:24.084057 [debug] [Thread-8 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m07:30:24.086120 [debug] [Thread-8 (]: Using vertica connection "model.test.actual"
[0m07:30:24.086369 [debug] [Thread-8 (]: On model.test.actual: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.actual"} */
drop view if exists "VMart"."test16666830232459306942_test_array_construct"."actual__dbt_backup" cascade
[0m07:30:24.093697 [debug] [Thread-9 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m07:30:24.094753 [debug] [Thread-9 (]: finished collecting timing info
[0m07:30:24.094959 [debug] [Thread-9 (]: On model.test.expected: Close
[0m07:30:24.095506 [info ] [Thread-9 (]: 2 of 2 OK created sql view model test16666830232459306942_test_array_construct.expected  [[32mCode: None, Rows: -1, Array Size: 1[0m in 0.11s]
[0m07:30:24.095875 [debug] [Thread-9 (]: Finished running node model.test.expected
[0m07:30:24.096929 [debug] [Thread-8 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m07:30:24.097808 [debug] [Thread-8 (]: finished collecting timing info
[0m07:30:24.097989 [debug] [Thread-8 (]: On model.test.actual: Close
[0m07:30:24.098802 [info ] [Thread-8 (]: 1 of 2 OK created sql view model test16666830232459306942_test_array_construct.actual  [[32mCode: None, Rows: -1, Array Size: 1[0m in 0.12s]
[0m07:30:24.099389 [debug] [Thread-8 (]: Finished running node model.test.actual
[0m07:30:24.100506 [debug] [MainThread]: Acquiring new vertica connection "master"
[0m07:30:24.100732 [debug] [MainThread]: Using vertica connection "master"
[0m07:30:24.100850 [debug] [MainThread]: On master: BEGIN
[0m07:30:24.100950 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:30:24.122576 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m07:30:24.128429 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.03 seconds
[0m07:30:24.128703 [debug] [MainThread]: On master: COMMIT
[0m07:30:24.128838 [debug] [MainThread]: Using vertica connection "master"
[0m07:30:24.128964 [debug] [MainThread]: On master: COMMIT
[0m07:30:24.133865 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.0 seconds
[0m07:30:24.134121 [debug] [MainThread]: On master: Close
[0m07:30:24.134627 [info ] [MainThread]: 
[0m07:30:24.134891 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.27 seconds (0.27s).
[0m07:30:24.135087 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:30:24.135186 [debug] [MainThread]: Connection 'model.test.actual' was properly closed.
[0m07:30:24.135281 [debug] [MainThread]: Connection 'model.test.expected' was properly closed.
[0m07:30:24.139456 [info ] [MainThread]: 
[0m07:30:24.139752 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:30:24.139970 [info ] [MainThread]: 
[0m07:30:24.140149 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m07:30:24.140384 [debug] [MainThread]: Flushing usage events
[0m07:30:24.140849 [debug] [MainThread]: Acquiring new vertica connection "_test"
[0m07:30:24.144990 [debug] [MainThread]: Using vertica connection "_test"
[0m07:30:24.145209 [debug] [MainThread]: On _test: BEGIN
[0m07:30:24.145325 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:30:24.163431 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m07:30:24.169562 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m07:30:24.169933 [debug] [MainThread]: Using vertica connection "_test"
[0m07:30:24.170148 [debug] [MainThread]: On _test: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "_test"} */

    select
    column_name
    , data_type
    , character_maximum_length
    , numeric_precision
    , numeric_scale
    from (
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.columns
        where table_schema = 'test16666830232459306942_test_array_construct'
        and table_name = 'expected'
        union all
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.view_columns
        where table_schema = 'test16666830232459306942_test_array_construct'
        and table_name = 'expected'
    ) t
    order by ordinal_position
  
[0m07:30:24.201080 [debug] [MainThread]: SQL status: Code: [Column(name='column_name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='data_type', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='character_maximum_length', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_precision', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_scale', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.03 seconds
[0m07:30:24.204735 [debug] [MainThread]: Using vertica connection "_test"
[0m07:30:24.204977 [debug] [MainThread]: On _test: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "_test"} */
with diff_count as (
    SELECT
        1 as id,
        COUNT(*) as num_missing FROM (
            (SELECT "array_col", "id" FROM "VMart"."test16666830232459306942_test_array_construct"."expected" EXCEPT
             SELECT "array_col", "id" FROM "VMart"."test16666830232459306942_test_array_construct"."actual")
             UNION ALL
            (SELECT "array_col", "id" FROM "VMart"."test16666830232459306942_test_array_construct"."actual" EXCEPT
             SELECT "array_col", "id" FROM "VMart"."test16666830232459306942_test_array_construct"."expected")
        ) as a
), table_a as (
    SELECT COUNT(*) as num_rows FROM "VMart"."test16666830232459306942_test_array_construct"."expected"
), table_b as (
    SELECT COUNT(*) as num_rows FROM "VMart"."test16666830232459306942_test_array_construct"."actual"
), row_count_diff as (
    select
        1 as id,
        table_a.num_rows - table_b.num_rows as difference
    from table_a, table_b
)
select
    row_count_diff.difference as row_count_difference,
    diff_count.num_missing as num_mismatched
from row_count_diff
join diff_count using (id)
[0m07:30:24.253369 [debug] [MainThread]: SQL status: Code: [Column(name='row_count_difference', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='num_mismatched', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.05 seconds
[0m07:30:24.254325 [debug] [MainThread]: On _test: ROLLBACK
[0m07:30:24.260905 [debug] [MainThread]: On _test: Close
[0m07:30:24.261885 [debug] [MainThread]: Acquiring new vertica connection "_test"
[0m07:30:24.263374 [debug] [MainThread]: Using vertica connection "_test"
[0m07:30:24.263550 [debug] [MainThread]: On _test: BEGIN
[0m07:30:24.263662 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:30:24.279832 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m07:30:24.285296 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m07:30:24.285523 [debug] [MainThread]: Using vertica connection "_test"
[0m07:30:24.285643 [debug] [MainThread]: On _test: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "_test"} */

    select
    column_name
    , data_type
    , character_maximum_length
    , numeric_precision
    , numeric_scale
    from (
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.columns
        where table_schema = 'test16666830232459306942_test_array_construct'
        and table_name = 'expected'
        union all
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.view_columns
        where table_schema = 'test16666830232459306942_test_array_construct'
        and table_name = 'expected'
    ) t
    order by ordinal_position
  
[0m07:30:24.314489 [debug] [MainThread]: SQL status: Code: [Column(name='column_name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='data_type', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='character_maximum_length', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_precision', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_scale', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.03 seconds
[0m07:30:24.315850 [debug] [MainThread]: On _test: ROLLBACK
[0m07:30:24.321309 [debug] [MainThread]: On _test: Close
[0m07:30:24.322134 [debug] [MainThread]: Acquiring new vertica connection "_test"
[0m07:30:24.323460 [debug] [MainThread]: Using vertica connection "_test"
[0m07:30:24.323605 [debug] [MainThread]: On _test: BEGIN
[0m07:30:24.323762 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:30:24.338856 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m07:30:24.344430 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m07:30:24.344693 [debug] [MainThread]: Using vertica connection "_test"
[0m07:30:24.344817 [debug] [MainThread]: On _test: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "_test"} */

    select
    column_name
    , data_type
    , character_maximum_length
    , numeric_precision
    , numeric_scale
    from (
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.columns
        where table_schema = 'test16666830232459306942_test_array_construct'
        and table_name = 'actual'
        union all
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.view_columns
        where table_schema = 'test16666830232459306942_test_array_construct'
        and table_name = 'actual'
    ) t
    order by ordinal_position
  
[0m07:30:24.370106 [debug] [MainThread]: SQL status: Code: [Column(name='column_name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='data_type', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='character_maximum_length', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_precision', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_scale', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.03 seconds
[0m07:30:24.371968 [debug] [MainThread]: On _test: ROLLBACK
[0m07:30:24.378162 [debug] [MainThread]: On _test: Close
[0m07:30:24.379670 [debug] [MainThread]: Acquiring new vertica connection "_test"
[0m07:30:24.379987 [debug] [MainThread]: Dropping schema "_ReferenceKey(database='vmart', schema='test16666830232459306942_test_array_construct', identifier=None)".
[0m07:30:24.384474 [debug] [MainThread]: Using vertica connection "_test"
[0m07:30:24.384724 [debug] [MainThread]: On _test: BEGIN
[0m07:30:24.384854 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:30:24.402605 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m07:30:24.408204 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m07:30:24.408541 [debug] [MainThread]: Using vertica connection "_test"
[0m07:30:24.408699 [debug] [MainThread]: On _test: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "_test"} */
drop schema if exists "test16666830232459306942_test_array_construct" cascade
  
[0m07:30:24.420927 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m07:30:24.421678 [debug] [MainThread]: On _test: COMMIT
[0m07:30:24.421857 [debug] [MainThread]: Using vertica connection "_test"
[0m07:30:24.421979 [debug] [MainThread]: On _test: COMMIT
[0m07:30:24.429632 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m07:30:24.429978 [debug] [MainThread]: On _test: Close
[0m07:30:24.430793 [debug] [MainThread]: Connection '_test' was properly closed.
