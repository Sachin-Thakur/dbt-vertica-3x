[0m11:11:14.053250 [debug] [MainThread]: Acquiring new vertica connection "_test"
[0m11:11:14.053425 [debug] [MainThread]: Acquiring new vertica connection "_test"
[0m11:11:14.053594 [debug] [MainThread]: Creating schema "_ReferenceKey(database='vmart', schema='test16660914745106022107_test_basic', identifier=None)"
[0m11:11:14.060045 [debug] [MainThread]: Using vertica connection "_test"
[0m11:11:14.060216 [debug] [MainThread]: On _test: BEGIN
[0m11:11:14.060324 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:11:14.083237 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:11:14.088391 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.03 seconds
[0m11:11:14.088759 [debug] [MainThread]: Using vertica connection "_test"
[0m11:11:14.088987 [debug] [MainThread]: On _test: create schema if not exists "test16660914745106022107_test_basic"
  
[0m11:11:14.096599 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:11:14.098205 [debug] [MainThread]: On _test: COMMIT
[0m11:11:14.098608 [debug] [MainThread]: Using vertica connection "_test"
[0m11:11:14.098945 [debug] [MainThread]: On _test: COMMIT
[0m11:11:14.107023 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:11:14.107628 [debug] [MainThread]: On _test: Close
[0m11:11:14.121755 [debug] [MainThread]: Connection '_test' was properly closed.


============================== 2022-10-18 11:11:14.127178 | e3397a0e-71e6-46b4-8744-c1baf273c20b ==============================
[0m11:11:14.127186 [info ] [MainThread]: Running with dbt=1.3.0
[0m11:11:14.127444 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/tmp/pytest-of-sachin/pytest-13/profile0', 'send_anonymous_usage_stats': False, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'show': False, 'which': 'seed', 'rpc_method': 'seed', 'indirect_selection': 'eager'}
[0m11:11:14.127554 [debug] [MainThread]: Tracking: do not track
[0m11:11:14.133188 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
[0m11:11:14.141874 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m11:11:14.142058 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m11:11:14.142198 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m11:11:14.146454 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m11:11:14.147301 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m11:11:14.147865 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m11:11:14.150371 [debug] [MainThread]: Parsing macros/materializations/models/incremental/helpers.sql
[0m11:11:14.152072 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m11:11:14.155590 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m11:11:14.156535 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m11:11:14.160164 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m11:11:14.161424 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m11:11:14.168264 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m11:11:14.169297 [debug] [MainThread]: Parsing macros/materializations/snapshots/helper.sql
[0m11:11:14.169450 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m11:11:14.174696 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m11:11:14.178255 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m11:11:14.178791 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m11:11:14.179216 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m11:11:14.181106 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m11:11:14.182681 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m11:11:14.186715 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m11:11:14.187551 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m11:11:14.188264 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m11:11:14.189666 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m11:11:14.191895 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m11:11:14.192772 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m11:11:14.195944 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m11:11:14.197319 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m11:11:14.199283 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m11:11:14.208416 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m11:11:14.213269 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m11:11:14.214205 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m11:11:14.220295 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m11:11:14.224316 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m11:11:14.234243 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m11:11:14.236326 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m11:11:14.239544 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m11:11:14.247071 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m11:11:14.248070 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m11:11:14.254879 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m11:11:14.264216 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m11:11:14.265275 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m11:11:14.266347 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m11:11:14.268954 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m11:11:14.279921 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m11:11:14.283980 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m11:11:14.284908 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m11:11:14.285841 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m11:11:14.287268 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m11:11:14.288498 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m11:11:14.290105 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m11:11:14.295804 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m11:11:14.304328 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m11:11:14.308518 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m11:11:14.316420 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m11:11:14.317717 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m11:11:14.319746 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m11:11:14.322288 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m11:11:14.325867 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m11:11:14.326627 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m11:11:14.327285 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m11:11:14.327868 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m11:11:14.328728 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m11:11:14.329673 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m11:11:14.330276 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m11:11:14.330867 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m11:11:14.331520 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m11:11:14.332751 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m11:11:14.333273 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m11:11:14.334026 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m11:11:14.334689 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m11:11:14.338861 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m11:11:14.339443 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m11:11:14.340223 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m11:11:14.340872 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m11:11:14.341620 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m11:11:14.342291 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m11:11:14.343653 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m11:11:14.344264 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m11:11:14.344778 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m11:11:14.345452 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m11:11:14.346145 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m11:11:14.347225 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m11:11:14.348073 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m11:11:14.348633 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m11:11:14.349061 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m11:11:14.349633 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m11:11:14.352686 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m11:11:14.357604 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m11:11:14.524013 [debug] [MainThread]: 1699: static parser successfully parsed view_model.sql
[0m11:11:14.531972 [debug] [MainThread]: 1603: static parser failed on swappable.sql
[0m11:11:14.534797 [debug] [MainThread]: 1602: parser fallback to jinja rendering on swappable.sql
[0m11:11:14.535765 [debug] [MainThread]: 1699: static parser successfully parsed table_model.sql
[0m11:11:14.579338 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 296 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
[0m11:11:14.580249 [info ] [MainThread]: 
[0m11:11:14.580729 [debug] [MainThread]: Acquiring new vertica connection "master"
[0m11:11:14.581419 [debug] [ThreadPool]: Acquiring new vertica connection "list_VMart"
[0m11:11:14.584833 [debug] [ThreadPool]: Using vertica connection "list_VMart"
[0m11:11:14.584986 [debug] [ThreadPool]: On list_VMart: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "list_VMart"} */

    select schema_name
    from v_catalog.schemata
  
[0m11:11:14.585126 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:11:14.604425 [debug] [ThreadPool]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:11:14.622382 [debug] [ThreadPool]: SQL status: Code: [Column(name='schema_name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.04 seconds
[0m11:11:14.625094 [debug] [ThreadPool]: On list_VMart: Close
[0m11:11:14.628318 [debug] [ThreadPool]: Acquiring new vertica connection "list_VMart_test16660914745106022107_test_basic"
[0m11:11:14.635057 [debug] [ThreadPool]: Using vertica connection "list_VMart_test16660914745106022107_test_basic"
[0m11:11:14.635202 [debug] [ThreadPool]: On list_VMart_test16660914745106022107_test_basic: BEGIN
[0m11:11:14.635318 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:11:14.653747 [debug] [ThreadPool]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:11:14.660615 [debug] [ThreadPool]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.03 seconds
[0m11:11:14.661176 [debug] [ThreadPool]: Using vertica connection "list_VMart_test16660914745106022107_test_basic"
[0m11:11:14.661526 [debug] [ThreadPool]: On list_VMart_test16660914745106022107_test_basic: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "list_VMart_test16660914745106022107_test_basic"} */
select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'table' as type
    from v_catalog.tables
    where table_schema ilike 'test16660914745106022107_test_basic'
    union all
    select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'view' as type
    from v_catalog.views
    where table_schema ilike 'test16660914745106022107_test_basic'
  
[0m11:11:14.679307 [debug] [ThreadPool]: SQL status: Code: [Column(name='database', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='schema', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='type', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.02 seconds
[0m11:11:14.681658 [debug] [ThreadPool]: On list_VMart_test16660914745106022107_test_basic: ROLLBACK
[0m11:11:14.691118 [debug] [ThreadPool]: On list_VMart_test16660914745106022107_test_basic: Close
[0m11:11:14.691842 [debug] [MainThread]: Using vertica connection "master"
[0m11:11:14.692011 [debug] [MainThread]: On master: BEGIN
[0m11:11:14.692129 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:11:14.709172 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:11:14.714611 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m11:11:14.714867 [debug] [MainThread]: On master: COMMIT
[0m11:11:14.714988 [debug] [MainThread]: Using vertica connection "master"
[0m11:11:14.715099 [debug] [MainThread]: On master: COMMIT
[0m11:11:14.722636 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:11:14.722882 [debug] [MainThread]: On master: Close
[0m11:11:14.723353 [info ] [MainThread]: Concurrency: 4 threads (target='default')
[0m11:11:14.723653 [info ] [MainThread]: 
[0m11:11:14.726589 [debug] [Thread-1 (]: Began running node seed.base.base
[0m11:11:14.726849 [info ] [Thread-1 (]: 1 of 1 START seed file test16660914745106022107_test_basic.base ................ [RUN]
[0m11:11:14.727314 [debug] [Thread-1 (]: Acquiring new vertica connection "seed.base.base"
[0m11:11:14.727452 [debug] [Thread-1 (]: Began compiling node seed.base.base
[0m11:11:14.727578 [debug] [Thread-1 (]: finished collecting timing info
[0m11:11:14.727693 [debug] [Thread-1 (]: Began executing node seed.base.base
[0m11:11:14.753021 [debug] [Thread-1 (]: Writing runtime sql for node "seed.base.base"
[0m11:11:14.753430 [debug] [Thread-1 (]: Using vertica connection "seed.base.base"
[0m11:11:14.753587 [debug] [Thread-1 (]: On seed.base.base: BEGIN
[0m11:11:14.753706 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:11:14.775461 [debug] [Thread-1 (]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:11:14.781195 [debug] [Thread-1 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.03 seconds
[0m11:11:14.781418 [debug] [Thread-1 (]: Using vertica connection "seed.base.base"
[0m11:11:14.781558 [debug] [Thread-1 (]: On seed.base.base: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "seed.base.base"} */

    
    create table "VMart"."test16660914745106022107_test_basic"."base" ("id" integer,"name" varchar(8),"some_date" timestamp without time zone)
  ;
    -- dbt seed --
    
        copy "VMart"."test16660914745106022107_test_basic"."base"
        ("id", "name", "some_date")
        from local '/tmp/pytest-of-sachin/pytest-13/project0/seeds/base.csv'
        delimiter ','
        enclosed by '"'
        skip 1
        abort on error
        rejected data as table "VMart"."test16660914745106022107_test_basic".seed_rejects;
    
  
[0m11:11:14.806488 [debug] [Thread-1 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m11:11:14.813695 [debug] [Thread-1 (]: On seed.base.base: COMMIT
[0m11:11:14.813911 [debug] [Thread-1 (]: Using vertica connection "seed.base.base"
[0m11:11:14.814059 [debug] [Thread-1 (]: On seed.base.base: COMMIT
[0m11:11:14.895329 [debug] [Thread-1 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.08 seconds
[0m11:11:14.895885 [debug] [Thread-1 (]: finished collecting timing info
[0m11:11:14.896076 [debug] [Thread-1 (]: On seed.base.base: Close
[0m11:11:14.896643 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file test16660914745106022107_test_basic.base ............ [[32mCode: None, Rows: -1, Array Size: 1[0m in 0.17s]
[0m11:11:14.897050 [debug] [Thread-1 (]: Finished running node seed.base.base
[0m11:11:14.898196 [debug] [MainThread]: Acquiring new vertica connection "master"
[0m11:11:14.898370 [debug] [MainThread]: Using vertica connection "master"
[0m11:11:14.898481 [debug] [MainThread]: On master: BEGIN
[0m11:11:14.898579 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:11:14.914470 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:11:14.921057 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m11:11:14.921309 [debug] [MainThread]: On master: COMMIT
[0m11:11:14.921427 [debug] [MainThread]: Using vertica connection "master"
[0m11:11:14.921530 [debug] [MainThread]: On master: COMMIT
[0m11:11:14.930225 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:11:14.930487 [debug] [MainThread]: On master: Close
[0m11:11:14.930974 [info ] [MainThread]: 
[0m11:11:14.931225 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m11:11:14.931415 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:11:14.931511 [debug] [MainThread]: Connection 'seed.base.base' was properly closed.
[0m11:11:14.935823 [info ] [MainThread]: 
[0m11:11:14.936127 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:11:14.936370 [info ] [MainThread]: 
[0m11:11:14.936550 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:11:14.936796 [debug] [MainThread]: Flushing usage events


============================== 2022-10-18 11:11:14.949312 | e3397a0e-71e6-46b4-8744-c1baf273c20b ==============================
[0m11:11:14.949326 [info ] [MainThread]: Running with dbt=1.3.0
[0m11:11:14.949815 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/tmp/pytest-of-sachin/pytest-13/profile0', 'send_anonymous_usage_stats': False, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:11:14.950011 [debug] [MainThread]: Tracking: do not track
[0m11:11:14.978832 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:11:14.979052 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:11:14.986802 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 296 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
[0m11:11:14.987621 [info ] [MainThread]: 
[0m11:11:14.988127 [debug] [MainThread]: Acquiring new vertica connection "master"
[0m11:11:14.988854 [debug] [ThreadPool]: Acquiring new vertica connection "list_VMart"
[0m11:11:14.990583 [debug] [ThreadPool]: Using vertica connection "list_VMart"
[0m11:11:14.990759 [debug] [ThreadPool]: On list_VMart: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "list_VMart"} */

    select schema_name
    from v_catalog.schemata
  
[0m11:11:14.990928 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:11:15.010101 [debug] [ThreadPool]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:11:15.045522 [debug] [ThreadPool]: SQL status: Code: [Column(name='schema_name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.05 seconds
[0m11:11:15.046563 [debug] [ThreadPool]: On list_VMart: Close
[0m11:11:15.047782 [debug] [ThreadPool]: Acquiring new vertica connection "list_VMart_test16660914745106022107_test_basic"
[0m11:11:15.083356 [debug] [ThreadPool]: Using vertica connection "list_VMart_test16660914745106022107_test_basic"
[0m11:11:15.083598 [debug] [ThreadPool]: On list_VMart_test16660914745106022107_test_basic: BEGIN
[0m11:11:15.083725 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:11:15.108519 [debug] [ThreadPool]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:11:15.114883 [debug] [ThreadPool]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.03 seconds
[0m11:11:15.115152 [debug] [ThreadPool]: Using vertica connection "list_VMart_test16660914745106022107_test_basic"
[0m11:11:15.115281 [debug] [ThreadPool]: On list_VMart_test16660914745106022107_test_basic: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "list_VMart_test16660914745106022107_test_basic"} */
select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'table' as type
    from v_catalog.tables
    where table_schema ilike 'test16660914745106022107_test_basic'
    union all
    select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'view' as type
    from v_catalog.views
    where table_schema ilike 'test16660914745106022107_test_basic'
  
[0m11:11:15.130091 [debug] [ThreadPool]: SQL status: Code: [Column(name='database', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='schema', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='type', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:11:15.131674 [debug] [ThreadPool]: On list_VMart_test16660914745106022107_test_basic: ROLLBACK
[0m11:11:15.138963 [debug] [ThreadPool]: On list_VMart_test16660914745106022107_test_basic: Close
[0m11:11:15.140015 [debug] [MainThread]: Using vertica connection "master"
[0m11:11:15.140234 [debug] [MainThread]: On master: BEGIN
[0m11:11:15.140356 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:11:15.159198 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:11:15.165747 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.03 seconds
[0m11:11:15.166022 [debug] [MainThread]: On master: COMMIT
[0m11:11:15.166142 [debug] [MainThread]: Using vertica connection "master"
[0m11:11:15.166252 [debug] [MainThread]: On master: COMMIT
[0m11:11:15.171800 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:11:15.172084 [debug] [MainThread]: On master: Close
[0m11:11:15.172574 [info ] [MainThread]: Concurrency: 4 threads (target='default')
[0m11:11:15.172875 [info ] [MainThread]: 
[0m11:11:15.174089 [debug] [Thread-8 (]: Began running node model.base.swappable
[0m11:11:15.174237 [debug] [Thread-9 (]: Began running node model.base.table_model
[0m11:11:15.174368 [debug] [Thread-10 ]: Began running node model.base.view_model
[0m11:11:15.174653 [info ] [Thread-8 (]: 1 of 3 START sql table model test16660914745106022107_test_basic.swappable ..... [RUN]
[0m11:11:15.174889 [info ] [Thread-9 (]: 2 of 3 START sql table model test16660914745106022107_test_basic.table_model ... [RUN]
[0m11:11:15.175105 [info ] [Thread-10 ]: 3 of 3 START sql view model test16660914745106022107_test_basic.view_model ..... [RUN]
[0m11:11:15.175641 [debug] [Thread-8 (]: Acquiring new vertica connection "model.base.swappable"
[0m11:11:15.176237 [debug] [Thread-9 (]: Acquiring new vertica connection "model.base.table_model"
[0m11:11:15.176745 [debug] [Thread-10 ]: Acquiring new vertica connection "model.base.view_model"
[0m11:11:15.176887 [debug] [Thread-8 (]: Began compiling node model.base.swappable
[0m11:11:15.177199 [debug] [Thread-9 (]: Began compiling node model.base.table_model
[0m11:11:15.177362 [debug] [Thread-10 ]: Began compiling node model.base.view_model
[0m11:11:15.177511 [debug] [Thread-8 (]: Compiling model.base.swappable
[0m11:11:15.177658 [debug] [Thread-9 (]: Compiling model.base.table_model
[0m11:11:15.177795 [debug] [Thread-10 ]: Compiling model.base.view_model
[0m11:11:15.180178 [debug] [Thread-8 (]: Writing injected SQL for node "model.base.swappable"
[0m11:11:15.182527 [debug] [Thread-9 (]: Writing injected SQL for node "model.base.table_model"
[0m11:11:15.184783 [debug] [Thread-10 ]: Writing injected SQL for node "model.base.view_model"
[0m11:11:15.185402 [debug] [Thread-10 ]: finished collecting timing info
[0m11:11:15.185533 [debug] [Thread-8 (]: finished collecting timing info
[0m11:11:15.185647 [debug] [Thread-9 (]: finished collecting timing info
[0m11:11:15.185812 [debug] [Thread-10 ]: Began executing node model.base.view_model
[0m11:11:15.185970 [debug] [Thread-8 (]: Began executing node model.base.swappable
[0m11:11:15.186123 [debug] [Thread-9 (]: Began executing node model.base.table_model
[0m11:11:15.207808 [debug] [Thread-10 ]: Writing runtime sql for node "model.base.view_model"
[0m11:11:15.225431 [debug] [Thread-8 (]: Using vertica connection "model.base.swappable"
[0m11:11:15.225857 [debug] [Thread-9 (]: Using vertica connection "model.base.table_model"
[0m11:11:15.226284 [debug] [Thread-8 (]: On model.base.swappable: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.base.swappable"} */
drop table if exists "VMart"."test16660914745106022107_test_basic"."swappable__dbt_tmp" cascade
[0m11:11:15.226499 [debug] [Thread-9 (]: On model.base.table_model: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.base.table_model"} */
drop table if exists "VMart"."test16660914745106022107_test_basic"."table_model__dbt_tmp" cascade
[0m11:11:15.226738 [debug] [Thread-8 (]: Opening a new connection, currently in state closed
[0m11:11:15.226877 [debug] [Thread-10 ]: Using vertica connection "model.base.view_model"
[0m11:11:15.227073 [debug] [Thread-9 (]: Opening a new connection, currently in state init
[0m11:11:15.227514 [debug] [Thread-10 ]: On model.base.view_model: BEGIN
[0m11:11:15.228000 [debug] [Thread-10 ]: Opening a new connection, currently in state init
[0m11:11:15.247428 [debug] [Thread-9 (]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:11:15.251385 [debug] [Thread-8 (]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:11:15.251716 [debug] [Thread-10 ]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:11:15.254488 [debug] [Thread-9 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.03 seconds
[0m11:11:15.256554 [debug] [Thread-9 (]: Using vertica connection "model.base.table_model"
[0m11:11:15.256749 [debug] [Thread-9 (]: On model.base.table_model: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.base.table_model"} */
drop table if exists "VMart"."test16660914745106022107_test_basic"."table_model__dbt_backup" cascade
[0m11:11:15.258028 [debug] [Thread-10 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.03 seconds
[0m11:11:15.258317 [debug] [Thread-8 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.03 seconds
[0m11:11:15.258479 [debug] [Thread-10 ]: Using vertica connection "model.base.view_model"
[0m11:11:15.260361 [debug] [Thread-8 (]: Using vertica connection "model.base.swappable"
[0m11:11:15.260596 [debug] [Thread-10 ]: On model.base.view_model: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.base.view_model"} */

  create view "VMart"."test16660914745106022107_test_basic"."view_model__dbt_tmp" as (
    

  select * from "VMart"."test16660914745106022107_test_basic"."base"
  );
[0m11:11:15.260833 [debug] [Thread-8 (]: On model.base.swappable: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.base.swappable"} */
drop table if exists "VMart"."test16660914745106022107_test_basic"."swappable__dbt_backup" cascade
[0m11:11:15.267493 [debug] [Thread-9 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:11:15.273093 [debug] [Thread-9 (]: Writing runtime sql for node "model.base.table_model"
[0m11:11:15.273520 [debug] [Thread-10 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:11:15.274089 [debug] [Thread-8 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:11:15.281201 [debug] [Thread-10 ]: Using vertica connection "model.base.view_model"
[0m11:11:15.282553 [debug] [Thread-8 (]: Writing runtime sql for node "model.base.swappable"
[0m11:11:15.282738 [debug] [Thread-10 ]: On model.base.view_model: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.base.view_model"} */
alter view "VMart"."test16660914745106022107_test_basic"."view_model__dbt_tmp" rename to "view_model"
[0m11:11:15.283360 [debug] [Thread-8 (]: Using vertica connection "model.base.swappable"
[0m11:11:15.283495 [debug] [Thread-9 (]: Using vertica connection "model.base.table_model"
[0m11:11:15.283658 [debug] [Thread-8 (]: On model.base.swappable: BEGIN
[0m11:11:15.283803 [debug] [Thread-9 (]: On model.base.table_model: BEGIN
[0m11:11:15.293658 [debug] [Thread-10 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:11:15.294086 [debug] [Thread-8 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:11:15.299544 [debug] [Thread-9 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m11:11:15.307771 [debug] [Thread-10 ]: On model.base.view_model: COMMIT
[0m11:11:15.308083 [debug] [Thread-8 (]: Using vertica connection "model.base.swappable"
[0m11:11:15.308317 [debug] [Thread-9 (]: Using vertica connection "model.base.table_model"
[0m11:11:15.308524 [debug] [Thread-10 ]: Using vertica connection "model.base.view_model"
[0m11:11:15.308783 [debug] [Thread-8 (]: On model.base.swappable: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.base.swappable"} */

  
    

  create  table
    "VMart"."test16660914745106022107_test_basic"."swappable__dbt_tmp"
    
  as (
    

  select * from "VMart"."test16660914745106022107_test_basic"."base"
  );

  
[0m11:11:15.308999 [debug] [Thread-9 (]: On model.base.table_model: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.base.table_model"} */

  
    

  create  table
    "VMart"."test16660914745106022107_test_basic"."table_model__dbt_tmp"
    
  as (
    

  select * from "VMart"."test16660914745106022107_test_basic"."base"
  );

  
[0m11:11:15.309185 [debug] [Thread-10 ]: On model.base.view_model: COMMIT
[0m11:11:15.320821 [debug] [Thread-10 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:11:15.323437 [debug] [Thread-10 ]: Using vertica connection "model.base.view_model"
[0m11:11:15.323688 [debug] [Thread-10 ]: On model.base.view_model: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.base.view_model"} */
drop view if exists "VMart"."test16660914745106022107_test_basic"."view_model__dbt_backup" cascade
[0m11:11:15.331227 [debug] [Thread-10 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:11:15.332824 [debug] [Thread-10 ]: finished collecting timing info
[0m11:11:15.333086 [debug] [Thread-10 ]: On model.base.view_model: Close
[0m11:11:15.333941 [info ] [Thread-10 ]: 3 of 3 OK created sql view model test16660914745106022107_test_basic.view_model  [[32mCode: None, Rows: -1, Array Size: 1[0m in 0.16s]
[0m11:11:15.334547 [debug] [Thread-10 ]: Finished running node model.base.view_model
[0m11:11:15.359731 [debug] [Thread-8 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.05 seconds
[0m11:11:15.361788 [debug] [Thread-8 (]: Using vertica connection "model.base.swappable"
[0m11:11:15.361977 [debug] [Thread-8 (]: On model.base.swappable: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.base.swappable"} */
alter table "VMart"."test16660914745106022107_test_basic"."swappable__dbt_tmp" rename to "swappable"
[0m11:11:15.365216 [debug] [Thread-9 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.06 seconds
[0m11:11:15.367113 [debug] [Thread-9 (]: Using vertica connection "model.base.table_model"
[0m11:11:15.367290 [debug] [Thread-9 (]: On model.base.table_model: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.base.table_model"} */
alter table "VMart"."test16660914745106022107_test_basic"."table_model__dbt_tmp" rename to "table_model"
[0m11:11:15.373219 [debug] [Thread-8 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:11:15.374120 [debug] [Thread-8 (]: On model.base.swappable: COMMIT
[0m11:11:15.374298 [debug] [Thread-8 (]: Using vertica connection "model.base.swappable"
[0m11:11:15.374408 [debug] [Thread-8 (]: On model.base.swappable: COMMIT
[0m11:11:15.380819 [debug] [Thread-9 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:11:15.381083 [debug] [Thread-8 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:11:15.381973 [debug] [Thread-9 (]: On model.base.table_model: COMMIT
[0m11:11:15.384445 [debug] [Thread-8 (]: Using vertica connection "model.base.swappable"
[0m11:11:15.384768 [debug] [Thread-9 (]: Using vertica connection "model.base.table_model"
[0m11:11:15.384992 [debug] [Thread-8 (]: On model.base.swappable: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.base.swappable"} */
drop table if exists "VMart"."test16660914745106022107_test_basic"."swappable__dbt_backup" cascade
[0m11:11:15.385144 [debug] [Thread-9 (]: On model.base.table_model: COMMIT
[0m11:11:15.390861 [debug] [Thread-9 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:11:15.395185 [debug] [Thread-9 (]: Using vertica connection "model.base.table_model"
[0m11:11:15.395613 [debug] [Thread-8 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:11:15.395851 [debug] [Thread-9 (]: On model.base.table_model: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.base.table_model"} */
drop table if exists "VMart"."test16660914745106022107_test_basic"."table_model__dbt_backup" cascade
[0m11:11:15.396901 [debug] [Thread-8 (]: finished collecting timing info
[0m11:11:15.397340 [debug] [Thread-8 (]: On model.base.swappable: Close
[0m11:11:15.398094 [info ] [Thread-8 (]: 1 of 3 OK created sql table model test16660914745106022107_test_basic.swappable  [[32mCode: None, Rows: -1, Array Size: 1[0m in 0.22s]
[0m11:11:15.398472 [debug] [Thread-8 (]: Finished running node model.base.swappable
[0m11:11:15.404725 [debug] [Thread-9 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:11:15.406198 [debug] [Thread-9 (]: finished collecting timing info
[0m11:11:15.406496 [debug] [Thread-9 (]: On model.base.table_model: Close
[0m11:11:15.407326 [info ] [Thread-9 (]: 2 of 3 OK created sql table model test16660914745106022107_test_basic.table_model  [[32mCode: None, Rows: -1, Array Size: 1[0m in 0.23s]
[0m11:11:15.407870 [debug] [Thread-9 (]: Finished running node model.base.table_model
[0m11:11:15.409124 [debug] [MainThread]: Acquiring new vertica connection "master"
[0m11:11:15.409434 [debug] [MainThread]: Using vertica connection "master"
[0m11:11:15.409645 [debug] [MainThread]: On master: BEGIN
[0m11:11:15.409830 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:11:15.428106 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:11:15.433963 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m11:11:15.434355 [debug] [MainThread]: On master: COMMIT
[0m11:11:15.434573 [debug] [MainThread]: Using vertica connection "master"
[0m11:11:15.434771 [debug] [MainThread]: On master: COMMIT
[0m11:11:15.439941 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.0 seconds
[0m11:11:15.440312 [debug] [MainThread]: On master: Close
[0m11:11:15.441050 [info ] [MainThread]: 
[0m11:11:15.441458 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 0 minutes and 0.45 seconds (0.45s).
[0m11:11:15.441793 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:11:15.441969 [debug] [MainThread]: Connection 'model.base.swappable' was properly closed.
[0m11:11:15.442144 [debug] [MainThread]: Connection 'model.base.table_model' was properly closed.
[0m11:11:15.442315 [debug] [MainThread]: Connection 'model.base.view_model' was properly closed.
[0m11:11:15.449360 [info ] [MainThread]: 
[0m11:11:15.449838 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:11:15.450228 [info ] [MainThread]: 
[0m11:11:15.450555 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m11:11:15.450985 [debug] [MainThread]: Flushing usage events
[0m11:11:15.451833 [debug] [MainThread]: Acquiring new vertica connection "_test"
[0m11:11:15.459159 [debug] [MainThread]: Using vertica connection "_test"
[0m11:11:15.459520 [debug] [MainThread]: On _test: BEGIN
[0m11:11:15.459733 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:11:15.479238 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:11:15.484768 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.03 seconds
[0m11:11:15.484990 [debug] [MainThread]: Using vertica connection "_test"
[0m11:11:15.485112 [debug] [MainThread]: On _test: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "_test"} */

    select
    column_name
    , data_type
    , character_maximum_length
    , numeric_precision
    , numeric_scale
    from (
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.columns
        where table_schema = 'test16660914745106022107_test_basic'
        and table_name = 'base'
        union all
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.view_columns
        where table_schema = 'test16660914745106022107_test_basic'
        and table_name = 'base'
    ) t
    order by ordinal_position
  
[0m11:11:15.523701 [debug] [MainThread]: SQL status: Code: [Column(name='column_name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='data_type', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='character_maximum_length', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_precision', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_scale', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.04 seconds
[0m11:11:15.526645 [debug] [MainThread]: Using vertica connection "_test"
[0m11:11:15.526869 [debug] [MainThread]: On _test: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "_test"} */
with diff_count as (
    SELECT
        1 as id,
        COUNT(*) as num_missing FROM (
            (SELECT "id", "name", "some_date" FROM "VMart"."test16660914745106022107_test_basic"."base" EXCEPT
             SELECT "id", "name", "some_date" FROM "VMart"."test16660914745106022107_test_basic"."view_model")
             UNION ALL
            (SELECT "id", "name", "some_date" FROM "VMart"."test16660914745106022107_test_basic"."view_model" EXCEPT
             SELECT "id", "name", "some_date" FROM "VMart"."test16660914745106022107_test_basic"."base")
        ) as a
), table_a as (
    SELECT COUNT(*) as num_rows FROM "VMart"."test16660914745106022107_test_basic"."base"
), table_b as (
    SELECT COUNT(*) as num_rows FROM "VMart"."test16660914745106022107_test_basic"."view_model"
), row_count_diff as (
    select
        1 as id,
        table_a.num_rows - table_b.num_rows as difference
    from table_a, table_b
)
select
    row_count_diff.difference as row_count_difference,
    diff_count.num_missing as num_mismatched
from row_count_diff
join diff_count using (id)
[0m11:11:15.564841 [debug] [MainThread]: SQL status: Code: [Column(name='row_count_difference', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='num_mismatched', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.04 seconds
[0m11:11:15.565885 [debug] [MainThread]: Using vertica connection "_test"
[0m11:11:15.566065 [debug] [MainThread]: On _test: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "_test"} */
with diff_count as (
    SELECT
        1 as id,
        COUNT(*) as num_missing FROM (
            (SELECT "id", "name", "some_date" FROM "VMart"."test16660914745106022107_test_basic"."base" EXCEPT
             SELECT "id", "name", "some_date" FROM "VMart"."test16660914745106022107_test_basic"."table_model")
             UNION ALL
            (SELECT "id", "name", "some_date" FROM "VMart"."test16660914745106022107_test_basic"."table_model" EXCEPT
             SELECT "id", "name", "some_date" FROM "VMart"."test16660914745106022107_test_basic"."base")
        ) as a
), table_a as (
    SELECT COUNT(*) as num_rows FROM "VMart"."test16660914745106022107_test_basic"."base"
), table_b as (
    SELECT COUNT(*) as num_rows FROM "VMart"."test16660914745106022107_test_basic"."table_model"
), row_count_diff as (
    select
        1 as id,
        table_a.num_rows - table_b.num_rows as difference
    from table_a, table_b
)
select
    row_count_diff.difference as row_count_difference,
    diff_count.num_missing as num_mismatched
from row_count_diff
join diff_count using (id)
[0m11:11:15.612216 [debug] [MainThread]: SQL status: Code: [Column(name='row_count_difference', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='num_mismatched', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.05 seconds
[0m11:11:15.613128 [debug] [MainThread]: On _test: ROLLBACK
[0m11:11:15.620379 [debug] [MainThread]: On _test: Close
[0m11:11:15.627086 [debug] [MainThread]: Connection '_test' was properly closed.


============================== 2022-10-18 11:11:15.632626 | e3397a0e-71e6-46b4-8744-c1baf273c20b ==============================
[0m11:11:15.632635 [info ] [MainThread]: Running with dbt=1.3.0
[0m11:11:15.632933 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/tmp/pytest-of-sachin/pytest-13/profile0', 'send_anonymous_usage_stats': False, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
[0m11:11:15.633072 [debug] [MainThread]: Tracking: do not track
[0m11:11:15.651551 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:11:15.651745 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:11:15.659288 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 296 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
[0m11:11:15.660465 [info ] [MainThread]: 
[0m11:11:15.661234 [debug] [MainThread]: Acquiring new vertica connection "master"
[0m11:11:15.662158 [debug] [ThreadPool]: Acquiring new vertica connection "list_VMart_test16660914745106022107_test_basic"
[0m11:11:15.663603 [debug] [ThreadPool]: Using vertica connection "list_VMart_test16660914745106022107_test_basic"
[0m11:11:15.663762 [debug] [ThreadPool]: On list_VMart_test16660914745106022107_test_basic: BEGIN
[0m11:11:15.663879 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:11:15.682264 [debug] [ThreadPool]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:11:15.687836 [debug] [ThreadPool]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m11:11:15.688102 [debug] [ThreadPool]: Using vertica connection "list_VMart_test16660914745106022107_test_basic"
[0m11:11:15.688240 [debug] [ThreadPool]: On list_VMart_test16660914745106022107_test_basic: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "list_VMart_test16660914745106022107_test_basic"} */
select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'table' as type
    from v_catalog.tables
    where table_schema ilike 'test16660914745106022107_test_basic'
    union all
    select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'view' as type
    from v_catalog.views
    where table_schema ilike 'test16660914745106022107_test_basic'
  
[0m11:11:15.709960 [debug] [ThreadPool]: SQL status: Code: [Column(name='database', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='schema', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='type', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.02 seconds
[0m11:11:15.711030 [debug] [ThreadPool]: On list_VMart_test16660914745106022107_test_basic: ROLLBACK
[0m11:11:15.717026 [debug] [ThreadPool]: On list_VMart_test16660914745106022107_test_basic: Close
[0m11:11:15.718217 [info ] [MainThread]: Concurrency: 4 threads (target='default')
[0m11:11:15.718655 [info ] [MainThread]: 
[0m11:11:15.720741 [debug] [Thread-15 ]: Began running node model.base.swappable
[0m11:11:15.721423 [debug] [Thread-15 ]: Acquiring new vertica connection "model.base.swappable"
[0m11:11:15.721666 [debug] [Thread-15 ]: Began compiling node model.base.swappable
[0m11:11:15.721838 [debug] [Thread-16 ]: Began running node model.base.table_model
[0m11:11:15.722022 [debug] [Thread-17 ]: Began running node model.base.view_model
[0m11:11:15.722222 [debug] [Thread-15 ]: Compiling model.base.swappable
[0m11:11:15.722385 [debug] [Thread-18 ]: Began running node seed.base.base
[0m11:11:15.722816 [debug] [Thread-16 ]: Acquiring new vertica connection "model.base.table_model"
[0m11:11:15.723344 [debug] [Thread-17 ]: Acquiring new vertica connection "model.base.view_model"
[0m11:11:15.725943 [debug] [Thread-15 ]: Writing injected SQL for node "model.base.swappable"
[0m11:11:15.726639 [debug] [Thread-18 ]: Acquiring new vertica connection "seed.base.base"
[0m11:11:15.726938 [debug] [Thread-16 ]: Began compiling node model.base.table_model
[0m11:11:15.727142 [debug] [Thread-17 ]: Began compiling node model.base.view_model
[0m11:11:15.727438 [debug] [Thread-18 ]: Began compiling node seed.base.base
[0m11:11:15.727666 [debug] [Thread-16 ]: Compiling model.base.table_model
[0m11:11:15.727820 [debug] [Thread-15 ]: finished collecting timing info
[0m11:11:15.727985 [debug] [Thread-17 ]: Compiling model.base.view_model
[0m11:11:15.728146 [debug] [Thread-18 ]: Compiling seed.base.base
[0m11:11:15.730459 [debug] [Thread-16 ]: Writing injected SQL for node "model.base.table_model"
[0m11:11:15.730743 [debug] [Thread-15 ]: Began executing node model.base.swappable
[0m11:11:15.732975 [debug] [Thread-17 ]: Writing injected SQL for node "model.base.view_model"
[0m11:11:15.734827 [debug] [Thread-18 ]: Writing injected SQL for node "seed.base.base"
[0m11:11:15.735288 [debug] [Thread-15 ]: finished collecting timing info
[0m11:11:15.735538 [debug] [Thread-16 ]: finished collecting timing info
[0m11:11:15.735749 [debug] [Thread-18 ]: finished collecting timing info
[0m11:11:15.735853 [debug] [Thread-17 ]: finished collecting timing info
[0m11:11:15.736544 [debug] [Thread-15 ]: Finished running node model.base.swappable
[0m11:11:15.736919 [debug] [Thread-16 ]: Began executing node model.base.table_model
[0m11:11:15.737143 [debug] [Thread-18 ]: Began executing node seed.base.base
[0m11:11:15.737335 [debug] [Thread-17 ]: Began executing node model.base.view_model
[0m11:11:15.737727 [debug] [Thread-16 ]: finished collecting timing info
[0m11:11:15.737923 [debug] [Thread-18 ]: finished collecting timing info
[0m11:11:15.738102 [debug] [Thread-17 ]: finished collecting timing info
[0m11:11:15.738748 [debug] [Thread-16 ]: Finished running node model.base.table_model
[0m11:11:15.739251 [debug] [Thread-18 ]: Finished running node seed.base.base
[0m11:11:15.739856 [debug] [Thread-17 ]: Finished running node model.base.view_model
[0m11:11:15.740817 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:11:15.741023 [debug] [MainThread]: Connection 'model.base.swappable' was properly closed.
[0m11:11:15.741191 [debug] [MainThread]: Connection 'model.base.table_model' was properly closed.
[0m11:11:15.741351 [debug] [MainThread]: Connection 'model.base.view_model' was properly closed.
[0m11:11:15.741505 [debug] [MainThread]: Connection 'seed.base.base' was properly closed.
[0m11:11:15.747967 [info ] [MainThread]: Done.
[0m11:11:15.749375 [debug] [MainThread]: Acquiring new vertica connection "generate_catalog"
[0m11:11:15.749535 [info ] [MainThread]: Building catalog
[0m11:11:15.750552 [debug] [ThreadPool]: Acquiring new vertica connection "VMart.information_schema"
[0m11:11:15.755577 [debug] [ThreadPool]: Using vertica connection "VMart.information_schema"
[0m11:11:15.755747 [debug] [ThreadPool]: On VMart.information_schema: BEGIN
[0m11:11:15.755857 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:11:15.775998 [debug] [ThreadPool]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:11:15.781505 [debug] [ThreadPool]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.03 seconds
[0m11:11:15.781922 [debug] [ThreadPool]: Using vertica connection "VMart.information_schema"
[0m11:11:15.782170 [debug] [ThreadPool]: On VMart.information_schema: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "VMart.information_schema"} */


    select
    'VMart' table_database
    , tab.table_schema
    , tab.table_name
    , 'TABLE' table_type
    , comment table_comment
    , tab.owner_name table_owner
    , col.column_name
    , col.ordinal_position column_index
    , col.data_type column_type
    , nullif('','') column_comment
    from v_catalog.tables tab
    join v_catalog.columns col on tab.table_id = col.table_id
    left join v_catalog.comments on tab.table_id = object_id
    where not(tab.is_system_table) and
        (lower(tab.table_schema) = lower('test16660914745106022107_test_basic'))
    union all
    select
    'VMart' table_database
    , vw.table_schema
    , vw.table_name
    , 'VIEW' table_type
    , comment table_comment
    , vw.owner_name table_owner
    , col.column_name
    , col.ordinal_position column_index
    , col.data_type column_type
    , nullif('','') column_comment
    from v_catalog.views vw
    join v_catalog.view_columns col on vw.table_id = col.table_id
    left join v_catalog.comments on vw.table_id = object_id
    where not(vw.is_system_view) and
        (lower(vw.table_schema) = lower('test16660914745106022107_test_basic'))
    order by table_schema, table_name, column_index

  
[0m11:11:16.428439 [debug] [ThreadPool]: SQL status: Code: [Column(name='table_database', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='table_schema', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='table_name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='table_type', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='table_comment', type_code=9, display_size=8192, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='table_owner', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='column_name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='column_index', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='column_type', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='column_comment', type_code=9, display_size=1, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.65 seconds
[0m11:11:16.434068 [debug] [ThreadPool]: On VMart.information_schema: ROLLBACK
[0m11:11:16.443184 [debug] [ThreadPool]: On VMart.information_schema: Close
[0m11:11:16.454319 [info ] [MainThread]: Catalog written to /tmp/pytest-of-sachin/pytest-13/project0/target/catalog.json
[0m11:11:16.454763 [debug] [MainThread]: Flushing usage events
[0m11:11:16.454928 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m11:11:16.455032 [debug] [MainThread]: Connection 'VMart.information_schema' was properly closed.
[0m11:11:16.455626 [debug] [MainThread]: Acquiring new vertica connection "_test"
[0m11:11:16.456921 [debug] [MainThread]: Using vertica connection "_test"
[0m11:11:16.457051 [debug] [MainThread]: On _test: BEGIN
[0m11:11:16.457153 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:11:16.474804 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:11:16.480990 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m11:11:16.481543 [debug] [MainThread]: Using vertica connection "_test"
[0m11:11:16.481889 [debug] [MainThread]: On _test: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "_test"} */
select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'table' as type
    from v_catalog.tables
    where table_schema ilike 'test16660914745106022107_test_basic'
    union all
    select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'view' as type
    from v_catalog.views
    where table_schema ilike 'test16660914745106022107_test_basic'
  
[0m11:11:16.505943 [debug] [MainThread]: SQL status: Code: [Column(name='database', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='schema', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='type', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.02 seconds
[0m11:11:16.508766 [debug] [MainThread]: On _test: ROLLBACK
[0m11:11:16.514662 [debug] [MainThread]: On _test: Close
[0m11:11:16.516930 [debug] [MainThread]: Acquiring new vertica connection "_test"
[0m11:11:16.520905 [debug] [MainThread]: Using vertica connection "_test"
[0m11:11:16.521312 [debug] [MainThread]: On _test: BEGIN
[0m11:11:16.521628 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:11:16.542794 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:11:16.548299 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.03 seconds
[0m11:11:16.548859 [debug] [MainThread]: Using vertica connection "_test"
[0m11:11:16.549209 [debug] [MainThread]: On _test: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "_test"} */
select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'table' as type
    from v_catalog.tables
    where table_schema ilike 'test16660914745106022107_test_basic'
    union all
    select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'view' as type
    from v_catalog.views
    where table_schema ilike 'test16660914745106022107_test_basic'
  
[0m11:11:16.567433 [debug] [MainThread]: SQL status: Code: [Column(name='database', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='schema', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='type', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.02 seconds
[0m11:11:16.570328 [debug] [MainThread]: On _test: ROLLBACK
[0m11:11:16.577236 [debug] [MainThread]: On _test: Close
[0m11:11:16.579437 [debug] [MainThread]: Acquiring new vertica connection "_test"
[0m11:11:16.583444 [debug] [MainThread]: Using vertica connection "_test"
[0m11:11:16.583855 [debug] [MainThread]: On _test: BEGIN
[0m11:11:16.584171 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:11:16.604270 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:11:16.611582 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.03 seconds
[0m11:11:16.612182 [debug] [MainThread]: Using vertica connection "_test"
[0m11:11:16.612587 [debug] [MainThread]: On _test: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "_test"} */
select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'table' as type
    from v_catalog.tables
    where table_schema ilike 'test16660914745106022107_test_basic'
    union all
    select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'view' as type
    from v_catalog.views
    where table_schema ilike 'test16660914745106022107_test_basic'
  
[0m11:11:16.635239 [debug] [MainThread]: SQL status: Code: [Column(name='database', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='schema', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='type', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.02 seconds
[0m11:11:16.638247 [debug] [MainThread]: On _test: ROLLBACK
[0m11:11:16.643918 [debug] [MainThread]: On _test: Close
[0m11:11:16.646228 [debug] [MainThread]: Acquiring new vertica connection "_test"
[0m11:11:16.650391 [debug] [MainThread]: Using vertica connection "_test"
[0m11:11:16.650829 [debug] [MainThread]: On _test: BEGIN
[0m11:11:16.651153 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:11:16.675363 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:11:16.690380 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.04 seconds
[0m11:11:16.690621 [debug] [MainThread]: Using vertica connection "_test"
[0m11:11:16.690741 [debug] [MainThread]: On _test: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "_test"} */
select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'table' as type
    from v_catalog.tables
    where table_schema ilike 'test16660914745106022107_test_basic'
    union all
    select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'view' as type
    from v_catalog.views
    where table_schema ilike 'test16660914745106022107_test_basic'
  
[0m11:11:16.715771 [debug] [MainThread]: SQL status: Code: [Column(name='database', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='schema', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='type', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.02 seconds
[0m11:11:16.718776 [debug] [MainThread]: On _test: ROLLBACK
[0m11:11:16.726584 [debug] [MainThread]: On _test: Close
[0m11:11:16.785240 [debug] [MainThread]: Acquiring new vertica connection "_test"
[0m11:11:16.785523 [debug] [MainThread]: Dropping schema "_ReferenceKey(database='vmart', schema='test16660914745106022107_test_basic', identifier=None)".
[0m11:11:16.789213 [debug] [MainThread]: Using vertica connection "_test"
[0m11:11:16.789439 [debug] [MainThread]: On _test: BEGIN
[0m11:11:16.789555 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:11:16.811660 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:11:16.820451 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.03 seconds
[0m11:11:16.820729 [debug] [MainThread]: Using vertica connection "_test"
[0m11:11:16.820852 [debug] [MainThread]: On _test: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "_test"} */
drop schema if exists "test16660914745106022107_test_basic" cascade
  
[0m11:11:16.844150 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m11:11:16.845919 [debug] [MainThread]: On _test: COMMIT
[0m11:11:16.846352 [debug] [MainThread]: Using vertica connection "_test"
[0m11:11:16.846690 [debug] [MainThread]: On _test: COMMIT
[0m11:11:16.855378 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:11:16.856173 [debug] [MainThread]: On _test: Close
[0m11:11:16.857945 [debug] [MainThread]: Connection '_test' was properly closed.
