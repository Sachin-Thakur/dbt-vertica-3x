[0m11:35:40.556587 [debug] [MainThread]: Acquiring new vertica connection "_test"
[0m11:35:40.556750 [debug] [MainThread]: Acquiring new vertica connection "_test"
[0m11:35:40.556914 [debug] [MainThread]: Creating schema "_ReferenceKey(database='vmart', schema='test16666977405865267433_test_array_construct', identifier=None)"
[0m11:35:40.558206 [debug] [MainThread]: Using vertica connection "_test"
[0m11:35:40.558340 [debug] [MainThread]: On _test: BEGIN
[0m11:35:40.558441 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:35:40.575734 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:35:40.581051 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m11:35:40.581365 [debug] [MainThread]: Using vertica connection "_test"
[0m11:35:40.581529 [debug] [MainThread]: On _test: create schema if not exists "test16666977405865267433_test_array_construct"
  
[0m11:35:40.590153 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:35:40.591548 [debug] [MainThread]: On _test: COMMIT
[0m11:35:40.591868 [debug] [MainThread]: Using vertica connection "_test"
[0m11:35:40.592129 [debug] [MainThread]: On _test: COMMIT
[0m11:35:40.597990 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:35:40.598473 [debug] [MainThread]: On _test: Close
[0m11:35:40.610813 [debug] [MainThread]: Connection '_test' was properly closed.


============================== 2022-10-25 11:35:40.616495 | 4c46ffb8-78e4-40ce-8c33-537f87f69c3d ==============================
[0m11:35:40.616503 [info ] [MainThread]: Running with dbt=1.3.0
[0m11:35:40.616786 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/tmp/pytest-of-sachin/pytest-26/profile2', 'send_anonymous_usage_stats': False, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
[0m11:35:40.616899 [debug] [MainThread]: Tracking: do not track
[0m11:35:40.622560 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
[0m11:35:40.630235 [debug] [MainThread]: Parsing macros/test_assert_equal.sql
[0m11:35:40.630768 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m11:35:40.630937 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m11:35:40.631070 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m11:35:40.635381 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m11:35:40.636237 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m11:35:40.636821 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m11:35:40.639365 [debug] [MainThread]: Parsing macros/materializations/models/incremental/helpers.sql
[0m11:35:40.641106 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m11:35:40.644679 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m11:35:40.645669 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m11:35:40.649568 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m11:35:40.650937 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m11:35:40.658469 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m11:35:40.659662 [debug] [MainThread]: Parsing macros/materializations/snapshots/helper.sql
[0m11:35:40.659837 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m11:35:40.665050 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m11:35:40.668628 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m11:35:40.669162 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m11:35:40.669596 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m11:35:40.671458 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m11:35:40.673047 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m11:35:40.677077 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m11:35:40.677957 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m11:35:40.678708 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m11:35:40.680110 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m11:35:40.682373 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m11:35:40.683271 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m11:35:40.686526 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m11:35:40.687952 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m11:35:40.689962 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m11:35:40.699042 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m11:35:40.703943 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m11:35:40.704900 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m11:35:40.711074 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m11:35:40.715084 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m11:35:40.725350 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m11:35:40.727434 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m11:35:40.730788 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m11:35:40.738469 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m11:35:40.739518 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m11:35:40.746475 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m11:35:40.755935 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m11:35:40.757018 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m11:35:40.758111 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m11:35:40.760749 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m11:35:40.771478 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m11:35:40.775543 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m11:35:40.776469 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m11:35:40.777411 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m11:35:40.778893 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m11:35:40.780134 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m11:35:40.781730 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m11:35:40.787807 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m11:35:40.796709 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m11:35:40.801040 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m11:35:40.809108 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m11:35:40.810442 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m11:35:40.812655 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m11:35:40.815262 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m11:35:40.818869 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m11:35:40.819665 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m11:35:40.820355 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m11:35:40.821027 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m11:35:40.821784 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m11:35:40.822700 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m11:35:40.823363 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m11:35:40.823951 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m11:35:40.824600 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m11:35:40.825824 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m11:35:40.826395 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m11:35:40.827226 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m11:35:40.827959 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m11:35:40.831938 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m11:35:40.832534 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m11:35:40.833311 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m11:35:40.833989 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m11:35:40.834755 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m11:35:40.835467 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m11:35:40.836848 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m11:35:40.837452 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m11:35:40.837972 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m11:35:40.838663 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m11:35:40.839395 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m11:35:40.840466 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m11:35:40.841335 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m11:35:40.841887 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m11:35:40.842327 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m11:35:40.843142 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m11:35:40.846297 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m11:35:40.851382 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m11:35:41.004322 [debug] [MainThread]: 1603: static parser failed on actual.sql
[0m11:35:41.007305 [debug] [MainThread]: 1602: parser fallback to jinja rendering on actual.sql
[0m11:35:41.008106 [debug] [MainThread]: 1603: static parser failed on expected.sql
[0m11:35:41.010614 [debug] [MainThread]: 1602: parser fallback to jinja rendering on expected.sql
[0m11:35:41.031470 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 297 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m11:35:41.032109 [info ] [MainThread]: 
[0m11:35:41.032565 [debug] [MainThread]: Acquiring new vertica connection "master"
[0m11:35:41.033166 [debug] [ThreadPool]: Acquiring new vertica connection "list_VMart"
[0m11:35:41.034423 [debug] [ThreadPool]: Using vertica connection "list_VMart"
[0m11:35:41.034550 [debug] [ThreadPool]: On list_VMart: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "list_VMart"} */

    select schema_name
    from v_catalog.schemata
  
[0m11:35:41.034661 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:35:41.051293 [debug] [ThreadPool]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:35:41.069130 [debug] [ThreadPool]: SQL status: Code: [Column(name='schema_name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.03 seconds
[0m11:35:41.071866 [debug] [ThreadPool]: On list_VMart: Close
[0m11:35:41.074796 [debug] [ThreadPool]: Acquiring new vertica connection "list_VMart_test16666977405865267433_test_array_construct"
[0m11:35:41.078692 [debug] [ThreadPool]: Using vertica connection "list_VMart_test16666977405865267433_test_array_construct"
[0m11:35:41.078993 [debug] [ThreadPool]: On list_VMart_test16666977405865267433_test_array_construct: BEGIN
[0m11:35:41.079153 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:35:41.094652 [debug] [ThreadPool]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:35:41.101461 [debug] [ThreadPool]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m11:35:41.102049 [debug] [ThreadPool]: Using vertica connection "list_VMart_test16666977405865267433_test_array_construct"
[0m11:35:41.102420 [debug] [ThreadPool]: On list_VMart_test16666977405865267433_test_array_construct: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "list_VMart_test16666977405865267433_test_array_construct"} */
select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'table' as type
    from v_catalog.tables
    where table_schema ilike 'test16666977405865267433_test_array_construct'
    union all
    select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'view' as type
    from v_catalog.views
    where table_schema ilike 'test16666977405865267433_test_array_construct'
  
[0m11:35:41.130077 [debug] [ThreadPool]: SQL status: Code: [Column(name='database', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='schema', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='type', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.03 seconds
[0m11:35:41.132713 [debug] [ThreadPool]: On list_VMart_test16666977405865267433_test_array_construct: ROLLBACK
[0m11:35:41.138125 [debug] [ThreadPool]: On list_VMart_test16666977405865267433_test_array_construct: Close
[0m11:35:41.139967 [debug] [MainThread]: Using vertica connection "master"
[0m11:35:41.140445 [debug] [MainThread]: On master: BEGIN
[0m11:35:41.140773 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:35:41.159483 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:35:41.165077 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m11:35:41.165592 [debug] [MainThread]: On master: COMMIT
[0m11:35:41.165943 [debug] [MainThread]: Using vertica connection "master"
[0m11:35:41.166264 [debug] [MainThread]: On master: COMMIT
[0m11:35:41.171641 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:35:41.172198 [debug] [MainThread]: On master: Close
[0m11:35:41.173285 [info ] [MainThread]: Concurrency: 4 threads (target='default')
[0m11:35:41.173938 [info ] [MainThread]: 
[0m11:35:41.177212 [debug] [Thread-29 ]: Began running node model.test.actual
[0m11:35:41.177693 [debug] [Thread-30 ]: Began running node model.test.expected
[0m11:35:41.178474 [info ] [Thread-29 ]: 1 of 2 START sql view model test16666977405865267433_test_array_construct.actual  [RUN]
[0m11:35:41.179255 [info ] [Thread-30 ]: 2 of 2 START sql view model test16666977405865267433_test_array_construct.expected  [RUN]
[0m11:35:41.180772 [debug] [Thread-29 ]: Acquiring new vertica connection "model.test.actual"
[0m11:35:41.182127 [debug] [Thread-30 ]: Acquiring new vertica connection "model.test.expected"
[0m11:35:41.182677 [debug] [Thread-29 ]: Began compiling node model.test.actual
[0m11:35:41.183147 [debug] [Thread-30 ]: Began compiling node model.test.expected
[0m11:35:41.183646 [debug] [Thread-29 ]: Compiling model.test.actual
[0m11:35:41.184041 [debug] [Thread-30 ]: Compiling model.test.expected
[0m11:35:41.188525 [debug] [Thread-29 ]: Writing injected SQL for node "model.test.actual"
[0m11:35:41.191304 [debug] [Thread-30 ]: Writing injected SQL for node "model.test.expected"
[0m11:35:41.191903 [debug] [Thread-30 ]: finished collecting timing info
[0m11:35:41.192059 [debug] [Thread-30 ]: Began executing node model.test.expected
[0m11:35:41.192202 [debug] [Thread-29 ]: finished collecting timing info
[0m11:35:41.194492 [debug] [Thread-30 ]: Writing runtime sql for node "model.test.expected"
[0m11:35:41.194719 [debug] [Thread-29 ]: Began executing node model.test.actual
[0m11:35:41.197104 [debug] [Thread-29 ]: Writing runtime sql for node "model.test.actual"
[0m11:35:41.197410 [debug] [Thread-30 ]: Using vertica connection "model.test.expected"
[0m11:35:41.197534 [debug] [Thread-29 ]: Using vertica connection "model.test.actual"
[0m11:35:41.197689 [debug] [Thread-30 ]: On model.test.expected: BEGIN
[0m11:35:41.197836 [debug] [Thread-29 ]: On model.test.actual: BEGIN
[0m11:35:41.197961 [debug] [Thread-30 ]: Opening a new connection, currently in state init
[0m11:35:41.198087 [debug] [Thread-29 ]: Opening a new connection, currently in state closed
[0m11:35:41.213459 [debug] [Thread-29 ]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:35:41.214500 [debug] [Thread-30 ]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:35:41.219324 [debug] [Thread-29 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m11:35:41.219533 [debug] [Thread-30 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m11:35:41.219758 [debug] [Thread-29 ]: Using vertica connection "model.test.actual"
[0m11:35:41.219976 [debug] [Thread-30 ]: Using vertica connection "model.test.expected"
[0m11:35:41.220203 [debug] [Thread-29 ]: On model.test.actual: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.actual"} */

  create view "VMart"."test16666977405865267433_test_array_construct"."actual__dbt_tmp" as (
    select 1 as id, 
    array[ 1 , 2 , 3 ]
     as array_col union all
select 2 as id, 
    array[]::INT[]
     as array_col
  );
[0m11:35:41.220407 [debug] [Thread-30 ]: On model.test.expected: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.expected"} */

  create view "VMart"."test16666977405865267433_test_array_construct"."expected__dbt_tmp" as (
    select 1 as id, 
    array[ 1 , 2 , 3 ]
     as array_col union all
select 2 as id, 
    array[]::INT[]
     as array_col
  );
[0m11:35:41.232758 [debug] [Thread-30 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:35:41.234741 [debug] [Thread-30 ]: Using vertica connection "model.test.expected"
[0m11:35:41.234888 [debug] [Thread-30 ]: On model.test.expected: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.expected"} */
alter view "VMart"."test16666977405865267433_test_array_construct"."expected__dbt_tmp" rename to "expected"
[0m11:35:41.235133 [debug] [Thread-29 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:35:41.237409 [debug] [Thread-29 ]: Using vertica connection "model.test.actual"
[0m11:35:41.237545 [debug] [Thread-29 ]: On model.test.actual: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.actual"} */
alter view "VMart"."test16666977405865267433_test_array_construct"."actual__dbt_tmp" rename to "actual"
[0m11:35:41.245178 [debug] [Thread-30 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:35:41.246980 [debug] [Thread-30 ]: On model.test.expected: COMMIT
[0m11:35:41.247253 [debug] [Thread-30 ]: Using vertica connection "model.test.expected"
[0m11:35:41.247465 [debug] [Thread-30 ]: On model.test.expected: COMMIT
[0m11:35:41.247815 [debug] [Thread-29 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:35:41.249593 [debug] [Thread-29 ]: On model.test.actual: COMMIT
[0m11:35:41.249909 [debug] [Thread-29 ]: Using vertica connection "model.test.actual"
[0m11:35:41.250158 [debug] [Thread-29 ]: On model.test.actual: COMMIT
[0m11:35:41.252235 [debug] [Thread-30 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.0 seconds
[0m11:35:41.255840 [debug] [Thread-30 ]: Using vertica connection "model.test.expected"
[0m11:35:41.256274 [debug] [Thread-30 ]: On model.test.expected: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.expected"} */
drop view if exists "VMart"."test16666977405865267433_test_array_construct"."expected__dbt_backup" cascade
[0m11:35:41.256870 [debug] [Thread-29 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:35:41.260136 [debug] [Thread-29 ]: Using vertica connection "model.test.actual"
[0m11:35:41.260512 [debug] [Thread-29 ]: On model.test.actual: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.actual"} */
drop view if exists "VMart"."test16666977405865267433_test_array_construct"."actual__dbt_backup" cascade
[0m11:35:41.263349 [debug] [Thread-30 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:35:41.265300 [debug] [Thread-30 ]: finished collecting timing info
[0m11:35:41.265958 [debug] [Thread-30 ]: On model.test.expected: Close
[0m11:35:41.267262 [info ] [Thread-30 ]: 2 of 2 OK created sql view model test16666977405865267433_test_array_construct.expected  [[32mCode: None, Rows: -1, Array Size: 1[0m in 0.09s]
[0m11:35:41.268122 [debug] [Thread-30 ]: Finished running node model.test.expected
[0m11:35:41.268600 [debug] [Thread-29 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:35:41.270796 [debug] [Thread-29 ]: finished collecting timing info
[0m11:35:41.271194 [debug] [Thread-29 ]: On model.test.actual: Close
[0m11:35:41.272381 [info ] [Thread-29 ]: 1 of 2 OK created sql view model test16666977405865267433_test_array_construct.actual  [[32mCode: None, Rows: -1, Array Size: 1[0m in 0.09s]
[0m11:35:41.273159 [debug] [Thread-29 ]: Finished running node model.test.actual
[0m11:35:41.275411 [debug] [MainThread]: Acquiring new vertica connection "master"
[0m11:35:41.275837 [debug] [MainThread]: Using vertica connection "master"
[0m11:35:41.276156 [debug] [MainThread]: On master: BEGIN
[0m11:35:41.276439 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:35:41.291145 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:35:41.296734 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m11:35:41.297303 [debug] [MainThread]: On master: COMMIT
[0m11:35:41.297650 [debug] [MainThread]: Using vertica connection "master"
[0m11:35:41.297956 [debug] [MainThread]: On master: COMMIT
[0m11:35:41.303523 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:35:41.304113 [debug] [MainThread]: On master: Close
[0m11:35:41.305287 [info ] [MainThread]: 
[0m11:35:41.305956 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.27 seconds (0.27s).
[0m11:35:41.306523 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:35:41.306820 [debug] [MainThread]: Connection 'model.test.actual' was properly closed.
[0m11:35:41.307115 [debug] [MainThread]: Connection 'model.test.expected' was properly closed.
[0m11:35:41.316379 [info ] [MainThread]: 
[0m11:35:41.316828 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:35:41.317216 [info ] [MainThread]: 
[0m11:35:41.317524 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m11:35:41.317912 [debug] [MainThread]: Flushing usage events


============================== 2022-10-25 11:35:41.337241 | 4c46ffb8-78e4-40ce-8c33-537f87f69c3d ==============================
[0m11:35:41.337253 [info ] [MainThread]: Running with dbt=1.3.0
[0m11:35:41.337742 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/tmp/pytest-of-sachin/pytest-26/profile2', 'send_anonymous_usage_stats': False, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
[0m11:35:41.337924 [debug] [MainThread]: Tracking: do not track
[0m11:35:41.357817 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:35:41.358012 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:35:41.365563 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 297 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m11:35:41.366212 [info ] [MainThread]: 
[0m11:35:41.366685 [debug] [MainThread]: Acquiring new vertica connection "master"
[0m11:35:41.367315 [debug] [ThreadPool]: Acquiring new vertica connection "list_VMart"
[0m11:35:41.368665 [debug] [ThreadPool]: Using vertica connection "list_VMart"
[0m11:35:41.368790 [debug] [ThreadPool]: On list_VMart: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "list_VMart"} */

    select schema_name
    from v_catalog.schemata
  
[0m11:35:41.368900 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:35:41.384390 [debug] [ThreadPool]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:35:41.404528 [debug] [ThreadPool]: SQL status: Code: [Column(name='schema_name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.04 seconds
[0m11:35:41.407364 [debug] [ThreadPool]: On list_VMart: Close
[0m11:35:41.410288 [debug] [ThreadPool]: Acquiring new vertica connection "list_VMart_test16666977405865267433_test_array_construct"
[0m11:35:41.415574 [debug] [ThreadPool]: Using vertica connection "list_VMart_test16666977405865267433_test_array_construct"
[0m11:35:41.416133 [debug] [ThreadPool]: On list_VMart_test16666977405865267433_test_array_construct: BEGIN
[0m11:35:41.416477 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:35:41.434489 [debug] [ThreadPool]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:35:41.439908 [debug] [ThreadPool]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m11:35:41.440121 [debug] [ThreadPool]: Using vertica connection "list_VMart_test16666977405865267433_test_array_construct"
[0m11:35:41.440279 [debug] [ThreadPool]: On list_VMart_test16666977405865267433_test_array_construct: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "list_VMart_test16666977405865267433_test_array_construct"} */
select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'table' as type
    from v_catalog.tables
    where table_schema ilike 'test16666977405865267433_test_array_construct'
    union all
    select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'view' as type
    from v_catalog.views
    where table_schema ilike 'test16666977405865267433_test_array_construct'
  
[0m11:35:41.460306 [debug] [ThreadPool]: SQL status: Code: [Column(name='database', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='schema', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='type', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.02 seconds
[0m11:35:41.461750 [debug] [ThreadPool]: On list_VMart_test16666977405865267433_test_array_construct: ROLLBACK
[0m11:35:41.467135 [debug] [ThreadPool]: On list_VMart_test16666977405865267433_test_array_construct: Close
[0m11:35:41.468745 [debug] [MainThread]: Using vertica connection "master"
[0m11:35:41.469196 [debug] [MainThread]: On master: BEGIN
[0m11:35:41.469513 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:35:41.484496 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:35:41.489440 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m11:35:41.489918 [debug] [MainThread]: On master: COMMIT
[0m11:35:41.490244 [debug] [MainThread]: Using vertica connection "master"
[0m11:35:41.490529 [debug] [MainThread]: On master: COMMIT
[0m11:35:41.495209 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.0 seconds
[0m11:35:41.495815 [debug] [MainThread]: On master: Close
[0m11:35:41.496907 [info ] [MainThread]: Concurrency: 4 threads (target='default')
[0m11:35:41.497618 [info ] [MainThread]: 
[0m11:35:41.542372 [debug] [Thread-36 ]: Began running node model.test.actual
[0m11:35:41.542600 [debug] [Thread-37 ]: Began running node model.test.expected
[0m11:35:41.542900 [info ] [Thread-36 ]: 1 of 2 START sql view model test16666977405865267433_test_array_construct.actual  [RUN]
[0m11:35:41.543128 [info ] [Thread-37 ]: 2 of 2 START sql view model test16666977405865267433_test_array_construct.expected  [RUN]
[0m11:35:41.543636 [debug] [Thread-36 ]: Acquiring new vertica connection "model.test.actual"
[0m11:35:41.544070 [debug] [Thread-37 ]: Acquiring new vertica connection "model.test.expected"
[0m11:35:41.544250 [debug] [Thread-36 ]: Began compiling node model.test.actual
[0m11:35:41.544396 [debug] [Thread-37 ]: Began compiling node model.test.expected
[0m11:35:41.544554 [debug] [Thread-36 ]: Compiling model.test.actual
[0m11:35:41.544704 [debug] [Thread-37 ]: Compiling model.test.expected
[0m11:35:41.547199 [debug] [Thread-36 ]: Writing injected SQL for node "model.test.actual"
[0m11:35:41.549491 [debug] [Thread-37 ]: Writing injected SQL for node "model.test.expected"
[0m11:35:41.549900 [debug] [Thread-36 ]: finished collecting timing info
[0m11:35:41.550004 [debug] [Thread-37 ]: finished collecting timing info
[0m11:35:41.550152 [debug] [Thread-36 ]: Began executing node model.test.actual
[0m11:35:41.550291 [debug] [Thread-37 ]: Began executing node model.test.expected
[0m11:35:41.552637 [debug] [Thread-36 ]: Writing runtime sql for node "model.test.actual"
[0m11:35:41.554958 [debug] [Thread-37 ]: Writing runtime sql for node "model.test.expected"
[0m11:35:41.555437 [debug] [Thread-36 ]: Using vertica connection "model.test.actual"
[0m11:35:41.555602 [debug] [Thread-37 ]: Using vertica connection "model.test.expected"
[0m11:35:41.555722 [debug] [Thread-36 ]: On model.test.actual: BEGIN
[0m11:35:41.555867 [debug] [Thread-37 ]: On model.test.expected: BEGIN
[0m11:35:41.556017 [debug] [Thread-36 ]: Opening a new connection, currently in state closed
[0m11:35:41.556193 [debug] [Thread-37 ]: Opening a new connection, currently in state init
[0m11:35:41.570830 [debug] [Thread-37 ]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:35:41.572017 [debug] [Thread-36 ]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:35:41.575196 [debug] [Thread-37 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m11:35:41.575543 [debug] [Thread-37 ]: Using vertica connection "model.test.expected"
[0m11:35:41.575797 [debug] [Thread-37 ]: On model.test.expected: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.expected"} */

  create view "VMart"."test16666977405865267433_test_array_construct"."expected__dbt_tmp" as (
    select 1 as id, 
    array[ 1 , 2 , 3 ]
     as array_col union all
select 2 as id, 
    array[]::INT[]
     as array_col
  );
[0m11:35:41.578847 [debug] [Thread-36 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m11:35:41.579298 [debug] [Thread-36 ]: Using vertica connection "model.test.actual"
[0m11:35:41.579606 [debug] [Thread-36 ]: On model.test.actual: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.actual"} */

  create view "VMart"."test16666977405865267433_test_array_construct"."actual__dbt_tmp" as (
    select 1 as id, 
    array[ 1 , 2 , 3 ]
     as array_col union all
select 2 as id, 
    array[]::INT[]
     as array_col
  );
[0m11:35:41.584525 [debug] [Thread-37 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:35:41.589713 [debug] [Thread-37 ]: Using vertica connection "model.test.expected"
[0m11:35:41.590178 [debug] [Thread-37 ]: On model.test.expected: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.expected"} */
alter view "VMart"."test16666977405865267433_test_array_construct"."expected" rename to "expected__dbt_backup"
[0m11:35:41.594605 [debug] [Thread-36 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:35:41.599208 [debug] [Thread-36 ]: Using vertica connection "model.test.actual"
[0m11:35:41.599723 [debug] [Thread-37 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:35:41.600171 [debug] [Thread-36 ]: On model.test.actual: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.actual"} */
alter view "VMart"."test16666977405865267433_test_array_construct"."actual" rename to "actual__dbt_backup"
[0m11:35:41.604738 [debug] [Thread-37 ]: Using vertica connection "model.test.expected"
[0m11:35:41.605590 [debug] [Thread-37 ]: On model.test.expected: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.expected"} */
alter view "VMart"."test16666977405865267433_test_array_construct"."expected__dbt_tmp" rename to "expected"
[0m11:35:41.614869 [debug] [Thread-37 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:35:41.618117 [debug] [Thread-37 ]: On model.test.expected: COMMIT
[0m11:35:41.618524 [debug] [Thread-37 ]: Using vertica connection "model.test.expected"
[0m11:35:41.618854 [debug] [Thread-36 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:35:41.619322 [debug] [Thread-37 ]: On model.test.expected: COMMIT
[0m11:35:41.623808 [debug] [Thread-36 ]: Using vertica connection "model.test.actual"
[0m11:35:41.624628 [debug] [Thread-36 ]: On model.test.actual: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.actual"} */
alter view "VMart"."test16666977405865267433_test_array_construct"."actual__dbt_tmp" rename to "actual"
[0m11:35:41.629187 [debug] [Thread-37 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.0 seconds
[0m11:35:41.634346 [debug] [Thread-37 ]: Using vertica connection "model.test.expected"
[0m11:35:41.634810 [debug] [Thread-36 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:35:41.635203 [debug] [Thread-37 ]: On model.test.expected: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.expected"} */
drop view if exists "VMart"."test16666977405865267433_test_array_construct"."expected__dbt_backup" cascade
[0m11:35:41.638419 [debug] [Thread-36 ]: On model.test.actual: COMMIT
[0m11:35:41.639197 [debug] [Thread-36 ]: Using vertica connection "model.test.actual"
[0m11:35:41.639525 [debug] [Thread-36 ]: On model.test.actual: COMMIT
[0m11:35:41.646914 [debug] [Thread-36 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:35:41.647454 [debug] [Thread-37 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:35:41.656376 [debug] [Thread-37 ]: finished collecting timing info
[0m11:35:41.657083 [debug] [Thread-36 ]: Using vertica connection "model.test.actual"
[0m11:35:41.657595 [debug] [Thread-37 ]: On model.test.expected: Close
[0m11:35:41.658113 [debug] [Thread-36 ]: On model.test.actual: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.actual"} */
drop view if exists "VMart"."test16666977405865267433_test_array_construct"."actual__dbt_backup" cascade
[0m11:35:41.659756 [info ] [Thread-37 ]: 2 of 2 OK created sql view model test16666977405865267433_test_array_construct.expected  [[32mCode: None, Rows: -1, Array Size: 1[0m in 0.12s]
[0m11:35:41.660683 [debug] [Thread-37 ]: Finished running node model.test.expected
[0m11:35:41.668190 [debug] [Thread-36 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:35:41.669374 [debug] [Thread-36 ]: finished collecting timing info
[0m11:35:41.669628 [debug] [Thread-36 ]: On model.test.actual: Close
[0m11:35:41.670255 [info ] [Thread-36 ]: 1 of 2 OK created sql view model test16666977405865267433_test_array_construct.actual  [[32mCode: None, Rows: -1, Array Size: 1[0m in 0.13s]
[0m11:35:41.670610 [debug] [Thread-36 ]: Finished running node model.test.actual
[0m11:35:41.671601 [debug] [MainThread]: Acquiring new vertica connection "master"
[0m11:35:41.671870 [debug] [MainThread]: Using vertica connection "master"
[0m11:35:41.672070 [debug] [MainThread]: On master: BEGIN
[0m11:35:41.672254 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:35:41.688710 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:35:41.693101 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m11:35:41.693272 [debug] [MainThread]: On master: COMMIT
[0m11:35:41.693374 [debug] [MainThread]: Using vertica connection "master"
[0m11:35:41.693467 [debug] [MainThread]: On master: COMMIT
[0m11:35:41.697988 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.0 seconds
[0m11:35:41.698253 [debug] [MainThread]: On master: Close
[0m11:35:41.698734 [info ] [MainThread]: 
[0m11:35:41.698979 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m11:35:41.699167 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:35:41.699275 [debug] [MainThread]: Connection 'model.test.actual' was properly closed.
[0m11:35:41.699375 [debug] [MainThread]: Connection 'model.test.expected' was properly closed.
[0m11:35:41.703380 [info ] [MainThread]: 
[0m11:35:41.703638 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:35:41.703843 [info ] [MainThread]: 
[0m11:35:41.704010 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m11:35:41.704231 [debug] [MainThread]: Flushing usage events
[0m11:35:41.704674 [debug] [MainThread]: Acquiring new vertica connection "_test"
[0m11:35:41.705927 [debug] [MainThread]: Using vertica connection "_test"
[0m11:35:41.706071 [debug] [MainThread]: On _test: BEGIN
[0m11:35:41.706177 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:35:41.720865 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:35:41.729080 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m11:35:41.729730 [debug] [MainThread]: Using vertica connection "_test"
[0m11:35:41.730091 [debug] [MainThread]: On _test: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "_test"} */

    select
    column_name
    , data_type
    , character_maximum_length
    , numeric_precision
    , numeric_scale
    from (
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.columns
        where table_schema = 'test16666977405865267433_test_array_construct'
        and table_name = 'expected'
        union all
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.view_columns
        where table_schema = 'test16666977405865267433_test_array_construct'
        and table_name = 'expected'
    ) t
    order by ordinal_position
  
[0m11:35:41.757906 [debug] [MainThread]: SQL status: Code: [Column(name='column_name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='data_type', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='character_maximum_length', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_precision', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_scale', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.03 seconds
[0m11:35:41.759976 [debug] [MainThread]: Using vertica connection "_test"
[0m11:35:41.760278 [debug] [MainThread]: On _test: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "_test"} */
with diff_count as (
    SELECT
        1 as id,
        COUNT(*) as num_missing FROM (
            (SELECT "array_col", "id" FROM "VMart"."test16666977405865267433_test_array_construct"."expected" EXCEPT
             SELECT "array_col", "id" FROM "VMart"."test16666977405865267433_test_array_construct"."actual")
             UNION ALL
            (SELECT "array_col", "id" FROM "VMart"."test16666977405865267433_test_array_construct"."actual" EXCEPT
             SELECT "array_col", "id" FROM "VMart"."test16666977405865267433_test_array_construct"."expected")
        ) as a
), table_a as (
    SELECT COUNT(*) as num_rows FROM "VMart"."test16666977405865267433_test_array_construct"."expected"
), table_b as (
    SELECT COUNT(*) as num_rows FROM "VMart"."test16666977405865267433_test_array_construct"."actual"
), row_count_diff as (
    select
        1 as id,
        table_a.num_rows - table_b.num_rows as difference
    from table_a, table_b
)
select
    row_count_diff.difference as row_count_difference,
    diff_count.num_missing as num_mismatched
from row_count_diff
join diff_count using (id)
[0m11:35:41.808792 [debug] [MainThread]: SQL status: Code: [Column(name='row_count_difference', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='num_mismatched', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.05 seconds
[0m11:35:41.811352 [debug] [MainThread]: On _test: ROLLBACK
[0m11:35:41.816256 [debug] [MainThread]: On _test: Close
[0m11:35:41.818401 [debug] [MainThread]: Acquiring new vertica connection "_test"
[0m11:35:41.822130 [debug] [MainThread]: Using vertica connection "_test"
[0m11:35:41.822538 [debug] [MainThread]: On _test: BEGIN
[0m11:35:41.822856 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:35:41.838686 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:35:41.844009 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m11:35:41.844580 [debug] [MainThread]: Using vertica connection "_test"
[0m11:35:41.844937 [debug] [MainThread]: On _test: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "_test"} */

    select
    column_name
    , data_type
    , character_maximum_length
    , numeric_precision
    , numeric_scale
    from (
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.columns
        where table_schema = 'test16666977405865267433_test_array_construct'
        and table_name = 'expected'
        union all
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.view_columns
        where table_schema = 'test16666977405865267433_test_array_construct'
        and table_name = 'expected'
    ) t
    order by ordinal_position
  
[0m11:35:41.871202 [debug] [MainThread]: SQL status: Code: [Column(name='column_name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='data_type', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='character_maximum_length', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_precision', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_scale', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.03 seconds
[0m11:35:41.874313 [debug] [MainThread]: On _test: ROLLBACK
[0m11:35:41.880035 [debug] [MainThread]: On _test: Close
[0m11:35:41.882133 [debug] [MainThread]: Acquiring new vertica connection "_test"
[0m11:35:41.886119 [debug] [MainThread]: Using vertica connection "_test"
[0m11:35:41.886601 [debug] [MainThread]: On _test: BEGIN
[0m11:35:41.886931 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:35:41.902255 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:35:41.907539 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m11:35:41.908100 [debug] [MainThread]: Using vertica connection "_test"
[0m11:35:41.908447 [debug] [MainThread]: On _test: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "_test"} */

    select
    column_name
    , data_type
    , character_maximum_length
    , numeric_precision
    , numeric_scale
    from (
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.columns
        where table_schema = 'test16666977405865267433_test_array_construct'
        and table_name = 'actual'
        union all
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.view_columns
        where table_schema = 'test16666977405865267433_test_array_construct'
        and table_name = 'actual'
    ) t
    order by ordinal_position
  
[0m11:35:41.934604 [debug] [MainThread]: SQL status: Code: [Column(name='column_name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='data_type', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='character_maximum_length', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_precision', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_scale', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.03 seconds
[0m11:35:41.937915 [debug] [MainThread]: On _test: ROLLBACK
[0m11:35:41.943506 [debug] [MainThread]: On _test: Close
[0m11:35:41.946284 [debug] [MainThread]: Acquiring new vertica connection "_test"
[0m11:35:41.946956 [debug] [MainThread]: Dropping schema "_ReferenceKey(database='vmart', schema='test16666977405865267433_test_array_construct', identifier=None)".
[0m11:35:41.950858 [debug] [MainThread]: Using vertica connection "_test"
[0m11:35:41.951376 [debug] [MainThread]: On _test: BEGIN
[0m11:35:41.951743 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:35:41.970761 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:35:41.976737 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m11:35:41.976987 [debug] [MainThread]: Using vertica connection "_test"
[0m11:35:41.977097 [debug] [MainThread]: On _test: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "_test"} */
drop schema if exists "test16666977405865267433_test_array_construct" cascade
  
[0m11:35:41.987652 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:35:41.988487 [debug] [MainThread]: On _test: COMMIT
[0m11:35:41.988627 [debug] [MainThread]: Using vertica connection "_test"
[0m11:35:41.988745 [debug] [MainThread]: On _test: COMMIT
[0m11:35:41.993373 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.0 seconds
[0m11:35:41.993796 [debug] [MainThread]: On _test: Close
[0m11:35:41.994838 [debug] [MainThread]: Connection '_test' was properly closed.
[0m11:35:42.012993 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
[0m11:35:42.013888 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m11:35:42.014124 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m11:35:42.014315 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m11:35:42.018975 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m11:35:42.020099 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m11:35:42.020784 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m11:35:42.024208 [debug] [MainThread]: Parsing macros/materializations/models/incremental/helpers.sql
[0m11:35:42.027030 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m11:35:42.032775 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m11:35:42.034201 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m11:35:42.040266 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m11:35:42.042124 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m11:35:42.049790 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m11:35:42.050932 [debug] [MainThread]: Parsing macros/materializations/snapshots/helper.sql
[0m11:35:42.051142 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m11:35:42.056771 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m11:35:42.060420 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m11:35:42.061073 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m11:35:42.061565 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m11:35:42.063699 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m11:35:42.065366 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m11:35:42.069514 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m11:35:42.070536 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m11:35:42.072450 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m11:35:42.073918 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m11:35:42.076475 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m11:35:42.077382 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m11:35:42.080764 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m11:35:42.082178 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m11:35:42.084262 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m11:35:42.093508 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m11:35:42.098358 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m11:35:42.099377 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m11:35:42.105663 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m11:35:42.109693 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m11:35:42.119792 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m11:35:42.121921 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m11:35:42.125183 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m11:35:42.132876 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m11:35:42.133902 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m11:35:42.140931 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m11:35:42.150568 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m11:35:42.151722 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m11:35:42.152847 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m11:35:42.155534 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m11:35:42.166575 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m11:35:42.170690 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m11:35:42.171672 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m11:35:42.172652 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m11:35:42.174181 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m11:35:42.175464 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m11:35:42.177134 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m11:35:42.183013 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m11:35:42.191706 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m11:35:42.195996 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m11:35:42.204072 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m11:35:42.205429 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m11:35:42.207501 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m11:35:42.210211 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m11:35:42.213947 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m11:35:42.214773 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m11:35:42.215500 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m11:35:42.216149 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m11:35:42.216956 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m11:35:42.217906 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m11:35:42.218580 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m11:35:42.219203 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m11:35:42.219909 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m11:35:42.221177 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m11:35:42.221736 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m11:35:42.222535 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m11:35:42.223311 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m11:35:42.227239 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m11:35:42.227981 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m11:35:42.228900 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m11:35:42.229675 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m11:35:42.230745 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m11:35:42.231589 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m11:35:42.233159 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m11:35:42.233855 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m11:35:42.234457 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m11:35:42.235255 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m11:35:42.236078 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m11:35:42.237476 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m11:35:42.238412 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m11:35:42.239072 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m11:35:42.239578 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m11:35:42.240239 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m11:35:42.243414 [debug] [MainThread]: Parsing macros/etc/datetime.sql
