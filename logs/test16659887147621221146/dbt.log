[0m06:38:34.713504 [debug] [MainThread]: Acquiring new vertica connection "_test"
[0m06:38:34.713701 [debug] [MainThread]: Acquiring new vertica connection "_test"
[0m06:38:34.713891 [debug] [MainThread]: Creating schema "_ReferenceKey(database='vmart', schema='test16659887147621221146_test_basic', identifier=None)"
[0m06:38:34.719170 [debug] [MainThread]: Using vertica connection "_test"
[0m06:38:34.719332 [debug] [MainThread]: On _test: BEGIN
[0m06:38:34.719445 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:38:34.838050 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m06:38:34.844357 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.12 seconds
[0m06:38:34.844913 [debug] [MainThread]: Using vertica connection "_test"
[0m06:38:34.845260 [debug] [MainThread]: On _test: create schema if not exists "test16659887147621221146_test_basic"
  
[0m06:38:34.857814 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m06:38:34.859734 [debug] [MainThread]: On _test: COMMIT
[0m06:38:34.860171 [debug] [MainThread]: Using vertica connection "_test"
[0m06:38:34.860510 [debug] [MainThread]: On _test: COMMIT
[0m06:38:34.867819 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m06:38:34.868400 [debug] [MainThread]: On _test: Close
[0m06:38:34.885755 [debug] [MainThread]: Connection '_test' was properly closed.


============================== 2022-10-17 06:38:34.891961 | 96574cad-dfaf-449b-a794-fc5702eb6416 ==============================
[0m06:38:34.891969 [info ] [MainThread]: Running with dbt=1.2.2
[0m06:38:34.892243 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/tmp/pytest-of-sachin/pytest-0/profile0', 'send_anonymous_usage_stats': False, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'parse_only': False, 'which': 'compile', 'rpc_method': 'compile', 'indirect_selection': 'eager'}
[0m06:38:34.892350 [debug] [MainThread]: Tracking: do not track
[0m06:38:34.897807 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
[0m06:38:34.906084 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m06:38:34.906268 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m06:38:34.906415 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m06:38:34.910739 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m06:38:34.911626 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m06:38:34.912205 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m06:38:34.914703 [debug] [MainThread]: Parsing macros/materializations/models/incremental/helpers.sql
[0m06:38:34.916471 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m06:38:34.920436 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m06:38:34.921331 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m06:38:34.925006 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m06:38:34.926252 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m06:38:34.933109 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m06:38:34.934094 [debug] [MainThread]: Parsing macros/materializations/snapshots/helper.sql
[0m06:38:34.934238 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m06:38:34.939367 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m06:38:34.942917 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m06:38:34.943460 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m06:38:34.943865 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m06:38:34.945727 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m06:38:34.947281 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m06:38:34.951285 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m06:38:34.952108 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m06:38:34.952800 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m06:38:34.954156 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m06:38:34.956431 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m06:38:34.957294 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m06:38:34.960517 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m06:38:34.961894 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m06:38:34.963908 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m06:38:34.973605 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m06:38:34.976311 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m06:38:34.977237 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m06:38:34.982751 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m06:38:34.991860 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m06:38:34.993562 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m06:38:34.996806 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m06:38:35.004436 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m06:38:35.005428 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m06:38:35.012431 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m06:38:35.022228 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m06:38:35.023303 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m06:38:35.024375 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m06:38:35.027014 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m06:38:35.038300 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m06:38:35.042429 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m06:38:35.043391 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m06:38:35.044334 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m06:38:35.045760 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m06:38:35.047494 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m06:38:35.049092 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m06:38:35.055609 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m06:38:35.065128 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m06:38:35.072465 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m06:38:35.086469 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m06:38:35.088744 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m06:38:35.093299 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m06:38:35.094571 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m06:38:35.095575 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m06:38:35.096579 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m06:38:35.097536 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m06:38:35.098591 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m06:38:35.100706 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m06:38:35.101542 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m06:38:35.102841 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m06:38:35.104082 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m06:38:35.109724 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m06:38:35.110688 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m06:38:35.111986 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m06:38:35.113043 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m06:38:35.114277 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m06:38:35.115374 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m06:38:35.117699 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m06:38:35.118671 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m06:38:35.119532 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m06:38:35.120624 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m06:38:35.121729 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m06:38:35.123537 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m06:38:35.124925 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m06:38:35.125891 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m06:38:35.126655 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m06:38:35.127539 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m06:38:35.130284 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m06:38:35.135538 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m06:38:35.327064 [debug] [MainThread]: 1699: static parser successfully parsed expected.sql
[0m06:38:35.334695 [debug] [MainThread]: 1699: static parser successfully parsed upstream.sql
[0m06:38:35.336904 [debug] [MainThread]: 1603: static parser failed on model.sql
[0m06:38:35.341727 [debug] [MainThread]: 1602: parser fallback to jinja rendering on model.sql
[0m06:38:35.372733 [info ] [MainThread]: Found 3 models, 1 test, 0 snapshots, 0 analyses, 266 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m06:38:35.373641 [info ] [MainThread]: 
[0m06:38:35.374039 [debug] [MainThread]: Acquiring new vertica connection "master"
[0m06:38:35.374641 [debug] [ThreadPool]: Acquiring new vertica connection "list_VMart_test16659887147621221146_test_basic"
[0m06:38:35.378347 [debug] [ThreadPool]: Using vertica connection "list_VMart_test16659887147621221146_test_basic"
[0m06:38:35.378509 [debug] [ThreadPool]: On list_VMart_test16659887147621221146_test_basic: BEGIN
[0m06:38:35.378619 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:38:35.393437 [debug] [ThreadPool]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m06:38:35.398756 [debug] [ThreadPool]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m06:38:35.398983 [debug] [ThreadPool]: Using vertica connection "list_VMart_test16659887147621221146_test_basic"
[0m06:38:35.399139 [debug] [ThreadPool]: On list_VMart_test16659887147621221146_test_basic: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "test", "target_name": "default", "connection_name": "list_VMart_test16659887147621221146_test_basic"} */
select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'table' as type
    from v_catalog.tables
    where table_schema ilike 'test16659887147621221146_test_basic'
    union all
    select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'view' as type
    from v_catalog.views
    where table_schema ilike 'test16659887147621221146_test_basic'
  
[0m06:38:35.423120 [debug] [ThreadPool]: SQL status: Code: [Column(name='database', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='schema', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='type', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.02 seconds
[0m06:38:35.425609 [debug] [ThreadPool]: On list_VMart_test16659887147621221146_test_basic: ROLLBACK
[0m06:38:35.430742 [debug] [ThreadPool]: On list_VMart_test16659887147621221146_test_basic: Close
[0m06:38:35.432630 [info ] [MainThread]: Concurrency: 4 threads (target='default')
[0m06:38:35.433453 [info ] [MainThread]: 
[0m06:38:35.451944 [debug] [Thread-1 (]: Began running node model.adapter_methods.upstream
[0m06:38:35.452867 [debug] [Thread-1 (]: Acquiring new vertica connection "model.adapter_methods.upstream"
[0m06:38:35.453313 [debug] [Thread-1 (]: Began compiling node model.adapter_methods.upstream
[0m06:38:35.453648 [debug] [Thread-1 (]: Compiling model.adapter_methods.upstream
[0m06:38:35.456281 [debug] [Thread-1 (]: Writing injected SQL for node "model.adapter_methods.upstream"
[0m06:38:35.457167 [debug] [Thread-1 (]: finished collecting timing info
[0m06:38:35.457604 [debug] [Thread-1 (]: Began executing node model.adapter_methods.upstream
[0m06:38:35.458007 [debug] [Thread-1 (]: finished collecting timing info
[0m06:38:35.458873 [debug] [Thread-1 (]: Finished running node model.adapter_methods.upstream
[0m06:38:35.460205 [debug] [Thread-3 (]: Began running node model.adapter_methods.model
[0m06:38:35.460998 [debug] [Thread-3 (]: Acquiring new vertica connection "model.adapter_methods.model"
[0m06:38:35.461416 [debug] [Thread-3 (]: Began compiling node model.adapter_methods.model
[0m06:38:35.461759 [debug] [Thread-3 (]: Compiling model.adapter_methods.model
[0m06:38:35.470898 [debug] [Thread-3 (]: Dropping schema "_ReferenceKey(database='vmart', schema='test16659887147621221146_test_basic', identifier=None)".
[0m06:38:35.475815 [debug] [Thread-3 (]: Using vertica connection "model.adapter_methods.model"
[0m06:38:35.475969 [debug] [Thread-3 (]: On model.adapter_methods.model: BEGIN
[0m06:38:35.476081 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m06:38:35.493821 [debug] [Thread-3 (]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m06:38:35.499505 [debug] [Thread-3 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m06:38:35.500026 [debug] [Thread-3 (]: Using vertica connection "model.adapter_methods.model"
[0m06:38:35.500366 [debug] [Thread-3 (]: On model.adapter_methods.model: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "test", "target_name": "default", "node_id": "model.adapter_methods.model"} */
drop schema if exists "test16659887147621221146_test_basic" cascade
  
[0m06:38:35.511886 [debug] [Thread-3 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m06:38:35.513687 [debug] [Thread-3 (]: On model.adapter_methods.model: COMMIT
[0m06:38:35.514119 [debug] [Thread-3 (]: Using vertica connection "model.adapter_methods.model"
[0m06:38:35.514490 [debug] [Thread-3 (]: On model.adapter_methods.model: COMMIT
[0m06:38:35.519799 [debug] [Thread-3 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.0 seconds
[0m06:38:35.520502 [debug] [Thread-3 (]: On "model.adapter_methods.model": cache miss for schema "{self.database}.{self.schema}", this is inefficient
[0m06:38:35.525490 [debug] [Thread-3 (]: Using vertica connection "model.adapter_methods.model"
[0m06:38:35.525919 [debug] [Thread-3 (]: On model.adapter_methods.model: BEGIN
[0m06:38:35.530815 [debug] [Thread-3 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.0 seconds
[0m06:38:35.531394 [debug] [Thread-3 (]: Using vertica connection "model.adapter_methods.model"
[0m06:38:35.531770 [debug] [Thread-3 (]: On model.adapter_methods.model: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "test", "target_name": "default", "node_id": "model.adapter_methods.model"} */
select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'table' as type
    from v_catalog.tables
    where table_schema ilike 'test16659887147621221146_test_basic'
    union all
    select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'view' as type
    from v_catalog.views
    where table_schema ilike 'test16659887147621221146_test_basic'
  
[0m06:38:35.545294 [debug] [Thread-3 (]: SQL status: Code: [Column(name='database', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='schema', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='type', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.01 seconds
[0m06:38:35.547566 [debug] [Thread-3 (]: with database=VMart, schema=test16659887147621221146_test_basic, relations=[]
[0m06:38:35.548176 [debug] [Thread-3 (]: Creating schema "_ReferenceKey(database='vmart', schema='test16659887147621221146_test_basic', identifier=None)"
[0m06:38:35.551807 [debug] [Thread-3 (]: Using vertica connection "model.adapter_methods.model"
[0m06:38:35.552303 [debug] [Thread-3 (]: On model.adapter_methods.model: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "test", "target_name": "default", "node_id": "model.adapter_methods.model"} */
create schema if not exists "test16659887147621221146_test_basic"
  
[0m06:38:35.560742 [debug] [Thread-3 (]: SQL status: Code: [Column(name='database', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='schema', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='type', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.01 seconds
[0m06:38:35.562539 [debug] [Thread-3 (]: On model.adapter_methods.model: COMMIT
[0m06:38:35.562968 [debug] [Thread-3 (]: Using vertica connection "model.adapter_methods.model"
[0m06:38:35.563366 [debug] [Thread-3 (]: On model.adapter_methods.model: COMMIT
[0m06:38:35.568487 [debug] [Thread-3 (]: SQL status: Code: [Column(name='database', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='schema', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='type', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.0 seconds
[0m06:38:35.578965 [debug] [Thread-3 (]: Using vertica connection "model.adapter_methods.model"
[0m06:38:35.579283 [debug] [Thread-3 (]: On model.adapter_methods.model: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "test", "target_name": "default", "node_id": "model.adapter_methods.model"} */

    
  create view "VMart"."test16659887147621221146_test_basic"."upstream" as (
    select 2 as id
  );
  
[0m06:38:35.588536 [debug] [Thread-3 (]: SQL status: Code: [Column(name='database', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='schema', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='type', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.01 seconds
[0m06:38:35.591019 [debug] [Thread-3 (]: Writing injected SQL for node "model.adapter_methods.model"
[0m06:38:35.591696 [debug] [Thread-3 (]: finished collecting timing info
[0m06:38:35.592049 [debug] [Thread-3 (]: Began executing node model.adapter_methods.model
[0m06:38:35.592388 [debug] [Thread-3 (]: finished collecting timing info
[0m06:38:35.592702 [debug] [Thread-3 (]: On model.adapter_methods.model: Close
[0m06:38:35.593614 [debug] [Thread-3 (]: Finished running node model.adapter_methods.model
[0m06:38:35.594562 [debug] [Thread-2 (]: Began running node model.adapter_methods.expected
[0m06:38:35.595003 [debug] [Thread-1 (]: Began running node test.adapter_methods.get_columns_in_relation
[0m06:38:35.595557 [debug] [Thread-2 (]: Acquiring new vertica connection "model.adapter_methods.expected"
[0m06:38:35.596048 [debug] [Thread-1 (]: Acquiring new vertica connection "test.adapter_methods.get_columns_in_relation"
[0m06:38:35.596456 [debug] [Thread-2 (]: Began compiling node model.adapter_methods.expected
[0m06:38:35.596751 [debug] [Thread-1 (]: Began compiling node test.adapter_methods.get_columns_in_relation
[0m06:38:35.597106 [debug] [Thread-2 (]: Compiling model.adapter_methods.expected
[0m06:38:35.597488 [debug] [Thread-1 (]: Compiling test.adapter_methods.get_columns_in_relation
[0m06:38:35.600548 [debug] [Thread-2 (]: Writing injected SQL for node "model.adapter_methods.expected"
[0m06:38:35.613068 [debug] [Thread-1 (]: Using vertica connection "test.adapter_methods.get_columns_in_relation"
[0m06:38:35.613382 [debug] [Thread-1 (]: On test.adapter_methods.get_columns_in_relation: BEGIN
[0m06:38:35.613616 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:38:35.614446 [debug] [Thread-2 (]: finished collecting timing info
[0m06:38:35.614778 [debug] [Thread-2 (]: Began executing node model.adapter_methods.expected
[0m06:38:35.615055 [debug] [Thread-2 (]: finished collecting timing info
[0m06:38:35.615654 [debug] [Thread-2 (]: Finished running node model.adapter_methods.expected
[0m06:38:35.628039 [debug] [Thread-1 (]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m06:38:35.633469 [debug] [Thread-1 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m06:38:35.633991 [debug] [Thread-1 (]: Using vertica connection "test.adapter_methods.get_columns_in_relation"
[0m06:38:35.634325 [debug] [Thread-1 (]: On test.adapter_methods.get_columns_in_relation: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "test", "target_name": "default", "node_id": "test.adapter_methods.get_columns_in_relation"} */

    select
    column_name
    , data_type
    , character_maximum_length
    , numeric_precision
    , numeric_scale
    from (
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.columns
        where table_schema = 'test16659887147621221146_test_basic'
        and table_name = 'model'
        union all
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.view_columns
        where table_schema = 'test16659887147621221146_test_basic'
        and table_name = 'model'
    ) t
    order by ordinal_position
  
[0m06:38:35.663928 [debug] [Thread-1 (]: SQL status: Code: [Column(name='column_name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='data_type', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='character_maximum_length', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_precision', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_scale', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.03 seconds
[0m06:38:35.670973 [debug] [Thread-1 (]: Writing injected SQL for node "test.adapter_methods.get_columns_in_relation"
[0m06:38:35.671761 [debug] [Thread-1 (]: finished collecting timing info
[0m06:38:35.672186 [debug] [Thread-1 (]: Began executing node test.adapter_methods.get_columns_in_relation
[0m06:38:35.672572 [debug] [Thread-1 (]: finished collecting timing info
[0m06:38:35.672947 [debug] [Thread-1 (]: On test.adapter_methods.get_columns_in_relation: ROLLBACK
[0m06:38:35.678176 [debug] [Thread-1 (]: On test.adapter_methods.get_columns_in_relation: Close
[0m06:38:35.679451 [debug] [Thread-1 (]: Finished running node test.adapter_methods.get_columns_in_relation
[0m06:38:35.681453 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:38:35.681929 [debug] [MainThread]: Connection 'test.adapter_methods.get_columns_in_relation' was properly closed.
[0m06:38:35.682288 [debug] [MainThread]: Connection 'model.adapter_methods.model' was properly closed.
[0m06:38:35.682622 [debug] [MainThread]: Connection 'model.adapter_methods.expected' was properly closed.
[0m06:38:35.692355 [info ] [MainThread]: Done.
[0m06:38:35.693170 [debug] [MainThread]: Flushing usage events


============================== 2022-10-17 06:38:35.709795 | 96574cad-dfaf-449b-a794-fc5702eb6416 ==============================
[0m06:38:35.709803 [info ] [MainThread]: Running with dbt=1.2.2
[0m06:38:35.710077 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/tmp/pytest-of-sachin/pytest-0/profile0', 'send_anonymous_usage_stats': False, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m06:38:35.710191 [debug] [MainThread]: Tracking: do not track
[0m06:38:35.726404 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:38:35.726588 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:38:35.732720 [info ] [MainThread]: Found 3 models, 1 test, 0 snapshots, 0 analyses, 266 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m06:38:35.733384 [info ] [MainThread]: 
[0m06:38:35.733729 [debug] [MainThread]: Acquiring new vertica connection "master"
[0m06:38:35.734342 [debug] [ThreadPool]: Acquiring new vertica connection "list_VMart"
[0m06:38:35.737891 [debug] [ThreadPool]: Using vertica connection "list_VMart"
[0m06:38:35.738034 [debug] [ThreadPool]: On list_VMart: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "test", "target_name": "default", "connection_name": "list_VMart"} */

    select schema_name
    from v_catalog.schemata
  
[0m06:38:35.738152 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:38:35.751542 [debug] [ThreadPool]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m06:38:35.765162 [debug] [ThreadPool]: SQL status: Code: [Column(name='schema_name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.03 seconds
[0m06:38:35.767671 [debug] [ThreadPool]: On list_VMart: Close
[0m06:38:35.769755 [debug] [ThreadPool]: Acquiring new vertica connection "list_VMart_test16659887147621221146_test_basic"
[0m06:38:35.809225 [debug] [ThreadPool]: Using vertica connection "list_VMart_test16659887147621221146_test_basic"
[0m06:38:35.809422 [debug] [ThreadPool]: On list_VMart_test16659887147621221146_test_basic: BEGIN
[0m06:38:35.809519 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:38:35.822616 [debug] [ThreadPool]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m06:38:35.827409 [debug] [ThreadPool]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m06:38:35.827659 [debug] [ThreadPool]: Using vertica connection "list_VMart_test16659887147621221146_test_basic"
[0m06:38:35.827815 [debug] [ThreadPool]: On list_VMart_test16659887147621221146_test_basic: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "test", "target_name": "default", "connection_name": "list_VMart_test16659887147621221146_test_basic"} */
select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'table' as type
    from v_catalog.tables
    where table_schema ilike 'test16659887147621221146_test_basic'
    union all
    select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'view' as type
    from v_catalog.views
    where table_schema ilike 'test16659887147621221146_test_basic'
  
[0m06:38:35.844214 [debug] [ThreadPool]: SQL status: Code: [Column(name='database', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='schema', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='type', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.02 seconds
[0m06:38:35.846440 [debug] [ThreadPool]: On list_VMart_test16659887147621221146_test_basic: ROLLBACK
[0m06:38:35.851547 [debug] [ThreadPool]: On list_VMart_test16659887147621221146_test_basic: Close
[0m06:38:35.852944 [debug] [MainThread]: Using vertica connection "master"
[0m06:38:35.853484 [debug] [MainThread]: On master: BEGIN
[0m06:38:35.853828 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:38:35.868988 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m06:38:35.874685 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m06:38:35.875201 [debug] [MainThread]: On master: COMMIT
[0m06:38:35.875579 [debug] [MainThread]: Using vertica connection "master"
[0m06:38:35.875968 [debug] [MainThread]: On master: COMMIT
[0m06:38:35.881592 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m06:38:35.882028 [debug] [MainThread]: On master: Close
[0m06:38:35.882811 [info ] [MainThread]: Concurrency: 4 threads (target='default')
[0m06:38:35.883492 [info ] [MainThread]: 
[0m06:38:35.886092 [debug] [Thread-8 (]: Began running node model.adapter_methods.upstream
[0m06:38:35.886858 [info ] [Thread-8 (]: 1 of 3 START view model test16659887147621221146_test_basic.upstream ........... [RUN]
[0m06:38:35.887695 [debug] [Thread-8 (]: Acquiring new vertica connection "model.adapter_methods.upstream"
[0m06:38:35.887954 [debug] [Thread-8 (]: Began compiling node model.adapter_methods.upstream
[0m06:38:35.888236 [debug] [Thread-8 (]: Compiling model.adapter_methods.upstream
[0m06:38:35.889976 [debug] [Thread-8 (]: Writing injected SQL for node "model.adapter_methods.upstream"
[0m06:38:35.890332 [debug] [Thread-8 (]: finished collecting timing info
[0m06:38:35.890521 [debug] [Thread-8 (]: Began executing node model.adapter_methods.upstream
[0m06:38:35.913207 [debug] [Thread-8 (]: Writing runtime SQL for node "model.adapter_methods.upstream"
[0m06:38:35.913627 [debug] [Thread-8 (]: Using vertica connection "model.adapter_methods.upstream"
[0m06:38:35.913780 [debug] [Thread-8 (]: On model.adapter_methods.upstream: BEGIN
[0m06:38:35.913892 [debug] [Thread-8 (]: Opening a new connection, currently in state closed
[0m06:38:35.929123 [debug] [Thread-8 (]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m06:38:35.934503 [debug] [Thread-8 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m06:38:35.934786 [debug] [Thread-8 (]: Using vertica connection "model.adapter_methods.upstream"
[0m06:38:35.934967 [debug] [Thread-8 (]: On model.adapter_methods.upstream: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "test", "target_name": "default", "node_id": "model.adapter_methods.upstream"} */

  create view "VMart"."test16659887147621221146_test_basic"."upstream__dbt_tmp" as (
    select 1 as id
  );
[0m06:38:35.945586 [debug] [Thread-8 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m06:38:35.955114 [debug] [Thread-8 (]: Using vertica connection "model.adapter_methods.upstream"
[0m06:38:35.955438 [debug] [Thread-8 (]: On model.adapter_methods.upstream: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "test", "target_name": "default", "node_id": "model.adapter_methods.upstream"} */
alter view "VMart"."test16659887147621221146_test_basic"."upstream" rename to "upstream__dbt_backup"
[0m06:38:35.965586 [debug] [Thread-8 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m06:38:35.969276 [debug] [Thread-8 (]: Using vertica connection "model.adapter_methods.upstream"
[0m06:38:35.969683 [debug] [Thread-8 (]: On model.adapter_methods.upstream: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "test", "target_name": "default", "node_id": "model.adapter_methods.upstream"} */
alter view "VMart"."test16659887147621221146_test_basic"."upstream__dbt_tmp" rename to "upstream"
[0m06:38:35.979817 [debug] [Thread-8 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m06:38:36.002753 [debug] [Thread-8 (]: On model.adapter_methods.upstream: COMMIT
[0m06:38:36.002991 [debug] [Thread-8 (]: Using vertica connection "model.adapter_methods.upstream"
[0m06:38:36.003108 [debug] [Thread-8 (]: On model.adapter_methods.upstream: COMMIT
[0m06:38:36.007474 [debug] [Thread-8 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.0 seconds
[0m06:38:36.010788 [debug] [Thread-8 (]: Using vertica connection "model.adapter_methods.upstream"
[0m06:38:36.010963 [debug] [Thread-8 (]: On model.adapter_methods.upstream: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "test", "target_name": "default", "node_id": "model.adapter_methods.upstream"} */
drop view if exists "VMart"."test16659887147621221146_test_basic"."upstream__dbt_backup" cascade
[0m06:38:36.018683 [debug] [Thread-8 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m06:38:36.019781 [debug] [Thread-8 (]: finished collecting timing info
[0m06:38:36.020022 [debug] [Thread-8 (]: On model.adapter_methods.upstream: Close
[0m06:38:36.020549 [info ] [Thread-8 (]: 1 of 3 OK created view model test16659887147621221146_test_basic.upstream ...... [[32mCode: None, Rows: -1, Array Size: 1[0m in 0.13s]
[0m06:38:36.020948 [debug] [Thread-8 (]: Finished running node model.adapter_methods.upstream
[0m06:38:36.021593 [debug] [Thread-10 ]: Began running node model.adapter_methods.model
[0m06:38:36.021845 [info ] [Thread-10 ]: 2 of 3 START view model test16659887147621221146_test_basic.model .............. [RUN]
[0m06:38:36.022210 [debug] [Thread-10 ]: Acquiring new vertica connection "model.adapter_methods.model"
[0m06:38:36.022338 [debug] [Thread-10 ]: Began compiling node model.adapter_methods.model
[0m06:38:36.022450 [debug] [Thread-10 ]: Compiling model.adapter_methods.model
[0m06:38:36.026585 [debug] [Thread-10 ]: Dropping schema "_ReferenceKey(database='vmart', schema='test16659887147621221146_test_basic', identifier=None)".
[0m06:38:36.029516 [debug] [Thread-10 ]: Using vertica connection "model.adapter_methods.model"
[0m06:38:36.029781 [debug] [Thread-10 ]: On model.adapter_methods.model: BEGIN
[0m06:38:36.029964 [debug] [Thread-10 ]: Opening a new connection, currently in state init
[0m06:38:36.043348 [debug] [Thread-10 ]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m06:38:36.049086 [debug] [Thread-10 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m06:38:36.049542 [debug] [Thread-10 ]: Using vertica connection "model.adapter_methods.model"
[0m06:38:36.049846 [debug] [Thread-10 ]: On model.adapter_methods.model: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "test", "target_name": "default", "node_id": "model.adapter_methods.model"} */
drop schema if exists "test16659887147621221146_test_basic" cascade
  
[0m06:38:36.061569 [debug] [Thread-10 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m06:38:36.063258 [debug] [Thread-10 ]: On model.adapter_methods.model: COMMIT
[0m06:38:36.063637 [debug] [Thread-10 ]: Using vertica connection "model.adapter_methods.model"
[0m06:38:36.063931 [debug] [Thread-10 ]: On model.adapter_methods.model: COMMIT
[0m06:38:36.068335 [debug] [Thread-10 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.0 seconds
[0m06:38:36.068966 [debug] [Thread-10 ]: On "model.adapter_methods.model": cache miss for schema "{self.database}.{self.schema}", this is inefficient
[0m06:38:36.072156 [debug] [Thread-10 ]: Using vertica connection "model.adapter_methods.model"
[0m06:38:36.072537 [debug] [Thread-10 ]: On model.adapter_methods.model: BEGIN
[0m06:38:36.078417 [debug] [Thread-10 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m06:38:36.078812 [debug] [Thread-10 ]: Using vertica connection "model.adapter_methods.model"
[0m06:38:36.079126 [debug] [Thread-10 ]: On model.adapter_methods.model: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "test", "target_name": "default", "node_id": "model.adapter_methods.model"} */
select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'table' as type
    from v_catalog.tables
    where table_schema ilike 'test16659887147621221146_test_basic'
    union all
    select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'view' as type
    from v_catalog.views
    where table_schema ilike 'test16659887147621221146_test_basic'
  
[0m06:38:36.093196 [debug] [Thread-10 ]: SQL status: Code: [Column(name='database', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='schema', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='type', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.01 seconds
[0m06:38:36.095125 [debug] [Thread-10 ]: with database=VMart, schema=test16659887147621221146_test_basic, relations=[]
[0m06:38:36.095664 [debug] [Thread-10 ]: Creating schema "_ReferenceKey(database='vmart', schema='test16659887147621221146_test_basic', identifier=None)"
[0m06:38:36.098788 [debug] [Thread-10 ]: Using vertica connection "model.adapter_methods.model"
[0m06:38:36.099184 [debug] [Thread-10 ]: On model.adapter_methods.model: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "test", "target_name": "default", "node_id": "model.adapter_methods.model"} */
create schema if not exists "test16659887147621221146_test_basic"
  
[0m06:38:36.107802 [debug] [Thread-10 ]: SQL status: Code: [Column(name='database', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='schema', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='type', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.01 seconds
[0m06:38:36.109319 [debug] [Thread-10 ]: On model.adapter_methods.model: COMMIT
[0m06:38:36.109686 [debug] [Thread-10 ]: Using vertica connection "model.adapter_methods.model"
[0m06:38:36.109997 [debug] [Thread-10 ]: On model.adapter_methods.model: COMMIT
[0m06:38:36.114702 [debug] [Thread-10 ]: SQL status: Code: [Column(name='database', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='schema', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='type', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.0 seconds
[0m06:38:36.116143 [debug] [Thread-10 ]: Using vertica connection "model.adapter_methods.model"
[0m06:38:36.116489 [debug] [Thread-10 ]: On model.adapter_methods.model: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "test", "target_name": "default", "node_id": "model.adapter_methods.model"} */

    
  create view "VMart"."test16659887147621221146_test_basic"."upstream" as (
    select 2 as id
  );
  
[0m06:38:36.126021 [debug] [Thread-10 ]: SQL status: Code: [Column(name='database', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='schema', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='type', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.01 seconds
[0m06:38:36.128403 [debug] [Thread-10 ]: Writing injected SQL for node "model.adapter_methods.model"
[0m06:38:36.129053 [debug] [Thread-10 ]: finished collecting timing info
[0m06:38:36.129439 [debug] [Thread-10 ]: Began executing node model.adapter_methods.model
[0m06:38:36.132190 [debug] [Thread-10 ]: On "model.adapter_methods.model": cache miss for schema "{self.database}.{self.schema}", this is inefficient
[0m06:38:36.134900 [debug] [Thread-10 ]: Using vertica connection "model.adapter_methods.model"
[0m06:38:36.135233 [debug] [Thread-10 ]: On model.adapter_methods.model: BEGIN
[0m06:38:36.141080 [debug] [Thread-10 ]: SQL status: Code: [Column(name='database', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='schema', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='type', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.01 seconds
[0m06:38:36.141515 [debug] [Thread-10 ]: Using vertica connection "model.adapter_methods.model"
[0m06:38:36.141778 [debug] [Thread-10 ]: On model.adapter_methods.model: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "test", "target_name": "default", "node_id": "model.adapter_methods.model"} */
select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'table' as type
    from v_catalog.tables
    where table_schema ilike 'test16659887147621221146_test_basic'
    union all
    select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'view' as type
    from v_catalog.views
    where table_schema ilike 'test16659887147621221146_test_basic'
  
[0m06:38:36.160108 [debug] [Thread-10 ]: SQL status: Code: [Column(name='database', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='schema', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='type', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.02 seconds
[0m06:38:36.162519 [debug] [Thread-10 ]: with database=VMart, schema=test16659887147621221146_test_basic, relations=[_ReferenceKey(database='vmart', schema='test16659887147621221146_test_basic', identifier='upstream')]
[0m06:38:36.164453 [debug] [Thread-10 ]: On "model.adapter_methods.model": cache miss for schema "{self.database}.{self.schema}", this is inefficient
[0m06:38:36.167900 [debug] [Thread-10 ]: Using vertica connection "model.adapter_methods.model"
[0m06:38:36.168314 [debug] [Thread-10 ]: On model.adapter_methods.model: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "test", "target_name": "default", "node_id": "model.adapter_methods.model"} */
select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'table' as type
    from v_catalog.tables
    where table_schema ilike 'test16659887147621221146_test_basic'
    union all
    select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'view' as type
    from v_catalog.views
    where table_schema ilike 'test16659887147621221146_test_basic'
  
[0m06:38:36.182570 [debug] [Thread-10 ]: SQL status: Code: [Column(name='database', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='schema', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='type', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.01 seconds
[0m06:38:36.184815 [debug] [Thread-10 ]: with database=VMart, schema=test16659887147621221146_test_basic, relations=[_ReferenceKey(database='vmart', schema='test16659887147621221146_test_basic', identifier='upstream')]
[0m06:38:36.186404 [debug] [Thread-10 ]: On "model.adapter_methods.model": cache miss for schema "{self.database}.{self.schema}", this is inefficient
[0m06:38:36.189638 [debug] [Thread-10 ]: Using vertica connection "model.adapter_methods.model"
[0m06:38:36.190030 [debug] [Thread-10 ]: On model.adapter_methods.model: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "test", "target_name": "default", "node_id": "model.adapter_methods.model"} */
select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'table' as type
    from v_catalog.tables
    where table_schema ilike 'test16659887147621221146_test_basic'
    union all
    select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'view' as type
    from v_catalog.views
    where table_schema ilike 'test16659887147621221146_test_basic'
  
[0m06:38:36.205694 [debug] [Thread-10 ]: SQL status: Code: [Column(name='database', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='schema', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='type', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.02 seconds
[0m06:38:36.208198 [debug] [Thread-10 ]: with database=VMart, schema=test16659887147621221146_test_basic, relations=[_ReferenceKey(database='vmart', schema='test16659887147621221146_test_basic', identifier='upstream')]
[0m06:38:36.210524 [debug] [Thread-10 ]: Writing runtime SQL for node "model.adapter_methods.model"
[0m06:38:36.211118 [debug] [Thread-10 ]: Using vertica connection "model.adapter_methods.model"
[0m06:38:36.211466 [debug] [Thread-10 ]: On model.adapter_methods.model: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "test", "target_name": "default", "node_id": "model.adapter_methods.model"} */

  create view "VMart"."test16659887147621221146_test_basic"."model__dbt_tmp" as (
    


    
    
    



select * from "VMart"."test16659887147621221146_test_basic"."upstream"
  );
[0m06:38:36.221550 [debug] [Thread-10 ]: SQL status: Code: [Column(name='database', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='schema', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='type', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.01 seconds
[0m06:38:36.225879 [debug] [Thread-10 ]: Using vertica connection "model.adapter_methods.model"
[0m06:38:36.226296 [debug] [Thread-10 ]: On model.adapter_methods.model: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "test", "target_name": "default", "node_id": "model.adapter_methods.model"} */
alter view "VMart"."test16659887147621221146_test_basic"."model__dbt_tmp" rename to "model"
[0m06:38:36.235950 [debug] [Thread-10 ]: SQL status: Code: [Column(name='database', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='schema', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='type', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.01 seconds
[0m06:38:36.238789 [debug] [Thread-10 ]: On model.adapter_methods.model: COMMIT
[0m06:38:36.239192 [debug] [Thread-10 ]: Using vertica connection "model.adapter_methods.model"
[0m06:38:36.239498 [debug] [Thread-10 ]: On model.adapter_methods.model: COMMIT
[0m06:38:36.244857 [debug] [Thread-10 ]: SQL status: Code: [Column(name='database', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='schema', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='type', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.01 seconds
[0m06:38:36.246631 [debug] [Thread-10 ]: Using vertica connection "model.adapter_methods.model"
[0m06:38:36.246849 [debug] [Thread-10 ]: On model.adapter_methods.model: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "test", "target_name": "default", "node_id": "model.adapter_methods.model"} */
drop view if exists "VMart"."test16659887147621221146_test_basic"."model__dbt_backup" cascade
[0m06:38:36.253530 [debug] [Thread-10 ]: SQL status: Code: [Column(name='database', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='schema', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='type', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.01 seconds
[0m06:38:36.254549 [debug] [Thread-10 ]: finished collecting timing info
[0m06:38:36.254771 [debug] [Thread-10 ]: On model.adapter_methods.model: Close
[0m06:38:36.255284 [info ] [Thread-10 ]: 2 of 3 OK created view model test16659887147621221146_test_basic.model ......... [[32mCode: [Column(name='database', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='schema', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='type', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1[0m in 0.23s]
[0m06:38:36.255695 [debug] [Thread-10 ]: Finished running node model.adapter_methods.model
[0m06:38:36.256120 [debug] [Thread-9 (]: Began running node model.adapter_methods.expected
[0m06:38:36.256374 [info ] [Thread-9 (]: 3 of 3 START view model test16659887147621221146_test_basic.expected ........... [RUN]
[0m06:38:36.256766 [debug] [Thread-9 (]: Acquiring new vertica connection "model.adapter_methods.expected"
[0m06:38:36.256983 [debug] [Thread-9 (]: Began compiling node model.adapter_methods.expected
[0m06:38:36.257107 [debug] [Thread-9 (]: Compiling model.adapter_methods.expected
[0m06:38:36.258895 [debug] [Thread-9 (]: Writing injected SQL for node "model.adapter_methods.expected"
[0m06:38:36.259197 [debug] [Thread-9 (]: finished collecting timing info
[0m06:38:36.259380 [debug] [Thread-9 (]: Began executing node model.adapter_methods.expected
[0m06:38:36.262676 [debug] [Thread-9 (]: Writing runtime SQL for node "model.adapter_methods.expected"
[0m06:38:36.262944 [debug] [Thread-9 (]: Using vertica connection "model.adapter_methods.expected"
[0m06:38:36.263076 [debug] [Thread-9 (]: On model.adapter_methods.expected: BEGIN
[0m06:38:36.263191 [debug] [Thread-9 (]: Opening a new connection, currently in state init
[0m06:38:36.277303 [debug] [Thread-9 (]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m06:38:36.281537 [debug] [Thread-9 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m06:38:36.282004 [debug] [Thread-9 (]: Using vertica connection "model.adapter_methods.expected"
[0m06:38:36.282308 [debug] [Thread-9 (]: On model.adapter_methods.expected: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "test", "target_name": "default", "node_id": "model.adapter_methods.expected"} */

  create view "VMart"."test16659887147621221146_test_basic"."expected__dbt_tmp" as (
    -- make sure this runs after 'model'
-- "VMart"."test16659887147621221146_test_basic"."model"
select 2 as id
  );
[0m06:38:36.292407 [debug] [Thread-9 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m06:38:36.296586 [debug] [Thread-9 (]: Using vertica connection "model.adapter_methods.expected"
[0m06:38:36.296968 [debug] [Thread-9 (]: On model.adapter_methods.expected: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "test", "target_name": "default", "node_id": "model.adapter_methods.expected"} */
alter view "VMart"."test16659887147621221146_test_basic"."expected__dbt_tmp" rename to "expected"
[0m06:38:36.306526 [debug] [Thread-9 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m06:38:36.309685 [debug] [Thread-9 (]: On model.adapter_methods.expected: COMMIT
[0m06:38:36.310084 [debug] [Thread-9 (]: Using vertica connection "model.adapter_methods.expected"
[0m06:38:36.310391 [debug] [Thread-9 (]: On model.adapter_methods.expected: COMMIT
[0m06:38:36.315127 [debug] [Thread-9 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.0 seconds
[0m06:38:36.318438 [debug] [Thread-9 (]: Using vertica connection "model.adapter_methods.expected"
[0m06:38:36.318849 [debug] [Thread-9 (]: On model.adapter_methods.expected: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "test", "target_name": "default", "node_id": "model.adapter_methods.expected"} */
drop view if exists "VMart"."test16659887147621221146_test_basic"."expected__dbt_backup" cascade
[0m06:38:36.325046 [debug] [Thread-9 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m06:38:36.327035 [debug] [Thread-9 (]: finished collecting timing info
[0m06:38:36.327528 [debug] [Thread-9 (]: On model.adapter_methods.expected: Close
[0m06:38:36.328550 [info ] [Thread-9 (]: 3 of 3 OK created view model test16659887147621221146_test_basic.expected ...... [[32mCode: None, Rows: -1, Array Size: 1[0m in 0.07s]
[0m06:38:36.329411 [debug] [Thread-9 (]: Finished running node model.adapter_methods.expected
[0m06:38:36.331267 [debug] [MainThread]: Acquiring new vertica connection "master"
[0m06:38:36.331715 [debug] [MainThread]: Using vertica connection "master"
[0m06:38:36.332042 [debug] [MainThread]: On master: BEGIN
[0m06:38:36.332310 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:38:36.346553 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m06:38:36.351132 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m06:38:36.351658 [debug] [MainThread]: On master: COMMIT
[0m06:38:36.352058 [debug] [MainThread]: Using vertica connection "master"
[0m06:38:36.352356 [debug] [MainThread]: On master: COMMIT
[0m06:38:36.356835 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.0 seconds
[0m06:38:36.357236 [debug] [MainThread]: On master: Close
[0m06:38:36.357918 [info ] [MainThread]: 
[0m06:38:36.358447 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.62 seconds (0.62s).
[0m06:38:36.358859 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:38:36.359086 [debug] [MainThread]: Connection 'model.adapter_methods.upstream' was properly closed.
[0m06:38:36.359280 [debug] [MainThread]: Connection 'model.adapter_methods.model' was properly closed.
[0m06:38:36.359436 [debug] [MainThread]: Connection 'model.adapter_methods.expected' was properly closed.
[0m06:38:36.364518 [info ] [MainThread]: 
[0m06:38:36.364854 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:38:36.365104 [info ] [MainThread]: 
[0m06:38:36.365346 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m06:38:36.365765 [debug] [MainThread]: Flushing usage events
[0m06:38:36.366247 [debug] [MainThread]: Acquiring new vertica connection "_test"
[0m06:38:36.367613 [debug] [MainThread]: Using vertica connection "_test"
[0m06:38:36.367778 [debug] [MainThread]: On _test: BEGIN
[0m06:38:36.367883 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:38:36.381602 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m06:38:36.386085 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m06:38:36.386385 [debug] [MainThread]: Using vertica connection "_test"
[0m06:38:36.386522 [debug] [MainThread]: On _test: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "test", "target_name": "default", "connection_name": "_test"} */

    select
    column_name
    , data_type
    , character_maximum_length
    , numeric_precision
    , numeric_scale
    from (
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.columns
        where table_schema = 'test16659887147621221146_test_basic'
        and table_name = 'model'
        union all
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.view_columns
        where table_schema = 'test16659887147621221146_test_basic'
        and table_name = 'model'
    ) t
    order by ordinal_position
  
[0m06:38:36.413763 [debug] [MainThread]: SQL status: Code: [Column(name='column_name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='data_type', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='character_maximum_length', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_precision', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_scale', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.03 seconds
[0m06:38:36.416482 [debug] [MainThread]: Using vertica connection "_test"
[0m06:38:36.416921 [debug] [MainThread]: On _test: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "test", "target_name": "default", "connection_name": "_test"} */
with diff_count as (
    SELECT
        1 as id,
        COUNT(*) as num_missing FROM (
            (SELECT "id" FROM "VMart"."test16659887147621221146_test_basic"."model" EXCEPT
             SELECT "id" FROM "VMart"."test16659887147621221146_test_basic"."expected")
             UNION ALL
            (SELECT "id" FROM "VMart"."test16659887147621221146_test_basic"."expected" EXCEPT
             SELECT "id" FROM "VMart"."test16659887147621221146_test_basic"."model")
        ) as a
), table_a as (
    SELECT COUNT(*) as num_rows FROM "VMart"."test16659887147621221146_test_basic"."model"
), table_b as (
    SELECT COUNT(*) as num_rows FROM "VMart"."test16659887147621221146_test_basic"."expected"
), row_count_diff as (
    select
        1 as id,
        table_a.num_rows - table_b.num_rows as difference
    from table_a, table_b
)
select
    row_count_diff.difference as row_count_difference,
    diff_count.num_missing as num_mismatched
from row_count_diff
join diff_count using (id)
[0m06:38:36.446202 [debug] [MainThread]: SQL status: Code: [Column(name='row_count_difference', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='num_mismatched', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.03 seconds
[0m06:38:36.448541 [debug] [MainThread]: On _test: ROLLBACK
[0m06:38:36.453362 [debug] [MainThread]: On _test: Close
[0m06:38:36.455741 [debug] [MainThread]: Acquiring new vertica connection "_test"
[0m06:38:36.456414 [debug] [MainThread]: Dropping schema "_ReferenceKey(database='vmart', schema='test16659887147621221146_test_basic', identifier=None)".
[0m06:38:36.460065 [debug] [MainThread]: Using vertica connection "_test"
[0m06:38:36.460521 [debug] [MainThread]: On _test: BEGIN
[0m06:38:36.460848 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:38:36.475291 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m06:38:36.480490 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m06:38:36.480893 [debug] [MainThread]: Using vertica connection "_test"
[0m06:38:36.481175 [debug] [MainThread]: On _test: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "test", "target_name": "default", "connection_name": "_test"} */
drop schema if exists "test16659887147621221146_test_basic" cascade
  
[0m06:38:36.491685 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m06:38:36.492894 [debug] [MainThread]: On _test: COMMIT
[0m06:38:36.493124 [debug] [MainThread]: Using vertica connection "_test"
[0m06:38:36.493321 [debug] [MainThread]: On _test: COMMIT
[0m06:38:36.498163 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.0 seconds
[0m06:38:36.498531 [debug] [MainThread]: On _test: Close
[0m06:38:36.499337 [debug] [MainThread]: Connection '_test' was properly closed.
