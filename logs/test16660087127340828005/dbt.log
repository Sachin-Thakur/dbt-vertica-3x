[0m12:11:52.125914 [debug] [MainThread]: Acquiring new vertica connection "_test"
[0m12:11:52.126067 [debug] [MainThread]: Acquiring new vertica connection "_test"
[0m12:11:52.126252 [debug] [MainThread]: Creating schema "_ReferenceKey(database='vmart', schema='test16660087127340828005_test_basic', identifier=None)"
[0m12:11:52.127625 [debug] [MainThread]: Using vertica connection "_test"
[0m12:11:52.127784 [debug] [MainThread]: On _test: BEGIN
[0m12:11:52.127904 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:11:52.150495 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m12:11:52.156809 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.03 seconds
[0m12:11:52.157217 [debug] [MainThread]: Using vertica connection "_test"
[0m12:11:52.157456 [debug] [MainThread]: On _test: create schema if not exists "test16660087127340828005_test_basic"
  
[0m12:11:52.172172 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m12:11:52.174105 [debug] [MainThread]: On _test: COMMIT
[0m12:11:52.174530 [debug] [MainThread]: Using vertica connection "_test"
[0m12:11:52.174869 [debug] [MainThread]: On _test: COMMIT
[0m12:11:52.183206 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m12:11:52.183835 [debug] [MainThread]: On _test: Close
[0m12:11:52.199857 [debug] [MainThread]: Connection '_test' was properly closed.


============================== 2022-10-17 12:11:52.205948 | 4de170fd-2832-4a50-bda3-3df5939502aa ==============================
[0m12:11:52.205957 [info ] [MainThread]: Running with dbt=1.3.0
[0m12:11:52.206288 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/tmp/pytest-of-sachin/pytest-24/profile3', 'send_anonymous_usage_stats': False, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'parse_only': False, 'which': 'compile', 'rpc_method': 'compile', 'indirect_selection': 'eager'}
[0m12:11:52.206430 [debug] [MainThread]: Tracking: do not track
[0m12:11:52.213410 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
[0m12:11:52.221416 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m12:11:52.221644 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m12:11:52.221792 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m12:11:52.226396 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m12:11:52.227348 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m12:11:52.227981 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m12:11:52.230689 [debug] [MainThread]: Parsing macros/materializations/models/incremental/helpers.sql
[0m12:11:52.232624 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m12:11:52.236422 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m12:11:52.237371 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m12:11:52.241199 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m12:11:52.242524 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m12:11:52.249964 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m12:11:52.251129 [debug] [MainThread]: Parsing macros/materializations/snapshots/helper.sql
[0m12:11:52.251297 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m12:11:52.256704 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m12:11:52.260422 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m12:11:52.261044 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m12:11:52.261514 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m12:11:52.263515 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m12:11:52.265180 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m12:11:52.269485 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m12:11:52.270403 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m12:11:52.271128 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m12:11:52.272604 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m12:11:52.274945 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m12:11:52.275921 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m12:11:52.279451 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m12:11:52.280935 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m12:11:52.283039 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m12:11:52.292477 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m12:11:52.297585 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m12:11:52.298580 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m12:11:52.305012 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m12:11:52.309164 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m12:11:52.319483 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m12:11:52.321705 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m12:11:52.325106 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m12:11:52.333086 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m12:11:52.334161 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m12:11:52.341870 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m12:11:52.354086 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m12:11:52.355528 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m12:11:52.356775 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m12:11:52.359649 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m12:11:52.371813 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m12:11:52.376652 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m12:11:52.377766 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m12:11:52.378945 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m12:11:52.380602 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m12:11:52.381974 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m12:11:52.383823 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m12:11:52.390786 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m12:11:52.400608 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m12:11:52.405525 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m12:11:52.414410 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m12:11:52.415969 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m12:11:52.418384 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m12:11:52.421654 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m12:11:52.425861 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m12:11:52.426788 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m12:11:52.427541 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m12:11:52.428216 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m12:11:52.429112 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m12:11:52.430169 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m12:11:52.430864 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m12:11:52.431518 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m12:11:52.432238 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m12:11:52.433645 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m12:11:52.434272 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m12:11:52.435144 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m12:11:52.435938 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m12:11:52.440608 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m12:11:52.441367 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m12:11:52.442243 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m12:11:52.442961 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m12:11:52.443836 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m12:11:52.444565 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m12:11:52.446174 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m12:11:52.446843 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m12:11:52.447423 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m12:11:52.448191 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m12:11:52.448951 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m12:11:52.450285 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m12:11:52.451292 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m12:11:52.451923 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m12:11:52.452505 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m12:11:52.453344 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m12:11:52.456950 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m12:11:52.462460 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m12:11:52.688251 [debug] [MainThread]: 1699: static parser successfully parsed expected.sql
[0m12:11:52.690843 [debug] [MainThread]: 1699: static parser successfully parsed upstream.sql
[0m12:11:52.692954 [debug] [MainThread]: 1603: static parser failed on model.sql
[0m12:11:52.697760 [debug] [MainThread]: 1602: parser fallback to jinja rendering on model.sql
[0m12:11:52.734185 [info ] [MainThread]: Found 3 models, 1 test, 0 snapshots, 0 analyses, 296 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m12:11:52.735328 [info ] [MainThread]: 
[0m12:11:52.736167 [debug] [MainThread]: Acquiring new vertica connection "master"
[0m12:11:52.737073 [debug] [ThreadPool]: Acquiring new vertica connection "list_VMart_test16660087127340828005_test_basic"
[0m12:11:52.738786 [debug] [ThreadPool]: Using vertica connection "list_VMart_test16660087127340828005_test_basic"
[0m12:11:52.739044 [debug] [ThreadPool]: On list_VMart_test16660087127340828005_test_basic: BEGIN
[0m12:11:52.739184 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:11:52.796610 [debug] [ThreadPool]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m12:11:52.811969 [debug] [ThreadPool]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.07 seconds
[0m12:11:52.812229 [debug] [ThreadPool]: Using vertica connection "list_VMart_test16660087127340828005_test_basic"
[0m12:11:52.812353 [debug] [ThreadPool]: On list_VMart_test16660087127340828005_test_basic: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "list_VMart_test16660087127340828005_test_basic"} */
select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'table' as type
    from v_catalog.tables
    where table_schema ilike 'test16660087127340828005_test_basic'
    union all
    select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'view' as type
    from v_catalog.views
    where table_schema ilike 'test16660087127340828005_test_basic'
  
[0m12:11:52.855046 [debug] [ThreadPool]: SQL status: Code: [Column(name='database', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='schema', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='type', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.04 seconds
[0m12:11:52.856078 [debug] [ThreadPool]: On list_VMart_test16660087127340828005_test_basic: ROLLBACK
[0m12:11:52.863918 [debug] [ThreadPool]: On list_VMart_test16660087127340828005_test_basic: Close
[0m12:11:52.864917 [info ] [MainThread]: Concurrency: 4 threads (target='default')
[0m12:11:52.865245 [info ] [MainThread]: 
[0m12:11:52.866313 [debug] [Thread-50 ]: Began running node model.adapter_methods.upstream
[0m12:11:52.866718 [debug] [Thread-50 ]: Acquiring new vertica connection "model.adapter_methods.upstream"
[0m12:11:52.866872 [debug] [Thread-50 ]: Began compiling node model.adapter_methods.upstream
[0m12:11:52.866997 [debug] [Thread-50 ]: Compiling model.adapter_methods.upstream
[0m12:11:52.868342 [debug] [Thread-50 ]: Writing injected SQL for node "model.adapter_methods.upstream"
[0m12:11:52.868700 [debug] [Thread-50 ]: finished collecting timing info
[0m12:11:52.868924 [debug] [Thread-50 ]: Began executing node model.adapter_methods.upstream
[0m12:11:52.869053 [debug] [Thread-50 ]: finished collecting timing info
[0m12:11:52.869467 [debug] [Thread-50 ]: Finished running node model.adapter_methods.upstream
[0m12:11:52.869852 [debug] [Thread-52 ]: Began running node model.adapter_methods.model
[0m12:11:52.870249 [debug] [Thread-52 ]: Acquiring new vertica connection "model.adapter_methods.model"
[0m12:11:52.870384 [debug] [Thread-52 ]: Began compiling node model.adapter_methods.model
[0m12:11:52.870499 [debug] [Thread-52 ]: Compiling model.adapter_methods.model
[0m12:11:52.874702 [debug] [Thread-52 ]: Dropping schema "_ReferenceKey(database='vmart', schema='test16660087127340828005_test_basic', identifier=None)".
[0m12:11:52.876188 [debug] [Thread-52 ]: Using vertica connection "model.adapter_methods.model"
[0m12:11:52.876350 [debug] [Thread-52 ]: On model.adapter_methods.model: BEGIN
[0m12:11:52.876459 [debug] [Thread-52 ]: Opening a new connection, currently in state init
[0m12:11:52.902105 [debug] [Thread-52 ]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m12:11:52.918129 [debug] [Thread-52 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.04 seconds
[0m12:11:52.918536 [debug] [Thread-52 ]: Using vertica connection "model.adapter_methods.model"
[0m12:11:52.918762 [debug] [Thread-52 ]: On model.adapter_methods.model: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.adapter_methods.model"} */
drop schema if exists "test16660087127340828005_test_basic" cascade
  
[0m12:11:52.933424 [debug] [Thread-52 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m12:11:52.934655 [debug] [Thread-52 ]: On model.adapter_methods.model: COMMIT
[0m12:11:52.934956 [debug] [Thread-52 ]: Using vertica connection "model.adapter_methods.model"
[0m12:11:52.935170 [debug] [Thread-52 ]: On model.adapter_methods.model: COMMIT
[0m12:11:52.942666 [debug] [Thread-52 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m12:11:52.943111 [debug] [Thread-52 ]: On "model.adapter_methods.model": cache miss for schema "{self.database}.{self.schema}", this is inefficient
[0m12:11:52.945672 [debug] [Thread-52 ]: Using vertica connection "model.adapter_methods.model"
[0m12:11:52.945945 [debug] [Thread-52 ]: On model.adapter_methods.model: BEGIN
[0m12:11:52.953773 [debug] [Thread-52 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m12:11:52.954150 [debug] [Thread-52 ]: Using vertica connection "model.adapter_methods.model"
[0m12:11:52.954357 [debug] [Thread-52 ]: On model.adapter_methods.model: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.adapter_methods.model"} */
select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'table' as type
    from v_catalog.tables
    where table_schema ilike 'test16660087127340828005_test_basic'
    union all
    select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'view' as type
    from v_catalog.views
    where table_schema ilike 'test16660087127340828005_test_basic'
  
[0m12:11:52.975961 [debug] [Thread-52 ]: SQL status: Code: [Column(name='database', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='schema', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='type', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.02 seconds
[0m12:11:52.977413 [debug] [Thread-52 ]: with database=VMart, schema=test16660087127340828005_test_basic, relations=[]
[0m12:11:52.977765 [debug] [Thread-52 ]: Creating schema "_ReferenceKey(database='vmart', schema='test16660087127340828005_test_basic', identifier=None)"
[0m12:11:52.980258 [debug] [Thread-52 ]: Using vertica connection "model.adapter_methods.model"
[0m12:11:52.980485 [debug] [Thread-52 ]: On model.adapter_methods.model: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.adapter_methods.model"} */
create schema if not exists "test16660087127340828005_test_basic"
  
[0m12:11:52.993453 [debug] [Thread-52 ]: SQL status: Code: [Column(name='database', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='schema', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='type', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.01 seconds
[0m12:11:52.994658 [debug] [Thread-52 ]: On model.adapter_methods.model: COMMIT
[0m12:11:52.994980 [debug] [Thread-52 ]: Using vertica connection "model.adapter_methods.model"
[0m12:11:52.995168 [debug] [Thread-52 ]: On model.adapter_methods.model: COMMIT
[0m12:11:53.002308 [debug] [Thread-52 ]: SQL status: Code: [Column(name='database', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='schema', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='type', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.01 seconds
[0m12:11:53.004705 [debug] [Thread-52 ]: Using vertica connection "model.adapter_methods.model"
[0m12:11:53.004928 [debug] [Thread-52 ]: On model.adapter_methods.model: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.adapter_methods.model"} */

    
  create view "VMart"."test16660087127340828005_test_basic"."upstream" as (
    select 2 as id
  );
  
[0m12:11:53.017687 [debug] [Thread-52 ]: SQL status: Code: [Column(name='database', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='schema', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='type', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.01 seconds
[0m12:11:53.019278 [debug] [Thread-52 ]: Writing injected SQL for node "model.adapter_methods.model"
[0m12:11:53.019704 [debug] [Thread-52 ]: finished collecting timing info
[0m12:11:53.019973 [debug] [Thread-52 ]: Began executing node model.adapter_methods.model
[0m12:11:53.020187 [debug] [Thread-52 ]: finished collecting timing info
[0m12:11:53.020403 [debug] [Thread-52 ]: On model.adapter_methods.model: Close
[0m12:11:53.021373 [debug] [Thread-52 ]: Finished running node model.adapter_methods.model
[0m12:11:53.022142 [debug] [Thread-51 ]: Began running node model.adapter_methods.expected
[0m12:11:53.022370 [debug] [Thread-50 ]: Began running node test.adapter_methods.get_columns_in_relation
[0m12:11:53.023032 [debug] [Thread-51 ]: Acquiring new vertica connection "model.adapter_methods.expected"
[0m12:11:53.023537 [debug] [Thread-50 ]: Acquiring new vertica connection "test.adapter_methods.get_columns_in_relation"
[0m12:11:53.023746 [debug] [Thread-51 ]: Began compiling node model.adapter_methods.expected
[0m12:11:53.023914 [debug] [Thread-50 ]: Began compiling node test.adapter_methods.get_columns_in_relation
[0m12:11:53.024087 [debug] [Thread-51 ]: Compiling model.adapter_methods.expected
[0m12:11:53.024230 [debug] [Thread-50 ]: Compiling test.adapter_methods.get_columns_in_relation
[0m12:11:53.026516 [debug] [Thread-51 ]: Writing injected SQL for node "model.adapter_methods.expected"
[0m12:11:53.035580 [debug] [Thread-50 ]: Using vertica connection "test.adapter_methods.get_columns_in_relation"
[0m12:11:53.036061 [debug] [Thread-50 ]: On test.adapter_methods.get_columns_in_relation: BEGIN
[0m12:11:53.036321 [debug] [Thread-50 ]: Opening a new connection, currently in state closed
[0m12:11:53.036517 [debug] [Thread-51 ]: finished collecting timing info
[0m12:11:53.037180 [debug] [Thread-51 ]: Began executing node model.adapter_methods.expected
[0m12:11:53.037362 [debug] [Thread-51 ]: finished collecting timing info
[0m12:11:53.037862 [debug] [Thread-51 ]: Finished running node model.adapter_methods.expected
[0m12:11:53.055739 [debug] [Thread-50 ]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m12:11:53.062259 [debug] [Thread-50 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.03 seconds
[0m12:11:53.062908 [debug] [Thread-50 ]: Using vertica connection "test.adapter_methods.get_columns_in_relation"
[0m12:11:53.063210 [debug] [Thread-50 ]: On test.adapter_methods.get_columns_in_relation: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "test.adapter_methods.get_columns_in_relation"} */

    select
    column_name
    , data_type
    , character_maximum_length
    , numeric_precision
    , numeric_scale
    from (
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.columns
        where table_schema = 'test16660087127340828005_test_basic'
        and table_name = 'model'
        union all
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.view_columns
        where table_schema = 'test16660087127340828005_test_basic'
        and table_name = 'model'
    ) t
    order by ordinal_position
  
[0m12:11:53.092203 [debug] [Thread-50 ]: SQL status: Code: [Column(name='column_name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='data_type', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='character_maximum_length', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_precision', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_scale', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.03 seconds
[0m12:11:53.094835 [debug] [Thread-50 ]: Writing injected SQL for node "test.adapter_methods.get_columns_in_relation"
[0m12:11:53.095173 [debug] [Thread-50 ]: finished collecting timing info
[0m12:11:53.095333 [debug] [Thread-50 ]: Began executing node test.adapter_methods.get_columns_in_relation
[0m12:11:53.095458 [debug] [Thread-50 ]: finished collecting timing info
[0m12:11:53.095593 [debug] [Thread-50 ]: On test.adapter_methods.get_columns_in_relation: ROLLBACK
[0m12:11:53.104398 [debug] [Thread-50 ]: On test.adapter_methods.get_columns_in_relation: Close
[0m12:11:53.105363 [debug] [Thread-50 ]: Finished running node test.adapter_methods.get_columns_in_relation
[0m12:11:53.106312 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:11:53.106554 [debug] [MainThread]: Connection 'test.adapter_methods.get_columns_in_relation' was properly closed.
[0m12:11:53.106676 [debug] [MainThread]: Connection 'model.adapter_methods.model' was properly closed.
[0m12:11:53.106794 [debug] [MainThread]: Connection 'model.adapter_methods.expected' was properly closed.
[0m12:11:53.111883 [info ] [MainThread]: Done.
[0m12:11:53.112267 [debug] [MainThread]: Flushing usage events


============================== 2022-10-17 12:11:53.125603 | 4de170fd-2832-4a50-bda3-3df5939502aa ==============================
[0m12:11:53.125618 [info ] [MainThread]: Running with dbt=1.3.0
[0m12:11:53.126060 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/tmp/pytest-of-sachin/pytest-24/profile3', 'send_anonymous_usage_stats': False, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:11:53.126240 [debug] [MainThread]: Tracking: do not track
[0m12:11:53.149288 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:11:53.149524 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:11:53.158959 [info ] [MainThread]: Found 3 models, 1 test, 0 snapshots, 0 analyses, 296 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m12:11:53.159740 [info ] [MainThread]: 
[0m12:11:53.160308 [debug] [MainThread]: Acquiring new vertica connection "master"
[0m12:11:53.161115 [debug] [ThreadPool]: Acquiring new vertica connection "list_VMart"
[0m12:11:53.162710 [debug] [ThreadPool]: Using vertica connection "list_VMart"
[0m12:11:53.162876 [debug] [ThreadPool]: On list_VMart: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "list_VMart"} */

    select schema_name
    from v_catalog.schemata
  
[0m12:11:53.162987 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:11:53.190742 [debug] [ThreadPool]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m12:11:53.205460 [debug] [ThreadPool]: SQL status: Code: [Column(name='schema_name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.04 seconds
[0m12:11:53.207317 [debug] [ThreadPool]: On list_VMart: Close
[0m12:11:53.208746 [debug] [ThreadPool]: Acquiring new vertica connection "list_VMart_test16660087127340828005_test_basic"
[0m12:11:53.210400 [debug] [ThreadPool]: Using vertica connection "list_VMart_test16660087127340828005_test_basic"
[0m12:11:53.210576 [debug] [ThreadPool]: On list_VMart_test16660087127340828005_test_basic: BEGIN
[0m12:11:53.210691 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:11:53.231643 [debug] [ThreadPool]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m12:11:53.236960 [debug] [ThreadPool]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.03 seconds
[0m12:11:53.237246 [debug] [ThreadPool]: Using vertica connection "list_VMart_test16660087127340828005_test_basic"
[0m12:11:53.237395 [debug] [ThreadPool]: On list_VMart_test16660087127340828005_test_basic: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "list_VMart_test16660087127340828005_test_basic"} */
select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'table' as type
    from v_catalog.tables
    where table_schema ilike 'test16660087127340828005_test_basic'
    union all
    select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'view' as type
    from v_catalog.views
    where table_schema ilike 'test16660087127340828005_test_basic'
  
[0m12:11:53.255002 [debug] [ThreadPool]: SQL status: Code: [Column(name='database', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='schema', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='type', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.02 seconds
[0m12:11:53.257150 [debug] [ThreadPool]: On list_VMart_test16660087127340828005_test_basic: ROLLBACK
[0m12:11:53.265110 [debug] [ThreadPool]: On list_VMart_test16660087127340828005_test_basic: Close
[0m12:11:53.266013 [debug] [MainThread]: Using vertica connection "master"
[0m12:11:53.266366 [debug] [MainThread]: On master: BEGIN
[0m12:11:53.266583 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:11:53.285275 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m12:11:53.290464 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m12:11:53.290727 [debug] [MainThread]: On master: COMMIT
[0m12:11:53.290845 [debug] [MainThread]: Using vertica connection "master"
[0m12:11:53.290950 [debug] [MainThread]: On master: COMMIT
[0m12:11:53.297339 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m12:11:53.297539 [debug] [MainThread]: On master: Close
[0m12:11:53.298053 [info ] [MainThread]: Concurrency: 4 threads (target='default')
[0m12:11:53.298330 [info ] [MainThread]: 
[0m12:11:53.299364 [debug] [Thread-57 ]: Began running node model.adapter_methods.upstream
[0m12:11:53.299648 [info ] [Thread-57 ]: 1 of 3 START sql view model test16660087127340828005_test_basic.upstream ....... [RUN]
[0m12:11:53.300179 [debug] [Thread-57 ]: Acquiring new vertica connection "model.adapter_methods.upstream"
[0m12:11:53.300324 [debug] [Thread-57 ]: Began compiling node model.adapter_methods.upstream
[0m12:11:53.300441 [debug] [Thread-57 ]: Compiling model.adapter_methods.upstream
[0m12:11:53.301714 [debug] [Thread-57 ]: Writing injected SQL for node "model.adapter_methods.upstream"
[0m12:11:53.302015 [debug] [Thread-57 ]: finished collecting timing info
[0m12:11:53.302157 [debug] [Thread-57 ]: Began executing node model.adapter_methods.upstream
[0m12:11:53.305136 [debug] [Thread-57 ]: Writing runtime sql for node "model.adapter_methods.upstream"
[0m12:11:53.305547 [debug] [Thread-57 ]: Using vertica connection "model.adapter_methods.upstream"
[0m12:11:53.305685 [debug] [Thread-57 ]: On model.adapter_methods.upstream: BEGIN
[0m12:11:53.305790 [debug] [Thread-57 ]: Opening a new connection, currently in state closed
[0m12:11:53.326507 [debug] [Thread-57 ]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m12:11:53.332334 [debug] [Thread-57 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.03 seconds
[0m12:11:53.332871 [debug] [Thread-57 ]: Using vertica connection "model.adapter_methods.upstream"
[0m12:11:53.333192 [debug] [Thread-57 ]: On model.adapter_methods.upstream: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.adapter_methods.upstream"} */

  create view "VMart"."test16660087127340828005_test_basic"."upstream__dbt_tmp" as (
    select 1 as id
  );
[0m12:11:53.344551 [debug] [Thread-57 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m12:11:53.350290 [debug] [Thread-57 ]: Using vertica connection "model.adapter_methods.upstream"
[0m12:11:53.350761 [debug] [Thread-57 ]: On model.adapter_methods.upstream: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.adapter_methods.upstream"} */
alter view "VMart"."test16660087127340828005_test_basic"."upstream" rename to "upstream__dbt_backup"
[0m12:11:53.363707 [debug] [Thread-57 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m12:11:53.369131 [debug] [Thread-57 ]: Using vertica connection "model.adapter_methods.upstream"
[0m12:11:53.369623 [debug] [Thread-57 ]: On model.adapter_methods.upstream: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.adapter_methods.upstream"} */
alter view "VMart"."test16660087127340828005_test_basic"."upstream__dbt_tmp" rename to "upstream"
[0m12:11:53.381691 [debug] [Thread-57 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m12:11:53.391338 [debug] [Thread-57 ]: On model.adapter_methods.upstream: COMMIT
[0m12:11:53.391753 [debug] [Thread-57 ]: Using vertica connection "model.adapter_methods.upstream"
[0m12:11:53.392034 [debug] [Thread-57 ]: On model.adapter_methods.upstream: COMMIT
[0m12:11:53.400702 [debug] [Thread-57 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m12:11:53.405000 [debug] [Thread-57 ]: Using vertica connection "model.adapter_methods.upstream"
[0m12:11:53.405462 [debug] [Thread-57 ]: On model.adapter_methods.upstream: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.adapter_methods.upstream"} */
drop view if exists "VMart"."test16660087127340828005_test_basic"."upstream__dbt_backup" cascade
[0m12:11:53.417874 [debug] [Thread-57 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m12:11:53.420367 [debug] [Thread-57 ]: finished collecting timing info
[0m12:11:53.420843 [debug] [Thread-57 ]: On model.adapter_methods.upstream: Close
[0m12:11:53.422217 [info ] [Thread-57 ]: 1 of 3 OK created sql view model test16660087127340828005_test_basic.upstream .. [[32mCode: None, Rows: -1, Array Size: 1[0m in 0.12s]
[0m12:11:53.423115 [debug] [Thread-57 ]: Finished running node model.adapter_methods.upstream
[0m12:11:53.424119 [debug] [Thread-59 ]: Began running node model.adapter_methods.model
[0m12:11:53.425066 [info ] [Thread-59 ]: 2 of 3 START sql view model test16660087127340828005_test_basic.model .......... [RUN]
[0m12:11:53.426373 [debug] [Thread-59 ]: Acquiring new vertica connection "model.adapter_methods.model"
[0m12:11:53.426748 [debug] [Thread-59 ]: Began compiling node model.adapter_methods.model
[0m12:11:53.427074 [debug] [Thread-59 ]: Compiling model.adapter_methods.model
[0m12:11:53.438605 [debug] [Thread-59 ]: Dropping schema "_ReferenceKey(database='vmart', schema='test16660087127340828005_test_basic', identifier=None)".
[0m12:11:53.441640 [debug] [Thread-59 ]: Using vertica connection "model.adapter_methods.model"
[0m12:11:53.441936 [debug] [Thread-59 ]: On model.adapter_methods.model: BEGIN
[0m12:11:53.442152 [debug] [Thread-59 ]: Opening a new connection, currently in state init
[0m12:11:53.458837 [debug] [Thread-59 ]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m12:11:53.466486 [debug] [Thread-59 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m12:11:53.467051 [debug] [Thread-59 ]: Using vertica connection "model.adapter_methods.model"
[0m12:11:53.467386 [debug] [Thread-59 ]: On model.adapter_methods.model: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.adapter_methods.model"} */
drop schema if exists "test16660087127340828005_test_basic" cascade
  
[0m12:11:53.480360 [debug] [Thread-59 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m12:11:53.482107 [debug] [Thread-59 ]: On model.adapter_methods.model: COMMIT
[0m12:11:53.482591 [debug] [Thread-59 ]: Using vertica connection "model.adapter_methods.model"
[0m12:11:53.482906 [debug] [Thread-59 ]: On model.adapter_methods.model: COMMIT
[0m12:11:53.489861 [debug] [Thread-59 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m12:11:53.490434 [debug] [Thread-59 ]: On "model.adapter_methods.model": cache miss for schema "{self.database}.{self.schema}", this is inefficient
[0m12:11:53.493387 [debug] [Thread-59 ]: Using vertica connection "model.adapter_methods.model"
[0m12:11:53.493649 [debug] [Thread-59 ]: On model.adapter_methods.model: BEGIN
[0m12:11:53.501797 [debug] [Thread-59 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m12:11:53.502054 [debug] [Thread-59 ]: Using vertica connection "model.adapter_methods.model"
[0m12:11:53.502219 [debug] [Thread-59 ]: On model.adapter_methods.model: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.adapter_methods.model"} */
select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'table' as type
    from v_catalog.tables
    where table_schema ilike 'test16660087127340828005_test_basic'
    union all
    select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'view' as type
    from v_catalog.views
    where table_schema ilike 'test16660087127340828005_test_basic'
  
[0m12:11:53.523468 [debug] [Thread-59 ]: SQL status: Code: [Column(name='database', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='schema', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='type', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.02 seconds
[0m12:11:53.524441 [debug] [Thread-59 ]: with database=VMart, schema=test16660087127340828005_test_basic, relations=[]
[0m12:11:53.524671 [debug] [Thread-59 ]: Creating schema "_ReferenceKey(database='vmart', schema='test16660087127340828005_test_basic', identifier=None)"
[0m12:11:53.526909 [debug] [Thread-59 ]: Using vertica connection "model.adapter_methods.model"
[0m12:11:53.527062 [debug] [Thread-59 ]: On model.adapter_methods.model: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.adapter_methods.model"} */
create schema if not exists "test16660087127340828005_test_basic"
  
[0m12:11:53.539299 [debug] [Thread-59 ]: SQL status: Code: [Column(name='database', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='schema', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='type', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.01 seconds
[0m12:11:53.540078 [debug] [Thread-59 ]: On model.adapter_methods.model: COMMIT
[0m12:11:53.540256 [debug] [Thread-59 ]: Using vertica connection "model.adapter_methods.model"
[0m12:11:53.540369 [debug] [Thread-59 ]: On model.adapter_methods.model: COMMIT
[0m12:11:53.548712 [debug] [Thread-59 ]: SQL status: Code: [Column(name='database', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='schema', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='type', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.01 seconds
[0m12:11:53.549428 [debug] [Thread-59 ]: Using vertica connection "model.adapter_methods.model"
[0m12:11:53.549569 [debug] [Thread-59 ]: On model.adapter_methods.model: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.adapter_methods.model"} */

    
  create view "VMart"."test16660087127340828005_test_basic"."upstream" as (
    select 2 as id
  );
  
[0m12:11:53.563610 [debug] [Thread-59 ]: SQL status: Code: [Column(name='database', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='schema', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='type', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.01 seconds
[0m12:11:53.564768 [debug] [Thread-59 ]: Writing injected SQL for node "model.adapter_methods.model"
[0m12:11:53.565143 [debug] [Thread-59 ]: finished collecting timing info
[0m12:11:53.565317 [debug] [Thread-59 ]: Began executing node model.adapter_methods.model
[0m12:11:53.566766 [debug] [Thread-59 ]: On "model.adapter_methods.model": cache miss for schema "{self.database}.{self.schema}", this is inefficient
[0m12:11:53.568052 [debug] [Thread-59 ]: Using vertica connection "model.adapter_methods.model"
[0m12:11:53.568203 [debug] [Thread-59 ]: On model.adapter_methods.model: BEGIN
[0m12:11:53.577750 [debug] [Thread-59 ]: SQL status: Code: [Column(name='database', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='schema', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='type', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.01 seconds
[0m12:11:53.577999 [debug] [Thread-59 ]: Using vertica connection "model.adapter_methods.model"
[0m12:11:53.578113 [debug] [Thread-59 ]: On model.adapter_methods.model: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.adapter_methods.model"} */
select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'table' as type
    from v_catalog.tables
    where table_schema ilike 'test16660087127340828005_test_basic'
    union all
    select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'view' as type
    from v_catalog.views
    where table_schema ilike 'test16660087127340828005_test_basic'
  
[0m12:11:53.614209 [debug] [Thread-59 ]: SQL status: Code: [Column(name='database', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='schema', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='type', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.04 seconds
[0m12:11:53.616227 [debug] [Thread-59 ]: with database=VMart, schema=test16660087127340828005_test_basic, relations=[_ReferenceKey(database='vmart', schema='test16660087127340828005_test_basic', identifier='upstream')]
[0m12:11:53.618012 [debug] [Thread-59 ]: On "model.adapter_methods.model": cache miss for schema "{self.database}.{self.schema}", this is inefficient
[0m12:11:53.621657 [debug] [Thread-59 ]: Using vertica connection "model.adapter_methods.model"
[0m12:11:53.622094 [debug] [Thread-59 ]: On model.adapter_methods.model: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.adapter_methods.model"} */
select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'table' as type
    from v_catalog.tables
    where table_schema ilike 'test16660087127340828005_test_basic'
    union all
    select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'view' as type
    from v_catalog.views
    where table_schema ilike 'test16660087127340828005_test_basic'
  
[0m12:11:53.651803 [debug] [Thread-59 ]: SQL status: Code: [Column(name='database', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='schema', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='type', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.03 seconds
[0m12:11:53.654142 [debug] [Thread-59 ]: with database=VMart, schema=test16660087127340828005_test_basic, relations=[_ReferenceKey(database='vmart', schema='test16660087127340828005_test_basic', identifier='upstream')]
[0m12:11:53.655949 [debug] [Thread-59 ]: On "model.adapter_methods.model": cache miss for schema "{self.database}.{self.schema}", this is inefficient
[0m12:11:53.659825 [debug] [Thread-59 ]: Using vertica connection "model.adapter_methods.model"
[0m12:11:53.660219 [debug] [Thread-59 ]: On model.adapter_methods.model: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.adapter_methods.model"} */
select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'table' as type
    from v_catalog.tables
    where table_schema ilike 'test16660087127340828005_test_basic'
    union all
    select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'view' as type
    from v_catalog.views
    where table_schema ilike 'test16660087127340828005_test_basic'
  
[0m12:11:53.678769 [debug] [Thread-59 ]: SQL status: Code: [Column(name='database', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='schema', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='type', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.02 seconds
[0m12:11:53.680840 [debug] [Thread-59 ]: with database=VMart, schema=test16660087127340828005_test_basic, relations=[_ReferenceKey(database='vmart', schema='test16660087127340828005_test_basic', identifier='upstream')]
[0m12:11:53.683969 [debug] [Thread-59 ]: Writing runtime sql for node "model.adapter_methods.model"
[0m12:11:53.684510 [debug] [Thread-59 ]: Using vertica connection "model.adapter_methods.model"
[0m12:11:53.684765 [debug] [Thread-59 ]: On model.adapter_methods.model: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.adapter_methods.model"} */

  create view "VMart"."test16660087127340828005_test_basic"."model__dbt_tmp" as (
    


    
    
    



select * from "VMart"."test16660087127340828005_test_basic"."upstream"
  );
[0m12:11:53.699657 [debug] [Thread-59 ]: SQL status: Code: [Column(name='database', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='schema', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='type', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.01 seconds
[0m12:11:53.705010 [debug] [Thread-59 ]: Using vertica connection "model.adapter_methods.model"
[0m12:11:53.705418 [debug] [Thread-59 ]: On model.adapter_methods.model: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.adapter_methods.model"} */
alter view "VMart"."test16660087127340828005_test_basic"."model__dbt_tmp" rename to "model"
[0m12:11:53.727414 [debug] [Thread-59 ]: SQL status: Code: [Column(name='database', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='schema', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='type', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.02 seconds
[0m12:11:53.731174 [debug] [Thread-59 ]: On model.adapter_methods.model: COMMIT
[0m12:11:53.731752 [debug] [Thread-59 ]: Using vertica connection "model.adapter_methods.model"
[0m12:11:53.732297 [debug] [Thread-59 ]: On model.adapter_methods.model: COMMIT
[0m12:11:53.747144 [debug] [Thread-59 ]: SQL status: Code: [Column(name='database', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='schema', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='type', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.01 seconds
[0m12:11:53.752090 [debug] [Thread-59 ]: Using vertica connection "model.adapter_methods.model"
[0m12:11:53.752584 [debug] [Thread-59 ]: On model.adapter_methods.model: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.adapter_methods.model"} */
drop view if exists "VMart"."test16660087127340828005_test_basic"."model__dbt_backup" cascade
[0m12:11:53.765003 [debug] [Thread-59 ]: SQL status: Code: [Column(name='database', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='schema', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='type', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.01 seconds
[0m12:11:53.767713 [debug] [Thread-59 ]: finished collecting timing info
[0m12:11:53.768333 [debug] [Thread-59 ]: On model.adapter_methods.model: Close
[0m12:11:53.769724 [info ] [Thread-59 ]: 2 of 3 OK created sql view model test16660087127340828005_test_basic.model ..... [[32mCode: [Column(name='database', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='schema', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='type', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1[0m in 0.34s]
[0m12:11:53.770654 [debug] [Thread-59 ]: Finished running node model.adapter_methods.model
[0m12:11:53.771871 [debug] [Thread-58 ]: Began running node model.adapter_methods.expected
[0m12:11:53.772513 [info ] [Thread-58 ]: 3 of 3 START sql view model test16660087127340828005_test_basic.expected ....... [RUN]
[0m12:11:53.773771 [debug] [Thread-58 ]: Acquiring new vertica connection "model.adapter_methods.expected"
[0m12:11:53.774135 [debug] [Thread-58 ]: Began compiling node model.adapter_methods.expected
[0m12:11:53.774466 [debug] [Thread-58 ]: Compiling model.adapter_methods.expected
[0m12:11:53.779766 [debug] [Thread-58 ]: Writing injected SQL for node "model.adapter_methods.expected"
[0m12:11:53.780476 [debug] [Thread-58 ]: finished collecting timing info
[0m12:11:53.780881 [debug] [Thread-58 ]: Began executing node model.adapter_methods.expected
[0m12:11:53.786546 [debug] [Thread-58 ]: Writing runtime sql for node "model.adapter_methods.expected"
[0m12:11:53.787036 [debug] [Thread-58 ]: Using vertica connection "model.adapter_methods.expected"
[0m12:11:53.787254 [debug] [Thread-58 ]: On model.adapter_methods.expected: BEGIN
[0m12:11:53.787383 [debug] [Thread-58 ]: Opening a new connection, currently in state init
[0m12:11:53.853705 [debug] [Thread-58 ]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m12:11:53.866439 [debug] [Thread-58 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.08 seconds
[0m12:11:53.866964 [debug] [Thread-58 ]: Using vertica connection "model.adapter_methods.expected"
[0m12:11:53.867318 [debug] [Thread-58 ]: On model.adapter_methods.expected: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.adapter_methods.expected"} */

  create view "VMart"."test16660087127340828005_test_basic"."expected__dbt_tmp" as (
    -- make sure this runs after 'model'
-- "VMart"."test16660087127340828005_test_basic"."model"
select 2 as id
  );
[0m12:11:53.884519 [debug] [Thread-58 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m12:11:53.889987 [debug] [Thread-58 ]: Using vertica connection "model.adapter_methods.expected"
[0m12:11:53.890526 [debug] [Thread-58 ]: On model.adapter_methods.expected: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.adapter_methods.expected"} */
alter view "VMart"."test16660087127340828005_test_basic"."expected__dbt_tmp" rename to "expected"
[0m12:11:53.904794 [debug] [Thread-58 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m12:11:53.908369 [debug] [Thread-58 ]: On model.adapter_methods.expected: COMMIT
[0m12:11:53.908843 [debug] [Thread-58 ]: Using vertica connection "model.adapter_methods.expected"
[0m12:11:53.909189 [debug] [Thread-58 ]: On model.adapter_methods.expected: COMMIT
[0m12:11:53.922820 [debug] [Thread-58 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m12:11:53.929523 [debug] [Thread-58 ]: Using vertica connection "model.adapter_methods.expected"
[0m12:11:53.929966 [debug] [Thread-58 ]: On model.adapter_methods.expected: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.adapter_methods.expected"} */
drop view if exists "VMart"."test16660087127340828005_test_basic"."expected__dbt_backup" cascade
[0m12:11:53.938717 [debug] [Thread-58 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m12:11:53.941199 [debug] [Thread-58 ]: finished collecting timing info
[0m12:11:53.941660 [debug] [Thread-58 ]: On model.adapter_methods.expected: Close
[0m12:11:53.942912 [info ] [Thread-58 ]: 3 of 3 OK created sql view model test16660087127340828005_test_basic.expected .. [[32mCode: None, Rows: -1, Array Size: 1[0m in 0.17s]
[0m12:11:53.943753 [debug] [Thread-58 ]: Finished running node model.adapter_methods.expected
[0m12:11:53.945826 [debug] [MainThread]: Acquiring new vertica connection "master"
[0m12:11:53.946146 [debug] [MainThread]: Using vertica connection "master"
[0m12:11:53.946369 [debug] [MainThread]: On master: BEGIN
[0m12:11:53.946580 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:11:53.965174 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m12:11:53.970886 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m12:11:53.971394 [debug] [MainThread]: On master: COMMIT
[0m12:11:53.971756 [debug] [MainThread]: Using vertica connection "master"
[0m12:11:53.972061 [debug] [MainThread]: On master: COMMIT
[0m12:11:53.977050 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.0 seconds
[0m12:11:53.977563 [debug] [MainThread]: On master: Close
[0m12:11:53.978756 [info ] [MainThread]: 
[0m12:11:53.979504 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.82 seconds (0.82s).
[0m12:11:53.980112 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:11:53.980416 [debug] [MainThread]: Connection 'model.adapter_methods.upstream' was properly closed.
[0m12:11:53.980802 [debug] [MainThread]: Connection 'model.adapter_methods.model' was properly closed.
[0m12:11:53.981112 [debug] [MainThread]: Connection 'model.adapter_methods.expected' was properly closed.
[0m12:11:53.991402 [info ] [MainThread]: 
[0m12:11:53.991949 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:11:53.992276 [info ] [MainThread]: 
[0m12:11:53.992541 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m12:11:53.992885 [debug] [MainThread]: Flushing usage events
[0m12:11:53.993652 [debug] [MainThread]: Acquiring new vertica connection "_test"
[0m12:11:53.995675 [debug] [MainThread]: Using vertica connection "_test"
[0m12:11:53.995887 [debug] [MainThread]: On _test: BEGIN
[0m12:11:53.996004 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:11:54.014052 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m12:11:54.020610 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m12:11:54.020908 [debug] [MainThread]: Using vertica connection "_test"
[0m12:11:54.021047 [debug] [MainThread]: On _test: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "_test"} */

    select
    column_name
    , data_type
    , character_maximum_length
    , numeric_precision
    , numeric_scale
    from (
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.columns
        where table_schema = 'test16660087127340828005_test_basic'
        and table_name = 'model'
        union all
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.view_columns
        where table_schema = 'test16660087127340828005_test_basic'
        and table_name = 'model'
    ) t
    order by ordinal_position
  
[0m12:11:54.058454 [debug] [MainThread]: SQL status: Code: [Column(name='column_name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='data_type', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='character_maximum_length', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_precision', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_scale', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.04 seconds
[0m12:11:54.059887 [debug] [MainThread]: Using vertica connection "_test"
[0m12:11:54.060119 [debug] [MainThread]: On _test: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "_test"} */
with diff_count as (
    SELECT
        1 as id,
        COUNT(*) as num_missing FROM (
            (SELECT "id" FROM "VMart"."test16660087127340828005_test_basic"."model" EXCEPT
             SELECT "id" FROM "VMart"."test16660087127340828005_test_basic"."expected")
             UNION ALL
            (SELECT "id" FROM "VMart"."test16660087127340828005_test_basic"."expected" EXCEPT
             SELECT "id" FROM "VMart"."test16660087127340828005_test_basic"."model")
        ) as a
), table_a as (
    SELECT COUNT(*) as num_rows FROM "VMart"."test16660087127340828005_test_basic"."model"
), table_b as (
    SELECT COUNT(*) as num_rows FROM "VMart"."test16660087127340828005_test_basic"."expected"
), row_count_diff as (
    select
        1 as id,
        table_a.num_rows - table_b.num_rows as difference
    from table_a, table_b
)
select
    row_count_diff.difference as row_count_difference,
    diff_count.num_missing as num_mismatched
from row_count_diff
join diff_count using (id)
[0m12:11:54.099378 [debug] [MainThread]: SQL status: Code: [Column(name='row_count_difference', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='num_mismatched', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.04 seconds
[0m12:11:54.101728 [debug] [MainThread]: On _test: ROLLBACK
[0m12:11:54.112620 [debug] [MainThread]: On _test: Close
[0m12:11:54.115507 [debug] [MainThread]: Acquiring new vertica connection "_test"
[0m12:11:54.116195 [debug] [MainThread]: Dropping schema "_ReferenceKey(database='vmart', schema='test16660087127340828005_test_basic', identifier=None)".
[0m12:11:54.120775 [debug] [MainThread]: Using vertica connection "_test"
[0m12:11:54.121279 [debug] [MainThread]: On _test: BEGIN
[0m12:11:54.121631 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:11:54.151824 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m12:11:54.158542 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.04 seconds
[0m12:11:54.158796 [debug] [MainThread]: Using vertica connection "_test"
[0m12:11:54.158912 [debug] [MainThread]: On _test: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "_test"} */
drop schema if exists "test16660087127340828005_test_basic" cascade
  
[0m12:11:54.170901 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m12:11:54.171720 [debug] [MainThread]: On _test: COMMIT
[0m12:11:54.171918 [debug] [MainThread]: Using vertica connection "_test"
[0m12:11:54.172051 [debug] [MainThread]: On _test: COMMIT
[0m12:11:54.178311 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m12:11:54.178730 [debug] [MainThread]: On _test: Close
[0m12:11:54.179519 [debug] [MainThread]: Connection '_test' was properly closed.
