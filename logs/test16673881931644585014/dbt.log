[0m11:23:12.889959 [debug] [MainThread]: Acquiring new vertica connection "_test"
[0m11:23:12.890194 [debug] [MainThread]: Acquiring new vertica connection "_test"
[0m11:23:12.890414 [debug] [MainThread]: Creating schema "_ReferenceKey(database='vmart', schema='test16673881931644585014_test_array_append', identifier=None)"
[0m11:23:12.897252 [debug] [MainThread]: Using vertica connection "_test"
[0m11:23:12.897477 [debug] [MainThread]: On _test: BEGIN
[0m11:23:12.897623 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:23:13.579809 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:23:13.674946 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.78 seconds
[0m11:23:13.675314 [debug] [MainThread]: Using vertica connection "_test"
[0m11:23:13.675499 [debug] [MainThread]: On _test: create schema if not exists "test16673881931644585014_test_array_append"
  
[0m11:23:13.764985 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.09 seconds
[0m11:23:13.765849 [debug] [MainThread]: On _test: COMMIT
[0m11:23:13.766052 [debug] [MainThread]: Using vertica connection "_test"
[0m11:23:13.766188 [debug] [MainThread]: On _test: COMMIT
[0m11:23:13.845142 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.08 seconds
[0m11:23:13.845439 [debug] [MainThread]: On _test: Close
[0m11:23:13.852294 [debug] [MainThread]: Connection '_test' was properly closed.


============================== 2022-11-02 11:23:13.859175 | 30391355-d5b7-4923-9c2f-26015cd2d328 ==============================
[0m11:23:13.859188 [info ] [MainThread]: Running with dbt=1.3.0
[0m11:23:13.859526 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/tmp/pytest-of-sachin/pytest-2/profile0', 'send_anonymous_usage_stats': False, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
[0m11:23:13.859656 [debug] [MainThread]: Tracking: do not track
[0m11:23:13.866757 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
[0m11:23:13.876041 [debug] [MainThread]: Parsing macros/test_assert_equal.sql
[0m11:23:13.876795 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m11:23:13.877013 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m11:23:13.877168 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m11:23:13.881928 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m11:23:13.883030 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m11:23:13.883670 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m11:23:13.886488 [debug] [MainThread]: Parsing macros/materializations/models/incremental/helpers.sql
[0m11:23:13.889293 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m11:23:13.894876 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m11:23:13.896068 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m11:23:13.900890 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m11:23:13.902784 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m11:23:13.910328 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m11:23:13.911544 [debug] [MainThread]: Parsing macros/materializations/snapshots/helper.sql
[0m11:23:13.911710 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m11:23:13.916851 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m11:23:13.920630 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m11:23:13.921322 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m11:23:13.921961 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m11:23:13.924084 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m11:23:13.925892 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m11:23:13.930048 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m11:23:13.930978 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m11:23:13.931683 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m11:23:13.933037 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m11:23:13.935536 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m11:23:13.936553 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m11:23:13.940379 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m11:23:13.941981 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m11:23:13.944079 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m11:23:13.953279 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m11:23:13.958349 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m11:23:13.959374 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m11:23:13.965638 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m11:23:13.969753 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m11:23:13.980847 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m11:23:13.983097 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m11:23:13.986394 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m11:23:13.994161 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m11:23:13.995196 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m11:23:14.002060 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m11:23:14.011696 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m11:23:14.012767 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m11:23:14.013840 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m11:23:14.016489 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m11:23:14.027727 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m11:23:14.031891 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m11:23:14.032813 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m11:23:14.033785 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m11:23:14.035260 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m11:23:14.036527 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m11:23:14.038484 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m11:23:14.044764 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m11:23:14.053761 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m11:23:14.058056 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m11:23:14.066120 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m11:23:14.067518 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m11:23:14.069723 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m11:23:14.072821 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m11:23:14.076858 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m11:23:14.077652 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m11:23:14.078338 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m11:23:14.078997 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m11:23:14.079762 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m11:23:14.080679 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m11:23:14.081271 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m11:23:14.081842 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m11:23:14.082488 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m11:23:14.083778 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m11:23:14.084312 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m11:23:14.085072 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m11:23:14.085781 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m11:23:14.089960 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m11:23:14.090555 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m11:23:14.091398 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m11:23:14.092038 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m11:23:14.092784 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m11:23:14.093447 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m11:23:14.094881 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m11:23:14.095501 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m11:23:14.096020 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m11:23:14.096688 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m11:23:14.097361 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m11:23:14.098461 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m11:23:14.099321 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m11:23:14.099855 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m11:23:14.100288 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m11:23:14.100857 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m11:23:14.103966 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m11:23:14.108966 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m11:23:14.282288 [debug] [MainThread]: 1603: static parser failed on actual.sql
[0m11:23:14.294919 [debug] [MainThread]: 1602: parser fallback to jinja rendering on actual.sql
[0m11:23:14.295818 [debug] [MainThread]: 1603: static parser failed on expected.sql
[0m11:23:14.298530 [debug] [MainThread]: 1602: parser fallback to jinja rendering on expected.sql
[0m11:23:14.326930 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 297 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m11:23:14.327831 [info ] [MainThread]: 
[0m11:23:14.328301 [debug] [MainThread]: Acquiring new vertica connection "master"
[0m11:23:14.329050 [debug] [ThreadPool]: Acquiring new vertica connection "list_VMart"
[0m11:23:14.332406 [debug] [ThreadPool]: Using vertica connection "list_VMart"
[0m11:23:14.332570 [debug] [ThreadPool]: On list_VMart: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "list_VMart"} */

    select schema_name
    from v_catalog.schemata
  
[0m11:23:14.332710 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:23:15.855062 [debug] [ThreadPool]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:23:15.959889 [debug] [ThreadPool]: SQL status: Code: [Column(name='schema_name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 1.63 seconds
[0m11:23:15.961038 [debug] [ThreadPool]: On list_VMart: Close
[0m11:23:15.962107 [debug] [ThreadPool]: Acquiring new vertica connection "list_VMart_test16673881931644585014_test_array_append"
[0m11:23:15.966434 [debug] [ThreadPool]: Using vertica connection "list_VMart_test16673881931644585014_test_array_append"
[0m11:23:15.966777 [debug] [ThreadPool]: On list_VMart_test16673881931644585014_test_array_append: BEGIN
[0m11:23:15.966936 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:23:16.268270 [debug] [ThreadPool]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:23:16.350197 [debug] [ThreadPool]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.38 seconds
[0m11:23:16.350575 [debug] [ThreadPool]: Using vertica connection "list_VMart_test16673881931644585014_test_array_append"
[0m11:23:16.350762 [debug] [ThreadPool]: On list_VMart_test16673881931644585014_test_array_append: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "list_VMart_test16673881931644585014_test_array_append"} */
select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'table' as type
    from v_catalog.tables
    where table_schema ilike 'test16673881931644585014_test_array_append'
    union all
    select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'view' as type
    from v_catalog.views
    where table_schema ilike 'test16673881931644585014_test_array_append'
  
[0m11:23:16.450196 [debug] [ThreadPool]: SQL status: Code: [Column(name='database', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='schema', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='type', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.1 seconds
[0m11:23:16.451099 [debug] [ThreadPool]: On list_VMart_test16673881931644585014_test_array_append: ROLLBACK
[0m11:23:16.542354 [debug] [ThreadPool]: On list_VMart_test16673881931644585014_test_array_append: Close
[0m11:23:16.543237 [debug] [MainThread]: Using vertica connection "master"
[0m11:23:16.543488 [debug] [MainThread]: On master: BEGIN
[0m11:23:16.543669 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:23:16.812230 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:23:16.903372 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.36 seconds
[0m11:23:16.903768 [debug] [MainThread]: On master: COMMIT
[0m11:23:16.903975 [debug] [MainThread]: Using vertica connection "master"
[0m11:23:16.904147 [debug] [MainThread]: On master: COMMIT
[0m11:23:16.990733 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.09 seconds
[0m11:23:16.991129 [debug] [MainThread]: On master: Close
[0m11:23:16.991823 [info ] [MainThread]: Concurrency: 4 threads (target='default')
[0m11:23:16.992246 [info ] [MainThread]: 
[0m11:23:16.995687 [debug] [Thread-1 (]: Began running node model.test.actual
[0m11:23:16.995826 [debug] [Thread-2 (]: Began running node model.test.expected
[0m11:23:16.996139 [info ] [Thread-1 (]: 1 of 2 START sql view model test16673881931644585014_test_array_append.actual .. [RUN]
[0m11:23:16.996438 [info ] [Thread-2 (]: 2 of 2 START sql view model test16673881931644585014_test_array_append.expected  [RUN]
[0m11:23:16.996954 [debug] [Thread-1 (]: Acquiring new vertica connection "model.test.actual"
[0m11:23:16.997543 [debug] [Thread-2 (]: Acquiring new vertica connection "model.test.expected"
[0m11:23:16.997710 [debug] [Thread-1 (]: Began compiling node model.test.actual
[0m11:23:16.997907 [debug] [Thread-2 (]: Began compiling node model.test.expected
[0m11:23:16.998055 [debug] [Thread-1 (]: Compiling model.test.actual
[0m11:23:16.998188 [debug] [Thread-2 (]: Compiling model.test.expected
[0m11:23:17.001636 [debug] [Thread-1 (]: Writing injected SQL for node "model.test.actual"
[0m11:23:17.004301 [debug] [Thread-2 (]: Writing injected SQL for node "model.test.expected"
[0m11:23:17.004867 [debug] [Thread-1 (]: finished collecting timing info
[0m11:23:17.004984 [debug] [Thread-2 (]: finished collecting timing info
[0m11:23:17.005145 [debug] [Thread-1 (]: Began executing node model.test.actual
[0m11:23:17.005292 [debug] [Thread-2 (]: Began executing node model.test.expected
[0m11:23:17.027823 [debug] [Thread-1 (]: Writing runtime sql for node "model.test.actual"
[0m11:23:17.030523 [debug] [Thread-2 (]: Writing runtime sql for node "model.test.expected"
[0m11:23:17.030983 [debug] [Thread-1 (]: Using vertica connection "model.test.actual"
[0m11:23:17.031113 [debug] [Thread-2 (]: Using vertica connection "model.test.expected"
[0m11:23:17.031257 [debug] [Thread-1 (]: On model.test.actual: BEGIN
[0m11:23:17.031392 [debug] [Thread-2 (]: On model.test.expected: BEGIN
[0m11:23:17.031517 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:23:17.031646 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m11:23:17.417080 [debug] [Thread-2 (]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:23:17.420096 [debug] [Thread-1 (]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:23:17.508282 [debug] [Thread-2 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.48 seconds
[0m11:23:17.508627 [debug] [Thread-2 (]: Using vertica connection "model.test.expected"
[0m11:23:17.508840 [debug] [Thread-2 (]: On model.test.expected: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.expected"} */

  create view "VMart"."test16673881931644585014_test_array_append"."expected__dbt_tmp" as (
    select 1 as id, 
    array[ 1 , 2 , 3 , 4 ]
     as array_col union all
select 2 as id, 
    array[ 4 ]
     as array_col
  );
[0m11:23:17.521768 [debug] [Thread-1 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.49 seconds
[0m11:23:17.521997 [debug] [Thread-1 (]: Using vertica connection "model.test.actual"
[0m11:23:17.522113 [debug] [Thread-1 (]: On model.test.actual: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.actual"} */

  create view "VMart"."test16673881931644585014_test_array_append"."actual__dbt_tmp" as (
    select 1 as id, array_append(
    array[ 1 , 2 , 3 ]
    , 4) as array_col union all
select 2 as id, array_append(
    array[]::INT[]
    , 4) as array_col
  );
[0m11:23:17.610737 [debug] [Thread-2 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.1 seconds
[0m11:23:17.618366 [debug] [Thread-2 (]: Using vertica connection "model.test.expected"
[0m11:23:17.618696 [debug] [Thread-2 (]: On model.test.expected: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.expected"} */
alter view "VMart"."test16673881931644585014_test_array_append"."expected__dbt_tmp" rename to "expected"
[0m11:23:17.622696 [debug] [Thread-1 (]: vertica adapter: :P Database error: Severity: ERROR, Message: Function array_append(array[int], int) does not exist, or permission is denied for array_append(array[int], int), Sqlstate: 42883, Hint: No function matches the given name and argument types. You may need to add explicit type casts, Routine: throwErrorFunctionDoesNotMatch, File: /data/jenkins/workspace/RE-ReleaseBuilds/RE-Knuckleboom/server/vertica/Parser/ParseFunc.cpp, Line: 4305, Error Code: 3457, SQL: '/* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.actual"} */   create view "VMart"."test16673881931644585014_test_array_append"."actual__dbt_tmp" as (     select 1 as id, array_append(     array[ 1 , 2 , 3 ]     , 4) as array_col union all select 2 as id, array_append(     array[]::INT[]     , 4) as array_col   );'
[0m11:23:17.622907 [debug] [Thread-1 (]: On model.test.actual: ROLLBACK
[0m11:23:17.719870 [debug] [Thread-1 (]: On model.test.actual: Close
[0m11:23:17.720323 [debug] [Thread-1 (]: finished collecting timing info
[0m11:23:17.720751 [debug] [Thread-1 (]: Database Error in model actual (models/actual.sql)
  Severity: ERROR, Message: Function array_append(array[int], int) does not exist, or permission is denied for array_append(array[int], int), Sqlstate: 42883, Hint: No function matches the given name and argument types. You may need to add explicit type casts, Routine: throwErrorFunctionDoesNotMatch, File: /data/jenkins/workspace/RE-ReleaseBuilds/RE-Knuckleboom/server/vertica/Parser/ParseFunc.cpp, Line: 4305, Error Code: 3457, SQL: '/* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.actual"} */   create view "VMart"."test16673881931644585014_test_array_append"."actual__dbt_tmp" as (     select 1 as id, array_append(     array[ 1 , 2 , 3 ]     , 4) as array_col union all select 2 as id, array_append(     array[]::INT[]     , 4) as array_col   );'
  compiled Code at target/run/test/models/actual.sql
[0m11:23:17.721052 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model test16673881931644585014_test_array_append.actual  [[31mERROR[0m in 0.72s]
[0m11:23:17.721396 [debug] [Thread-1 (]: Finished running node model.test.actual
[0m11:23:17.722345 [debug] [Thread-2 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.1 seconds
[0m11:23:17.741615 [debug] [Thread-2 (]: On model.test.expected: COMMIT
[0m11:23:17.741946 [debug] [Thread-2 (]: Using vertica connection "model.test.expected"
[0m11:23:17.742168 [debug] [Thread-2 (]: On model.test.expected: COMMIT
[0m11:23:17.844478 [debug] [Thread-2 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.1 seconds
[0m11:23:17.851713 [debug] [Thread-2 (]: Using vertica connection "model.test.expected"
[0m11:23:17.852060 [debug] [Thread-2 (]: On model.test.expected: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.expected"} */
drop view if exists "VMart"."test16673881931644585014_test_array_append"."expected__dbt_backup" cascade
[0m11:23:17.956599 [debug] [Thread-2 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.1 seconds
[0m11:23:17.958076 [debug] [Thread-2 (]: finished collecting timing info
[0m11:23:17.958367 [debug] [Thread-2 (]: On model.test.expected: Close
[0m11:23:17.959186 [info ] [Thread-2 (]: 2 of 2 OK created sql view model test16673881931644585014_test_array_append.expected  [[32mCode: None, Rows: -1, Array Size: 1[0m in 0.96s]
[0m11:23:17.959738 [debug] [Thread-2 (]: Finished running node model.test.expected
[0m11:23:17.960696 [debug] [MainThread]: Acquiring new vertica connection "master"
[0m11:23:17.960875 [debug] [MainThread]: Using vertica connection "master"
[0m11:23:17.960995 [debug] [MainThread]: On master: BEGIN
[0m11:23:17.961103 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:23:18.344805 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:23:18.436786 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.48 seconds
[0m11:23:18.437050 [debug] [MainThread]: On master: COMMIT
[0m11:23:18.437169 [debug] [MainThread]: Using vertica connection "master"
[0m11:23:18.437271 [debug] [MainThread]: On master: COMMIT
[0m11:23:18.531966 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.09 seconds
[0m11:23:18.532342 [debug] [MainThread]: On master: Close
[0m11:23:18.533106 [info ] [MainThread]: 
[0m11:23:18.533411 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 4.20 seconds (4.20s).
[0m11:23:18.533633 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:23:18.533736 [debug] [MainThread]: Connection 'model.test.actual' was properly closed.
[0m11:23:18.533834 [debug] [MainThread]: Connection 'model.test.expected' was properly closed.
[0m11:23:18.537592 [info ] [MainThread]: 
[0m11:23:18.537851 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:23:18.538076 [info ] [MainThread]: 
[0m11:23:18.538262 [error] [MainThread]: [33mDatabase Error in model actual (models/actual.sql)[0m
[0m11:23:18.538435 [error] [MainThread]:   Severity: ERROR, Message: Function array_append(array[int], int) does not exist, or permission is denied for array_append(array[int], int), Sqlstate: 42883, Hint: No function matches the given name and argument types. You may need to add explicit type casts, Routine: throwErrorFunctionDoesNotMatch, File: /data/jenkins/workspace/RE-ReleaseBuilds/RE-Knuckleboom/server/vertica/Parser/ParseFunc.cpp, Line: 4305, Error Code: 3457, SQL: '/* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.actual"} */   create view "VMart"."test16673881931644585014_test_array_append"."actual__dbt_tmp" as (     select 1 as id, array_append(     array[ 1 , 2 , 3 ]     , 4) as array_col union all select 2 as id, array_append(     array[]::INT[]     , 4) as array_col   );'
[0m11:23:18.538613 [error] [MainThread]:   compiled Code at target/run/test/models/actual.sql
[0m11:23:18.538814 [info ] [MainThread]: 
[0m11:23:18.538992 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m11:23:18.539232 [debug] [MainThread]: Flushing usage events
[0m11:23:18.588273 [debug] [MainThread]: Acquiring new vertica connection "_test"
[0m11:23:18.592916 [debug] [MainThread]: Using vertica connection "_test"
[0m11:23:18.593242 [debug] [MainThread]: On _test: BEGIN
[0m11:23:18.593427 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:23:18.870093 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:23:18.958034 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.36 seconds
[0m11:23:18.958319 [debug] [MainThread]: Using vertica connection "_test"
[0m11:23:18.958475 [debug] [MainThread]: On _test: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "_test"} */

    select
    column_name
    , data_type
    , character_maximum_length
    , numeric_precision
    , numeric_scale
    from (
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.columns
        where table_schema = 'test16673881931644585014_test_array_append'
        and table_name = 'expected'
        union all
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.view_columns
        where table_schema = 'test16673881931644585014_test_array_append'
        and table_name = 'expected'
    ) t
    order by ordinal_position
  
[0m11:23:19.092990 [debug] [MainThread]: SQL status: Code: [Column(name='column_name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='data_type', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='character_maximum_length', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_precision', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_scale', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.13 seconds
[0m11:23:19.095928 [debug] [MainThread]: Using vertica connection "_test"
[0m11:23:19.096174 [debug] [MainThread]: On _test: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "_test"} */
with diff_count as (
    SELECT
        1 as id,
        COUNT(*) as num_missing FROM (
            (SELECT "array_col", "id" FROM "VMart"."test16673881931644585014_test_array_append"."expected" EXCEPT
             SELECT "array_col", "id" FROM "VMart"."test16673881931644585014_test_array_append"."actual")
             UNION ALL
            (SELECT "array_col", "id" FROM "VMart"."test16673881931644585014_test_array_append"."actual" EXCEPT
             SELECT "array_col", "id" FROM "VMart"."test16673881931644585014_test_array_append"."expected")
        ) as a
), table_a as (
    SELECT COUNT(*) as num_rows FROM "VMart"."test16673881931644585014_test_array_append"."expected"
), table_b as (
    SELECT COUNT(*) as num_rows FROM "VMart"."test16673881931644585014_test_array_append"."actual"
), row_count_diff as (
    select
        1 as id,
        table_a.num_rows - table_b.num_rows as difference
    from table_a, table_b
)
select
    row_count_diff.difference as row_count_difference,
    diff_count.num_missing as num_mismatched
from row_count_diff
join diff_count using (id)
[0m11:23:19.272945 [debug] [MainThread]: vertica adapter: :P Database error: Severity: ERROR, Message: Relation "test16673881931644585014_test_array_append.actual" does not exist, Sqlstate: 42V01, Routine: throwRelationDoesNotExist, File: /data/jenkins/workspace/RE-ReleaseBuilds/RE-Knuckleboom/server/vertica/Catalog/CatalogLookup.cpp, Line: 4114, Error Code: 4568, SQL: '/* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "_test"} */ with diff_count as (     SELECT         1 as id,         COUNT(*) as num_missing FROM (             (SELECT "array_col", "id" FROM "VMart"."test16673881931644585014_test_array_append"."expected" EXCEPT              SELECT "array_col", "id" FROM "VMart"."test16673881931644585014_test_array_append"."actual")              UNION ALL             (SELECT "array_col", "id" FROM "VMart"."test16673881931644585014_test_array_append"."actual" EXCEPT              SELECT "array_col", "id" FROM "VMart"."test16673881931644585014_test_array_append"."expected")         ) as a ), table_a as (     SELECT COUNT(*) as num_rows FROM "VMart"."test16673881931644585014_test_array_append"."expected" ), table_b as (     SELECT COUNT(*) as num_rows FROM "VMart"."test16673881931644585014_test_array_append"."actual" ), row_count_diff as (     select         1 as id,         table_a.num_rows - table_b.num_rows as difference     from table_a, table_b ) select     row_count_diff.difference as row_count_difference,     diff_count.num_missing as num_mismatched from row_count_diff join diff_count using (id)'
[0m11:23:19.273236 [debug] [MainThread]: On _test: ROLLBACK
[0m11:23:19.370179 [debug] [MainThread]: On _test: Close
[0m11:23:19.451429 [debug] [MainThread]: Acquiring new vertica connection "_test"
[0m11:23:19.452144 [debug] [MainThread]: Dropping schema "_ReferenceKey(database='vmart', schema='test16673881931644585014_test_array_append', identifier=None)".
[0m11:23:19.456216 [debug] [MainThread]: Using vertica connection "_test"
[0m11:23:19.456449 [debug] [MainThread]: On _test: BEGIN
[0m11:23:19.456568 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:23:19.762292 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:23:19.846526 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.39 seconds
[0m11:23:19.846774 [debug] [MainThread]: Using vertica connection "_test"
[0m11:23:19.846917 [debug] [MainThread]: On _test: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "_test"} */
drop schema if exists "test16673881931644585014_test_array_append" cascade
  
[0m11:23:20.129235 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.28 seconds
[0m11:23:20.130050 [debug] [MainThread]: On _test: COMMIT
[0m11:23:20.130236 [debug] [MainThread]: Using vertica connection "_test"
[0m11:23:20.130358 [debug] [MainThread]: On _test: COMMIT
[0m11:23:20.558259 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.43 seconds
[0m11:23:20.558601 [debug] [MainThread]: On _test: Close
[0m11:23:20.559408 [debug] [MainThread]: Connection '_test' was properly closed.
