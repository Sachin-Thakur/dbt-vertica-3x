[0m05:51:28.392891 [debug] [MainThread]: Acquiring new vertica connection "_test"
[0m05:51:28.393121 [debug] [MainThread]: Acquiring new vertica connection "_test"
[0m05:51:28.393299 [debug] [MainThread]: Creating schema "_ReferenceKey(database='vmart', schema='test16667634881586048159_test_array_construct', identifier=None)"
[0m05:51:28.394874 [debug] [MainThread]: Using vertica connection "_test"
[0m05:51:28.395065 [debug] [MainThread]: On _test: BEGIN
[0m05:51:28.395171 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:51:28.412126 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m05:51:28.417689 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m05:51:28.417974 [debug] [MainThread]: Using vertica connection "_test"
[0m05:51:28.418102 [debug] [MainThread]: On _test: create schema if not exists "test16667634881586048159_test_array_construct"
  
[0m05:51:28.429877 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m05:51:28.430674 [debug] [MainThread]: On _test: COMMIT
[0m05:51:28.430858 [debug] [MainThread]: Using vertica connection "_test"
[0m05:51:28.430971 [debug] [MainThread]: On _test: COMMIT
[0m05:51:28.435352 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.0 seconds
[0m05:51:28.435713 [debug] [MainThread]: On _test: Close
[0m05:51:28.443216 [debug] [MainThread]: Connection '_test' was properly closed.


============================== 2022-10-26 05:51:28.449767 | b0c9e18b-7223-4cd6-9db5-0b5e90260df9 ==============================
[0m05:51:28.449779 [info ] [MainThread]: Running with dbt=1.3.0
[0m05:51:28.450159 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/tmp/pytest-of-sachin/pytest-37/profile12', 'send_anonymous_usage_stats': False, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
[0m05:51:28.450317 [debug] [MainThread]: Tracking: do not track
[0m05:51:28.457576 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
[0m05:51:28.466287 [debug] [MainThread]: Parsing macros/test_assert_equal.sql
[0m05:51:28.467074 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m05:51:28.467312 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m05:51:28.467449 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m05:51:28.472259 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m05:51:28.473363 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m05:51:28.474053 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m05:51:28.476903 [debug] [MainThread]: Parsing macros/materializations/models/incremental/helpers.sql
[0m05:51:28.478884 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m05:51:28.482915 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m05:51:28.484094 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m05:51:28.488510 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m05:51:28.490118 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m05:51:28.497972 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m05:51:28.499307 [debug] [MainThread]: Parsing macros/materializations/snapshots/helper.sql
[0m05:51:28.499529 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m05:51:28.505427 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m05:51:28.509676 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m05:51:28.510409 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m05:51:28.510912 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m05:51:28.513015 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m05:51:28.514822 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m05:51:28.519383 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m05:51:28.520451 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m05:51:28.521249 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m05:51:28.522845 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m05:51:28.525387 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m05:51:28.526471 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m05:51:28.530065 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m05:51:28.531618 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m05:51:28.533865 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m05:51:28.543795 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m05:51:28.549934 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m05:51:28.551043 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m05:51:28.557797 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m05:51:28.562233 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m05:51:28.573273 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m05:51:28.575624 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m05:51:28.579206 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m05:51:28.587799 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m05:51:28.588942 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m05:51:28.596634 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m05:51:28.607160 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m05:51:28.608378 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m05:51:28.609592 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m05:51:28.612497 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m05:51:28.624474 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m05:51:28.628994 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m05:51:28.630012 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m05:51:28.631058 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m05:51:28.632641 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m05:51:28.634011 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m05:51:28.635764 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m05:51:28.642139 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m05:51:28.651759 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m05:51:28.656464 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m05:51:28.665372 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m05:51:28.666883 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m05:51:28.669149 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m05:51:28.672019 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m05:51:28.675952 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m05:51:28.676801 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m05:51:28.677524 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m05:51:28.678154 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m05:51:28.678992 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m05:51:28.680018 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m05:51:28.680673 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m05:51:28.681318 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m05:51:28.682042 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m05:51:28.683421 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m05:51:28.684013 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m05:51:28.684842 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m05:51:28.685568 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m05:51:28.690167 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m05:51:28.690835 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m05:51:28.691708 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m05:51:28.692428 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m05:51:28.693292 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m05:51:28.694036 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m05:51:28.695567 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m05:51:28.696230 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m05:51:28.696793 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m05:51:28.697509 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m05:51:28.698273 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m05:51:28.699479 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m05:51:28.700460 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m05:51:28.701070 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m05:51:28.701541 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m05:51:28.702204 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m05:51:28.705619 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m05:51:28.711076 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m05:51:28.868849 [debug] [MainThread]: 1603: static parser failed on actual.sql
[0m05:51:28.871948 [debug] [MainThread]: 1602: parser fallback to jinja rendering on actual.sql
[0m05:51:28.872830 [debug] [MainThread]: 1603: static parser failed on expected.sql
[0m05:51:28.875523 [debug] [MainThread]: 1602: parser fallback to jinja rendering on expected.sql
[0m05:51:28.897089 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 297 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m05:51:28.897722 [info ] [MainThread]: 
[0m05:51:28.898198 [debug] [MainThread]: Acquiring new vertica connection "master"
[0m05:51:28.898947 [debug] [ThreadPool]: Acquiring new vertica connection "list_VMart"
[0m05:51:28.900184 [debug] [ThreadPool]: Using vertica connection "list_VMart"
[0m05:51:28.900452 [debug] [ThreadPool]: On list_VMart: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "list_VMart"} */

    select schema_name
    from v_catalog.schemata
  
[0m05:51:28.900583 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:51:28.917756 [debug] [ThreadPool]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m05:51:28.934537 [debug] [ThreadPool]: SQL status: Code: [Column(name='schema_name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.03 seconds
[0m05:51:28.938288 [debug] [ThreadPool]: On list_VMart: Close
[0m05:51:28.941620 [debug] [ThreadPool]: Acquiring new vertica connection "list_VMart_test16667634881586048159_test_array_construct"
[0m05:51:28.945630 [debug] [ThreadPool]: Using vertica connection "list_VMart_test16667634881586048159_test_array_construct"
[0m05:51:28.946104 [debug] [ThreadPool]: On list_VMart_test16667634881586048159_test_array_construct: BEGIN
[0m05:51:28.946414 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:51:28.959860 [debug] [ThreadPool]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m05:51:28.964846 [debug] [ThreadPool]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m05:51:28.965258 [debug] [ThreadPool]: Using vertica connection "list_VMart_test16667634881586048159_test_array_construct"
[0m05:51:28.965555 [debug] [ThreadPool]: On list_VMart_test16667634881586048159_test_array_construct: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "list_VMart_test16667634881586048159_test_array_construct"} */
select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'table' as type
    from v_catalog.tables
    where table_schema ilike 'test16667634881586048159_test_array_construct'
    union all
    select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'view' as type
    from v_catalog.views
    where table_schema ilike 'test16667634881586048159_test_array_construct'
  
[0m05:51:28.980799 [debug] [ThreadPool]: SQL status: Code: [Column(name='database', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='schema', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='type', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.01 seconds
[0m05:51:28.983097 [debug] [ThreadPool]: On list_VMart_test16667634881586048159_test_array_construct: ROLLBACK
[0m05:51:28.988937 [debug] [ThreadPool]: On list_VMart_test16667634881586048159_test_array_construct: Close
[0m05:51:28.990322 [debug] [MainThread]: Using vertica connection "master"
[0m05:51:28.990757 [debug] [MainThread]: On master: BEGIN
[0m05:51:28.991068 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:51:29.008545 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m05:51:29.014336 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m05:51:29.014894 [debug] [MainThread]: On master: COMMIT
[0m05:51:29.015246 [debug] [MainThread]: Using vertica connection "master"
[0m05:51:29.015566 [debug] [MainThread]: On master: COMMIT
[0m05:51:29.020597 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.0 seconds
[0m05:51:29.021153 [debug] [MainThread]: On master: Close
[0m05:51:29.022297 [info ] [MainThread]: Concurrency: 4 threads (target='default')
[0m05:51:29.022949 [info ] [MainThread]: 
[0m05:51:29.026273 [debug] [Thread-120]: Began running node model.test.actual
[0m05:51:29.026893 [debug] [Thread-121]: Began running node model.test.expected
[0m05:51:29.027588 [info ] [Thread-120]: 1 of 2 START sql view model test16667634881586048159_test_array_construct.actual  [RUN]
[0m05:51:29.028284 [info ] [Thread-121]: 2 of 2 START sql view model test16667634881586048159_test_array_construct.expected  [RUN]
[0m05:51:29.029665 [debug] [Thread-120]: Acquiring new vertica connection "model.test.actual"
[0m05:51:29.031035 [debug] [Thread-121]: Acquiring new vertica connection "model.test.expected"
[0m05:51:29.031453 [debug] [Thread-120]: Began compiling node model.test.actual
[0m05:51:29.031898 [debug] [Thread-121]: Began compiling node model.test.expected
[0m05:51:29.032307 [debug] [Thread-120]: Compiling model.test.actual
[0m05:51:29.032677 [debug] [Thread-121]: Compiling model.test.expected
[0m05:51:29.036719 [debug] [Thread-120]: Writing injected SQL for node "model.test.actual"
[0m05:51:29.039297 [debug] [Thread-121]: Writing injected SQL for node "model.test.expected"
[0m05:51:29.040127 [debug] [Thread-120]: finished collecting timing info
[0m05:51:29.040521 [debug] [Thread-120]: Began executing node model.test.actual
[0m05:51:29.040750 [debug] [Thread-121]: finished collecting timing info
[0m05:51:29.045297 [debug] [Thread-120]: Writing runtime sql for node "model.test.actual"
[0m05:51:29.045671 [debug] [Thread-121]: Began executing node model.test.expected
[0m05:51:29.049034 [debug] [Thread-121]: Writing runtime sql for node "model.test.expected"
[0m05:51:29.049348 [debug] [Thread-120]: Using vertica connection "model.test.actual"
[0m05:51:29.049494 [debug] [Thread-121]: Using vertica connection "model.test.expected"
[0m05:51:29.049675 [debug] [Thread-120]: On model.test.actual: BEGIN
[0m05:51:29.049904 [debug] [Thread-121]: On model.test.expected: BEGIN
[0m05:51:29.050134 [debug] [Thread-120]: Opening a new connection, currently in state closed
[0m05:51:29.050320 [debug] [Thread-121]: Opening a new connection, currently in state init
[0m05:51:29.064623 [debug] [Thread-121]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m05:51:29.065650 [debug] [Thread-120]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m05:51:29.070208 [debug] [Thread-121]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m05:51:29.070427 [debug] [Thread-121]: Using vertica connection "model.test.expected"
[0m05:51:29.070633 [debug] [Thread-121]: On model.test.expected: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.expected"} */

  create view "VMart"."test16667634881586048159_test_array_construct"."expected__dbt_tmp" as (
    select 1 as id, 
    array[ 1 , 2 , 3 ]
     as array_col union all
select 2 as id, 
    array[]::INT[]
     as array_col
  );
[0m05:51:29.071113 [debug] [Thread-120]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m05:51:29.071281 [debug] [Thread-120]: Using vertica connection "model.test.actual"
[0m05:51:29.071394 [debug] [Thread-120]: On model.test.actual: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.actual"} */

  create view "VMart"."test16667634881586048159_test_array_construct"."actual__dbt_tmp" as (
    select 1 as id, 
    array[ 1 , 2 , 3 ]
     as array_col union all
select 2 as id, 
    array[]::INT[]
     as array_col
  );
[0m05:51:29.080726 [debug] [Thread-121]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m05:51:29.083655 [debug] [Thread-121]: Using vertica connection "model.test.expected"
[0m05:51:29.083875 [debug] [Thread-121]: On model.test.expected: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.expected"} */
alter view "VMart"."test16667634881586048159_test_array_construct"."expected__dbt_tmp" rename to "expected"
[0m05:51:29.084088 [debug] [Thread-120]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m05:51:29.120803 [debug] [Thread-121]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.04 seconds
[0m05:51:29.122017 [debug] [Thread-121]: On model.test.expected: COMMIT
[0m05:51:29.122206 [debug] [Thread-121]: Using vertica connection "model.test.expected"
[0m05:51:29.122343 [debug] [Thread-121]: On model.test.expected: COMMIT
[0m05:51:29.127074 [debug] [Thread-120]: Using vertica connection "model.test.actual"
[0m05:51:29.127265 [debug] [Thread-121]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.0 seconds
[0m05:51:29.127437 [debug] [Thread-120]: On model.test.actual: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.actual"} */
alter view "VMart"."test16667634881586048159_test_array_construct"."actual__dbt_tmp" rename to "actual"
[0m05:51:29.128684 [debug] [Thread-121]: Using vertica connection "model.test.expected"
[0m05:51:29.128978 [debug] [Thread-121]: On model.test.expected: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.expected"} */
drop view if exists "VMart"."test16667634881586048159_test_array_construct"."expected__dbt_backup" cascade
[0m05:51:29.135909 [debug] [Thread-121]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m05:51:29.136692 [debug] [Thread-121]: finished collecting timing info
[0m05:51:29.136847 [debug] [Thread-121]: On model.test.expected: Close
[0m05:51:29.137351 [info ] [Thread-121]: 2 of 2 OK created sql view model test16667634881586048159_test_array_construct.expected  [[32mCode: None, Rows: -1, Array Size: 1[0m in 0.11s]
[0m05:51:29.137763 [debug] [Thread-121]: Finished running node model.test.expected
[0m05:51:29.138362 [debug] [Thread-120]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m05:51:29.139328 [debug] [Thread-120]: On model.test.actual: COMMIT
[0m05:51:29.139468 [debug] [Thread-120]: Using vertica connection "model.test.actual"
[0m05:51:29.139577 [debug] [Thread-120]: On model.test.actual: COMMIT
[0m05:51:29.144800 [debug] [Thread-120]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m05:51:29.146284 [debug] [Thread-120]: Using vertica connection "model.test.actual"
[0m05:51:29.146434 [debug] [Thread-120]: On model.test.actual: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.actual"} */
drop view if exists "VMart"."test16667634881586048159_test_array_construct"."actual__dbt_backup" cascade
[0m05:51:29.154263 [debug] [Thread-120]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m05:51:29.155305 [debug] [Thread-120]: finished collecting timing info
[0m05:51:29.155537 [debug] [Thread-120]: On model.test.actual: Close
[0m05:51:29.156131 [info ] [Thread-120]: 1 of 2 OK created sql view model test16667634881586048159_test_array_construct.actual  [[32mCode: None, Rows: -1, Array Size: 1[0m in 0.13s]
[0m05:51:29.156480 [debug] [Thread-120]: Finished running node model.test.actual
[0m05:51:29.157523 [debug] [MainThread]: Acquiring new vertica connection "master"
[0m05:51:29.157693 [debug] [MainThread]: Using vertica connection "master"
[0m05:51:29.157801 [debug] [MainThread]: On master: BEGIN
[0m05:51:29.157911 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:51:29.170509 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m05:51:29.174612 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m05:51:29.174824 [debug] [MainThread]: On master: COMMIT
[0m05:51:29.174933 [debug] [MainThread]: Using vertica connection "master"
[0m05:51:29.175034 [debug] [MainThread]: On master: COMMIT
[0m05:51:29.178864 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.0 seconds
[0m05:51:29.179042 [debug] [MainThread]: On master: Close
[0m05:51:29.179600 [info ] [MainThread]: 
[0m05:51:29.179842 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m05:51:29.180025 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:51:29.180119 [debug] [MainThread]: Connection 'model.test.actual' was properly closed.
[0m05:51:29.180209 [debug] [MainThread]: Connection 'model.test.expected' was properly closed.
[0m05:51:29.185037 [info ] [MainThread]: 
[0m05:51:29.185329 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:51:29.185548 [info ] [MainThread]: 
[0m05:51:29.185724 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m05:51:29.185979 [debug] [MainThread]: Flushing usage events


============================== 2022-10-26 05:51:29.205743 | b0c9e18b-7223-4cd6-9db5-0b5e90260df9 ==============================
[0m05:51:29.205758 [info ] [MainThread]: Running with dbt=1.3.0
[0m05:51:29.206286 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/tmp/pytest-of-sachin/pytest-37/profile12', 'send_anonymous_usage_stats': False, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
[0m05:51:29.206468 [debug] [MainThread]: Tracking: do not track
[0m05:51:29.229757 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:51:29.230016 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:51:29.238843 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 297 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m05:51:29.239527 [info ] [MainThread]: 
[0m05:51:29.240022 [debug] [MainThread]: Acquiring new vertica connection "master"
[0m05:51:29.240662 [debug] [ThreadPool]: Acquiring new vertica connection "list_VMart"
[0m05:51:29.242966 [debug] [ThreadPool]: Using vertica connection "list_VMart"
[0m05:51:29.243302 [debug] [ThreadPool]: On list_VMart: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "list_VMart"} */

    select schema_name
    from v_catalog.schemata
  
[0m05:51:29.243496 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:51:29.259211 [debug] [ThreadPool]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m05:51:29.272371 [debug] [ThreadPool]: SQL status: Code: [Column(name='schema_name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.03 seconds
[0m05:51:29.273453 [debug] [ThreadPool]: On list_VMart: Close
[0m05:51:29.274816 [debug] [ThreadPool]: Acquiring new vertica connection "list_VMart_test16667634881586048159_test_array_construct"
[0m05:51:29.276162 [debug] [ThreadPool]: Using vertica connection "list_VMart_test16667634881586048159_test_array_construct"
[0m05:51:29.276326 [debug] [ThreadPool]: On list_VMart_test16667634881586048159_test_array_construct: BEGIN
[0m05:51:29.276580 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:51:29.292159 [debug] [ThreadPool]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m05:51:29.299278 [debug] [ThreadPool]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m05:51:29.299690 [debug] [ThreadPool]: Using vertica connection "list_VMart_test16667634881586048159_test_array_construct"
[0m05:51:29.299925 [debug] [ThreadPool]: On list_VMart_test16667634881586048159_test_array_construct: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "list_VMart_test16667634881586048159_test_array_construct"} */
select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'table' as type
    from v_catalog.tables
    where table_schema ilike 'test16667634881586048159_test_array_construct'
    union all
    select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'view' as type
    from v_catalog.views
    where table_schema ilike 'test16667634881586048159_test_array_construct'
  
[0m05:51:29.336924 [debug] [ThreadPool]: SQL status: Code: [Column(name='database', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='schema', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='type', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.04 seconds
[0m05:51:29.338670 [debug] [ThreadPool]: On list_VMart_test16667634881586048159_test_array_construct: ROLLBACK
[0m05:51:29.345986 [debug] [ThreadPool]: On list_VMart_test16667634881586048159_test_array_construct: Close
[0m05:51:29.347411 [debug] [MainThread]: Using vertica connection "master"
[0m05:51:29.347647 [debug] [MainThread]: On master: BEGIN
[0m05:51:29.347781 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:51:29.361188 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m05:51:29.365618 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m05:51:29.365875 [debug] [MainThread]: On master: COMMIT
[0m05:51:29.366044 [debug] [MainThread]: Using vertica connection "master"
[0m05:51:29.366156 [debug] [MainThread]: On master: COMMIT
[0m05:51:29.369850 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.0 seconds
[0m05:51:29.370038 [debug] [MainThread]: On master: Close
[0m05:51:29.370474 [info ] [MainThread]: Concurrency: 4 threads (target='default')
[0m05:51:29.370723 [info ] [MainThread]: 
[0m05:51:29.372106 [debug] [Thread-127]: Began running node model.test.actual
[0m05:51:29.372236 [debug] [Thread-128]: Began running node model.test.expected
[0m05:51:29.372533 [info ] [Thread-127]: 1 of 2 START sql view model test16667634881586048159_test_array_construct.actual  [RUN]
[0m05:51:29.372750 [info ] [Thread-128]: 2 of 2 START sql view model test16667634881586048159_test_array_construct.expected  [RUN]
[0m05:51:29.373349 [debug] [Thread-127]: Acquiring new vertica connection "model.test.actual"
[0m05:51:29.374393 [debug] [Thread-128]: Acquiring new vertica connection "model.test.expected"
[0m05:51:29.374760 [debug] [Thread-127]: Began compiling node model.test.actual
[0m05:51:29.374950 [debug] [Thread-128]: Began compiling node model.test.expected
[0m05:51:29.375162 [debug] [Thread-127]: Compiling model.test.actual
[0m05:51:29.375295 [debug] [Thread-128]: Compiling model.test.expected
[0m05:51:29.377982 [debug] [Thread-127]: Writing injected SQL for node "model.test.actual"
[0m05:51:29.380466 [debug] [Thread-128]: Writing injected SQL for node "model.test.expected"
[0m05:51:29.380885 [debug] [Thread-127]: finished collecting timing info
[0m05:51:29.381016 [debug] [Thread-128]: finished collecting timing info
[0m05:51:29.381164 [debug] [Thread-127]: Began executing node model.test.actual
[0m05:51:29.381308 [debug] [Thread-128]: Began executing node model.test.expected
[0m05:51:29.383763 [debug] [Thread-127]: Writing runtime sql for node "model.test.actual"
[0m05:51:29.386354 [debug] [Thread-128]: Writing runtime sql for node "model.test.expected"
[0m05:51:29.386817 [debug] [Thread-127]: Using vertica connection "model.test.actual"
[0m05:51:29.386970 [debug] [Thread-128]: Using vertica connection "model.test.expected"
[0m05:51:29.387092 [debug] [Thread-127]: On model.test.actual: BEGIN
[0m05:51:29.387227 [debug] [Thread-128]: On model.test.expected: BEGIN
[0m05:51:29.387356 [debug] [Thread-127]: Opening a new connection, currently in state closed
[0m05:51:29.387483 [debug] [Thread-128]: Opening a new connection, currently in state init
[0m05:51:29.400820 [debug] [Thread-128]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m05:51:29.401947 [debug] [Thread-127]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m05:51:29.405094 [debug] [Thread-128]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m05:51:29.405304 [debug] [Thread-128]: Using vertica connection "model.test.expected"
[0m05:51:29.405437 [debug] [Thread-128]: On model.test.expected: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.expected"} */

  create view "VMart"."test16667634881586048159_test_array_construct"."expected__dbt_tmp" as (
    select 1 as id, 
    array[ 1 , 2 , 3 ]
     as array_col union all
select 2 as id, 
    array[]::INT[]
     as array_col
  );
[0m05:51:29.407208 [debug] [Thread-127]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m05:51:29.407373 [debug] [Thread-127]: Using vertica connection "model.test.actual"
[0m05:51:29.407490 [debug] [Thread-127]: On model.test.actual: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.actual"} */

  create view "VMart"."test16667634881586048159_test_array_construct"."actual__dbt_tmp" as (
    select 1 as id, 
    array[ 1 , 2 , 3 ]
     as array_col union all
select 2 as id, 
    array[]::INT[]
     as array_col
  );
[0m05:51:29.413879 [debug] [Thread-128]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m05:51:29.416033 [debug] [Thread-128]: Using vertica connection "model.test.expected"
[0m05:51:29.416245 [debug] [Thread-128]: On model.test.expected: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.expected"} */
alter view "VMart"."test16667634881586048159_test_array_construct"."expected" rename to "expected__dbt_backup"
[0m05:51:29.419364 [debug] [Thread-127]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m05:51:29.421261 [debug] [Thread-127]: Using vertica connection "model.test.actual"
[0m05:51:29.421455 [debug] [Thread-127]: On model.test.actual: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.actual"} */
alter view "VMart"."test16667634881586048159_test_array_construct"."actual" rename to "actual__dbt_backup"
[0m05:51:29.423894 [debug] [Thread-128]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m05:51:29.427007 [debug] [Thread-128]: Using vertica connection "model.test.expected"
[0m05:51:29.427212 [debug] [Thread-128]: On model.test.expected: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.expected"} */
alter view "VMart"."test16667634881586048159_test_array_construct"."expected__dbt_tmp" rename to "expected"
[0m05:51:29.433553 [debug] [Thread-127]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m05:51:29.435688 [debug] [Thread-127]: Using vertica connection "model.test.actual"
[0m05:51:29.435850 [debug] [Thread-128]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m05:51:29.436024 [debug] [Thread-127]: On model.test.actual: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.actual"} */
alter view "VMart"."test16667634881586048159_test_array_construct"."actual__dbt_tmp" rename to "actual"
[0m05:51:29.437060 [debug] [Thread-128]: On model.test.expected: COMMIT
[0m05:51:29.437355 [debug] [Thread-128]: Using vertica connection "model.test.expected"
[0m05:51:29.437498 [debug] [Thread-128]: On model.test.expected: COMMIT
[0m05:51:29.441890 [debug] [Thread-128]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.0 seconds
[0m05:51:29.443508 [debug] [Thread-128]: Using vertica connection "model.test.expected"
[0m05:51:29.443669 [debug] [Thread-128]: On model.test.expected: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.expected"} */
drop view if exists "VMart"."test16667634881586048159_test_array_construct"."expected__dbt_backup" cascade
[0m05:51:29.449135 [debug] [Thread-127]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m05:51:29.450457 [debug] [Thread-127]: On model.test.actual: COMMIT
[0m05:51:29.450659 [debug] [Thread-127]: Using vertica connection "model.test.actual"
[0m05:51:29.450770 [debug] [Thread-127]: On model.test.actual: COMMIT
[0m05:51:29.451755 [debug] [Thread-128]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m05:51:29.452811 [debug] [Thread-128]: finished collecting timing info
[0m05:51:29.453061 [debug] [Thread-128]: On model.test.expected: Close
[0m05:51:29.453663 [info ] [Thread-128]: 2 of 2 OK created sql view model test16667634881586048159_test_array_construct.expected  [[32mCode: None, Rows: -1, Array Size: 1[0m in 0.08s]
[0m05:51:29.454044 [debug] [Thread-128]: Finished running node model.test.expected
[0m05:51:29.457075 [debug] [Thread-127]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m05:51:29.458702 [debug] [Thread-127]: Using vertica connection "model.test.actual"
[0m05:51:29.458873 [debug] [Thread-127]: On model.test.actual: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.actual"} */
drop view if exists "VMart"."test16667634881586048159_test_array_construct"."actual__dbt_backup" cascade
[0m05:51:29.469878 [debug] [Thread-127]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m05:51:29.470892 [debug] [Thread-127]: finished collecting timing info
[0m05:51:29.471093 [debug] [Thread-127]: On model.test.actual: Close
[0m05:51:29.471627 [info ] [Thread-127]: 1 of 2 OK created sql view model test16667634881586048159_test_array_construct.actual  [[32mCode: None, Rows: -1, Array Size: 1[0m in 0.10s]
[0m05:51:29.472023 [debug] [Thread-127]: Finished running node model.test.actual
[0m05:51:29.473289 [debug] [MainThread]: Acquiring new vertica connection "master"
[0m05:51:29.473505 [debug] [MainThread]: Using vertica connection "master"
[0m05:51:29.473620 [debug] [MainThread]: On master: BEGIN
[0m05:51:29.473724 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:51:29.488714 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m05:51:29.493692 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m05:51:29.494097 [debug] [MainThread]: On master: COMMIT
[0m05:51:29.494286 [debug] [MainThread]: Using vertica connection "master"
[0m05:51:29.494402 [debug] [MainThread]: On master: COMMIT
[0m05:51:29.499270 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.0 seconds
[0m05:51:29.499597 [debug] [MainThread]: On master: Close
[0m05:51:29.500116 [info ] [MainThread]: 
[0m05:51:29.500370 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.26 seconds (0.26s).
[0m05:51:29.500581 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:51:29.500678 [debug] [MainThread]: Connection 'model.test.actual' was properly closed.
[0m05:51:29.500776 [debug] [MainThread]: Connection 'model.test.expected' was properly closed.
[0m05:51:29.505242 [info ] [MainThread]: 
[0m05:51:29.505534 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:51:29.505767 [info ] [MainThread]: 
[0m05:51:29.505961 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m05:51:29.506201 [debug] [MainThread]: Flushing usage events
[0m05:51:29.506665 [debug] [MainThread]: Acquiring new vertica connection "_test"
[0m05:51:29.507930 [debug] [MainThread]: Using vertica connection "_test"
[0m05:51:29.508079 [debug] [MainThread]: On _test: BEGIN
[0m05:51:29.508186 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:51:29.522649 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m05:51:29.527927 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m05:51:29.528301 [debug] [MainThread]: Using vertica connection "_test"
[0m05:51:29.528505 [debug] [MainThread]: On _test: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "_test"} */

    select
    column_name
    , data_type
    , character_maximum_length
    , numeric_precision
    , numeric_scale
    from (
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.columns
        where table_schema = 'test16667634881586048159_test_array_construct'
        and table_name = 'expected'
        union all
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.view_columns
        where table_schema = 'test16667634881586048159_test_array_construct'
        and table_name = 'expected'
    ) t
    order by ordinal_position
  
[0m05:51:29.567177 [debug] [MainThread]: SQL status: Code: [Column(name='column_name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='data_type', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='character_maximum_length', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_precision', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_scale', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.04 seconds
[0m05:51:29.568417 [debug] [MainThread]: Using vertica connection "_test"
[0m05:51:29.568712 [debug] [MainThread]: On _test: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "_test"} */
with diff_count as (
    SELECT
        1 as id,
        COUNT(*) as num_missing FROM (
            (SELECT "array_col", "id" FROM "VMart"."test16667634881586048159_test_array_construct"."expected" EXCEPT
             SELECT "array_col", "id" FROM "VMart"."test16667634881586048159_test_array_construct"."actual")
             UNION ALL
            (SELECT "array_col", "id" FROM "VMart"."test16667634881586048159_test_array_construct"."actual" EXCEPT
             SELECT "array_col", "id" FROM "VMart"."test16667634881586048159_test_array_construct"."expected")
        ) as a
), table_a as (
    SELECT COUNT(*) as num_rows FROM "VMart"."test16667634881586048159_test_array_construct"."expected"
), table_b as (
    SELECT COUNT(*) as num_rows FROM "VMart"."test16667634881586048159_test_array_construct"."actual"
), row_count_diff as (
    select
        1 as id,
        table_a.num_rows - table_b.num_rows as difference
    from table_a, table_b
)
select
    row_count_diff.difference as row_count_difference,
    diff_count.num_missing as num_mismatched
from row_count_diff
join diff_count using (id)
[0m05:51:29.615268 [debug] [MainThread]: SQL status: Code: [Column(name='row_count_difference', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='num_mismatched', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.05 seconds
[0m05:51:29.616208 [debug] [MainThread]: On _test: ROLLBACK
[0m05:51:29.621481 [debug] [MainThread]: On _test: Close
[0m05:51:29.622719 [debug] [MainThread]: Acquiring new vertica connection "_test"
[0m05:51:29.624121 [debug] [MainThread]: Using vertica connection "_test"
[0m05:51:29.624301 [debug] [MainThread]: On _test: BEGIN
[0m05:51:29.624413 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:51:29.638165 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m05:51:29.643455 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m05:51:29.643718 [debug] [MainThread]: Using vertica connection "_test"
[0m05:51:29.643836 [debug] [MainThread]: On _test: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "_test"} */

    select
    column_name
    , data_type
    , character_maximum_length
    , numeric_precision
    , numeric_scale
    from (
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.columns
        where table_schema = 'test16667634881586048159_test_array_construct'
        and table_name = 'expected'
        union all
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.view_columns
        where table_schema = 'test16667634881586048159_test_array_construct'
        and table_name = 'expected'
    ) t
    order by ordinal_position
  
[0m05:51:29.680907 [debug] [MainThread]: SQL status: Code: [Column(name='column_name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='data_type', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='character_maximum_length', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_precision', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_scale', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.04 seconds
[0m05:51:29.682014 [debug] [MainThread]: On _test: ROLLBACK
[0m05:51:29.686030 [debug] [MainThread]: On _test: Close
[0m05:51:29.686696 [debug] [MainThread]: Acquiring new vertica connection "_test"
[0m05:51:29.688032 [debug] [MainThread]: Using vertica connection "_test"
[0m05:51:29.688174 [debug] [MainThread]: On _test: BEGIN
[0m05:51:29.688285 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:51:29.701161 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m05:51:29.705346 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m05:51:29.705508 [debug] [MainThread]: Using vertica connection "_test"
[0m05:51:29.705629 [debug] [MainThread]: On _test: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "_test"} */

    select
    column_name
    , data_type
    , character_maximum_length
    , numeric_precision
    , numeric_scale
    from (
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.columns
        where table_schema = 'test16667634881586048159_test_array_construct'
        and table_name = 'actual'
        union all
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.view_columns
        where table_schema = 'test16667634881586048159_test_array_construct'
        and table_name = 'actual'
    ) t
    order by ordinal_position
  
[0m05:51:29.739485 [debug] [MainThread]: SQL status: Code: [Column(name='column_name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='data_type', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='character_maximum_length', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_precision', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_scale', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.03 seconds
[0m05:51:29.740835 [debug] [MainThread]: On _test: ROLLBACK
[0m05:51:29.745267 [debug] [MainThread]: On _test: Close
[0m05:51:29.746614 [debug] [MainThread]: Acquiring new vertica connection "_test"
[0m05:51:29.746952 [debug] [MainThread]: Dropping schema "_ReferenceKey(database='vmart', schema='test16667634881586048159_test_array_construct', identifier=None)".
[0m05:51:29.749309 [debug] [MainThread]: Using vertica connection "_test"
[0m05:51:29.749614 [debug] [MainThread]: On _test: BEGIN
[0m05:51:29.749795 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:51:29.763844 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m05:51:29.767951 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m05:51:29.768194 [debug] [MainThread]: Using vertica connection "_test"
[0m05:51:29.768317 [debug] [MainThread]: On _test: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "_test"} */
drop schema if exists "test16667634881586048159_test_array_construct" cascade
  
[0m05:51:29.777927 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m05:51:29.778875 [debug] [MainThread]: On _test: COMMIT
[0m05:51:29.779087 [debug] [MainThread]: Using vertica connection "_test"
[0m05:51:29.779248 [debug] [MainThread]: On _test: COMMIT
[0m05:51:29.783403 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.0 seconds
[0m05:51:29.783733 [debug] [MainThread]: On _test: Close
[0m05:51:29.784575 [debug] [MainThread]: Connection '_test' was properly closed.
[0m05:51:29.804912 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
[0m05:51:29.806231 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m05:51:29.806524 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m05:51:29.806774 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m05:51:29.813529 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m05:51:29.814860 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m05:51:29.815795 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m05:51:29.819111 [debug] [MainThread]: Parsing macros/materializations/models/incremental/helpers.sql
[0m05:51:29.821568 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m05:51:29.825777 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m05:51:29.826866 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m05:51:29.831041 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m05:51:29.832447 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m05:51:29.839637 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m05:51:29.840747 [debug] [MainThread]: Parsing macros/materializations/snapshots/helper.sql
[0m05:51:29.840953 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m05:51:29.846599 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m05:51:29.853032 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m05:51:29.854236 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m05:51:29.855145 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m05:51:29.858706 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m05:51:29.861755 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m05:51:29.868042 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m05:51:29.869151 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m05:51:29.871222 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m05:51:29.872884 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m05:51:29.875588 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m05:51:29.876523 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m05:51:29.880127 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m05:51:29.881761 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m05:51:29.884093 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m05:51:29.893805 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m05:51:29.899105 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m05:51:29.900252 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m05:51:29.906807 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m05:51:29.910972 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m05:51:29.921534 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m05:51:29.923765 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m05:51:29.927093 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m05:51:29.935236 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m05:51:29.936309 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m05:51:29.943543 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m05:51:29.953479 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m05:51:29.954656 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m05:51:29.956118 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m05:51:29.958871 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m05:51:29.970203 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m05:51:29.974726 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m05:51:29.975811 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m05:51:29.976843 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m05:51:29.978486 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m05:51:29.979791 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m05:51:29.981596 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m05:51:29.987475 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m05:51:29.996420 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m05:51:30.000847 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m05:51:30.009251 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m05:51:30.010694 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m05:51:30.012791 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m05:51:30.015688 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m05:51:30.019325 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m05:51:30.020137 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m05:51:30.020913 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m05:51:30.021595 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m05:51:30.022429 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m05:51:30.023420 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m05:51:30.024125 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m05:51:30.024929 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m05:51:30.025710 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m05:51:30.027017 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m05:51:30.027607 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m05:51:30.028497 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m05:51:30.029313 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m05:51:30.033710 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m05:51:30.034386 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m05:51:30.035204 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m05:51:30.035903 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m05:51:30.036783 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m05:51:30.037543 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m05:51:30.039019 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m05:51:30.039681 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m05:51:30.040256 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m05:51:30.040997 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m05:51:30.041760 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m05:51:30.042900 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m05:51:30.043819 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m05:51:30.044472 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m05:51:30.044971 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m05:51:30.045667 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m05:51:30.049092 [debug] [MainThread]: Parsing macros/etc/datetime.sql
