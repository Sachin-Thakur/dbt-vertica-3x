[0m11:39:24.199178 [debug] [MainThread]: Acquiring new vertica connection "_test"
[0m11:39:24.199388 [debug] [MainThread]: Acquiring new vertica connection "_test"
[0m11:39:24.199626 [debug] [MainThread]: Creating schema "_ReferenceKey(database='vmart', schema='test16666979649084685123_test_array_concat', identifier=None)"
[0m11:39:24.200896 [debug] [MainThread]: Using vertica connection "_test"
[0m11:39:24.201031 [debug] [MainThread]: On _test: BEGIN
[0m11:39:24.201135 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:39:24.219306 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:39:24.224501 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m11:39:24.224828 [debug] [MainThread]: Using vertica connection "_test"
[0m11:39:24.224996 [debug] [MainThread]: On _test: create schema if not exists "test16666979649084685123_test_array_concat"
  
[0m11:39:24.235840 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:39:24.237485 [debug] [MainThread]: On _test: COMMIT
[0m11:39:24.237875 [debug] [MainThread]: Using vertica connection "_test"
[0m11:39:24.238190 [debug] [MainThread]: On _test: COMMIT
[0m11:39:24.244539 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:39:24.245187 [debug] [MainThread]: On _test: Close
[0m11:39:24.258035 [debug] [MainThread]: Connection '_test' was properly closed.


============================== 2022-10-25 11:39:24.263556 | 085e4380-0fd0-4f58-81a6-2d730d8d1797 ==============================
[0m11:39:24.263564 [info ] [MainThread]: Running with dbt=1.3.0
[0m11:39:24.263831 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/tmp/pytest-of-sachin/pytest-27/profile1', 'send_anonymous_usage_stats': False, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
[0m11:39:24.263943 [debug] [MainThread]: Tracking: do not track
[0m11:39:24.269743 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
[0m11:39:24.277288 [debug] [MainThread]: Parsing macros/test_assert_equal.sql
[0m11:39:24.277815 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m11:39:24.277982 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m11:39:24.278113 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m11:39:24.282364 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m11:39:24.283307 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m11:39:24.283917 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m11:39:24.286449 [debug] [MainThread]: Parsing macros/materializations/models/incremental/helpers.sql
[0m11:39:24.288212 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m11:39:24.291795 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m11:39:24.292689 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m11:39:24.296363 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m11:39:24.297641 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m11:39:24.304622 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m11:39:24.305695 [debug] [MainThread]: Parsing macros/materializations/snapshots/helper.sql
[0m11:39:24.305855 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m11:39:24.311001 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m11:39:24.314563 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m11:39:24.315137 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m11:39:24.315621 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m11:39:24.317532 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m11:39:24.319137 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m11:39:24.323170 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m11:39:24.324079 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m11:39:24.324764 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m11:39:24.326144 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m11:39:24.328450 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m11:39:24.329330 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m11:39:24.332615 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m11:39:24.334023 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m11:39:24.336037 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m11:39:24.345048 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m11:39:24.350456 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m11:39:24.351402 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m11:39:24.357662 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m11:39:24.361600 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m11:39:24.371538 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m11:39:24.373624 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m11:39:24.376856 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m11:39:24.384487 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m11:39:24.385494 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m11:39:24.392393 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m11:39:24.401841 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m11:39:24.402941 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m11:39:24.404049 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m11:39:24.406704 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m11:39:24.417460 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m11:39:24.421573 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m11:39:24.422506 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m11:39:24.423510 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m11:39:24.424955 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m11:39:24.426152 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m11:39:24.427782 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m11:39:24.433608 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m11:39:24.442187 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m11:39:24.446404 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m11:39:24.454539 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m11:39:24.455865 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m11:39:24.457928 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m11:39:24.460549 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m11:39:24.464115 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m11:39:24.464897 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m11:39:24.465555 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m11:39:24.466161 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m11:39:24.466933 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m11:39:24.467856 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m11:39:24.468470 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m11:39:24.469066 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m11:39:24.469718 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m11:39:24.470961 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m11:39:24.471500 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m11:39:24.472254 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m11:39:24.472913 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m11:39:24.476979 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m11:39:24.477562 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m11:39:24.478345 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m11:39:24.479003 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m11:39:24.479799 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m11:39:24.480476 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m11:39:24.481908 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m11:39:24.482542 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m11:39:24.483084 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m11:39:24.483769 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m11:39:24.484444 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m11:39:24.485528 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m11:39:24.486367 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m11:39:24.486917 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m11:39:24.487360 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m11:39:24.487951 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m11:39:24.490993 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m11:39:24.495892 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m11:39:24.646622 [debug] [MainThread]: 1603: static parser failed on actual.sql
[0m11:39:24.652315 [debug] [MainThread]: 1602: parser fallback to jinja rendering on actual.sql
[0m11:39:24.653180 [debug] [MainThread]: 1603: static parser failed on expected.sql
[0m11:39:24.656181 [debug] [MainThread]: 1602: parser fallback to jinja rendering on expected.sql
[0m11:39:24.677086 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 297 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m11:39:24.677737 [info ] [MainThread]: 
[0m11:39:24.678208 [debug] [MainThread]: Acquiring new vertica connection "master"
[0m11:39:24.678880 [debug] [ThreadPool]: Acquiring new vertica connection "list_VMart"
[0m11:39:24.680103 [debug] [ThreadPool]: Using vertica connection "list_VMart"
[0m11:39:24.680234 [debug] [ThreadPool]: On list_VMart: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "list_VMart"} */

    select schema_name
    from v_catalog.schemata
  
[0m11:39:24.680334 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:39:24.699069 [debug] [ThreadPool]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:39:24.718152 [debug] [ThreadPool]: SQL status: Code: [Column(name='schema_name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.04 seconds
[0m11:39:24.720852 [debug] [ThreadPool]: On list_VMart: Close
[0m11:39:24.723833 [debug] [ThreadPool]: Acquiring new vertica connection "list_VMart_test16666979649084685123_test_array_concat"
[0m11:39:24.732998 [debug] [ThreadPool]: Using vertica connection "list_VMart_test16666979649084685123_test_array_concat"
[0m11:39:24.733513 [debug] [ThreadPool]: On list_VMart_test16666979649084685123_test_array_concat: BEGIN
[0m11:39:24.733855 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:39:24.749353 [debug] [ThreadPool]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:39:24.755634 [debug] [ThreadPool]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m11:39:24.756201 [debug] [ThreadPool]: Using vertica connection "list_VMart_test16666979649084685123_test_array_concat"
[0m11:39:24.756550 [debug] [ThreadPool]: On list_VMart_test16666979649084685123_test_array_concat: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "list_VMart_test16666979649084685123_test_array_concat"} */
select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'table' as type
    from v_catalog.tables
    where table_schema ilike 'test16666979649084685123_test_array_concat'
    union all
    select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'view' as type
    from v_catalog.views
    where table_schema ilike 'test16666979649084685123_test_array_concat'
  
[0m11:39:24.771418 [debug] [ThreadPool]: SQL status: Code: [Column(name='database', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='schema', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='type', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:39:24.774013 [debug] [ThreadPool]: On list_VMart_test16666979649084685123_test_array_concat: ROLLBACK
[0m11:39:24.779680 [debug] [ThreadPool]: On list_VMart_test16666979649084685123_test_array_concat: Close
[0m11:39:24.781596 [debug] [MainThread]: Using vertica connection "master"
[0m11:39:24.782092 [debug] [MainThread]: On master: BEGIN
[0m11:39:24.782525 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:39:24.797850 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:39:24.803180 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m11:39:24.803816 [debug] [MainThread]: On master: COMMIT
[0m11:39:24.804199 [debug] [MainThread]: Using vertica connection "master"
[0m11:39:24.804542 [debug] [MainThread]: On master: COMMIT
[0m11:39:24.809543 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.0 seconds
[0m11:39:24.810171 [debug] [MainThread]: On master: Close
[0m11:39:24.811390 [info ] [MainThread]: Concurrency: 4 threads (target='default')
[0m11:39:24.812132 [info ] [MainThread]: 
[0m11:39:24.815598 [debug] [Thread-15 ]: Began running node model.test.actual
[0m11:39:24.816103 [debug] [Thread-16 ]: Began running node model.test.expected
[0m11:39:24.816804 [info ] [Thread-15 ]: 1 of 2 START sql view model test16666979649084685123_test_array_concat.actual .. [RUN]
[0m11:39:24.817601 [info ] [Thread-16 ]: 2 of 2 START sql view model test16666979649084685123_test_array_concat.expected  [RUN]
[0m11:39:24.819232 [debug] [Thread-15 ]: Acquiring new vertica connection "model.test.actual"
[0m11:39:24.820914 [debug] [Thread-16 ]: Acquiring new vertica connection "model.test.expected"
[0m11:39:24.821528 [debug] [Thread-15 ]: Began compiling node model.test.actual
[0m11:39:24.822046 [debug] [Thread-16 ]: Began compiling node model.test.expected
[0m11:39:24.822518 [debug] [Thread-15 ]: Compiling model.test.actual
[0m11:39:24.823000 [debug] [Thread-16 ]: Compiling model.test.expected
[0m11:39:24.832595 [debug] [Thread-15 ]: Writing injected SQL for node "model.test.actual"
[0m11:39:24.837623 [debug] [Thread-16 ]: Writing injected SQL for node "model.test.expected"
[0m11:39:24.838349 [debug] [Thread-15 ]: finished collecting timing info
[0m11:39:24.838475 [debug] [Thread-16 ]: finished collecting timing info
[0m11:39:24.838688 [debug] [Thread-15 ]: Began executing node model.test.actual
[0m11:39:24.838868 [debug] [Thread-16 ]: Began executing node model.test.expected
[0m11:39:24.841374 [debug] [Thread-15 ]: Writing runtime sql for node "model.test.actual"
[0m11:39:24.845003 [debug] [Thread-16 ]: Writing runtime sql for node "model.test.expected"
[0m11:39:24.845622 [debug] [Thread-15 ]: Using vertica connection "model.test.actual"
[0m11:39:24.845790 [debug] [Thread-16 ]: Using vertica connection "model.test.expected"
[0m11:39:24.845964 [debug] [Thread-15 ]: On model.test.actual: BEGIN
[0m11:39:24.846123 [debug] [Thread-16 ]: On model.test.expected: BEGIN
[0m11:39:24.846297 [debug] [Thread-15 ]: Opening a new connection, currently in state closed
[0m11:39:24.846432 [debug] [Thread-16 ]: Opening a new connection, currently in state init
[0m11:39:24.860263 [debug] [Thread-15 ]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:39:24.861414 [debug] [Thread-16 ]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:39:24.864607 [debug] [Thread-15 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m11:39:24.864919 [debug] [Thread-15 ]: Using vertica connection "model.test.actual"
[0m11:39:24.865125 [debug] [Thread-15 ]: On model.test.actual: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.actual"} */

  create view "VMart"."test16666979649084685123_test_array_concat"."actual__dbt_tmp" as (
    select 1 as id, array_cat(
    array[ 1 , 2 , 3 ]
    , 
    array[ 4 , 5 , 6 ]
    ) as array_col union all
select 2 as id, array_cat(
    array[]::INT[]
    , 
    array[ 2 ]
    ) as array_col union all
select 3 as id, array_cat(
    array[ 3 ]
    , 
    array[]::INT[]
    ) as array_col
  );
[0m11:39:24.865520 [debug] [Thread-16 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m11:39:24.865690 [debug] [Thread-16 ]: Using vertica connection "model.test.expected"
[0m11:39:24.865804 [debug] [Thread-16 ]: On model.test.expected: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.expected"} */

  create view "VMart"."test16666979649084685123_test_array_concat"."expected__dbt_tmp" as (
    select 1 as id, 
    array[ 1 , 2 , 3 , 4 , 5 , 6 ]
     as array_col union all
select 2 as id, 
    array[ 2 ]
     as array_col union all
select 3 as id, 
    array[ 3 ]
     as array_col
  );
[0m11:39:24.874054 [debug] [Thread-15 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:39:24.876722 [debug] [Thread-15 ]: Using vertica connection "model.test.actual"
[0m11:39:24.876890 [debug] [Thread-15 ]: On model.test.actual: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.actual"} */
alter view "VMart"."test16666979649084685123_test_array_concat"."actual__dbt_tmp" rename to "actual"
[0m11:39:24.882872 [debug] [Thread-16 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m11:39:24.884446 [debug] [Thread-16 ]: Using vertica connection "model.test.expected"
[0m11:39:24.884593 [debug] [Thread-16 ]: On model.test.expected: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.expected"} */
alter view "VMart"."test16666979649084685123_test_array_concat"."expected__dbt_tmp" rename to "expected"
[0m11:39:24.884836 [debug] [Thread-15 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:39:24.885827 [debug] [Thread-15 ]: On model.test.actual: COMMIT
[0m11:39:24.885977 [debug] [Thread-15 ]: Using vertica connection "model.test.actual"
[0m11:39:24.886085 [debug] [Thread-15 ]: On model.test.actual: COMMIT
[0m11:39:24.890105 [debug] [Thread-15 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.0 seconds
[0m11:39:24.891408 [debug] [Thread-15 ]: Using vertica connection "model.test.actual"
[0m11:39:24.891535 [debug] [Thread-15 ]: On model.test.actual: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.actual"} */
drop view if exists "VMart"."test16666979649084685123_test_array_concat"."actual__dbt_backup" cascade
[0m11:39:24.896596 [debug] [Thread-15 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.0 seconds
[0m11:39:24.897326 [debug] [Thread-15 ]: finished collecting timing info
[0m11:39:24.897483 [debug] [Thread-15 ]: On model.test.actual: Close
[0m11:39:24.897994 [info ] [Thread-15 ]: 1 of 2 OK created sql view model test16666979649084685123_test_array_concat.actual  [[32mCode: None, Rows: -1, Array Size: 1[0m in 0.08s]
[0m11:39:24.898329 [debug] [Thread-15 ]: Finished running node model.test.actual
[0m11:39:24.898558 [debug] [Thread-16 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:39:24.899555 [debug] [Thread-16 ]: On model.test.expected: COMMIT
[0m11:39:24.899703 [debug] [Thread-16 ]: Using vertica connection "model.test.expected"
[0m11:39:24.899837 [debug] [Thread-16 ]: On model.test.expected: COMMIT
[0m11:39:24.905325 [debug] [Thread-16 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:39:24.906618 [debug] [Thread-16 ]: Using vertica connection "model.test.expected"
[0m11:39:24.906759 [debug] [Thread-16 ]: On model.test.expected: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.expected"} */
drop view if exists "VMart"."test16666979649084685123_test_array_concat"."expected__dbt_backup" cascade
[0m11:39:24.914968 [debug] [Thread-16 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:39:24.915866 [debug] [Thread-16 ]: finished collecting timing info
[0m11:39:24.916028 [debug] [Thread-16 ]: On model.test.expected: Close
[0m11:39:24.916526 [info ] [Thread-16 ]: 2 of 2 OK created sql view model test16666979649084685123_test_array_concat.expected  [[32mCode: None, Rows: -1, Array Size: 1[0m in 0.10s]
[0m11:39:24.916861 [debug] [Thread-16 ]: Finished running node model.test.expected
[0m11:39:24.918110 [debug] [MainThread]: Acquiring new vertica connection "master"
[0m11:39:24.918357 [debug] [MainThread]: Using vertica connection "master"
[0m11:39:24.918549 [debug] [MainThread]: On master: BEGIN
[0m11:39:24.918732 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:39:24.937850 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:39:24.943065 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m11:39:24.943254 [debug] [MainThread]: On master: COMMIT
[0m11:39:24.943379 [debug] [MainThread]: Using vertica connection "master"
[0m11:39:24.943497 [debug] [MainThread]: On master: COMMIT
[0m11:39:24.948251 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.0 seconds
[0m11:39:24.948449 [debug] [MainThread]: On master: Close
[0m11:39:24.948977 [info ] [MainThread]: 
[0m11:39:24.949214 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.27 seconds (0.27s).
[0m11:39:24.949409 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:39:24.949501 [debug] [MainThread]: Connection 'model.test.actual' was properly closed.
[0m11:39:24.949614 [debug] [MainThread]: Connection 'model.test.expected' was properly closed.
[0m11:39:24.953490 [info ] [MainThread]: 
[0m11:39:24.953777 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:39:24.954006 [info ] [MainThread]: 
[0m11:39:24.954188 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m11:39:24.954427 [debug] [MainThread]: Flushing usage events


============================== 2022-10-25 11:39:24.972604 | 085e4380-0fd0-4f58-81a6-2d730d8d1797 ==============================
[0m11:39:24.972618 [info ] [MainThread]: Running with dbt=1.3.0
[0m11:39:24.973010 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/tmp/pytest-of-sachin/pytest-27/profile1', 'send_anonymous_usage_stats': False, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
[0m11:39:24.973234 [debug] [MainThread]: Tracking: do not track
[0m11:39:24.995676 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:39:24.995901 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:39:25.004028 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 297 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m11:39:25.004763 [info ] [MainThread]: 
[0m11:39:25.005275 [debug] [MainThread]: Acquiring new vertica connection "master"
[0m11:39:25.005992 [debug] [ThreadPool]: Acquiring new vertica connection "list_VMart"
[0m11:39:25.007281 [debug] [ThreadPool]: Using vertica connection "list_VMart"
[0m11:39:25.007560 [debug] [ThreadPool]: On list_VMart: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "list_VMart"} */

    select schema_name
    from v_catalog.schemata
  
[0m11:39:25.007705 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:39:25.024439 [debug] [ThreadPool]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:39:25.041256 [debug] [ThreadPool]: SQL status: Code: [Column(name='schema_name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.03 seconds
[0m11:39:25.042370 [debug] [ThreadPool]: On list_VMart: Close
[0m11:39:25.043477 [debug] [ThreadPool]: Acquiring new vertica connection "list_VMart_test16666979649084685123_test_array_concat"
[0m11:39:25.044877 [debug] [ThreadPool]: Using vertica connection "list_VMart_test16666979649084685123_test_array_concat"
[0m11:39:25.045047 [debug] [ThreadPool]: On list_VMart_test16666979649084685123_test_array_concat: BEGIN
[0m11:39:25.045157 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:39:25.060366 [debug] [ThreadPool]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:39:25.065643 [debug] [ThreadPool]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m11:39:25.065897 [debug] [ThreadPool]: Using vertica connection "list_VMart_test16666979649084685123_test_array_concat"
[0m11:39:25.066026 [debug] [ThreadPool]: On list_VMart_test16666979649084685123_test_array_concat: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "list_VMart_test16666979649084685123_test_array_concat"} */
select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'table' as type
    from v_catalog.tables
    where table_schema ilike 'test16666979649084685123_test_array_concat'
    union all
    select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'view' as type
    from v_catalog.views
    where table_schema ilike 'test16666979649084685123_test_array_concat'
  
[0m11:39:25.081015 [debug] [ThreadPool]: SQL status: Code: [Column(name='database', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='schema', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='type', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:39:25.082340 [debug] [ThreadPool]: On list_VMart_test16666979649084685123_test_array_concat: ROLLBACK
[0m11:39:25.086981 [debug] [ThreadPool]: On list_VMart_test16666979649084685123_test_array_concat: Close
[0m11:39:25.087869 [debug] [MainThread]: Using vertica connection "master"
[0m11:39:25.088067 [debug] [MainThread]: On master: BEGIN
[0m11:39:25.088188 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:39:25.101177 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:39:25.105298 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m11:39:25.105636 [debug] [MainThread]: On master: COMMIT
[0m11:39:25.105764 [debug] [MainThread]: Using vertica connection "master"
[0m11:39:25.105873 [debug] [MainThread]: On master: COMMIT
[0m11:39:25.110544 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.0 seconds
[0m11:39:25.110784 [debug] [MainThread]: On master: Close
[0m11:39:25.111247 [info ] [MainThread]: Concurrency: 4 threads (target='default')
[0m11:39:25.111543 [info ] [MainThread]: 
[0m11:39:25.112904 [debug] [Thread-22 ]: Began running node model.test.actual
[0m11:39:25.113035 [debug] [Thread-23 ]: Began running node model.test.expected
[0m11:39:25.113265 [info ] [Thread-22 ]: 1 of 2 START sql view model test16666979649084685123_test_array_concat.actual .. [RUN]
[0m11:39:25.113453 [info ] [Thread-23 ]: 2 of 2 START sql view model test16666979649084685123_test_array_concat.expected  [RUN]
[0m11:39:25.113959 [debug] [Thread-22 ]: Acquiring new vertica connection "model.test.actual"
[0m11:39:25.114428 [debug] [Thread-23 ]: Acquiring new vertica connection "model.test.expected"
[0m11:39:25.114572 [debug] [Thread-22 ]: Began compiling node model.test.actual
[0m11:39:25.114718 [debug] [Thread-23 ]: Began compiling node model.test.expected
[0m11:39:25.114870 [debug] [Thread-22 ]: Compiling model.test.actual
[0m11:39:25.115005 [debug] [Thread-23 ]: Compiling model.test.expected
[0m11:39:25.119137 [debug] [Thread-22 ]: Writing injected SQL for node "model.test.actual"
[0m11:39:25.122122 [debug] [Thread-23 ]: Writing injected SQL for node "model.test.expected"
[0m11:39:25.122594 [debug] [Thread-22 ]: finished collecting timing info
[0m11:39:25.122741 [debug] [Thread-23 ]: finished collecting timing info
[0m11:39:25.122880 [debug] [Thread-22 ]: Began executing node model.test.actual
[0m11:39:25.123029 [debug] [Thread-23 ]: Began executing node model.test.expected
[0m11:39:25.126009 [debug] [Thread-22 ]: Writing runtime sql for node "model.test.actual"
[0m11:39:25.128482 [debug] [Thread-23 ]: Writing runtime sql for node "model.test.expected"
[0m11:39:25.128961 [debug] [Thread-22 ]: Using vertica connection "model.test.actual"
[0m11:39:25.129122 [debug] [Thread-23 ]: Using vertica connection "model.test.expected"
[0m11:39:25.129250 [debug] [Thread-22 ]: On model.test.actual: BEGIN
[0m11:39:25.129383 [debug] [Thread-23 ]: On model.test.expected: BEGIN
[0m11:39:25.129510 [debug] [Thread-22 ]: Opening a new connection, currently in state closed
[0m11:39:25.129636 [debug] [Thread-23 ]: Opening a new connection, currently in state init
[0m11:39:25.144410 [debug] [Thread-22 ]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:39:25.145359 [debug] [Thread-23 ]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:39:25.148590 [debug] [Thread-22 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m11:39:25.148790 [debug] [Thread-22 ]: Using vertica connection "model.test.actual"
[0m11:39:25.148910 [debug] [Thread-22 ]: On model.test.actual: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.actual"} */

  create view "VMart"."test16666979649084685123_test_array_concat"."actual__dbt_tmp" as (
    select 1 as id, array_cat(
    array[ 1 , 2 , 3 ]
    , 
    array[ 4 , 5 , 6 ]
    ) as array_col union all
select 2 as id, array_cat(
    array[]::INT[]
    , 
    array[ 2 ]
    ) as array_col union all
select 3 as id, array_cat(
    array[ 3 ]
    , 
    array[]::INT[]
    ) as array_col
  );
[0m11:39:25.151810 [debug] [Thread-23 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m11:39:25.152049 [debug] [Thread-23 ]: Using vertica connection "model.test.expected"
[0m11:39:25.152197 [debug] [Thread-23 ]: On model.test.expected: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.expected"} */

  create view "VMart"."test16666979649084685123_test_array_concat"."expected__dbt_tmp" as (
    select 1 as id, 
    array[ 1 , 2 , 3 , 4 , 5 , 6 ]
     as array_col union all
select 2 as id, 
    array[ 2 ]
     as array_col union all
select 3 as id, 
    array[ 3 ]
     as array_col
  );
[0m11:39:25.159709 [debug] [Thread-22 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:39:25.161700 [debug] [Thread-22 ]: Using vertica connection "model.test.actual"
[0m11:39:25.161883 [debug] [Thread-22 ]: On model.test.actual: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.actual"} */
alter view "VMart"."test16666979649084685123_test_array_concat"."actual" rename to "actual__dbt_backup"
[0m11:39:25.164850 [debug] [Thread-23 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:39:25.208190 [debug] [Thread-23 ]: Using vertica connection "model.test.expected"
[0m11:39:25.208541 [debug] [Thread-22 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.05 seconds
[0m11:39:25.208762 [debug] [Thread-23 ]: On model.test.expected: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.expected"} */
alter view "VMart"."test16666979649084685123_test_array_concat"."expected" rename to "expected__dbt_backup"
[0m11:39:25.210712 [debug] [Thread-22 ]: Using vertica connection "model.test.actual"
[0m11:39:25.211139 [debug] [Thread-22 ]: On model.test.actual: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.actual"} */
alter view "VMart"."test16666979649084685123_test_array_concat"."actual__dbt_tmp" rename to "actual"
[0m11:39:25.219262 [debug] [Thread-22 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:39:25.220685 [debug] [Thread-22 ]: On model.test.actual: COMMIT
[0m11:39:25.220883 [debug] [Thread-22 ]: Using vertica connection "model.test.actual"
[0m11:39:25.221001 [debug] [Thread-22 ]: On model.test.actual: COMMIT
[0m11:39:25.223629 [debug] [Thread-23 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:39:25.226748 [debug] [Thread-23 ]: Using vertica connection "model.test.expected"
[0m11:39:25.227076 [debug] [Thread-23 ]: On model.test.expected: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.expected"} */
alter view "VMart"."test16666979649084685123_test_array_concat"."expected__dbt_tmp" rename to "expected"
[0m11:39:25.227447 [debug] [Thread-22 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:39:25.229012 [debug] [Thread-22 ]: Using vertica connection "model.test.actual"
[0m11:39:25.229219 [debug] [Thread-22 ]: On model.test.actual: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.actual"} */
drop view if exists "VMart"."test16666979649084685123_test_array_concat"."actual__dbt_backup" cascade
[0m11:39:25.237452 [debug] [Thread-22 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:39:25.238534 [debug] [Thread-22 ]: finished collecting timing info
[0m11:39:25.238753 [debug] [Thread-22 ]: On model.test.actual: Close
[0m11:39:25.239347 [info ] [Thread-22 ]: 1 of 2 OK created sql view model test16666979649084685123_test_array_concat.actual  [[32mCode: None, Rows: -1, Array Size: 1[0m in 0.13s]
[0m11:39:25.239647 [debug] [Thread-23 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:39:25.241065 [debug] [Thread-23 ]: On model.test.expected: COMMIT
[0m11:39:25.241332 [debug] [Thread-23 ]: Using vertica connection "model.test.expected"
[0m11:39:25.241643 [debug] [Thread-22 ]: Finished running node model.test.actual
[0m11:39:25.241827 [debug] [Thread-23 ]: On model.test.expected: COMMIT
[0m11:39:25.246264 [debug] [Thread-23 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.0 seconds
[0m11:39:25.248968 [debug] [Thread-23 ]: Using vertica connection "model.test.expected"
[0m11:39:25.249315 [debug] [Thread-23 ]: On model.test.expected: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.expected"} */
drop view if exists "VMart"."test16666979649084685123_test_array_concat"."expected__dbt_backup" cascade
[0m11:39:25.258022 [debug] [Thread-23 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:39:25.259573 [debug] [Thread-23 ]: finished collecting timing info
[0m11:39:25.259889 [debug] [Thread-23 ]: On model.test.expected: Close
[0m11:39:25.260755 [info ] [Thread-23 ]: 2 of 2 OK created sql view model test16666979649084685123_test_array_concat.expected  [[32mCode: None, Rows: -1, Array Size: 1[0m in 0.15s]
[0m11:39:25.261326 [debug] [Thread-23 ]: Finished running node model.test.expected
[0m11:39:25.262492 [debug] [MainThread]: Acquiring new vertica connection "master"
[0m11:39:25.262769 [debug] [MainThread]: Using vertica connection "master"
[0m11:39:25.262980 [debug] [MainThread]: On master: BEGIN
[0m11:39:25.263165 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:39:25.276048 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:39:25.280257 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m11:39:25.280646 [debug] [MainThread]: On master: COMMIT
[0m11:39:25.280866 [debug] [MainThread]: Using vertica connection "master"
[0m11:39:25.281048 [debug] [MainThread]: On master: COMMIT
[0m11:39:25.285510 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.0 seconds
[0m11:39:25.285928 [debug] [MainThread]: On master: Close
[0m11:39:25.286740 [info ] [MainThread]: 
[0m11:39:25.287185 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m11:39:25.287563 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:39:25.287733 [debug] [MainThread]: Connection 'model.test.actual' was properly closed.
[0m11:39:25.287880 [debug] [MainThread]: Connection 'model.test.expected' was properly closed.
[0m11:39:25.295128 [info ] [MainThread]: 
[0m11:39:25.295639 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:39:25.296005 [info ] [MainThread]: 
[0m11:39:25.296310 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m11:39:25.296693 [debug] [MainThread]: Flushing usage events
[0m11:39:25.297412 [debug] [MainThread]: Acquiring new vertica connection "_test"
[0m11:39:25.304357 [debug] [MainThread]: Using vertica connection "_test"
[0m11:39:25.304761 [debug] [MainThread]: On _test: BEGIN
[0m11:39:25.304975 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:39:25.321303 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:39:25.329858 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m11:39:25.330144 [debug] [MainThread]: Using vertica connection "_test"
[0m11:39:25.330287 [debug] [MainThread]: On _test: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "_test"} */

    select
    column_name
    , data_type
    , character_maximum_length
    , numeric_precision
    , numeric_scale
    from (
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.columns
        where table_schema = 'test16666979649084685123_test_array_concat'
        and table_name = 'expected'
        union all
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.view_columns
        where table_schema = 'test16666979649084685123_test_array_concat'
        and table_name = 'expected'
    ) t
    order by ordinal_position
  
[0m11:39:25.385419 [debug] [MainThread]: SQL status: Code: [Column(name='column_name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='data_type', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='character_maximum_length', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_precision', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_scale', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.05 seconds
[0m11:39:25.388170 [debug] [MainThread]: Using vertica connection "_test"
[0m11:39:25.388371 [debug] [MainThread]: On _test: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "_test"} */
with diff_count as (
    SELECT
        1 as id,
        COUNT(*) as num_missing FROM (
            (SELECT "array_col", "id" FROM "VMart"."test16666979649084685123_test_array_concat"."expected" EXCEPT
             SELECT "array_col", "id" FROM "VMart"."test16666979649084685123_test_array_concat"."actual")
             UNION ALL
            (SELECT "array_col", "id" FROM "VMart"."test16666979649084685123_test_array_concat"."actual" EXCEPT
             SELECT "array_col", "id" FROM "VMart"."test16666979649084685123_test_array_concat"."expected")
        ) as a
), table_a as (
    SELECT COUNT(*) as num_rows FROM "VMart"."test16666979649084685123_test_array_concat"."expected"
), table_b as (
    SELECT COUNT(*) as num_rows FROM "VMart"."test16666979649084685123_test_array_concat"."actual"
), row_count_diff as (
    select
        1 as id,
        table_a.num_rows - table_b.num_rows as difference
    from table_a, table_b
)
select
    row_count_diff.difference as row_count_difference,
    diff_count.num_missing as num_mismatched
from row_count_diff
join diff_count using (id)
[0m11:39:25.446173 [debug] [MainThread]: SQL status: Code: [Column(name='row_count_difference', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='num_mismatched', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.06 seconds
[0m11:39:25.447717 [debug] [MainThread]: On _test: ROLLBACK
[0m11:39:25.453966 [debug] [MainThread]: On _test: Close
[0m11:39:25.454965 [debug] [MainThread]: Acquiring new vertica connection "_test"
[0m11:39:25.456310 [debug] [MainThread]: Using vertica connection "_test"
[0m11:39:25.456450 [debug] [MainThread]: On _test: BEGIN
[0m11:39:25.456561 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:39:25.472743 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:39:25.476936 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m11:39:25.477244 [debug] [MainThread]: Using vertica connection "_test"
[0m11:39:25.477406 [debug] [MainThread]: On _test: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "_test"} */

    select
    column_name
    , data_type
    , character_maximum_length
    , numeric_precision
    , numeric_scale
    from (
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.columns
        where table_schema = 'test16666979649084685123_test_array_concat'
        and table_name = 'expected'
        union all
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.view_columns
        where table_schema = 'test16666979649084685123_test_array_concat'
        and table_name = 'expected'
    ) t
    order by ordinal_position
  
[0m11:39:25.504292 [debug] [MainThread]: SQL status: Code: [Column(name='column_name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='data_type', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='character_maximum_length', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_precision', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_scale', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.03 seconds
[0m11:39:25.507381 [debug] [MainThread]: On _test: ROLLBACK
[0m11:39:25.513168 [debug] [MainThread]: On _test: Close
[0m11:39:25.515246 [debug] [MainThread]: Acquiring new vertica connection "_test"
[0m11:39:25.520754 [debug] [MainThread]: Using vertica connection "_test"
[0m11:39:25.521170 [debug] [MainThread]: On _test: BEGIN
[0m11:39:25.521476 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:39:25.535677 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:39:25.541042 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m11:39:25.541613 [debug] [MainThread]: Using vertica connection "_test"
[0m11:39:25.541972 [debug] [MainThread]: On _test: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "_test"} */

    select
    column_name
    , data_type
    , character_maximum_length
    , numeric_precision
    , numeric_scale
    from (
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.columns
        where table_schema = 'test16666979649084685123_test_array_concat'
        and table_name = 'actual'
        union all
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.view_columns
        where table_schema = 'test16666979649084685123_test_array_concat'
        and table_name = 'actual'
    ) t
    order by ordinal_position
  
[0m11:39:25.568449 [debug] [MainThread]: SQL status: Code: [Column(name='column_name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='data_type', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='character_maximum_length', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_precision', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_scale', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.03 seconds
[0m11:39:25.571504 [debug] [MainThread]: On _test: ROLLBACK
[0m11:39:25.576864 [debug] [MainThread]: On _test: Close
[0m11:39:25.579703 [debug] [MainThread]: Acquiring new vertica connection "_test"
[0m11:39:25.580351 [debug] [MainThread]: Dropping schema "_ReferenceKey(database='vmart', schema='test16666979649084685123_test_array_concat', identifier=None)".
[0m11:39:25.584195 [debug] [MainThread]: Using vertica connection "_test"
[0m11:39:25.584730 [debug] [MainThread]: On _test: BEGIN
[0m11:39:25.585081 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:39:25.599964 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:39:25.605052 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m11:39:25.605287 [debug] [MainThread]: Using vertica connection "_test"
[0m11:39:25.605444 [debug] [MainThread]: On _test: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "_test"} */
drop schema if exists "test16666979649084685123_test_array_concat" cascade
  
[0m11:39:25.615731 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:39:25.616578 [debug] [MainThread]: On _test: COMMIT
[0m11:39:25.616767 [debug] [MainThread]: Using vertica connection "_test"
[0m11:39:25.616901 [debug] [MainThread]: On _test: COMMIT
[0m11:39:25.621284 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.0 seconds
[0m11:39:25.621537 [debug] [MainThread]: On _test: Close
[0m11:39:25.622555 [debug] [MainThread]: Connection '_test' was properly closed.
[0m11:39:25.639514 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
[0m11:39:25.640442 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m11:39:25.640684 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m11:39:25.640859 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m11:39:25.646864 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m11:39:25.648434 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m11:39:25.649413 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m11:39:25.653350 [debug] [MainThread]: Parsing macros/materializations/models/incremental/helpers.sql
[0m11:39:25.655876 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m11:39:25.660951 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m11:39:25.662288 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m11:39:25.667298 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m11:39:25.668846 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m11:39:25.677709 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m11:39:25.679018 [debug] [MainThread]: Parsing macros/materializations/snapshots/helper.sql
[0m11:39:25.679264 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m11:39:25.684912 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m11:39:25.688624 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m11:39:25.689274 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m11:39:25.689770 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m11:39:25.691836 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m11:39:25.693661 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m11:39:25.697865 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m11:39:25.698778 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m11:39:25.700697 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m11:39:25.702137 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m11:39:25.704535 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m11:39:25.705404 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m11:39:25.708758 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m11:39:25.710173 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m11:39:25.712256 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m11:39:25.721488 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m11:39:25.726300 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m11:39:25.727372 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m11:39:25.733646 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m11:39:25.737730 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m11:39:25.747911 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m11:39:25.750062 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m11:39:25.753346 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m11:39:25.761445 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m11:39:25.762502 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m11:39:25.769438 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m11:39:25.778906 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m11:39:25.780035 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m11:39:25.781238 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m11:39:25.783926 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m11:39:25.794708 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m11:39:25.798845 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m11:39:25.799818 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m11:39:25.800797 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m11:39:25.802288 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m11:39:25.803532 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m11:39:25.805186 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m11:39:25.810912 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m11:39:25.819577 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m11:39:25.823798 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m11:39:25.831904 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m11:39:25.833277 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m11:39:25.835359 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m11:39:25.837972 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m11:39:25.841671 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m11:39:25.842489 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m11:39:25.843224 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m11:39:25.843858 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m11:39:25.844645 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m11:39:25.845616 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m11:39:25.846254 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m11:39:25.846877 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m11:39:25.847650 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m11:39:25.848948 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m11:39:25.849522 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m11:39:25.850327 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m11:39:25.851049 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m11:39:25.855020 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m11:39:25.855663 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m11:39:25.856480 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m11:39:25.857186 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m11:39:25.858087 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m11:39:25.858801 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m11:39:25.860248 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m11:39:25.860883 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m11:39:25.861442 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m11:39:25.862153 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m11:39:25.862928 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m11:39:25.864085 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m11:39:25.865014 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m11:39:25.865605 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m11:39:25.866076 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m11:39:25.866714 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m11:39:25.869800 [debug] [MainThread]: Parsing macros/etc/datetime.sql
