[0m13:30:17.370204 [debug] [MainThread]: Acquiring new vertica connection "_test"
[0m13:30:17.370388 [debug] [MainThread]: Acquiring new vertica connection "_test"
[0m13:30:17.370572 [debug] [MainThread]: Creating schema "_ReferenceKey(database='vmart', schema='test16658406171269843173_test_basic', identifier=None)"
[0m13:30:17.376278 [debug] [MainThread]: Using vertica connection "_test"
[0m13:30:17.376473 [debug] [MainThread]: On _test: BEGIN
[0m13:30:17.376602 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:30:17.452466 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m13:30:17.462567 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.09 seconds
[0m13:30:17.463225 [debug] [MainThread]: Using vertica connection "_test"
[0m13:30:17.463635 [debug] [MainThread]: On _test: create schema if not exists "test16658406171269843173_test_basic"
  
[0m13:30:17.591445 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.13 seconds
[0m13:30:17.593327 [debug] [MainThread]: On _test: COMMIT
[0m13:30:17.593773 [debug] [MainThread]: Using vertica connection "_test"
[0m13:30:17.594120 [debug] [MainThread]: On _test: COMMIT
[0m13:30:17.657657 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.06 seconds
[0m13:30:17.658364 [debug] [MainThread]: On _test: Close
[0m13:30:17.673621 [debug] [MainThread]: Connection '_test' was properly closed.


============================== 2022-10-15 13:30:17.679649 | 901d5a89-d9b7-4477-89b3-50d453532b3d ==============================
[0m13:30:17.679662 [info ] [MainThread]: Running with dbt=1.2.2
[0m13:30:17.679986 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/tmp/pytest-of-sachin/pytest-94/profile0', 'send_anonymous_usage_stats': False, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'parse_only': False, 'which': 'compile', 'rpc_method': 'compile', 'indirect_selection': 'eager'}
[0m13:30:17.680114 [debug] [MainThread]: Tracking: do not track
[0m13:30:17.686737 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
[0m13:30:17.694900 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m13:30:17.695169 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m13:30:17.695327 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m13:30:17.699697 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m13:30:17.700566 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m13:30:17.701133 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m13:30:17.703696 [debug] [MainThread]: Parsing macros/materializations/models/incremental/helpers.sql
[0m13:30:17.705579 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m13:30:17.710289 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m13:30:17.711451 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m13:30:17.715269 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m13:30:17.716537 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m13:30:17.723762 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m13:30:17.725084 [debug] [MainThread]: Parsing macros/materializations/snapshots/helper.sql
[0m13:30:17.725296 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m13:30:17.730786 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m13:30:17.734385 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m13:30:17.734954 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m13:30:17.735385 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m13:30:17.737249 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m13:30:17.738947 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m13:30:17.743416 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m13:30:17.744389 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m13:30:17.745135 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m13:30:17.746644 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m13:30:17.748960 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m13:30:17.749846 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m13:30:17.753093 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m13:30:17.754560 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m13:30:17.756828 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m13:30:17.767302 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m13:30:17.770271 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m13:30:17.771317 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m13:30:17.777391 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m13:30:17.786767 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m13:30:17.788641 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m13:30:17.792231 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m13:30:17.800586 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m13:30:17.801660 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m13:30:17.809320 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m13:30:17.819636 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m13:30:17.820760 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m13:30:17.821997 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m13:30:17.824767 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m13:30:17.835759 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m13:30:17.840095 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m13:30:17.841041 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m13:30:17.841993 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m13:30:17.843566 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m13:30:17.845295 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m13:30:17.846885 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m13:30:17.852620 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m13:30:17.861376 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m13:30:17.865657 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m13:30:17.874039 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m13:30:17.875431 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m13:30:17.878198 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m13:30:17.878987 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m13:30:17.879591 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m13:30:17.880211 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m13:30:17.880793 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m13:30:17.881431 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m13:30:17.882680 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m13:30:17.883200 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m13:30:17.883960 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m13:30:17.884745 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m13:30:17.888094 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m13:30:17.888761 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m13:30:17.889551 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m13:30:17.890198 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m13:30:17.890945 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m13:30:17.891680 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m13:30:17.893106 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m13:30:17.893722 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m13:30:17.894238 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m13:30:17.894937 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m13:30:17.895619 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m13:30:17.896717 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m13:30:17.897557 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m13:30:17.898107 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m13:30:17.898548 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m13:30:17.899145 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m13:30:17.901844 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m13:30:17.906893 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m13:30:18.069113 [debug] [MainThread]: 1699: static parser successfully parsed expected.sql
[0m13:30:18.077409 [debug] [MainThread]: 1699: static parser successfully parsed upstream.sql
[0m13:30:18.079066 [debug] [MainThread]: 1603: static parser failed on model.sql
[0m13:30:18.083504 [debug] [MainThread]: 1602: parser fallback to jinja rendering on model.sql
[0m13:30:18.114665 [info ] [MainThread]: Found 3 models, 1 test, 0 snapshots, 0 analyses, 266 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m13:30:18.115660 [info ] [MainThread]: 
[0m13:30:18.116099 [debug] [MainThread]: Acquiring new vertica connection "master"
[0m13:30:18.116765 [debug] [ThreadPool]: Acquiring new vertica connection "list_VMart_test16658406171269843173_test_basic"
[0m13:30:18.120635 [debug] [ThreadPool]: Using vertica connection "list_VMart_test16658406171269843173_test_basic"
[0m13:30:18.120830 [debug] [ThreadPool]: On list_VMart_test16658406171269843173_test_basic: BEGIN
[0m13:30:18.120955 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:30:18.183284 [debug] [ThreadPool]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m13:30:18.203972 [debug] [ThreadPool]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.08 seconds
[0m13:30:18.204262 [debug] [ThreadPool]: Using vertica connection "list_VMart_test16658406171269843173_test_basic"
[0m13:30:18.204436 [debug] [ThreadPool]: On list_VMart_test16658406171269843173_test_basic: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "test", "target_name": "default", "connection_name": "list_VMart_test16658406171269843173_test_basic"} */
select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'table' as type
    from v_catalog.tables
    where table_schema ilike 'test16658406171269843173_test_basic'
    union all
    select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'view' as type
    from v_catalog.views
    where table_schema ilike 'test16658406171269843173_test_basic'
  
[0m13:30:18.228010 [debug] [ThreadPool]: SQL status: Code: [Column(name='database', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='schema', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='type', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.02 seconds
[0m13:30:18.229003 [debug] [ThreadPool]: On list_VMart_test16658406171269843173_test_basic: ROLLBACK
[0m13:30:18.246562 [debug] [ThreadPool]: On list_VMart_test16658406171269843173_test_basic: Close
[0m13:30:18.247437 [info ] [MainThread]: Concurrency: 4 threads (target='default')
[0m13:30:18.247763 [info ] [MainThread]: 
[0m13:30:18.251376 [debug] [Thread-1 (]: Began running node model.adapter_methods.upstream
[0m13:30:18.251738 [debug] [Thread-1 (]: Acquiring new vertica connection "model.adapter_methods.upstream"
[0m13:30:18.251900 [debug] [Thread-1 (]: Began compiling node model.adapter_methods.upstream
[0m13:30:18.252037 [debug] [Thread-1 (]: Compiling model.adapter_methods.upstream
[0m13:30:18.253078 [debug] [Thread-1 (]: Writing injected SQL for node "model.adapter_methods.upstream"
[0m13:30:18.253400 [debug] [Thread-1 (]: finished collecting timing info
[0m13:30:18.253547 [debug] [Thread-1 (]: Began executing node model.adapter_methods.upstream
[0m13:30:18.253677 [debug] [Thread-1 (]: finished collecting timing info
[0m13:30:18.253986 [debug] [Thread-1 (]: Finished running node model.adapter_methods.upstream
[0m13:30:18.254391 [debug] [Thread-3 (]: Began running node model.adapter_methods.model
[0m13:30:18.254641 [debug] [Thread-3 (]: Acquiring new vertica connection "model.adapter_methods.model"
[0m13:30:18.254788 [debug] [Thread-3 (]: Began compiling node model.adapter_methods.model
[0m13:30:18.254910 [debug] [Thread-3 (]: Compiling model.adapter_methods.model
[0m13:30:18.258870 [debug] [Thread-3 (]: Dropping schema "_ReferenceKey(database='vmart', schema='test16658406171269843173_test_basic', identifier=None)".
[0m13:30:18.262497 [debug] [Thread-3 (]: Using vertica connection "model.adapter_methods.model"
[0m13:30:18.262725 [debug] [Thread-3 (]: On model.adapter_methods.model: BEGIN
[0m13:30:18.262851 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:30:18.302081 [debug] [Thread-3 (]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m13:30:18.315250 [debug] [Thread-3 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.05 seconds
[0m13:30:18.315519 [debug] [Thread-3 (]: Using vertica connection "model.adapter_methods.model"
[0m13:30:18.315653 [debug] [Thread-3 (]: On model.adapter_methods.model: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "test", "target_name": "default", "node_id": "model.adapter_methods.model"} */
drop schema if exists "test16658406171269843173_test_basic" cascade
  
[0m13:30:18.342188 [debug] [Thread-3 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.03 seconds
[0m13:30:18.343012 [debug] [Thread-3 (]: On model.adapter_methods.model: COMMIT
[0m13:30:18.343227 [debug] [Thread-3 (]: Using vertica connection "model.adapter_methods.model"
[0m13:30:18.343362 [debug] [Thread-3 (]: On model.adapter_methods.model: COMMIT
[0m13:30:18.361184 [debug] [Thread-3 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m13:30:18.361504 [debug] [Thread-3 (]: On "model.adapter_methods.model": cache miss for schema "{self.database}.{self.schema}", this is inefficient
[0m13:30:18.363441 [debug] [Thread-3 (]: Using vertica connection "model.adapter_methods.model"
[0m13:30:18.363621 [debug] [Thread-3 (]: On model.adapter_methods.model: BEGIN
[0m13:30:18.390250 [debug] [Thread-3 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.03 seconds
[0m13:30:18.390537 [debug] [Thread-3 (]: Using vertica connection "model.adapter_methods.model"
[0m13:30:18.390662 [debug] [Thread-3 (]: On model.adapter_methods.model: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "test", "target_name": "default", "node_id": "model.adapter_methods.model"} */
select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'table' as type
    from v_catalog.tables
    where table_schema ilike 'test16658406171269843173_test_basic'
    union all
    select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'view' as type
    from v_catalog.views
    where table_schema ilike 'test16658406171269843173_test_basic'
  
[0m13:30:18.418022 [debug] [Thread-3 (]: SQL status: Code: [Column(name='database', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='schema', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='type', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.03 seconds
[0m13:30:18.419431 [debug] [Thread-3 (]: with database=VMart, schema=test16658406171269843173_test_basic, relations=[]
[0m13:30:18.419826 [debug] [Thread-3 (]: Creating schema "_ReferenceKey(database='vmart', schema='test16658406171269843173_test_basic', identifier=None)"
[0m13:30:18.421905 [debug] [Thread-3 (]: Using vertica connection "model.adapter_methods.model"
[0m13:30:18.422202 [debug] [Thread-3 (]: On model.adapter_methods.model: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "test", "target_name": "default", "node_id": "model.adapter_methods.model"} */
create schema if not exists "test16658406171269843173_test_basic"
  
[0m13:30:18.479184 [debug] [Thread-3 (]: SQL status: Code: [Column(name='database', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='schema', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='type', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.06 seconds
[0m13:30:18.480002 [debug] [Thread-3 (]: On model.adapter_methods.model: COMMIT
[0m13:30:18.480190 [debug] [Thread-3 (]: Using vertica connection "model.adapter_methods.model"
[0m13:30:18.480308 [debug] [Thread-3 (]: On model.adapter_methods.model: COMMIT
[0m13:30:18.494741 [debug] [Thread-3 (]: SQL status: Code: [Column(name='database', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='schema', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='type', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.01 seconds
[0m13:30:18.498958 [debug] [Thread-3 (]: Using vertica connection "model.adapter_methods.model"
[0m13:30:18.499198 [debug] [Thread-3 (]: On model.adapter_methods.model: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "test", "target_name": "default", "node_id": "model.adapter_methods.model"} */

    
  create view "VMart"."test16658406171269843173_test_basic"."upstream" as (
    select 2 as id
  );
  
[0m13:30:18.530482 [debug] [Thread-3 (]: SQL status: Code: [Column(name='database', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='schema', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='type', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.03 seconds
[0m13:30:18.531496 [debug] [Thread-3 (]: Writing injected SQL for node "model.adapter_methods.model"
[0m13:30:18.531784 [debug] [Thread-3 (]: finished collecting timing info
[0m13:30:18.531932 [debug] [Thread-3 (]: Began executing node model.adapter_methods.model
[0m13:30:18.532053 [debug] [Thread-3 (]: finished collecting timing info
[0m13:30:18.532179 [debug] [Thread-3 (]: On model.adapter_methods.model: Close
[0m13:30:18.532609 [debug] [Thread-3 (]: Finished running node model.adapter_methods.model
[0m13:30:18.533197 [debug] [Thread-2 (]: Began running node model.adapter_methods.expected
[0m13:30:18.533391 [debug] [Thread-1 (]: Began running node test.adapter_methods.get_columns_in_relation
[0m13:30:18.533767 [debug] [Thread-2 (]: Acquiring new vertica connection "model.adapter_methods.expected"
[0m13:30:18.534170 [debug] [Thread-1 (]: Acquiring new vertica connection "test.adapter_methods.get_columns_in_relation"
[0m13:30:18.534415 [debug] [Thread-2 (]: Began compiling node model.adapter_methods.expected
[0m13:30:18.534642 [debug] [Thread-1 (]: Began compiling node test.adapter_methods.get_columns_in_relation
[0m13:30:18.534868 [debug] [Thread-2 (]: Compiling model.adapter_methods.expected
[0m13:30:18.535100 [debug] [Thread-1 (]: Compiling test.adapter_methods.get_columns_in_relation
[0m13:30:18.537898 [debug] [Thread-2 (]: Writing injected SQL for node "model.adapter_methods.expected"
[0m13:30:18.545804 [debug] [Thread-1 (]: Using vertica connection "test.adapter_methods.get_columns_in_relation"
[0m13:30:18.546168 [debug] [Thread-1 (]: On test.adapter_methods.get_columns_in_relation: BEGIN
[0m13:30:18.546303 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:30:18.546501 [debug] [Thread-2 (]: finished collecting timing info
[0m13:30:18.546873 [debug] [Thread-2 (]: Began executing node model.adapter_methods.expected
[0m13:30:18.547033 [debug] [Thread-2 (]: finished collecting timing info
[0m13:30:18.547372 [debug] [Thread-2 (]: Finished running node model.adapter_methods.expected
[0m13:30:19.700696 [debug] [Thread-1 (]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m13:30:19.725036 [debug] [Thread-1 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 1.18 seconds
[0m13:30:19.725659 [debug] [Thread-1 (]: Using vertica connection "test.adapter_methods.get_columns_in_relation"
[0m13:30:19.726077 [debug] [Thread-1 (]: On test.adapter_methods.get_columns_in_relation: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "test", "target_name": "default", "node_id": "test.adapter_methods.get_columns_in_relation"} */

    select
    column_name
    , data_type
    , character_maximum_length
    , numeric_precision
    , numeric_scale
    from (
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.columns
        where table_schema = 'test16658406171269843173_test_basic'
        and table_name = 'model'
        union all
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.view_columns
        where table_schema = 'test16658406171269843173_test_basic'
        and table_name = 'model'
    ) t
    order by ordinal_position
  
[0m13:30:19.785168 [debug] [Thread-1 (]: SQL status: Code: [Column(name='column_name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='data_type', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='character_maximum_length', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_precision', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_scale', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.06 seconds
[0m13:30:19.791721 [debug] [Thread-1 (]: Writing injected SQL for node "test.adapter_methods.get_columns_in_relation"
[0m13:30:19.792392 [debug] [Thread-1 (]: finished collecting timing info
[0m13:30:19.792758 [debug] [Thread-1 (]: Began executing node test.adapter_methods.get_columns_in_relation
[0m13:30:19.792996 [debug] [Thread-1 (]: finished collecting timing info
[0m13:30:19.793259 [debug] [Thread-1 (]: On test.adapter_methods.get_columns_in_relation: ROLLBACK
[0m13:30:19.808159 [debug] [Thread-1 (]: On test.adapter_methods.get_columns_in_relation: Close
[0m13:30:19.808796 [debug] [Thread-1 (]: Finished running node test.adapter_methods.get_columns_in_relation
[0m13:30:19.809601 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:30:19.809786 [debug] [MainThread]: Connection 'test.adapter_methods.get_columns_in_relation' was properly closed.
[0m13:30:19.809899 [debug] [MainThread]: Connection 'model.adapter_methods.model' was properly closed.
[0m13:30:19.810005 [debug] [MainThread]: Connection 'model.adapter_methods.expected' was properly closed.
[0m13:30:19.813994 [info ] [MainThread]: Done.
[0m13:30:19.814357 [debug] [MainThread]: Flushing usage events


============================== 2022-10-15 13:30:19.825886 | 901d5a89-d9b7-4477-89b3-50d453532b3d ==============================
[0m13:30:19.825906 [info ] [MainThread]: Running with dbt=1.2.2
[0m13:30:19.826251 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/tmp/pytest-of-sachin/pytest-94/profile0', 'send_anonymous_usage_stats': False, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:30:19.826373 [debug] [MainThread]: Tracking: do not track
[0m13:30:19.843889 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:30:19.844089 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:30:19.850541 [info ] [MainThread]: Found 3 models, 1 test, 0 snapshots, 0 analyses, 266 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m13:30:19.851222 [info ] [MainThread]: 
[0m13:30:19.851587 [debug] [MainThread]: Acquiring new vertica connection "master"
[0m13:30:19.852154 [debug] [ThreadPool]: Acquiring new vertica connection "list_VMart"
[0m13:30:19.855852 [debug] [ThreadPool]: Using vertica connection "list_VMart"
[0m13:30:19.856033 [debug] [ThreadPool]: On list_VMart: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "test", "target_name": "default", "connection_name": "list_VMart"} */

    select schema_name
    from v_catalog.schemata
  
[0m13:30:19.856185 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:30:19.892568 [debug] [ThreadPool]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m13:30:20.047667 [debug] [ThreadPool]: SQL status: Code: [Column(name='schema_name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.19 seconds
[0m13:30:20.050513 [debug] [ThreadPool]: On list_VMart: Close
[0m13:30:20.053055 [debug] [ThreadPool]: Acquiring new vertica connection "list_VMart_test16658406171269843173_test_basic"
[0m13:30:20.092233 [debug] [ThreadPool]: Using vertica connection "list_VMart_test16658406171269843173_test_basic"
[0m13:30:20.092445 [debug] [ThreadPool]: On list_VMart_test16658406171269843173_test_basic: BEGIN
[0m13:30:20.092610 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:30:20.334439 [debug] [ThreadPool]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m13:30:20.346236 [debug] [ThreadPool]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.25 seconds
[0m13:30:20.346947 [debug] [ThreadPool]: Using vertica connection "list_VMart_test16658406171269843173_test_basic"
[0m13:30:20.347422 [debug] [ThreadPool]: On list_VMart_test16658406171269843173_test_basic: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "test", "target_name": "default", "connection_name": "list_VMart_test16658406171269843173_test_basic"} */
select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'table' as type
    from v_catalog.tables
    where table_schema ilike 'test16658406171269843173_test_basic'
    union all
    select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'view' as type
    from v_catalog.views
    where table_schema ilike 'test16658406171269843173_test_basic'
  
[0m13:30:20.391256 [debug] [ThreadPool]: SQL status: Code: [Column(name='database', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='schema', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='type', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.04 seconds
[0m13:30:20.393939 [debug] [ThreadPool]: On list_VMart_test16658406171269843173_test_basic: ROLLBACK
[0m13:30:20.847325 [debug] [ThreadPool]: On list_VMart_test16658406171269843173_test_basic: Close
[0m13:30:20.849102 [debug] [MainThread]: Using vertica connection "master"
[0m13:30:20.849620 [debug] [MainThread]: On master: BEGIN
[0m13:30:20.850015 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:30:21.114875 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m13:30:21.138557 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.29 seconds
[0m13:30:21.139167 [debug] [MainThread]: On master: COMMIT
[0m13:30:21.139559 [debug] [MainThread]: Using vertica connection "master"
[0m13:30:21.139898 [debug] [MainThread]: On master: COMMIT
[0m13:30:21.161992 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m13:30:21.162655 [debug] [MainThread]: On master: Close
[0m13:30:21.163621 [info ] [MainThread]: Concurrency: 4 threads (target='default')
[0m13:30:21.164423 [info ] [MainThread]: 
[0m13:30:21.167970 [debug] [Thread-8 (]: Began running node model.adapter_methods.upstream
[0m13:30:21.168747 [info ] [Thread-8 (]: 1 of 3 START view model test16658406171269843173_test_basic.upstream ........... [RUN]
[0m13:30:21.169861 [debug] [Thread-8 (]: Acquiring new vertica connection "model.adapter_methods.upstream"
[0m13:30:21.170252 [debug] [Thread-8 (]: Began compiling node model.adapter_methods.upstream
[0m13:30:21.170619 [debug] [Thread-8 (]: Compiling model.adapter_methods.upstream
[0m13:30:21.173583 [debug] [Thread-8 (]: Writing injected SQL for node "model.adapter_methods.upstream"
[0m13:30:21.174280 [debug] [Thread-8 (]: finished collecting timing info
[0m13:30:21.174680 [debug] [Thread-8 (]: Began executing node model.adapter_methods.upstream
[0m13:30:21.202916 [debug] [Thread-8 (]: Writing runtime SQL for node "model.adapter_methods.upstream"
[0m13:30:21.203360 [debug] [Thread-8 (]: Using vertica connection "model.adapter_methods.upstream"
[0m13:30:21.203519 [debug] [Thread-8 (]: On model.adapter_methods.upstream: BEGIN
[0m13:30:21.203654 [debug] [Thread-8 (]: Opening a new connection, currently in state closed
[0m13:30:21.274819 [debug] [Thread-8 (]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m13:30:21.306950 [debug] [Thread-8 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.1 seconds
[0m13:30:21.307673 [debug] [Thread-8 (]: Using vertica connection "model.adapter_methods.upstream"
[0m13:30:21.308134 [debug] [Thread-8 (]: On model.adapter_methods.upstream: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "test", "target_name": "default", "node_id": "model.adapter_methods.upstream"} */

  create view "VMart"."test16658406171269843173_test_basic"."upstream__dbt_tmp" as (
    select 1 as id
  );
[0m13:30:21.325402 [debug] [Thread-8 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m13:30:21.339467 [debug] [Thread-8 (]: Using vertica connection "model.adapter_methods.upstream"
[0m13:30:21.340021 [debug] [Thread-8 (]: On model.adapter_methods.upstream: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "test", "target_name": "default", "node_id": "model.adapter_methods.upstream"} */
alter view "VMart"."test16658406171269843173_test_basic"."upstream" rename to "upstream__dbt_backup"
[0m13:30:21.361991 [debug] [Thread-8 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m13:30:21.367581 [debug] [Thread-8 (]: Using vertica connection "model.adapter_methods.upstream"
[0m13:30:21.368142 [debug] [Thread-8 (]: On model.adapter_methods.upstream: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "test", "target_name": "default", "node_id": "model.adapter_methods.upstream"} */
alter view "VMart"."test16658406171269843173_test_basic"."upstream__dbt_tmp" rename to "upstream"
[0m13:30:21.382169 [debug] [Thread-8 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m13:30:21.404695 [debug] [Thread-8 (]: On model.adapter_methods.upstream: COMMIT
[0m13:30:21.404913 [debug] [Thread-8 (]: Using vertica connection "model.adapter_methods.upstream"
[0m13:30:21.405033 [debug] [Thread-8 (]: On model.adapter_methods.upstream: COMMIT
[0m13:30:21.416523 [debug] [Thread-8 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m13:30:21.421401 [debug] [Thread-8 (]: Using vertica connection "model.adapter_methods.upstream"
[0m13:30:21.421610 [debug] [Thread-8 (]: On model.adapter_methods.upstream: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "test", "target_name": "default", "node_id": "model.adapter_methods.upstream"} */
drop view if exists "VMart"."test16658406171269843173_test_basic"."upstream__dbt_backup" cascade
[0m13:30:21.461778 [debug] [Thread-8 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.04 seconds
[0m13:30:21.464240 [debug] [Thread-8 (]: finished collecting timing info
[0m13:30:21.464774 [debug] [Thread-8 (]: On model.adapter_methods.upstream: Close
[0m13:30:21.465929 [info ] [Thread-8 (]: 1 of 3 OK created view model test16658406171269843173_test_basic.upstream ...... [[32mCode: None, Rows: -1, Array Size: 1[0m in 0.30s]
[0m13:30:21.466982 [debug] [Thread-8 (]: Finished running node model.adapter_methods.upstream
[0m13:30:21.468469 [debug] [Thread-10 ]: Began running node model.adapter_methods.model
[0m13:30:21.469231 [info ] [Thread-10 ]: 2 of 3 START view model test16658406171269843173_test_basic.model .............. [RUN]
[0m13:30:21.470395 [debug] [Thread-10 ]: Acquiring new vertica connection "model.adapter_methods.model"
[0m13:30:21.470796 [debug] [Thread-10 ]: Began compiling node model.adapter_methods.model
[0m13:30:21.471201 [debug] [Thread-10 ]: Compiling model.adapter_methods.model
[0m13:30:21.480563 [debug] [Thread-10 ]: Dropping schema "_ReferenceKey(database='vmart', schema='test16658406171269843173_test_basic', identifier=None)".
[0m13:30:21.483489 [debug] [Thread-10 ]: Using vertica connection "model.adapter_methods.model"
[0m13:30:21.483744 [debug] [Thread-10 ]: On model.adapter_methods.model: BEGIN
[0m13:30:21.483876 [debug] [Thread-10 ]: Opening a new connection, currently in state init
[0m13:30:21.769762 [debug] [Thread-10 ]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m13:30:21.789613 [debug] [Thread-10 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.31 seconds
[0m13:30:21.790205 [debug] [Thread-10 ]: Using vertica connection "model.adapter_methods.model"
[0m13:30:21.790626 [debug] [Thread-10 ]: On model.adapter_methods.model: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "test", "target_name": "default", "node_id": "model.adapter_methods.model"} */
drop schema if exists "test16658406171269843173_test_basic" cascade
  
[0m13:30:21.806186 [debug] [Thread-10 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m13:30:21.808214 [debug] [Thread-10 ]: On model.adapter_methods.model: COMMIT
[0m13:30:21.808752 [debug] [Thread-10 ]: Using vertica connection "model.adapter_methods.model"
[0m13:30:21.809150 [debug] [Thread-10 ]: On model.adapter_methods.model: COMMIT
[0m13:30:21.822954 [debug] [Thread-10 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m13:30:21.823800 [debug] [Thread-10 ]: On "model.adapter_methods.model": cache miss for schema "{self.database}.{self.schema}", this is inefficient
[0m13:30:21.827512 [debug] [Thread-10 ]: Using vertica connection "model.adapter_methods.model"
[0m13:30:21.828007 [debug] [Thread-10 ]: On model.adapter_methods.model: BEGIN
[0m13:30:22.062259 [debug] [Thread-10 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.23 seconds
[0m13:30:22.062880 [debug] [Thread-10 ]: Using vertica connection "model.adapter_methods.model"
[0m13:30:22.063325 [debug] [Thread-10 ]: On model.adapter_methods.model: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "test", "target_name": "default", "node_id": "model.adapter_methods.model"} */
select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'table' as type
    from v_catalog.tables
    where table_schema ilike 'test16658406171269843173_test_basic'
    union all
    select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'view' as type
    from v_catalog.views
    where table_schema ilike 'test16658406171269843173_test_basic'
  
[0m13:30:22.093964 [debug] [Thread-10 ]: SQL status: Code: [Column(name='database', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='schema', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='type', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.03 seconds
[0m13:30:22.096526 [debug] [Thread-10 ]: with database=VMart, schema=test16658406171269843173_test_basic, relations=[]
[0m13:30:22.097188 [debug] [Thread-10 ]: Creating schema "_ReferenceKey(database='vmart', schema='test16658406171269843173_test_basic', identifier=None)"
[0m13:30:22.100836 [debug] [Thread-10 ]: Using vertica connection "model.adapter_methods.model"
[0m13:30:22.101279 [debug] [Thread-10 ]: On model.adapter_methods.model: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "test", "target_name": "default", "node_id": "model.adapter_methods.model"} */
create schema if not exists "test16658406171269843173_test_basic"
  
[0m13:30:22.131440 [debug] [Thread-10 ]: SQL status: Code: [Column(name='database', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='schema', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='type', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.03 seconds
[0m13:30:22.133516 [debug] [Thread-10 ]: On model.adapter_methods.model: COMMIT
[0m13:30:22.133997 [debug] [Thread-10 ]: Using vertica connection "model.adapter_methods.model"
[0m13:30:22.134388 [debug] [Thread-10 ]: On model.adapter_methods.model: COMMIT
[0m13:30:22.178607 [debug] [Thread-10 ]: SQL status: Code: [Column(name='database', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='schema', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='type', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.04 seconds
[0m13:30:22.180566 [debug] [Thread-10 ]: Using vertica connection "model.adapter_methods.model"
[0m13:30:22.181060 [debug] [Thread-10 ]: On model.adapter_methods.model: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "test", "target_name": "default", "node_id": "model.adapter_methods.model"} */

    
  create view "VMart"."test16658406171269843173_test_basic"."upstream" as (
    select 2 as id
  );
  
[0m13:30:22.198461 [debug] [Thread-10 ]: SQL status: Code: [Column(name='database', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='schema', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='type', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.02 seconds
[0m13:30:22.201232 [debug] [Thread-10 ]: Writing injected SQL for node "model.adapter_methods.model"
[0m13:30:22.202025 [debug] [Thread-10 ]: finished collecting timing info
[0m13:30:22.202512 [debug] [Thread-10 ]: Began executing node model.adapter_methods.model
[0m13:30:22.205653 [debug] [Thread-10 ]: On "model.adapter_methods.model": cache miss for schema "{self.database}.{self.schema}", this is inefficient
[0m13:30:22.209182 [debug] [Thread-10 ]: Using vertica connection "model.adapter_methods.model"
[0m13:30:22.209812 [debug] [Thread-10 ]: On model.adapter_methods.model: BEGIN
[0m13:30:22.247310 [debug] [Thread-10 ]: SQL status: Code: [Column(name='database', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='schema', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='type', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.04 seconds
[0m13:30:22.247926 [debug] [Thread-10 ]: Using vertica connection "model.adapter_methods.model"
[0m13:30:22.248308 [debug] [Thread-10 ]: On model.adapter_methods.model: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "test", "target_name": "default", "node_id": "model.adapter_methods.model"} */
select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'table' as type
    from v_catalog.tables
    where table_schema ilike 'test16658406171269843173_test_basic'
    union all
    select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'view' as type
    from v_catalog.views
    where table_schema ilike 'test16658406171269843173_test_basic'
  
[0m13:30:22.277104 [debug] [Thread-10 ]: SQL status: Code: [Column(name='database', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='schema', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='type', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.03 seconds
[0m13:30:22.279971 [debug] [Thread-10 ]: with database=VMart, schema=test16658406171269843173_test_basic, relations=[_ReferenceKey(database='vmart', schema='test16658406171269843173_test_basic', identifier='upstream')]
[0m13:30:22.282114 [debug] [Thread-10 ]: On "model.adapter_methods.model": cache miss for schema "{self.database}.{self.schema}", this is inefficient
[0m13:30:22.285867 [debug] [Thread-10 ]: Using vertica connection "model.adapter_methods.model"
[0m13:30:22.286295 [debug] [Thread-10 ]: On model.adapter_methods.model: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "test", "target_name": "default", "node_id": "model.adapter_methods.model"} */
select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'table' as type
    from v_catalog.tables
    where table_schema ilike 'test16658406171269843173_test_basic'
    union all
    select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'view' as type
    from v_catalog.views
    where table_schema ilike 'test16658406171269843173_test_basic'
  
[0m13:30:22.321101 [debug] [Thread-10 ]: SQL status: Code: [Column(name='database', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='schema', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='type', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.03 seconds
[0m13:30:22.323760 [debug] [Thread-10 ]: with database=VMart, schema=test16658406171269843173_test_basic, relations=[_ReferenceKey(database='vmart', schema='test16658406171269843173_test_basic', identifier='upstream')]
[0m13:30:22.325653 [debug] [Thread-10 ]: On "model.adapter_methods.model": cache miss for schema "{self.database}.{self.schema}", this is inefficient
[0m13:30:22.329683 [debug] [Thread-10 ]: Using vertica connection "model.adapter_methods.model"
[0m13:30:22.330111 [debug] [Thread-10 ]: On model.adapter_methods.model: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "test", "target_name": "default", "node_id": "model.adapter_methods.model"} */
select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'table' as type
    from v_catalog.tables
    where table_schema ilike 'test16658406171269843173_test_basic'
    union all
    select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'view' as type
    from v_catalog.views
    where table_schema ilike 'test16658406171269843173_test_basic'
  
[0m13:30:22.363722 [debug] [Thread-10 ]: SQL status: Code: [Column(name='database', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='schema', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='type', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.03 seconds
[0m13:30:22.366607 [debug] [Thread-10 ]: with database=VMart, schema=test16658406171269843173_test_basic, relations=[_ReferenceKey(database='vmart', schema='test16658406171269843173_test_basic', identifier='upstream')]
[0m13:30:22.370022 [debug] [Thread-10 ]: Writing runtime SQL for node "model.adapter_methods.model"
[0m13:30:22.371077 [debug] [Thread-10 ]: Using vertica connection "model.adapter_methods.model"
[0m13:30:22.371506 [debug] [Thread-10 ]: On model.adapter_methods.model: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "test", "target_name": "default", "node_id": "model.adapter_methods.model"} */

  create view "VMart"."test16658406171269843173_test_basic"."model__dbt_tmp" as (
    


    
    
    



select * from "VMart"."test16658406171269843173_test_basic"."upstream"
  );
[0m13:30:22.387284 [debug] [Thread-10 ]: SQL status: Code: [Column(name='database', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='schema', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='type', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.02 seconds
[0m13:30:22.392375 [debug] [Thread-10 ]: Using vertica connection "model.adapter_methods.model"
[0m13:30:22.393031 [debug] [Thread-10 ]: On model.adapter_methods.model: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "test", "target_name": "default", "node_id": "model.adapter_methods.model"} */
alter view "VMart"."test16658406171269843173_test_basic"."model__dbt_tmp" rename to "model"
[0m13:30:22.418259 [debug] [Thread-10 ]: SQL status: Code: [Column(name='database', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='schema', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='type', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.02 seconds
[0m13:30:22.421912 [debug] [Thread-10 ]: On model.adapter_methods.model: COMMIT
[0m13:30:22.422359 [debug] [Thread-10 ]: Using vertica connection "model.adapter_methods.model"
[0m13:30:22.422706 [debug] [Thread-10 ]: On model.adapter_methods.model: COMMIT
[0m13:30:22.439539 [debug] [Thread-10 ]: SQL status: Code: [Column(name='database', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='schema', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='type', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.02 seconds
[0m13:30:22.443870 [debug] [Thread-10 ]: Using vertica connection "model.adapter_methods.model"
[0m13:30:22.444351 [debug] [Thread-10 ]: On model.adapter_methods.model: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "test", "target_name": "default", "node_id": "model.adapter_methods.model"} */
drop view if exists "VMart"."test16658406171269843173_test_basic"."model__dbt_backup" cascade
[0m13:30:22.454689 [debug] [Thread-10 ]: SQL status: Code: [Column(name='database', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='schema', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='type', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.01 seconds
[0m13:30:22.457065 [debug] [Thread-10 ]: finished collecting timing info
[0m13:30:22.457545 [debug] [Thread-10 ]: On model.adapter_methods.model: Close
[0m13:30:22.458643 [info ] [Thread-10 ]: 2 of 3 OK created view model test16658406171269843173_test_basic.model ......... [[32mCode: [Column(name='database', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='schema', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='type', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1[0m in 0.99s]
[0m13:30:22.460110 [debug] [Thread-10 ]: Finished running node model.adapter_methods.model
[0m13:30:22.461597 [debug] [Thread-9 (]: Began running node model.adapter_methods.expected
[0m13:30:22.462262 [info ] [Thread-9 (]: 3 of 3 START view model test16658406171269843173_test_basic.expected ........... [RUN]
[0m13:30:22.463353 [debug] [Thread-9 (]: Acquiring new vertica connection "model.adapter_methods.expected"
[0m13:30:22.463755 [debug] [Thread-9 (]: Began compiling node model.adapter_methods.expected
[0m13:30:22.464106 [debug] [Thread-9 (]: Compiling model.adapter_methods.expected
[0m13:30:22.467893 [debug] [Thread-9 (]: Writing injected SQL for node "model.adapter_methods.expected"
[0m13:30:22.468179 [debug] [Thread-9 (]: finished collecting timing info
[0m13:30:22.468330 [debug] [Thread-9 (]: Began executing node model.adapter_methods.expected
[0m13:30:22.471769 [debug] [Thread-9 (]: Writing runtime SQL for node "model.adapter_methods.expected"
[0m13:30:22.472039 [debug] [Thread-9 (]: Using vertica connection "model.adapter_methods.expected"
[0m13:30:22.472163 [debug] [Thread-9 (]: On model.adapter_methods.expected: BEGIN
[0m13:30:22.472271 [debug] [Thread-9 (]: Opening a new connection, currently in state init
[0m13:30:22.540828 [debug] [Thread-9 (]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m13:30:22.555414 [debug] [Thread-9 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.08 seconds
[0m13:30:22.555994 [debug] [Thread-9 (]: Using vertica connection "model.adapter_methods.expected"
[0m13:30:22.556355 [debug] [Thread-9 (]: On model.adapter_methods.expected: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "test", "target_name": "default", "node_id": "model.adapter_methods.expected"} */

  create view "VMart"."test16658406171269843173_test_basic"."expected__dbt_tmp" as (
    -- make sure this runs after 'model'
-- "VMart"."test16658406171269843173_test_basic"."model"
select 2 as id
  );
[0m13:30:22.578255 [debug] [Thread-9 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m13:30:22.583938 [debug] [Thread-9 (]: Using vertica connection "model.adapter_methods.expected"
[0m13:30:22.584468 [debug] [Thread-9 (]: On model.adapter_methods.expected: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "test", "target_name": "default", "node_id": "model.adapter_methods.expected"} */
alter view "VMart"."test16658406171269843173_test_basic"."expected__dbt_tmp" rename to "expected"
[0m13:30:22.608002 [debug] [Thread-9 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m13:30:22.612054 [debug] [Thread-9 (]: On model.adapter_methods.expected: COMMIT
[0m13:30:22.612572 [debug] [Thread-9 (]: Using vertica connection "model.adapter_methods.expected"
[0m13:30:22.612946 [debug] [Thread-9 (]: On model.adapter_methods.expected: COMMIT
[0m13:30:22.629897 [debug] [Thread-9 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m13:30:22.634008 [debug] [Thread-9 (]: Using vertica connection "model.adapter_methods.expected"
[0m13:30:22.634505 [debug] [Thread-9 (]: On model.adapter_methods.expected: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "test", "target_name": "default", "node_id": "model.adapter_methods.expected"} */
drop view if exists "VMart"."test16658406171269843173_test_basic"."expected__dbt_backup" cascade
[0m13:30:22.644464 [debug] [Thread-9 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m13:30:22.646969 [debug] [Thread-9 (]: finished collecting timing info
[0m13:30:22.647551 [debug] [Thread-9 (]: On model.adapter_methods.expected: Close
[0m13:30:22.648699 [info ] [Thread-9 (]: 3 of 3 OK created view model test16658406171269843173_test_basic.expected ...... [[32mCode: None, Rows: -1, Array Size: 1[0m in 0.19s]
[0m13:30:22.649671 [debug] [Thread-9 (]: Finished running node model.adapter_methods.expected
[0m13:30:22.651963 [debug] [MainThread]: Acquiring new vertica connection "master"
[0m13:30:22.652486 [debug] [MainThread]: Using vertica connection "master"
[0m13:30:22.652836 [debug] [MainThread]: On master: BEGIN
[0m13:30:22.653152 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:30:22.705995 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m13:30:22.718151 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.06 seconds
[0m13:30:22.718837 [debug] [MainThread]: On master: COMMIT
[0m13:30:22.719260 [debug] [MainThread]: Using vertica connection "master"
[0m13:30:22.719664 [debug] [MainThread]: On master: COMMIT
[0m13:30:22.731058 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m13:30:22.731722 [debug] [MainThread]: On master: Close
[0m13:30:22.732725 [info ] [MainThread]: 
[0m13:30:22.733508 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 2.88 seconds (2.88s).
[0m13:30:22.734173 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:30:22.734513 [debug] [MainThread]: Connection 'model.adapter_methods.upstream' was properly closed.
[0m13:30:22.734821 [debug] [MainThread]: Connection 'model.adapter_methods.model' was properly closed.
[0m13:30:22.735173 [debug] [MainThread]: Connection 'model.adapter_methods.expected' was properly closed.
[0m13:30:22.745707 [info ] [MainThread]: 
[0m13:30:22.746438 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:30:22.746951 [info ] [MainThread]: 
[0m13:30:22.747398 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m13:30:22.747904 [debug] [MainThread]: Flushing usage events
[0m13:30:22.748579 [debug] [MainThread]: Acquiring new vertica connection "_test"
[0m13:30:22.750416 [debug] [MainThread]: Using vertica connection "_test"
[0m13:30:22.750648 [debug] [MainThread]: On _test: BEGIN
[0m13:30:22.750814 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:30:22.787059 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m13:30:22.800215 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.05 seconds
[0m13:30:22.800817 [debug] [MainThread]: Using vertica connection "_test"
[0m13:30:22.801226 [debug] [MainThread]: On _test: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "test", "target_name": "default", "connection_name": "_test"} */

    select
    column_name
    , data_type
    , character_maximum_length
    , numeric_precision
    , numeric_scale
    from (
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.columns
        where table_schema = 'test16658406171269843173_test_basic'
        and table_name = 'model'
        union all
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.view_columns
        where table_schema = 'test16658406171269843173_test_basic'
        and table_name = 'model'
    ) t
    order by ordinal_position
  
[0m13:30:22.862422 [debug] [MainThread]: SQL status: Code: [Column(name='column_name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='data_type', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='character_maximum_length', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_precision', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_scale', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.06 seconds
[0m13:30:22.865455 [debug] [MainThread]: Using vertica connection "_test"
[0m13:30:22.865943 [debug] [MainThread]: On _test: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "test", "target_name": "default", "connection_name": "_test"} */
with diff_count as (
    SELECT
        1 as id,
        COUNT(*) as num_missing FROM (
            (SELECT "id" FROM "VMart"."test16658406171269843173_test_basic"."model" EXCEPT
             SELECT "id" FROM "VMart"."test16658406171269843173_test_basic"."expected")
             UNION ALL
            (SELECT "id" FROM "VMart"."test16658406171269843173_test_basic"."expected" EXCEPT
             SELECT "id" FROM "VMart"."test16658406171269843173_test_basic"."model")
        ) as a
), table_a as (
    SELECT COUNT(*) as num_rows FROM "VMart"."test16658406171269843173_test_basic"."model"
), table_b as (
    SELECT COUNT(*) as num_rows FROM "VMart"."test16658406171269843173_test_basic"."expected"
), row_count_diff as (
    select
        1 as id,
        table_a.num_rows - table_b.num_rows as difference
    from table_a, table_b
)
select
    row_count_diff.difference as row_count_difference,
    diff_count.num_missing as num_mismatched
from row_count_diff
join diff_count using (id)
[0m13:30:22.904928 [debug] [MainThread]: SQL status: Code: [Column(name='row_count_difference', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='num_mismatched', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.04 seconds
[0m13:30:22.907440 [debug] [MainThread]: On _test: ROLLBACK
[0m13:30:22.924453 [debug] [MainThread]: On _test: Close
[0m13:30:22.926985 [debug] [MainThread]: Acquiring new vertica connection "_test"
[0m13:30:22.927827 [debug] [MainThread]: Dropping schema "_ReferenceKey(database='vmart', schema='test16658406171269843173_test_basic', identifier=None)".
[0m13:30:22.933141 [debug] [MainThread]: Using vertica connection "_test"
[0m13:30:22.933887 [debug] [MainThread]: On _test: BEGIN
[0m13:30:22.934542 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:30:22.977525 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m13:30:22.999268 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.06 seconds
[0m13:30:22.999721 [debug] [MainThread]: Using vertica connection "_test"
[0m13:30:22.999954 [debug] [MainThread]: On _test: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "test", "target_name": "default", "connection_name": "_test"} */
drop schema if exists "test16658406171269843173_test_basic" cascade
  
[0m13:30:23.031239 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.03 seconds
[0m13:30:23.032464 [debug] [MainThread]: On _test: COMMIT
[0m13:30:23.032770 [debug] [MainThread]: Using vertica connection "_test"
[0m13:30:23.032963 [debug] [MainThread]: On _test: COMMIT
[0m13:30:23.246901 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.21 seconds
[0m13:30:23.247710 [debug] [MainThread]: On _test: Close
[0m13:30:23.248956 [debug] [MainThread]: Connection '_test' was properly closed.
