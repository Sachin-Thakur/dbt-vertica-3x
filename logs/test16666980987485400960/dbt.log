[0m11:41:38.118538 [debug] [MainThread]: Acquiring new vertica connection "_test"
[0m11:41:38.118700 [debug] [MainThread]: Acquiring new vertica connection "_test"
[0m11:41:38.118899 [debug] [MainThread]: Creating schema "_ReferenceKey(database='vmart', schema='test16666980987485400960_test_array_concat', identifier=None)"
[0m11:41:38.120240 [debug] [MainThread]: Using vertica connection "_test"
[0m11:41:38.120372 [debug] [MainThread]: On _test: BEGIN
[0m11:41:38.120475 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:41:38.139978 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:41:38.145564 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.03 seconds
[0m11:41:38.145887 [debug] [MainThread]: Using vertica connection "_test"
[0m11:41:38.146066 [debug] [MainThread]: On _test: create schema if not exists "test16666980987485400960_test_array_concat"
  
[0m11:41:38.156749 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:41:38.158578 [debug] [MainThread]: On _test: COMMIT
[0m11:41:38.159005 [debug] [MainThread]: Using vertica connection "_test"
[0m11:41:38.159377 [debug] [MainThread]: On _test: COMMIT
[0m11:41:38.165560 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:41:38.166158 [debug] [MainThread]: On _test: Close
[0m11:41:38.180246 [debug] [MainThread]: Connection '_test' was properly closed.


============================== 2022-10-25 11:41:38.185778 | 12c916b4-5ca7-4d0b-b674-5d9e6507415e ==============================
[0m11:41:38.185786 [info ] [MainThread]: Running with dbt=1.3.0
[0m11:41:38.186065 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/tmp/pytest-of-sachin/pytest-28/profile1', 'send_anonymous_usage_stats': False, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
[0m11:41:38.186170 [debug] [MainThread]: Tracking: do not track
[0m11:41:38.191774 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
[0m11:41:38.199538 [debug] [MainThread]: Parsing macros/test_assert_equal.sql
[0m11:41:38.200101 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m11:41:38.200258 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m11:41:38.200424 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m11:41:38.204681 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m11:41:38.205572 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m11:41:38.206160 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m11:41:38.208675 [debug] [MainThread]: Parsing macros/materializations/models/incremental/helpers.sql
[0m11:41:38.210389 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m11:41:38.213968 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m11:41:38.214895 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m11:41:38.218605 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m11:41:38.219880 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m11:41:38.226797 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m11:41:38.227809 [debug] [MainThread]: Parsing macros/materializations/snapshots/helper.sql
[0m11:41:38.227975 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m11:41:38.233123 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m11:41:38.236657 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m11:41:38.237217 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m11:41:38.237644 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m11:41:38.239548 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m11:41:38.241136 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m11:41:38.245157 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m11:41:38.246011 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m11:41:38.246699 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m11:41:38.248121 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m11:41:38.250409 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m11:41:38.251304 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m11:41:38.254510 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m11:41:38.255941 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m11:41:38.257950 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m11:41:38.267008 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m11:41:38.272416 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m11:41:38.273340 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m11:41:38.279410 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m11:41:38.283433 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m11:41:38.293411 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m11:41:38.295522 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m11:41:38.298788 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m11:41:38.306393 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m11:41:38.307412 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m11:41:38.314335 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m11:41:38.323724 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m11:41:38.324804 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m11:41:38.325887 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m11:41:38.328527 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m11:41:38.339284 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m11:41:38.343348 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m11:41:38.344311 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m11:41:38.345255 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m11:41:38.346697 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m11:41:38.347915 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m11:41:38.349515 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m11:41:38.355178 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m11:41:38.363738 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m11:41:38.367967 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m11:41:38.375952 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m11:41:38.377272 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m11:41:38.379354 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m11:41:38.381976 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m11:41:38.385558 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m11:41:38.386330 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m11:41:38.386976 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m11:41:38.387551 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m11:41:38.388307 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m11:41:38.389233 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m11:41:38.389835 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m11:41:38.390465 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m11:41:38.391113 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m11:41:38.392337 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m11:41:38.392859 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m11:41:38.393603 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m11:41:38.394256 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m11:41:38.398372 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m11:41:38.398949 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m11:41:38.399741 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m11:41:38.400390 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m11:41:38.401171 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m11:41:38.401834 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m11:41:38.403270 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m11:41:38.403881 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m11:41:38.404390 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m11:41:38.405038 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m11:41:38.405687 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m11:41:38.406754 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m11:41:38.407612 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m11:41:38.408151 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m11:41:38.408575 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m11:41:38.409159 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m11:41:38.412228 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m11:41:38.417165 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m11:41:38.567783 [debug] [MainThread]: 1603: static parser failed on actual.sql
[0m11:41:38.573428 [debug] [MainThread]: 1602: parser fallback to jinja rendering on actual.sql
[0m11:41:38.574267 [debug] [MainThread]: 1603: static parser failed on expected.sql
[0m11:41:38.577353 [debug] [MainThread]: 1602: parser fallback to jinja rendering on expected.sql
[0m11:41:38.598462 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 297 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m11:41:38.599098 [info ] [MainThread]: 
[0m11:41:38.599626 [debug] [MainThread]: Acquiring new vertica connection "master"
[0m11:41:38.600284 [debug] [ThreadPool]: Acquiring new vertica connection "list_VMart"
[0m11:41:38.601467 [debug] [ThreadPool]: Using vertica connection "list_VMart"
[0m11:41:38.601609 [debug] [ThreadPool]: On list_VMart: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "list_VMart"} */

    select schema_name
    from v_catalog.schemata
  
[0m11:41:38.601856 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:41:38.622448 [debug] [ThreadPool]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:41:38.643702 [debug] [ThreadPool]: SQL status: Code: [Column(name='schema_name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.04 seconds
[0m11:41:38.646439 [debug] [ThreadPool]: On list_VMart: Close
[0m11:41:38.649502 [debug] [ThreadPool]: Acquiring new vertica connection "list_VMart_test16666980987485400960_test_array_concat"
[0m11:41:38.653493 [debug] [ThreadPool]: Using vertica connection "list_VMart_test16666980987485400960_test_array_concat"
[0m11:41:38.653948 [debug] [ThreadPool]: On list_VMart_test16666980987485400960_test_array_concat: BEGIN
[0m11:41:38.654258 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:41:38.673473 [debug] [ThreadPool]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:41:38.679110 [debug] [ThreadPool]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m11:41:38.679694 [debug] [ThreadPool]: Using vertica connection "list_VMart_test16666980987485400960_test_array_concat"
[0m11:41:38.680074 [debug] [ThreadPool]: On list_VMart_test16666980987485400960_test_array_concat: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "list_VMart_test16666980987485400960_test_array_concat"} */
select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'table' as type
    from v_catalog.tables
    where table_schema ilike 'test16666980987485400960_test_array_concat'
    union all
    select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'view' as type
    from v_catalog.views
    where table_schema ilike 'test16666980987485400960_test_array_concat'
  
[0m11:41:38.699894 [debug] [ThreadPool]: SQL status: Code: [Column(name='database', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='schema', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='type', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.02 seconds
[0m11:41:38.702724 [debug] [ThreadPool]: On list_VMart_test16666980987485400960_test_array_concat: ROLLBACK
[0m11:41:38.709666 [debug] [ThreadPool]: On list_VMart_test16666980987485400960_test_array_concat: Close
[0m11:41:38.711586 [debug] [MainThread]: Using vertica connection "master"
[0m11:41:38.712054 [debug] [MainThread]: On master: BEGIN
[0m11:41:38.712393 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:41:38.734623 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:41:38.740689 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.03 seconds
[0m11:41:38.741283 [debug] [MainThread]: On master: COMMIT
[0m11:41:38.741648 [debug] [MainThread]: Using vertica connection "master"
[0m11:41:38.741977 [debug] [MainThread]: On master: COMMIT
[0m11:41:38.747059 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.0 seconds
[0m11:41:38.747545 [debug] [MainThread]: On master: Close
[0m11:41:38.748681 [info ] [MainThread]: Concurrency: 4 threads (target='default')
[0m11:41:38.749418 [info ] [MainThread]: 
[0m11:41:38.752508 [debug] [Thread-15 ]: Began running node model.test.actual
[0m11:41:38.753163 [info ] [Thread-15 ]: 1 of 2 START sql view model test16666980987485400960_test_array_concat.actual .. [RUN]
[0m11:41:38.753589 [debug] [Thread-16 ]: Began running node model.test.expected
[0m11:41:38.754792 [debug] [Thread-15 ]: Acquiring new vertica connection "model.test.actual"
[0m11:41:38.755443 [info ] [Thread-16 ]: 2 of 2 START sql view model test16666980987485400960_test_array_concat.expected  [RUN]
[0m11:41:38.755962 [debug] [Thread-15 ]: Began compiling node model.test.actual
[0m11:41:38.756984 [debug] [Thread-16 ]: Acquiring new vertica connection "model.test.expected"
[0m11:41:38.757285 [debug] [Thread-15 ]: Compiling model.test.actual
[0m11:41:38.757598 [debug] [Thread-16 ]: Began compiling node model.test.expected
[0m11:41:38.763136 [debug] [Thread-15 ]: Writing injected SQL for node "model.test.actual"
[0m11:41:38.763346 [debug] [Thread-16 ]: Compiling model.test.expected
[0m11:41:38.766012 [debug] [Thread-16 ]: Writing injected SQL for node "model.test.expected"
[0m11:41:38.766433 [debug] [Thread-15 ]: finished collecting timing info
[0m11:41:38.766553 [debug] [Thread-16 ]: finished collecting timing info
[0m11:41:38.766716 [debug] [Thread-15 ]: Began executing node model.test.actual
[0m11:41:38.766867 [debug] [Thread-16 ]: Began executing node model.test.expected
[0m11:41:38.770708 [debug] [Thread-15 ]: Writing runtime sql for node "model.test.actual"
[0m11:41:38.773496 [debug] [Thread-16 ]: Writing runtime sql for node "model.test.expected"
[0m11:41:38.774159 [debug] [Thread-16 ]: Using vertica connection "model.test.expected"
[0m11:41:38.774356 [debug] [Thread-15 ]: Using vertica connection "model.test.actual"
[0m11:41:38.774569 [debug] [Thread-16 ]: On model.test.expected: BEGIN
[0m11:41:38.774742 [debug] [Thread-15 ]: On model.test.actual: BEGIN
[0m11:41:38.774923 [debug] [Thread-16 ]: Opening a new connection, currently in state init
[0m11:41:38.775087 [debug] [Thread-15 ]: Opening a new connection, currently in state closed
[0m11:41:38.792621 [debug] [Thread-15 ]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:41:38.793108 [debug] [Thread-16 ]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:41:38.798318 [debug] [Thread-16 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m11:41:38.798460 [debug] [Thread-15 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m11:41:38.798630 [debug] [Thread-16 ]: Using vertica connection "model.test.expected"
[0m11:41:38.798776 [debug] [Thread-15 ]: Using vertica connection "model.test.actual"
[0m11:41:38.798910 [debug] [Thread-16 ]: On model.test.expected: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.expected"} */

  create view "VMart"."test16666980987485400960_test_array_concat"."expected__dbt_tmp" as (
    select 1 as id, 
    array[ 1 , 2 , 3 , 4 , 5 , 6 ]
     as array_col union all
select 2 as id, 
    array[ 2 ]
     as array_col union all
select 3 as id, 
    array[ 3 ]
     as array_col
  );
[0m11:41:38.799032 [debug] [Thread-15 ]: On model.test.actual: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.actual"} */

  create view "VMart"."test16666980987485400960_test_array_concat"."actual__dbt_tmp" as (
    select 1 as id, array_cat(
    array[ 1 , 2 , 3 ]
    , 
    array[ 4 , 5 , 6 ]
    ) as array_col union all
select 2 as id, array_cat(
    array[]::INT[]
    , 
    array[ 2 ]
    ) as array_col union all
select 3 as id, array_cat(
    array[ 3 ]
    , 
    array[]::INT[]
    ) as array_col
  );
[0m11:41:38.811406 [debug] [Thread-16 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:41:38.814049 [debug] [Thread-16 ]: Using vertica connection "model.test.expected"
[0m11:41:38.814234 [debug] [Thread-16 ]: On model.test.expected: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.expected"} */
alter view "VMart"."test16666980987485400960_test_array_concat"."expected__dbt_tmp" rename to "expected"
[0m11:41:38.814683 [debug] [Thread-15 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m11:41:38.816238 [debug] [Thread-15 ]: Using vertica connection "model.test.actual"
[0m11:41:38.816372 [debug] [Thread-15 ]: On model.test.actual: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.actual"} */
alter view "VMart"."test16666980987485400960_test_array_concat"."actual__dbt_tmp" rename to "actual"
[0m11:41:38.827026 [debug] [Thread-16 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:41:38.828101 [debug] [Thread-16 ]: On model.test.expected: COMMIT
[0m11:41:38.828258 [debug] [Thread-16 ]: Using vertica connection "model.test.expected"
[0m11:41:38.828366 [debug] [Thread-16 ]: On model.test.expected: COMMIT
[0m11:41:38.828628 [debug] [Thread-15 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:41:38.829532 [debug] [Thread-15 ]: On model.test.actual: COMMIT
[0m11:41:38.829665 [debug] [Thread-15 ]: Using vertica connection "model.test.actual"
[0m11:41:38.829769 [debug] [Thread-15 ]: On model.test.actual: COMMIT
[0m11:41:38.833682 [debug] [Thread-16 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:41:38.835100 [debug] [Thread-16 ]: Using vertica connection "model.test.expected"
[0m11:41:38.835263 [debug] [Thread-16 ]: On model.test.expected: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.expected"} */
drop view if exists "VMart"."test16666980987485400960_test_array_concat"."expected__dbt_backup" cascade
[0m11:41:38.836927 [debug] [Thread-15 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:41:38.838221 [debug] [Thread-15 ]: Using vertica connection "model.test.actual"
[0m11:41:38.838354 [debug] [Thread-15 ]: On model.test.actual: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.actual"} */
drop view if exists "VMart"."test16666980987485400960_test_array_concat"."actual__dbt_backup" cascade
[0m11:41:38.842353 [debug] [Thread-16 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:41:38.843171 [debug] [Thread-16 ]: finished collecting timing info
[0m11:41:38.843346 [debug] [Thread-16 ]: On model.test.expected: Close
[0m11:41:38.843964 [info ] [Thread-16 ]: 2 of 2 OK created sql view model test16666980987485400960_test_array_concat.expected  [[32mCode: None, Rows: -1, Array Size: 1[0m in 0.09s]
[0m11:41:38.844348 [debug] [Thread-16 ]: Finished running node model.test.expected
[0m11:41:38.844527 [debug] [Thread-15 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:41:38.845227 [debug] [Thread-15 ]: finished collecting timing info
[0m11:41:38.845386 [debug] [Thread-15 ]: On model.test.actual: Close
[0m11:41:38.845907 [info ] [Thread-15 ]: 1 of 2 OK created sql view model test16666980987485400960_test_array_concat.actual  [[32mCode: None, Rows: -1, Array Size: 1[0m in 0.09s]
[0m11:41:38.846213 [debug] [Thread-15 ]: Finished running node model.test.actual
[0m11:41:38.847095 [debug] [MainThread]: Acquiring new vertica connection "master"
[0m11:41:38.847304 [debug] [MainThread]: Using vertica connection "master"
[0m11:41:38.847424 [debug] [MainThread]: On master: BEGIN
[0m11:41:38.847530 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:41:38.864255 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:41:38.869447 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m11:41:38.869664 [debug] [MainThread]: On master: COMMIT
[0m11:41:38.869792 [debug] [MainThread]: Using vertica connection "master"
[0m11:41:38.869901 [debug] [MainThread]: On master: COMMIT
[0m11:41:38.874840 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.0 seconds
[0m11:41:38.875040 [debug] [MainThread]: On master: Close
[0m11:41:38.875521 [info ] [MainThread]: 
[0m11:41:38.875775 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m11:41:38.875982 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:41:38.876075 [debug] [MainThread]: Connection 'model.test.actual' was properly closed.
[0m11:41:38.876179 [debug] [MainThread]: Connection 'model.test.expected' was properly closed.
[0m11:41:38.880116 [info ] [MainThread]: 
[0m11:41:38.880395 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:41:38.880627 [info ] [MainThread]: 
[0m11:41:38.880818 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m11:41:38.881072 [debug] [MainThread]: Flushing usage events


============================== 2022-10-25 11:41:38.898884 | 12c916b4-5ca7-4d0b-b674-5d9e6507415e ==============================
[0m11:41:38.898897 [info ] [MainThread]: Running with dbt=1.3.0
[0m11:41:38.899435 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/tmp/pytest-of-sachin/pytest-28/profile1', 'send_anonymous_usage_stats': False, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
[0m11:41:38.899586 [debug] [MainThread]: Tracking: do not track
[0m11:41:38.920943 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:41:38.921171 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:41:38.929300 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 297 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m11:41:38.930086 [info ] [MainThread]: 
[0m11:41:38.930581 [debug] [MainThread]: Acquiring new vertica connection "master"
[0m11:41:38.931294 [debug] [ThreadPool]: Acquiring new vertica connection "list_VMart"
[0m11:41:38.932704 [debug] [ThreadPool]: Using vertica connection "list_VMart"
[0m11:41:38.932869 [debug] [ThreadPool]: On list_VMart: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "list_VMart"} */

    select schema_name
    from v_catalog.schemata
  
[0m11:41:38.932981 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:41:38.955639 [debug] [ThreadPool]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:41:38.972866 [debug] [ThreadPool]: SQL status: Code: [Column(name='schema_name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.04 seconds
[0m11:41:38.973966 [debug] [ThreadPool]: On list_VMart: Close
[0m11:41:38.975365 [debug] [ThreadPool]: Acquiring new vertica connection "list_VMart_test16666980987485400960_test_array_concat"
[0m11:41:38.977008 [debug] [ThreadPool]: Using vertica connection "list_VMart_test16666980987485400960_test_array_concat"
[0m11:41:38.977233 [debug] [ThreadPool]: On list_VMart_test16666980987485400960_test_array_concat: BEGIN
[0m11:41:38.977383 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:41:38.995379 [debug] [ThreadPool]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:41:39.000642 [debug] [ThreadPool]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m11:41:39.000925 [debug] [ThreadPool]: Using vertica connection "list_VMart_test16666980987485400960_test_array_concat"
[0m11:41:39.001061 [debug] [ThreadPool]: On list_VMart_test16666980987485400960_test_array_concat: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "list_VMart_test16666980987485400960_test_array_concat"} */
select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'table' as type
    from v_catalog.tables
    where table_schema ilike 'test16666980987485400960_test_array_concat'
    union all
    select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'view' as type
    from v_catalog.views
    where table_schema ilike 'test16666980987485400960_test_array_concat'
  
[0m11:41:39.020493 [debug] [ThreadPool]: SQL status: Code: [Column(name='database', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='schema', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='type', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.02 seconds
[0m11:41:39.021626 [debug] [ThreadPool]: On list_VMart_test16666980987485400960_test_array_concat: ROLLBACK
[0m11:41:39.026893 [debug] [ThreadPool]: On list_VMart_test16666980987485400960_test_array_concat: Close
[0m11:41:39.027694 [debug] [MainThread]: Using vertica connection "master"
[0m11:41:39.027896 [debug] [MainThread]: On master: BEGIN
[0m11:41:39.028032 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:41:39.044846 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:41:39.050567 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m11:41:39.050846 [debug] [MainThread]: On master: COMMIT
[0m11:41:39.050976 [debug] [MainThread]: Using vertica connection "master"
[0m11:41:39.051081 [debug] [MainThread]: On master: COMMIT
[0m11:41:39.056070 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.0 seconds
[0m11:41:39.056355 [debug] [MainThread]: On master: Close
[0m11:41:39.056831 [info ] [MainThread]: Concurrency: 4 threads (target='default')
[0m11:41:39.057110 [info ] [MainThread]: 
[0m11:41:39.058216 [debug] [Thread-22 ]: Began running node model.test.actual
[0m11:41:39.058379 [debug] [Thread-23 ]: Began running node model.test.expected
[0m11:41:39.058652 [info ] [Thread-22 ]: 1 of 2 START sql view model test16666980987485400960_test_array_concat.actual .. [RUN]
[0m11:41:39.058888 [info ] [Thread-23 ]: 2 of 2 START sql view model test16666980987485400960_test_array_concat.expected  [RUN]
[0m11:41:39.059426 [debug] [Thread-22 ]: Acquiring new vertica connection "model.test.actual"
[0m11:41:39.060014 [debug] [Thread-23 ]: Acquiring new vertica connection "model.test.expected"
[0m11:41:39.060176 [debug] [Thread-22 ]: Began compiling node model.test.actual
[0m11:41:39.060320 [debug] [Thread-23 ]: Began compiling node model.test.expected
[0m11:41:39.060459 [debug] [Thread-22 ]: Compiling model.test.actual
[0m11:41:39.060591 [debug] [Thread-23 ]: Compiling model.test.expected
[0m11:41:39.064950 [debug] [Thread-22 ]: Writing injected SQL for node "model.test.actual"
[0m11:41:39.067964 [debug] [Thread-23 ]: Writing injected SQL for node "model.test.expected"
[0m11:41:39.068469 [debug] [Thread-22 ]: finished collecting timing info
[0m11:41:39.068643 [debug] [Thread-22 ]: Began executing node model.test.actual
[0m11:41:39.071079 [debug] [Thread-22 ]: Writing runtime sql for node "model.test.actual"
[0m11:41:39.071377 [debug] [Thread-23 ]: finished collecting timing info
[0m11:41:39.071530 [debug] [Thread-22 ]: Using vertica connection "model.test.actual"
[0m11:41:39.071685 [debug] [Thread-23 ]: Began executing node model.test.expected
[0m11:41:39.071823 [debug] [Thread-22 ]: On model.test.actual: BEGIN
[0m11:41:39.075157 [debug] [Thread-23 ]: Writing runtime sql for node "model.test.expected"
[0m11:41:39.075667 [debug] [Thread-22 ]: Opening a new connection, currently in state closed
[0m11:41:39.076489 [debug] [Thread-23 ]: Using vertica connection "model.test.expected"
[0m11:41:39.076693 [debug] [Thread-23 ]: On model.test.expected: BEGIN
[0m11:41:39.076861 [debug] [Thread-23 ]: Opening a new connection, currently in state init
[0m11:41:39.095592 [debug] [Thread-22 ]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:41:39.095962 [debug] [Thread-23 ]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:41:39.102156 [debug] [Thread-22 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.03 seconds
[0m11:41:39.102431 [debug] [Thread-23 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.03 seconds
[0m11:41:39.102592 [debug] [Thread-22 ]: Using vertica connection "model.test.actual"
[0m11:41:39.102753 [debug] [Thread-23 ]: Using vertica connection "model.test.expected"
[0m11:41:39.102885 [debug] [Thread-22 ]: On model.test.actual: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.actual"} */

  create view "VMart"."test16666980987485400960_test_array_concat"."actual__dbt_tmp" as (
    select 1 as id, array_cat(
    array[ 1 , 2 , 3 ]
    , 
    array[ 4 , 5 , 6 ]
    ) as array_col union all
select 2 as id, array_cat(
    array[]::INT[]
    , 
    array[ 2 ]
    ) as array_col union all
select 3 as id, array_cat(
    array[ 3 ]
    , 
    array[]::INT[]
    ) as array_col
  );
[0m11:41:39.103006 [debug] [Thread-23 ]: On model.test.expected: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.expected"} */

  create view "VMart"."test16666980987485400960_test_array_concat"."expected__dbt_tmp" as (
    select 1 as id, 
    array[ 1 , 2 , 3 , 4 , 5 , 6 ]
     as array_col union all
select 2 as id, 
    array[ 2 ]
     as array_col union all
select 3 as id, 
    array[ 3 ]
     as array_col
  );
[0m11:41:39.115917 [debug] [Thread-22 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:41:39.118088 [debug] [Thread-22 ]: Using vertica connection "model.test.actual"
[0m11:41:39.118317 [debug] [Thread-23 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m11:41:39.118467 [debug] [Thread-22 ]: On model.test.actual: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.actual"} */
alter view "VMart"."test16666980987485400960_test_array_concat"."actual" rename to "actual__dbt_backup"
[0m11:41:39.164371 [debug] [Thread-23 ]: Using vertica connection "model.test.expected"
[0m11:41:39.164737 [debug] [Thread-23 ]: On model.test.expected: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.expected"} */
alter view "VMart"."test16666980987485400960_test_array_concat"."expected" rename to "expected__dbt_backup"
[0m11:41:39.170682 [debug] [Thread-22 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:41:39.173925 [debug] [Thread-22 ]: Using vertica connection "model.test.actual"
[0m11:41:39.174276 [debug] [Thread-22 ]: On model.test.actual: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.actual"} */
alter view "VMart"."test16666980987485400960_test_array_concat"."actual__dbt_tmp" rename to "actual"
[0m11:41:39.177358 [debug] [Thread-23 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:41:39.180586 [debug] [Thread-23 ]: Using vertica connection "model.test.expected"
[0m11:41:39.180929 [debug] [Thread-23 ]: On model.test.expected: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.expected"} */
alter view "VMart"."test16666980987485400960_test_array_concat"."expected__dbt_tmp" rename to "expected"
[0m11:41:39.184538 [debug] [Thread-22 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:41:39.185917 [debug] [Thread-22 ]: On model.test.actual: COMMIT
[0m11:41:39.186138 [debug] [Thread-22 ]: Using vertica connection "model.test.actual"
[0m11:41:39.186258 [debug] [Thread-22 ]: On model.test.actual: COMMIT
[0m11:41:39.192825 [debug] [Thread-23 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:41:39.194943 [debug] [Thread-23 ]: On model.test.expected: COMMIT
[0m11:41:39.195283 [debug] [Thread-22 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:41:39.195514 [debug] [Thread-23 ]: Using vertica connection "model.test.expected"
[0m11:41:39.197133 [debug] [Thread-22 ]: Using vertica connection "model.test.actual"
[0m11:41:39.197421 [debug] [Thread-23 ]: On model.test.expected: COMMIT
[0m11:41:39.197631 [debug] [Thread-22 ]: On model.test.actual: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.actual"} */
drop view if exists "VMart"."test16666980987485400960_test_array_concat"."actual__dbt_backup" cascade
[0m11:41:39.204862 [debug] [Thread-23 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:41:39.207385 [debug] [Thread-23 ]: Using vertica connection "model.test.expected"
[0m11:41:39.207714 [debug] [Thread-23 ]: On model.test.expected: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.expected"} */
drop view if exists "VMart"."test16666980987485400960_test_array_concat"."expected__dbt_backup" cascade
[0m11:41:39.210162 [debug] [Thread-22 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:41:39.211141 [debug] [Thread-22 ]: finished collecting timing info
[0m11:41:39.211360 [debug] [Thread-22 ]: On model.test.actual: Close
[0m11:41:39.211930 [info ] [Thread-22 ]: 1 of 2 OK created sql view model test16666980987485400960_test_array_concat.actual  [[32mCode: None, Rows: -1, Array Size: 1[0m in 0.15s]
[0m11:41:39.212295 [debug] [Thread-22 ]: Finished running node model.test.actual
[0m11:41:39.217972 [debug] [Thread-23 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:41:39.219483 [debug] [Thread-23 ]: finished collecting timing info
[0m11:41:39.219799 [debug] [Thread-23 ]: On model.test.expected: Close
[0m11:41:39.220607 [info ] [Thread-23 ]: 2 of 2 OK created sql view model test16666980987485400960_test_array_concat.expected  [[32mCode: None, Rows: -1, Array Size: 1[0m in 0.16s]
[0m11:41:39.221133 [debug] [Thread-23 ]: Finished running node model.test.expected
[0m11:41:39.222122 [debug] [MainThread]: Acquiring new vertica connection "master"
[0m11:41:39.222334 [debug] [MainThread]: Using vertica connection "master"
[0m11:41:39.222461 [debug] [MainThread]: On master: BEGIN
[0m11:41:39.222568 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:41:39.240445 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:41:39.248212 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.03 seconds
[0m11:41:39.248586 [debug] [MainThread]: On master: COMMIT
[0m11:41:39.248772 [debug] [MainThread]: Using vertica connection "master"
[0m11:41:39.248936 [debug] [MainThread]: On master: COMMIT
[0m11:41:39.254930 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:41:39.255339 [debug] [MainThread]: On master: Close
[0m11:41:39.256075 [info ] [MainThread]: 
[0m11:41:39.256486 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m11:41:39.256815 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:41:39.256975 [debug] [MainThread]: Connection 'model.test.actual' was properly closed.
[0m11:41:39.257122 [debug] [MainThread]: Connection 'model.test.expected' was properly closed.
[0m11:41:39.264410 [info ] [MainThread]: 
[0m11:41:39.264897 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:41:39.265259 [info ] [MainThread]: 
[0m11:41:39.265558 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m11:41:39.265947 [debug] [MainThread]: Flushing usage events
[0m11:41:39.266665 [debug] [MainThread]: Acquiring new vertica connection "_test"
[0m11:41:39.272038 [debug] [MainThread]: Using vertica connection "_test"
[0m11:41:39.272375 [debug] [MainThread]: On _test: BEGIN
[0m11:41:39.272563 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:41:39.291014 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:41:39.297862 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.03 seconds
[0m11:41:39.298235 [debug] [MainThread]: Using vertica connection "_test"
[0m11:41:39.298437 [debug] [MainThread]: On _test: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "_test"} */

    select
    column_name
    , data_type
    , character_maximum_length
    , numeric_precision
    , numeric_scale
    from (
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.columns
        where table_schema = 'test16666980987485400960_test_array_concat'
        and table_name = 'expected'
        union all
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.view_columns
        where table_schema = 'test16666980987485400960_test_array_concat'
        and table_name = 'expected'
    ) t
    order by ordinal_position
  
[0m11:41:39.337826 [debug] [MainThread]: SQL status: Code: [Column(name='column_name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='data_type', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='character_maximum_length', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_precision', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_scale', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.04 seconds
[0m11:41:39.340584 [debug] [MainThread]: Using vertica connection "_test"
[0m11:41:39.340779 [debug] [MainThread]: On _test: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "_test"} */
with diff_count as (
    SELECT
        1 as id,
        COUNT(*) as num_missing FROM (
            (SELECT "array_col", "id" FROM "VMart"."test16666980987485400960_test_array_concat"."expected" EXCEPT
             SELECT "array_col", "id" FROM "VMart"."test16666980987485400960_test_array_concat"."actual")
             UNION ALL
            (SELECT "array_col", "id" FROM "VMart"."test16666980987485400960_test_array_concat"."actual" EXCEPT
             SELECT "array_col", "id" FROM "VMart"."test16666980987485400960_test_array_concat"."expected")
        ) as a
), table_a as (
    SELECT COUNT(*) as num_rows FROM "VMart"."test16666980987485400960_test_array_concat"."expected"
), table_b as (
    SELECT COUNT(*) as num_rows FROM "VMart"."test16666980987485400960_test_array_concat"."actual"
), row_count_diff as (
    select
        1 as id,
        table_a.num_rows - table_b.num_rows as difference
    from table_a, table_b
)
select
    row_count_diff.difference as row_count_difference,
    diff_count.num_missing as num_mismatched
from row_count_diff
join diff_count using (id)
[0m11:41:39.399399 [debug] [MainThread]: SQL status: Code: [Column(name='row_count_difference', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='num_mismatched', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.06 seconds
[0m11:41:39.400253 [debug] [MainThread]: On _test: ROLLBACK
[0m11:41:39.407127 [debug] [MainThread]: On _test: Close
[0m11:41:39.408202 [debug] [MainThread]: Acquiring new vertica connection "_test"
[0m11:41:39.410152 [debug] [MainThread]: Using vertica connection "_test"
[0m11:41:39.410402 [debug] [MainThread]: On _test: BEGIN
[0m11:41:39.410599 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:41:39.428723 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:41:39.434046 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m11:41:39.434608 [debug] [MainThread]: Using vertica connection "_test"
[0m11:41:39.434950 [debug] [MainThread]: On _test: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "_test"} */

    select
    column_name
    , data_type
    , character_maximum_length
    , numeric_precision
    , numeric_scale
    from (
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.columns
        where table_schema = 'test16666980987485400960_test_array_concat'
        and table_name = 'expected'
        union all
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.view_columns
        where table_schema = 'test16666980987485400960_test_array_concat'
        and table_name = 'expected'
    ) t
    order by ordinal_position
  
[0m11:41:39.462162 [debug] [MainThread]: SQL status: Code: [Column(name='column_name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='data_type', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='character_maximum_length', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_precision', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_scale', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.03 seconds
[0m11:41:39.465444 [debug] [MainThread]: On _test: ROLLBACK
[0m11:41:39.472751 [debug] [MainThread]: On _test: Close
[0m11:41:39.474848 [debug] [MainThread]: Acquiring new vertica connection "_test"
[0m11:41:39.480493 [debug] [MainThread]: Using vertica connection "_test"
[0m11:41:39.480934 [debug] [MainThread]: On _test: BEGIN
[0m11:41:39.481258 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:41:39.498346 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:41:39.504320 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m11:41:39.504883 [debug] [MainThread]: Using vertica connection "_test"
[0m11:41:39.505241 [debug] [MainThread]: On _test: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "_test"} */

    select
    column_name
    , data_type
    , character_maximum_length
    , numeric_precision
    , numeric_scale
    from (
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.columns
        where table_schema = 'test16666980987485400960_test_array_concat'
        and table_name = 'actual'
        union all
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.view_columns
        where table_schema = 'test16666980987485400960_test_array_concat'
        and table_name = 'actual'
    ) t
    order by ordinal_position
  
[0m11:41:39.534395 [debug] [MainThread]: SQL status: Code: [Column(name='column_name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='data_type', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='character_maximum_length', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_precision', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_scale', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.03 seconds
[0m11:41:39.537507 [debug] [MainThread]: On _test: ROLLBACK
[0m11:41:39.543676 [debug] [MainThread]: On _test: Close
[0m11:41:39.546841 [debug] [MainThread]: Acquiring new vertica connection "_test"
[0m11:41:39.547629 [debug] [MainThread]: Dropping schema "_ReferenceKey(database='vmart', schema='test16666980987485400960_test_array_concat', identifier=None)".
[0m11:41:39.551963 [debug] [MainThread]: Using vertica connection "_test"
[0m11:41:39.552509 [debug] [MainThread]: On _test: BEGIN
[0m11:41:39.552908 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:41:39.569587 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:41:39.575930 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m11:41:39.576177 [debug] [MainThread]: Using vertica connection "_test"
[0m11:41:39.576293 [debug] [MainThread]: On _test: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "_test"} */
drop schema if exists "test16666980987485400960_test_array_concat" cascade
  
[0m11:41:39.592010 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m11:41:39.593435 [debug] [MainThread]: On _test: COMMIT
[0m11:41:39.593814 [debug] [MainThread]: Using vertica connection "_test"
[0m11:41:39.594100 [debug] [MainThread]: On _test: COMMIT
[0m11:41:39.599739 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:41:39.600415 [debug] [MainThread]: On _test: Close
[0m11:41:39.602116 [debug] [MainThread]: Connection '_test' was properly closed.
[0m11:41:39.625992 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
[0m11:41:39.627012 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m11:41:39.627258 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m11:41:39.627448 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m11:41:39.632104 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m11:41:39.633068 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m11:41:39.633713 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m11:41:39.636535 [debug] [MainThread]: Parsing macros/materializations/models/incremental/helpers.sql
[0m11:41:39.638482 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m11:41:39.642208 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m11:41:39.643166 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m11:41:39.647190 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m11:41:39.648560 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m11:41:39.655821 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m11:41:39.656981 [debug] [MainThread]: Parsing macros/materializations/snapshots/helper.sql
[0m11:41:39.657207 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m11:41:39.662835 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m11:41:39.666477 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m11:41:39.667082 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m11:41:39.667557 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m11:41:39.669457 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m11:41:39.671071 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m11:41:39.675122 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m11:41:39.676022 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m11:41:39.677842 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m11:41:39.679327 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m11:41:39.681739 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m11:41:39.682581 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m11:41:39.685833 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m11:41:39.687257 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m11:41:39.689335 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m11:41:39.698508 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m11:41:39.703338 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m11:41:39.704304 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m11:41:39.710499 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m11:41:39.714586 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m11:41:39.724618 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m11:41:39.726713 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m11:41:39.729989 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m11:41:39.738029 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m11:41:39.739074 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m11:41:39.746059 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m11:41:39.755485 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m11:41:39.756590 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m11:41:39.757700 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m11:41:39.760382 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m11:41:39.771135 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m11:41:39.775267 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m11:41:39.776242 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m11:41:39.777218 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m11:41:39.778704 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m11:41:39.779981 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m11:41:39.781669 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m11:41:39.787425 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m11:41:39.796007 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m11:41:39.800285 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m11:41:39.808280 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m11:41:39.809626 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m11:41:39.811688 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m11:41:39.814386 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m11:41:39.817990 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m11:41:39.818798 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m11:41:39.819522 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m11:41:39.820175 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m11:41:39.820982 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m11:41:39.821930 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m11:41:39.822598 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m11:41:39.823224 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m11:41:39.823916 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m11:41:39.825199 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m11:41:39.825764 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m11:41:39.826552 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m11:41:39.827337 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m11:41:39.831355 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m11:41:39.832003 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m11:41:39.832814 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m11:41:39.833515 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m11:41:39.834322 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m11:41:39.835078 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m11:41:39.836518 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m11:41:39.837169 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m11:41:39.837758 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m11:41:39.838524 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m11:41:39.839291 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m11:41:39.840424 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m11:41:39.841327 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m11:41:39.841956 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m11:41:39.842435 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m11:41:39.843117 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m11:41:39.846246 [debug] [MainThread]: Parsing macros/etc/datetime.sql
