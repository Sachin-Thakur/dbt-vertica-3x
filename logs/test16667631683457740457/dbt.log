[0m05:46:08.510911 [debug] [MainThread]: Acquiring new vertica connection "_test"
[0m05:46:08.511099 [debug] [MainThread]: Acquiring new vertica connection "_test"
[0m05:46:08.511282 [debug] [MainThread]: Creating schema "_ReferenceKey(database='vmart', schema='test16667631683457740457_test_array_concat', identifier=None)"
[0m05:46:08.512769 [debug] [MainThread]: Using vertica connection "_test"
[0m05:46:08.512926 [debug] [MainThread]: On _test: BEGIN
[0m05:46:08.513040 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:46:08.531663 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m05:46:08.537293 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m05:46:08.537476 [debug] [MainThread]: Using vertica connection "_test"
[0m05:46:08.537602 [debug] [MainThread]: On _test: create schema if not exists "test16667631683457740457_test_array_concat"
  
[0m05:46:08.549594 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m05:46:08.550288 [debug] [MainThread]: On _test: COMMIT
[0m05:46:08.550439 [debug] [MainThread]: Using vertica connection "_test"
[0m05:46:08.550558 [debug] [MainThread]: On _test: COMMIT
[0m05:46:08.564096 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m05:46:08.564363 [debug] [MainThread]: On _test: Close
[0m05:46:08.571442 [debug] [MainThread]: Connection '_test' was properly closed.


============================== 2022-10-26 05:46:08.623990 | 55d4df59-9086-400b-88b4-88ea303099a7 ==============================
[0m05:46:08.624001 [info ] [MainThread]: Running with dbt=1.3.0
[0m05:46:08.624332 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/tmp/pytest-of-sachin/pytest-35/profile11', 'send_anonymous_usage_stats': False, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
[0m05:46:08.624457 [debug] [MainThread]: Tracking: do not track
[0m05:46:08.630686 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
[0m05:46:08.638286 [debug] [MainThread]: Parsing macros/test_assert_equal.sql
[0m05:46:08.638816 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m05:46:08.638982 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m05:46:08.639112 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m05:46:08.643315 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m05:46:08.644299 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m05:46:08.644882 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m05:46:08.647417 [debug] [MainThread]: Parsing macros/materializations/models/incremental/helpers.sql
[0m05:46:08.649152 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m05:46:08.652622 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m05:46:08.653513 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m05:46:08.657179 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m05:46:08.658444 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m05:46:08.665342 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m05:46:08.666408 [debug] [MainThread]: Parsing macros/materializations/snapshots/helper.sql
[0m05:46:08.666563 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m05:46:08.671604 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m05:46:08.675147 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m05:46:08.675680 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m05:46:08.676102 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m05:46:08.677986 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m05:46:08.679590 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m05:46:08.683614 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m05:46:08.684465 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m05:46:08.685141 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m05:46:08.686497 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m05:46:08.688736 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m05:46:08.689604 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m05:46:08.692821 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m05:46:08.694189 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m05:46:08.696171 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m05:46:08.705105 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m05:46:08.709940 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m05:46:08.710877 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m05:46:08.716936 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m05:46:08.720877 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m05:46:08.730756 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m05:46:08.732862 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m05:46:08.736081 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m05:46:08.743730 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m05:46:08.744723 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m05:46:08.751827 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m05:46:08.761101 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m05:46:08.762241 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m05:46:08.763323 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m05:46:08.765991 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m05:46:08.776713 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m05:46:08.780796 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m05:46:08.781740 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m05:46:08.782722 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m05:46:08.784157 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m05:46:08.785351 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m05:46:08.786948 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m05:46:08.792678 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m05:46:08.801337 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m05:46:08.805501 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m05:46:08.813404 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m05:46:08.814724 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m05:46:08.816782 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m05:46:08.819349 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m05:46:08.822964 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m05:46:08.823742 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m05:46:08.824397 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m05:46:08.824973 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m05:46:08.825750 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m05:46:08.826674 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m05:46:08.827305 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m05:46:08.827893 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m05:46:08.828532 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m05:46:08.829742 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m05:46:08.830271 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m05:46:08.831027 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m05:46:08.831738 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m05:46:08.835713 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m05:46:08.836323 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m05:46:08.837085 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m05:46:08.837734 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m05:46:08.838532 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m05:46:08.839183 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m05:46:08.840560 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m05:46:08.841155 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m05:46:08.841727 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m05:46:08.842424 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m05:46:08.843106 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m05:46:08.844187 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m05:46:08.845039 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m05:46:08.845626 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m05:46:08.846093 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m05:46:08.846694 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m05:46:08.849790 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m05:46:08.854763 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m05:46:09.009009 [debug] [MainThread]: 1603: static parser failed on actual.sql
[0m05:46:09.014954 [debug] [MainThread]: 1602: parser fallback to jinja rendering on actual.sql
[0m05:46:09.015916 [debug] [MainThread]: 1603: static parser failed on expected.sql
[0m05:46:09.019461 [debug] [MainThread]: 1602: parser fallback to jinja rendering on expected.sql
[0m05:46:09.042453 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 297 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m05:46:09.043220 [info ] [MainThread]: 
[0m05:46:09.043725 [debug] [MainThread]: Acquiring new vertica connection "master"
[0m05:46:09.044386 [debug] [ThreadPool]: Acquiring new vertica connection "list_VMart"
[0m05:46:09.045711 [debug] [ThreadPool]: Using vertica connection "list_VMart"
[0m05:46:09.045932 [debug] [ThreadPool]: On list_VMart: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "list_VMart"} */

    select schema_name
    from v_catalog.schemata
  
[0m05:46:09.046047 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:46:09.064708 [debug] [ThreadPool]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m05:46:09.086159 [debug] [ThreadPool]: SQL status: Code: [Column(name='schema_name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.04 seconds
[0m05:46:09.087208 [debug] [ThreadPool]: On list_VMart: Close
[0m05:46:09.088546 [debug] [ThreadPool]: Acquiring new vertica connection "list_VMart_test16667631683457740457_test_array_concat"
[0m05:46:09.089850 [debug] [ThreadPool]: Using vertica connection "list_VMart_test16667631683457740457_test_array_concat"
[0m05:46:09.090024 [debug] [ThreadPool]: On list_VMart_test16667631683457740457_test_array_concat: BEGIN
[0m05:46:09.090131 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:46:09.106546 [debug] [ThreadPool]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m05:46:09.113047 [debug] [ThreadPool]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m05:46:09.113277 [debug] [ThreadPool]: Using vertica connection "list_VMart_test16667631683457740457_test_array_concat"
[0m05:46:09.113399 [debug] [ThreadPool]: On list_VMart_test16667631683457740457_test_array_concat: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "list_VMart_test16667631683457740457_test_array_concat"} */
select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'table' as type
    from v_catalog.tables
    where table_schema ilike 'test16667631683457740457_test_array_concat'
    union all
    select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'view' as type
    from v_catalog.views
    where table_schema ilike 'test16667631683457740457_test_array_concat'
  
[0m05:46:09.139193 [debug] [ThreadPool]: SQL status: Code: [Column(name='database', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='schema', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='type', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.03 seconds
[0m05:46:09.140231 [debug] [ThreadPool]: On list_VMart_test16667631683457740457_test_array_concat: ROLLBACK
[0m05:46:09.150019 [debug] [ThreadPool]: On list_VMart_test16667631683457740457_test_array_concat: Close
[0m05:46:09.151008 [debug] [MainThread]: Using vertica connection "master"
[0m05:46:09.151247 [debug] [MainThread]: On master: BEGIN
[0m05:46:09.151407 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:46:09.175302 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m05:46:09.182386 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.03 seconds
[0m05:46:09.182660 [debug] [MainThread]: On master: COMMIT
[0m05:46:09.182807 [debug] [MainThread]: Using vertica connection "master"
[0m05:46:09.182939 [debug] [MainThread]: On master: COMMIT
[0m05:46:09.188931 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m05:46:09.189232 [debug] [MainThread]: On master: Close
[0m05:46:09.189753 [info ] [MainThread]: Concurrency: 4 threads (target='default')
[0m05:46:09.190051 [info ] [MainThread]: 
[0m05:46:09.191529 [debug] [Thread-106]: Began running node model.test.actual
[0m05:46:09.191697 [debug] [Thread-107]: Began running node model.test.expected
[0m05:46:09.191961 [info ] [Thread-106]: 1 of 2 START sql view model test16667631683457740457_test_array_concat.actual .. [RUN]
[0m05:46:09.192233 [info ] [Thread-107]: 2 of 2 START sql view model test16667631683457740457_test_array_concat.expected  [RUN]
[0m05:46:09.192781 [debug] [Thread-106]: Acquiring new vertica connection "model.test.actual"
[0m05:46:09.193343 [debug] [Thread-107]: Acquiring new vertica connection "model.test.expected"
[0m05:46:09.193519 [debug] [Thread-106]: Began compiling node model.test.actual
[0m05:46:09.193680 [debug] [Thread-107]: Began compiling node model.test.expected
[0m05:46:09.193855 [debug] [Thread-106]: Compiling model.test.actual
[0m05:46:09.194066 [debug] [Thread-107]: Compiling model.test.expected
[0m05:46:09.198344 [debug] [Thread-106]: Writing injected SQL for node "model.test.actual"
[0m05:46:09.201282 [debug] [Thread-107]: Writing injected SQL for node "model.test.expected"
[0m05:46:09.201829 [debug] [Thread-107]: finished collecting timing info
[0m05:46:09.201969 [debug] [Thread-106]: finished collecting timing info
[0m05:46:09.202124 [debug] [Thread-107]: Began executing node model.test.expected
[0m05:46:09.202272 [debug] [Thread-106]: Began executing node model.test.actual
[0m05:46:09.204707 [debug] [Thread-107]: Writing runtime sql for node "model.test.expected"
[0m05:46:09.207086 [debug] [Thread-106]: Writing runtime sql for node "model.test.actual"
[0m05:46:09.207591 [debug] [Thread-107]: Using vertica connection "model.test.expected"
[0m05:46:09.207721 [debug] [Thread-106]: Using vertica connection "model.test.actual"
[0m05:46:09.207865 [debug] [Thread-107]: On model.test.expected: BEGIN
[0m05:46:09.208000 [debug] [Thread-106]: On model.test.actual: BEGIN
[0m05:46:09.208132 [debug] [Thread-107]: Opening a new connection, currently in state init
[0m05:46:09.208265 [debug] [Thread-106]: Opening a new connection, currently in state closed
[0m05:46:09.227144 [debug] [Thread-106]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m05:46:09.230462 [debug] [Thread-107]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m05:46:09.233854 [debug] [Thread-106]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.03 seconds
[0m05:46:09.234197 [debug] [Thread-106]: Using vertica connection "model.test.actual"
[0m05:46:09.234347 [debug] [Thread-106]: On model.test.actual: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.actual"} */

  create view "VMart"."test16667631683457740457_test_array_concat"."actual__dbt_tmp" as (
    select 1 as id, array_cat(
    array[ 1 , 2 , 3 ]
    , 
    array[ 4 , 5 , 6 ]
    ) as array_col union all
select 2 as id, array_cat(
    array[]::INT[]
    , 
    array[ 2 ]
    ) as array_col union all
select 3 as id, array_cat(
    array[ 3 ]
    , 
    array[]::INT[]
    ) as array_col
  );
[0m05:46:09.237121 [debug] [Thread-107]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.03 seconds
[0m05:46:09.237288 [debug] [Thread-107]: Using vertica connection "model.test.expected"
[0m05:46:09.237409 [debug] [Thread-107]: On model.test.expected: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.expected"} */

  create view "VMart"."test16667631683457740457_test_array_concat"."expected__dbt_tmp" as (
    select 1 as id, 
    array[ 1 , 2 , 3 , 4 , 5 , 6 ]
     as array_col union all
select 2 as id, 
    array[ 2 ]
     as array_col union all
select 3 as id, 
    array[ 3 ]
     as array_col
  );
[0m05:46:09.246217 [debug] [Thread-106]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m05:46:09.248397 [debug] [Thread-106]: Using vertica connection "model.test.actual"
[0m05:46:09.248605 [debug] [Thread-106]: On model.test.actual: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.actual"} */
alter view "VMart"."test16667631683457740457_test_array_concat"."actual__dbt_tmp" rename to "actual"
[0m05:46:09.249490 [debug] [Thread-107]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m05:46:09.251922 [debug] [Thread-107]: Using vertica connection "model.test.expected"
[0m05:46:09.252108 [debug] [Thread-107]: On model.test.expected: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.expected"} */
alter view "VMart"."test16667631683457740457_test_array_concat"."expected__dbt_tmp" rename to "expected"
[0m05:46:09.259207 [debug] [Thread-106]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m05:46:09.260532 [debug] [Thread-106]: On model.test.actual: COMMIT
[0m05:46:09.260719 [debug] [Thread-106]: Using vertica connection "model.test.actual"
[0m05:46:09.260853 [debug] [Thread-106]: On model.test.actual: COMMIT
[0m05:46:09.264798 [debug] [Thread-107]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m05:46:09.266586 [debug] [Thread-107]: On model.test.expected: COMMIT
[0m05:46:09.266844 [debug] [Thread-107]: Using vertica connection "model.test.expected"
[0m05:46:09.267132 [debug] [Thread-107]: On model.test.expected: COMMIT
[0m05:46:09.267502 [debug] [Thread-106]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m05:46:09.268998 [debug] [Thread-106]: Using vertica connection "model.test.actual"
[0m05:46:09.269143 [debug] [Thread-106]: On model.test.actual: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.actual"} */
drop view if exists "VMart"."test16667631683457740457_test_array_concat"."actual__dbt_backup" cascade
[0m05:46:09.273709 [debug] [Thread-107]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m05:46:09.273870 [debug] [Thread-106]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.0 seconds
[0m05:46:09.275375 [debug] [Thread-107]: Using vertica connection "model.test.expected"
[0m05:46:09.276271 [debug] [Thread-106]: finished collecting timing info
[0m05:46:09.276460 [debug] [Thread-107]: On model.test.expected: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.expected"} */
drop view if exists "VMart"."test16667631683457740457_test_array_concat"."expected__dbt_backup" cascade
[0m05:46:09.276617 [debug] [Thread-106]: On model.test.actual: Close
[0m05:46:09.277259 [info ] [Thread-106]: 1 of 2 OK created sql view model test16667631683457740457_test_array_concat.actual  [[32mCode: None, Rows: -1, Array Size: 1[0m in 0.08s]
[0m05:46:09.277624 [debug] [Thread-106]: Finished running node model.test.actual
[0m05:46:09.283471 [debug] [Thread-107]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m05:46:09.284464 [debug] [Thread-107]: finished collecting timing info
[0m05:46:09.284655 [debug] [Thread-107]: On model.test.expected: Close
[0m05:46:09.285189 [info ] [Thread-107]: 2 of 2 OK created sql view model test16667631683457740457_test_array_concat.expected  [[32mCode: None, Rows: -1, Array Size: 1[0m in 0.09s]
[0m05:46:09.285530 [debug] [Thread-107]: Finished running node model.test.expected
[0m05:46:09.286410 [debug] [MainThread]: Acquiring new vertica connection "master"
[0m05:46:09.286571 [debug] [MainThread]: Using vertica connection "master"
[0m05:46:09.286680 [debug] [MainThread]: On master: BEGIN
[0m05:46:09.286777 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:46:09.303148 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m05:46:09.308352 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m05:46:09.308600 [debug] [MainThread]: On master: COMMIT
[0m05:46:09.308721 [debug] [MainThread]: Using vertica connection "master"
[0m05:46:09.308835 [debug] [MainThread]: On master: COMMIT
[0m05:46:09.314101 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m05:46:09.314324 [debug] [MainThread]: On master: Close
[0m05:46:09.314886 [info ] [MainThread]: 
[0m05:46:09.315161 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.27 seconds (0.27s).
[0m05:46:09.315354 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:46:09.315452 [debug] [MainThread]: Connection 'model.test.actual' was properly closed.
[0m05:46:09.315545 [debug] [MainThread]: Connection 'model.test.expected' was properly closed.
[0m05:46:09.319786 [info ] [MainThread]: 
[0m05:46:09.320082 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:46:09.320320 [info ] [MainThread]: 
[0m05:46:09.320496 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m05:46:09.320728 [debug] [MainThread]: Flushing usage events


============================== 2022-10-26 05:46:09.338200 | 55d4df59-9086-400b-88b4-88ea303099a7 ==============================
[0m05:46:09.338213 [info ] [MainThread]: Running with dbt=1.3.0
[0m05:46:09.338680 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/tmp/pytest-of-sachin/pytest-35/profile11', 'send_anonymous_usage_stats': False, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
[0m05:46:09.338862 [debug] [MainThread]: Tracking: do not track
[0m05:46:09.363015 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:46:09.363248 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:46:09.371609 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 297 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m05:46:09.372293 [info ] [MainThread]: 
[0m05:46:09.372783 [debug] [MainThread]: Acquiring new vertica connection "master"
[0m05:46:09.373408 [debug] [ThreadPool]: Acquiring new vertica connection "list_VMart"
[0m05:46:09.375043 [debug] [ThreadPool]: Using vertica connection "list_VMart"
[0m05:46:09.375211 [debug] [ThreadPool]: On list_VMart: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "list_VMart"} */

    select schema_name
    from v_catalog.schemata
  
[0m05:46:09.375332 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:46:09.394129 [debug] [ThreadPool]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m05:46:09.410600 [debug] [ThreadPool]: SQL status: Code: [Column(name='schema_name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.04 seconds
[0m05:46:09.411672 [debug] [ThreadPool]: On list_VMart: Close
[0m05:46:09.413030 [debug] [ThreadPool]: Acquiring new vertica connection "list_VMart_test16667631683457740457_test_array_concat"
[0m05:46:09.414491 [debug] [ThreadPool]: Using vertica connection "list_VMart_test16667631683457740457_test_array_concat"
[0m05:46:09.414715 [debug] [ThreadPool]: On list_VMart_test16667631683457740457_test_array_concat: BEGIN
[0m05:46:09.414830 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:46:09.431628 [debug] [ThreadPool]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m05:46:09.437055 [debug] [ThreadPool]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m05:46:09.437428 [debug] [ThreadPool]: Using vertica connection "list_VMart_test16667631683457740457_test_array_concat"
[0m05:46:09.437571 [debug] [ThreadPool]: On list_VMart_test16667631683457740457_test_array_concat: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "list_VMart_test16667631683457740457_test_array_concat"} */
select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'table' as type
    from v_catalog.tables
    where table_schema ilike 'test16667631683457740457_test_array_concat'
    union all
    select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'view' as type
    from v_catalog.views
    where table_schema ilike 'test16667631683457740457_test_array_concat'
  
[0m05:46:09.452941 [debug] [ThreadPool]: SQL status: Code: [Column(name='database', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='schema', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='type', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.02 seconds
[0m05:46:09.454109 [debug] [ThreadPool]: On list_VMart_test16667631683457740457_test_array_concat: ROLLBACK
[0m05:46:09.460521 [debug] [ThreadPool]: On list_VMart_test16667631683457740457_test_array_concat: Close
[0m05:46:09.461445 [debug] [MainThread]: Using vertica connection "master"
[0m05:46:09.461642 [debug] [MainThread]: On master: BEGIN
[0m05:46:09.461766 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:46:09.479541 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m05:46:09.485261 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m05:46:09.485735 [debug] [MainThread]: On master: COMMIT
[0m05:46:09.486037 [debug] [MainThread]: Using vertica connection "master"
[0m05:46:09.486296 [debug] [MainThread]: On master: COMMIT
[0m05:46:09.491593 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m05:46:09.492175 [debug] [MainThread]: On master: Close
[0m05:46:09.493286 [info ] [MainThread]: Concurrency: 4 threads (target='default')
[0m05:46:09.494008 [info ] [MainThread]: 
[0m05:46:09.497409 [debug] [Thread-113]: Began running node model.test.actual
[0m05:46:09.497862 [debug] [Thread-114]: Began running node model.test.expected
[0m05:46:09.498662 [info ] [Thread-113]: 1 of 2 START sql view model test16667631683457740457_test_array_concat.actual .. [RUN]
[0m05:46:09.499408 [info ] [Thread-114]: 2 of 2 START sql view model test16667631683457740457_test_array_concat.expected  [RUN]
[0m05:46:09.500976 [debug] [Thread-113]: Acquiring new vertica connection "model.test.actual"
[0m05:46:09.502437 [debug] [Thread-114]: Acquiring new vertica connection "model.test.expected"
[0m05:46:09.502975 [debug] [Thread-113]: Began compiling node model.test.actual
[0m05:46:09.503516 [debug] [Thread-114]: Began compiling node model.test.expected
[0m05:46:09.504023 [debug] [Thread-113]: Compiling model.test.actual
[0m05:46:09.504484 [debug] [Thread-114]: Compiling model.test.expected
[0m05:46:09.515657 [debug] [Thread-113]: Writing injected SQL for node "model.test.actual"
[0m05:46:09.521668 [debug] [Thread-114]: Writing injected SQL for node "model.test.expected"
[0m05:46:09.522650 [debug] [Thread-114]: finished collecting timing info
[0m05:46:09.523048 [debug] [Thread-113]: finished collecting timing info
[0m05:46:09.523544 [debug] [Thread-114]: Began executing node model.test.expected
[0m05:46:09.524022 [debug] [Thread-113]: Began executing node model.test.actual
[0m05:46:09.529996 [debug] [Thread-114]: Writing runtime sql for node "model.test.expected"
[0m05:46:09.534710 [debug] [Thread-113]: Writing runtime sql for node "model.test.actual"
[0m05:46:09.535583 [debug] [Thread-114]: Using vertica connection "model.test.expected"
[0m05:46:09.536007 [debug] [Thread-114]: On model.test.expected: BEGIN
[0m05:46:09.536289 [debug] [Thread-113]: Using vertica connection "model.test.actual"
[0m05:46:09.536684 [debug] [Thread-114]: Opening a new connection, currently in state init
[0m05:46:09.537049 [debug] [Thread-113]: On model.test.actual: BEGIN
[0m05:46:09.537955 [debug] [Thread-113]: Opening a new connection, currently in state closed
[0m05:46:09.554085 [debug] [Thread-114]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m05:46:09.556867 [debug] [Thread-113]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m05:46:09.560297 [debug] [Thread-114]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m05:46:09.560785 [debug] [Thread-114]: Using vertica connection "model.test.expected"
[0m05:46:09.561115 [debug] [Thread-114]: On model.test.expected: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.expected"} */

  create view "VMart"."test16667631683457740457_test_array_concat"."expected__dbt_tmp" as (
    select 1 as id, 
    array[ 1 , 2 , 3 , 4 , 5 , 6 ]
     as array_col union all
select 2 as id, 
    array[ 2 ]
     as array_col union all
select 3 as id, 
    array[ 3 ]
     as array_col
  );
[0m05:46:09.563594 [debug] [Thread-113]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.03 seconds
[0m05:46:09.564082 [debug] [Thread-113]: Using vertica connection "model.test.actual"
[0m05:46:09.564418 [debug] [Thread-113]: On model.test.actual: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.actual"} */

  create view "VMart"."test16667631683457740457_test_array_concat"."actual__dbt_tmp" as (
    select 1 as id, array_cat(
    array[ 1 , 2 , 3 ]
    , 
    array[ 4 , 5 , 6 ]
    ) as array_col union all
select 2 as id, array_cat(
    array[]::INT[]
    , 
    array[ 2 ]
    ) as array_col union all
select 3 as id, array_cat(
    array[ 3 ]
    , 
    array[]::INT[]
    ) as array_col
  );
[0m05:46:09.570628 [debug] [Thread-114]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m05:46:09.575665 [debug] [Thread-114]: Using vertica connection "model.test.expected"
[0m05:46:09.576114 [debug] [Thread-114]: On model.test.expected: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.expected"} */
alter view "VMart"."test16667631683457740457_test_array_concat"."expected" rename to "expected__dbt_backup"
[0m05:46:09.580069 [debug] [Thread-113]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m05:46:09.585010 [debug] [Thread-113]: Using vertica connection "model.test.actual"
[0m05:46:09.585410 [debug] [Thread-113]: On model.test.actual: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.actual"} */
alter view "VMart"."test16667631683457740457_test_array_concat"."actual" rename to "actual__dbt_backup"
[0m05:46:09.585933 [debug] [Thread-114]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m05:46:09.592493 [debug] [Thread-114]: Using vertica connection "model.test.expected"
[0m05:46:09.592891 [debug] [Thread-114]: On model.test.expected: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.expected"} */
alter view "VMart"."test16667631683457740457_test_array_concat"."expected__dbt_tmp" rename to "expected"
[0m05:46:09.597834 [debug] [Thread-113]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m05:46:09.602660 [debug] [Thread-113]: Using vertica connection "model.test.actual"
[0m05:46:09.603065 [debug] [Thread-113]: On model.test.actual: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.actual"} */
alter view "VMart"."test16667631683457740457_test_array_concat"."actual__dbt_tmp" rename to "actual"
[0m05:46:09.603403 [debug] [Thread-114]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m05:46:09.606448 [debug] [Thread-114]: On model.test.expected: COMMIT
[0m05:46:09.606821 [debug] [Thread-114]: Using vertica connection "model.test.expected"
[0m05:46:09.607128 [debug] [Thread-114]: On model.test.expected: COMMIT
[0m05:46:09.613668 [debug] [Thread-114]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m05:46:09.617563 [debug] [Thread-114]: Using vertica connection "model.test.expected"
[0m05:46:09.618044 [debug] [Thread-114]: On model.test.expected: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.expected"} */
drop view if exists "VMart"."test16667631683457740457_test_array_concat"."expected__dbt_backup" cascade
[0m05:46:09.618428 [debug] [Thread-113]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m05:46:09.621816 [debug] [Thread-113]: On model.test.actual: COMMIT
[0m05:46:09.622206 [debug] [Thread-113]: Using vertica connection "model.test.actual"
[0m05:46:09.622501 [debug] [Thread-113]: On model.test.actual: COMMIT
[0m05:46:09.629163 [debug] [Thread-114]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m05:46:09.631470 [debug] [Thread-114]: finished collecting timing info
[0m05:46:09.632012 [debug] [Thread-113]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m05:46:09.632548 [debug] [Thread-114]: On model.test.expected: Close
[0m05:46:09.636334 [debug] [Thread-113]: Using vertica connection "model.test.actual"
[0m05:46:09.637954 [info ] [Thread-114]: 2 of 2 OK created sql view model test16667631683457740457_test_array_concat.expected  [[32mCode: None, Rows: -1, Array Size: 1[0m in 0.14s]
[0m05:46:09.638510 [debug] [Thread-113]: On model.test.actual: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.test.actual"} */
drop view if exists "VMart"."test16667631683457740457_test_array_concat"."actual__dbt_backup" cascade
[0m05:46:09.639560 [debug] [Thread-114]: Finished running node model.test.expected
[0m05:46:09.652445 [debug] [Thread-113]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m05:46:09.654896 [debug] [Thread-113]: finished collecting timing info
[0m05:46:09.655388 [debug] [Thread-113]: On model.test.actual: Close
[0m05:46:09.656692 [info ] [Thread-113]: 1 of 2 OK created sql view model test16667631683457740457_test_array_concat.actual  [[32mCode: None, Rows: -1, Array Size: 1[0m in 0.16s]
[0m05:46:09.657616 [debug] [Thread-113]: Finished running node model.test.actual
[0m05:46:09.660012 [debug] [MainThread]: Acquiring new vertica connection "master"
[0m05:46:09.660498 [debug] [MainThread]: Using vertica connection "master"
[0m05:46:09.660818 [debug] [MainThread]: On master: BEGIN
[0m05:46:09.661107 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:46:09.677508 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m05:46:09.685111 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m05:46:09.685781 [debug] [MainThread]: On master: COMMIT
[0m05:46:09.686326 [debug] [MainThread]: Using vertica connection "master"
[0m05:46:09.686845 [debug] [MainThread]: On master: COMMIT
[0m05:46:09.692753 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m05:46:09.693164 [debug] [MainThread]: On master: Close
[0m05:46:09.694109 [info ] [MainThread]: 
[0m05:46:09.694551 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.32 seconds (0.32s).
[0m05:46:09.694923 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:46:09.695098 [debug] [MainThread]: Connection 'model.test.actual' was properly closed.
[0m05:46:09.695225 [debug] [MainThread]: Connection 'model.test.expected' was properly closed.
[0m05:46:09.700050 [info ] [MainThread]: 
[0m05:46:09.700303 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:46:09.700502 [info ] [MainThread]: 
[0m05:46:09.700663 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m05:46:09.700877 [debug] [MainThread]: Flushing usage events
[0m05:46:09.701298 [debug] [MainThread]: Acquiring new vertica connection "_test"
[0m05:46:09.702484 [debug] [MainThread]: Using vertica connection "_test"
[0m05:46:09.702610 [debug] [MainThread]: On _test: BEGIN
[0m05:46:09.702703 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:46:09.718856 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m05:46:09.724852 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m05:46:09.725368 [debug] [MainThread]: Using vertica connection "_test"
[0m05:46:09.725698 [debug] [MainThread]: On _test: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "_test"} */

    select
    column_name
    , data_type
    , character_maximum_length
    , numeric_precision
    , numeric_scale
    from (
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.columns
        where table_schema = 'test16667631683457740457_test_array_concat'
        and table_name = 'expected'
        union all
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.view_columns
        where table_schema = 'test16667631683457740457_test_array_concat'
        and table_name = 'expected'
    ) t
    order by ordinal_position
  
[0m05:46:09.752825 [debug] [MainThread]: SQL status: Code: [Column(name='column_name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='data_type', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='character_maximum_length', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_precision', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_scale', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.03 seconds
[0m05:46:09.756052 [debug] [MainThread]: Using vertica connection "_test"
[0m05:46:09.756555 [debug] [MainThread]: On _test: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "_test"} */
with diff_count as (
    SELECT
        1 as id,
        COUNT(*) as num_missing FROM (
            (SELECT "array_col", "id" FROM "VMart"."test16667631683457740457_test_array_concat"."expected" EXCEPT
             SELECT "array_col", "id" FROM "VMart"."test16667631683457740457_test_array_concat"."actual")
             UNION ALL
            (SELECT "array_col", "id" FROM "VMart"."test16667631683457740457_test_array_concat"."actual" EXCEPT
             SELECT "array_col", "id" FROM "VMart"."test16667631683457740457_test_array_concat"."expected")
        ) as a
), table_a as (
    SELECT COUNT(*) as num_rows FROM "VMart"."test16667631683457740457_test_array_concat"."expected"
), table_b as (
    SELECT COUNT(*) as num_rows FROM "VMart"."test16667631683457740457_test_array_concat"."actual"
), row_count_diff as (
    select
        1 as id,
        table_a.num_rows - table_b.num_rows as difference
    from table_a, table_b
)
select
    row_count_diff.difference as row_count_difference,
    diff_count.num_missing as num_mismatched
from row_count_diff
join diff_count using (id)
[0m05:46:09.816513 [debug] [MainThread]: SQL status: Code: [Column(name='row_count_difference', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='num_mismatched', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.06 seconds
[0m05:46:09.819137 [debug] [MainThread]: On _test: ROLLBACK
[0m05:46:09.826348 [debug] [MainThread]: On _test: Close
[0m05:46:09.828324 [debug] [MainThread]: Acquiring new vertica connection "_test"
[0m05:46:09.831942 [debug] [MainThread]: Using vertica connection "_test"
[0m05:46:09.832366 [debug] [MainThread]: On _test: BEGIN
[0m05:46:09.832693 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:46:09.851123 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m05:46:09.857054 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m05:46:09.857618 [debug] [MainThread]: Using vertica connection "_test"
[0m05:46:09.858001 [debug] [MainThread]: On _test: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "_test"} */

    select
    column_name
    , data_type
    , character_maximum_length
    , numeric_precision
    , numeric_scale
    from (
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.columns
        where table_schema = 'test16667631683457740457_test_array_concat'
        and table_name = 'expected'
        union all
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.view_columns
        where table_schema = 'test16667631683457740457_test_array_concat'
        and table_name = 'expected'
    ) t
    order by ordinal_position
  
[0m05:46:09.893025 [debug] [MainThread]: SQL status: Code: [Column(name='column_name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='data_type', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='character_maximum_length', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_precision', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_scale', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.03 seconds
[0m05:46:09.896108 [debug] [MainThread]: On _test: ROLLBACK
[0m05:46:09.903810 [debug] [MainThread]: On _test: Close
[0m05:46:09.905936 [debug] [MainThread]: Acquiring new vertica connection "_test"
[0m05:46:09.909773 [debug] [MainThread]: Using vertica connection "_test"
[0m05:46:09.910208 [debug] [MainThread]: On _test: BEGIN
[0m05:46:09.910534 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:46:09.928764 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m05:46:09.934002 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m05:46:09.934558 [debug] [MainThread]: Using vertica connection "_test"
[0m05:46:09.934925 [debug] [MainThread]: On _test: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "_test"} */

    select
    column_name
    , data_type
    , character_maximum_length
    , numeric_precision
    , numeric_scale
    from (
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.columns
        where table_schema = 'test16667631683457740457_test_array_concat'
        and table_name = 'actual'
        union all
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.view_columns
        where table_schema = 'test16667631683457740457_test_array_concat'
        and table_name = 'actual'
    ) t
    order by ordinal_position
  
[0m05:46:09.966090 [debug] [MainThread]: SQL status: Code: [Column(name='column_name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='data_type', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='character_maximum_length', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_precision', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_scale', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.03 seconds
[0m05:46:09.969162 [debug] [MainThread]: On _test: ROLLBACK
[0m05:46:09.975634 [debug] [MainThread]: On _test: Close
[0m05:46:09.978433 [debug] [MainThread]: Acquiring new vertica connection "_test"
[0m05:46:09.979158 [debug] [MainThread]: Dropping schema "_ReferenceKey(database='vmart', schema='test16667631683457740457_test_array_concat', identifier=None)".
[0m05:46:09.988122 [debug] [MainThread]: Using vertica connection "_test"
[0m05:46:09.988751 [debug] [MainThread]: On _test: BEGIN
[0m05:46:09.989179 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:46:10.009169 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m05:46:10.016692 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.03 seconds
[0m05:46:10.016941 [debug] [MainThread]: Using vertica connection "_test"
[0m05:46:10.017075 [debug] [MainThread]: On _test: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "_test"} */
drop schema if exists "test16667631683457740457_test_array_concat" cascade
  
[0m05:46:10.027943 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m05:46:10.028871 [debug] [MainThread]: On _test: COMMIT
[0m05:46:10.029070 [debug] [MainThread]: Using vertica connection "_test"
[0m05:46:10.029213 [debug] [MainThread]: On _test: COMMIT
[0m05:46:10.035800 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m05:46:10.036137 [debug] [MainThread]: On _test: Close
[0m05:46:10.037313 [debug] [MainThread]: Connection '_test' was properly closed.
[0m05:46:10.055526 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
[0m05:46:10.056469 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m05:46:10.056682 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m05:46:10.056848 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m05:46:10.061738 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m05:46:10.062954 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m05:46:10.063989 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m05:46:10.068143 [debug] [MainThread]: Parsing macros/materializations/models/incremental/helpers.sql
[0m05:46:10.070943 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m05:46:10.076713 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m05:46:10.078180 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m05:46:10.084522 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m05:46:10.087254 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m05:46:10.098594 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m05:46:10.100353 [debug] [MainThread]: Parsing macros/materializations/snapshots/helper.sql
[0m05:46:10.100640 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m05:46:10.109342 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m05:46:10.115159 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m05:46:10.116088 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m05:46:10.116734 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m05:46:10.119521 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m05:46:10.122058 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m05:46:10.128057 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m05:46:10.129731 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m05:46:10.131957 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m05:46:10.133640 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m05:46:10.136141 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m05:46:10.137007 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m05:46:10.140298 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m05:46:10.141718 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m05:46:10.143846 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m05:46:10.153023 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m05:46:10.157811 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m05:46:10.158804 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m05:46:10.165094 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m05:46:10.169112 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m05:46:10.179212 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m05:46:10.181347 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m05:46:10.184613 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m05:46:10.192318 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m05:46:10.193356 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m05:46:10.200827 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m05:46:10.247905 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m05:46:10.249167 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m05:46:10.250321 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m05:46:10.252975 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m05:46:10.263722 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m05:46:10.267857 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m05:46:10.268789 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m05:46:10.269748 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m05:46:10.271205 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m05:46:10.272394 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m05:46:10.274036 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m05:46:10.279667 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m05:46:10.288140 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m05:46:10.292261 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m05:46:10.300060 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m05:46:10.301378 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m05:46:10.303407 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m05:46:10.305966 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m05:46:10.309491 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m05:46:10.310310 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m05:46:10.310982 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m05:46:10.311581 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m05:46:10.312367 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m05:46:10.313295 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m05:46:10.313953 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m05:46:10.314565 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m05:46:10.315227 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m05:46:10.316448 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m05:46:10.316990 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m05:46:10.317758 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m05:46:10.318455 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m05:46:10.322391 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m05:46:10.322995 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m05:46:10.323785 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m05:46:10.324459 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m05:46:10.325239 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m05:46:10.325928 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m05:46:10.327318 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m05:46:10.327962 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m05:46:10.328519 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m05:46:10.329211 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m05:46:10.329901 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m05:46:10.331075 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m05:46:10.331937 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m05:46:10.332493 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m05:46:10.332955 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m05:46:10.333567 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m05:46:10.336672 [debug] [MainThread]: Parsing macros/etc/datetime.sql
