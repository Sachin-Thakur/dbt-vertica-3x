[0m11:10:49.933441 [debug] [MainThread]: Acquiring new vertica connection "_test"
[0m11:10:49.933621 [debug] [MainThread]: Acquiring new vertica connection "_test"
[0m11:10:49.933789 [debug] [MainThread]: Creating schema "_ReferenceKey(database='vmart', schema='test16660914502674047497_test_basic', identifier=None)"
[0m11:10:49.940228 [debug] [MainThread]: Using vertica connection "_test"
[0m11:10:49.940391 [debug] [MainThread]: On _test: BEGIN
[0m11:10:49.940504 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:10:49.964469 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:10:49.971639 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.03 seconds
[0m11:10:49.972036 [debug] [MainThread]: Using vertica connection "_test"
[0m11:10:49.972288 [debug] [MainThread]: On _test: create schema if not exists "test16660914502674047497_test_basic"
  
[0m11:10:49.988513 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m11:10:49.990389 [debug] [MainThread]: On _test: COMMIT
[0m11:10:49.990814 [debug] [MainThread]: Using vertica connection "_test"
[0m11:10:49.991155 [debug] [MainThread]: On _test: COMMIT
[0m11:10:49.998804 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:10:49.999400 [debug] [MainThread]: On _test: Close
[0m11:10:50.015047 [debug] [MainThread]: Connection '_test' was properly closed.


============================== 2022-10-18 11:10:50.020588 | 469d4fd0-7cfc-44a8-aa92-afa362fb0def ==============================
[0m11:10:50.020596 [info ] [MainThread]: Running with dbt=1.3.0
[0m11:10:50.020852 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/tmp/pytest-of-sachin/pytest-12/profile0', 'send_anonymous_usage_stats': False, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'show': False, 'which': 'seed', 'rpc_method': 'seed', 'indirect_selection': 'eager'}
[0m11:10:50.020968 [debug] [MainThread]: Tracking: do not track
[0m11:10:50.026578 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
[0m11:10:50.035192 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m11:10:50.035370 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m11:10:50.035515 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m11:10:50.039797 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m11:10:50.040687 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m11:10:50.041284 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m11:10:50.043831 [debug] [MainThread]: Parsing macros/materializations/models/incremental/helpers.sql
[0m11:10:50.045538 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m11:10:50.049042 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m11:10:50.049942 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m11:10:50.053607 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m11:10:50.054868 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m11:10:50.061960 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m11:10:50.062985 [debug] [MainThread]: Parsing macros/materializations/snapshots/helper.sql
[0m11:10:50.063135 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m11:10:50.068231 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m11:10:50.071758 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m11:10:50.072332 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m11:10:50.072764 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m11:10:50.074605 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m11:10:50.076205 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m11:10:50.080281 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m11:10:50.081126 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m11:10:50.081807 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m11:10:50.083163 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m11:10:50.085405 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m11:10:50.086322 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m11:10:50.089502 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m11:10:50.090854 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m11:10:50.092877 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m11:10:50.101915 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m11:10:50.106722 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m11:10:50.107656 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m11:10:50.114670 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m11:10:50.118855 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m11:10:50.128765 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m11:10:50.130876 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m11:10:50.134097 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m11:10:50.141652 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m11:10:50.142681 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m11:10:50.149530 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m11:10:50.158850 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m11:10:50.159948 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m11:10:50.161053 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m11:10:50.163686 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m11:10:50.174797 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m11:10:50.178921 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m11:10:50.179842 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m11:10:50.180803 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m11:10:50.182245 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m11:10:50.183430 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m11:10:50.185060 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m11:10:50.190726 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m11:10:50.199235 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m11:10:50.203409 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m11:10:50.211365 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m11:10:50.212741 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m11:10:50.214751 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m11:10:50.217294 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m11:10:50.220815 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m11:10:50.221590 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m11:10:50.222244 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m11:10:50.222823 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m11:10:50.223555 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m11:10:50.224497 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m11:10:50.225096 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m11:10:50.225698 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m11:10:50.226378 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m11:10:50.227607 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m11:10:50.228169 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m11:10:50.228940 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m11:10:50.229606 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m11:10:50.233460 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m11:10:50.234047 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m11:10:50.234846 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m11:10:50.235506 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m11:10:50.236324 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m11:10:50.237007 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m11:10:50.238370 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m11:10:50.238969 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m11:10:50.239489 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m11:10:50.240146 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m11:10:50.240838 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m11:10:50.241902 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m11:10:50.242792 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m11:10:50.243340 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m11:10:50.243803 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m11:10:50.244457 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m11:10:50.247585 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m11:10:50.252539 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m11:10:50.416353 [debug] [MainThread]: 1699: static parser successfully parsed view_model.sql
[0m11:10:50.424230 [debug] [MainThread]: 1603: static parser failed on swappable.sql
[0m11:10:50.427138 [debug] [MainThread]: 1602: parser fallback to jinja rendering on swappable.sql
[0m11:10:50.428009 [debug] [MainThread]: 1699: static parser successfully parsed table_model.sql
[0m11:10:50.473143 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 296 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
[0m11:10:50.474141 [info ] [MainThread]: 
[0m11:10:50.474632 [debug] [MainThread]: Acquiring new vertica connection "master"
[0m11:10:50.475342 [debug] [ThreadPool]: Acquiring new vertica connection "list_VMart"
[0m11:10:50.479026 [debug] [ThreadPool]: Using vertica connection "list_VMart"
[0m11:10:50.479189 [debug] [ThreadPool]: On list_VMart: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "list_VMart"} */

    select schema_name
    from v_catalog.schemata
  
[0m11:10:50.479298 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:10:50.503250 [debug] [ThreadPool]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:10:50.544144 [debug] [ThreadPool]: SQL status: Code: [Column(name='schema_name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.06 seconds
[0m11:10:50.547076 [debug] [ThreadPool]: On list_VMart: Close
[0m11:10:50.550592 [debug] [ThreadPool]: Acquiring new vertica connection "list_VMart_test16660914502674047497_test_basic"
[0m11:10:50.557919 [debug] [ThreadPool]: Using vertica connection "list_VMart_test16660914502674047497_test_basic"
[0m11:10:50.558114 [debug] [ThreadPool]: On list_VMart_test16660914502674047497_test_basic: BEGIN
[0m11:10:50.558230 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:10:50.604534 [debug] [ThreadPool]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:10:50.627848 [debug] [ThreadPool]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.07 seconds
[0m11:10:50.628104 [debug] [ThreadPool]: Using vertica connection "list_VMart_test16660914502674047497_test_basic"
[0m11:10:50.628241 [debug] [ThreadPool]: On list_VMart_test16660914502674047497_test_basic: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "list_VMart_test16660914502674047497_test_basic"} */
select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'table' as type
    from v_catalog.tables
    where table_schema ilike 'test16660914502674047497_test_basic'
    union all
    select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'view' as type
    from v_catalog.views
    where table_schema ilike 'test16660914502674047497_test_basic'
  
[0m11:10:50.663082 [debug] [ThreadPool]: SQL status: Code: [Column(name='database', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='schema', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='type', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.03 seconds
[0m11:10:50.663936 [debug] [ThreadPool]: On list_VMart_test16660914502674047497_test_basic: ROLLBACK
[0m11:10:50.688473 [debug] [ThreadPool]: On list_VMart_test16660914502674047497_test_basic: Close
[0m11:10:50.689306 [debug] [MainThread]: Using vertica connection "master"
[0m11:10:50.689502 [debug] [MainThread]: On master: BEGIN
[0m11:10:50.689634 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:10:50.710845 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:10:50.716294 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.03 seconds
[0m11:10:50.716499 [debug] [MainThread]: On master: COMMIT
[0m11:10:50.716621 [debug] [MainThread]: Using vertica connection "master"
[0m11:10:50.716726 [debug] [MainThread]: On master: COMMIT
[0m11:10:50.724255 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:10:50.724512 [debug] [MainThread]: On master: Close
[0m11:10:50.724964 [info ] [MainThread]: Concurrency: 4 threads (target='default')
[0m11:10:50.725232 [info ] [MainThread]: 
[0m11:10:50.727732 [debug] [Thread-1 (]: Began running node seed.base.base
[0m11:10:50.728013 [info ] [Thread-1 (]: 1 of 1 START seed file test16660914502674047497_test_basic.base ................ [RUN]
[0m11:10:50.728509 [debug] [Thread-1 (]: Acquiring new vertica connection "seed.base.base"
[0m11:10:50.728650 [debug] [Thread-1 (]: Began compiling node seed.base.base
[0m11:10:50.728777 [debug] [Thread-1 (]: finished collecting timing info
[0m11:10:50.728896 [debug] [Thread-1 (]: Began executing node seed.base.base
[0m11:10:50.757583 [debug] [Thread-1 (]: Writing runtime sql for node "seed.base.base"
[0m11:10:50.758038 [debug] [Thread-1 (]: Using vertica connection "seed.base.base"
[0m11:10:50.758202 [debug] [Thread-1 (]: On seed.base.base: BEGIN
[0m11:10:50.758317 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:10:50.775934 [debug] [Thread-1 (]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:10:50.781709 [debug] [Thread-1 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m11:10:50.782071 [debug] [Thread-1 (]: Using vertica connection "seed.base.base"
[0m11:10:50.782274 [debug] [Thread-1 (]: On seed.base.base: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "seed.base.base"} */

    
    create table "VMart"."test16660914502674047497_test_basic"."base" ("id" integer,"name" varchar(8),"some_date" timestamp without time zone)
  ;
    -- dbt seed --
    
        copy "VMart"."test16660914502674047497_test_basic"."base"
        ("id", "name", "some_date")
        from local '/tmp/pytest-of-sachin/pytest-12/project0/seeds/base.csv'
        delimiter ','
        enclosed by '"'
        skip 1
        abort on error
        rejected data as table "VMart"."test16660914502674047497_test_basic".seed_rejects;
    
  
[0m11:10:50.808271 [debug] [Thread-1 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.03 seconds
[0m11:10:50.819297 [debug] [Thread-1 (]: On seed.base.base: COMMIT
[0m11:10:50.819644 [debug] [Thread-1 (]: Using vertica connection "seed.base.base"
[0m11:10:50.819834 [debug] [Thread-1 (]: On seed.base.base: COMMIT
[0m11:10:50.899603 [debug] [Thread-1 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.08 seconds
[0m11:10:50.900419 [debug] [Thread-1 (]: finished collecting timing info
[0m11:10:50.900722 [debug] [Thread-1 (]: On seed.base.base: Close
[0m11:10:50.901443 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file test16660914502674047497_test_basic.base ............ [[32mCode: None, Rows: -1, Array Size: 1[0m in 0.17s]
[0m11:10:50.902014 [debug] [Thread-1 (]: Finished running node seed.base.base
[0m11:10:50.903259 [debug] [MainThread]: Acquiring new vertica connection "master"
[0m11:10:50.903648 [debug] [MainThread]: Using vertica connection "master"
[0m11:10:50.903876 [debug] [MainThread]: On master: BEGIN
[0m11:10:50.904061 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:10:50.921938 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:10:50.929419 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.03 seconds
[0m11:10:50.929692 [debug] [MainThread]: On master: COMMIT
[0m11:10:50.929824 [debug] [MainThread]: Using vertica connection "master"
[0m11:10:50.929933 [debug] [MainThread]: On master: COMMIT
[0m11:10:50.936132 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:10:50.936411 [debug] [MainThread]: On master: Close
[0m11:10:50.936880 [info ] [MainThread]: 
[0m11:10:50.937141 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 0.46 seconds (0.46s).
[0m11:10:50.937343 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:10:50.937448 [debug] [MainThread]: Connection 'seed.base.base' was properly closed.
[0m11:10:50.941678 [info ] [MainThread]: 
[0m11:10:50.942009 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:10:50.942253 [info ] [MainThread]: 
[0m11:10:50.942448 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:10:50.942702 [debug] [MainThread]: Flushing usage events


============================== 2022-10-18 11:10:50.956102 | 469d4fd0-7cfc-44a8-aa92-afa362fb0def ==============================
[0m11:10:50.956113 [info ] [MainThread]: Running with dbt=1.3.0
[0m11:10:50.956468 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/tmp/pytest-of-sachin/pytest-12/profile0', 'send_anonymous_usage_stats': False, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:10:50.956598 [debug] [MainThread]: Tracking: do not track
[0m11:10:50.987771 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:10:50.988001 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:10:50.995865 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 296 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
[0m11:10:50.996659 [info ] [MainThread]: 
[0m11:10:50.997151 [debug] [MainThread]: Acquiring new vertica connection "master"
[0m11:10:50.997847 [debug] [ThreadPool]: Acquiring new vertica connection "list_VMart"
[0m11:10:50.999527 [debug] [ThreadPool]: Using vertica connection "list_VMart"
[0m11:10:50.999793 [debug] [ThreadPool]: On list_VMart: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "list_VMart"} */

    select schema_name
    from v_catalog.schemata
  
[0m11:10:50.999913 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:10:51.021598 [debug] [ThreadPool]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:10:51.049048 [debug] [ThreadPool]: SQL status: Code: [Column(name='schema_name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.05 seconds
[0m11:10:51.050521 [debug] [ThreadPool]: On list_VMart: Close
[0m11:10:51.052069 [debug] [ThreadPool]: Acquiring new vertica connection "list_VMart_test16660914502674047497_test_basic"
[0m11:10:51.096564 [debug] [ThreadPool]: Using vertica connection "list_VMart_test16660914502674047497_test_basic"
[0m11:10:51.096797 [debug] [ThreadPool]: On list_VMart_test16660914502674047497_test_basic: BEGIN
[0m11:10:51.096926 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:10:51.114534 [debug] [ThreadPool]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:10:51.120025 [debug] [ThreadPool]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m11:10:51.120294 [debug] [ThreadPool]: Using vertica connection "list_VMart_test16660914502674047497_test_basic"
[0m11:10:51.120428 [debug] [ThreadPool]: On list_VMart_test16660914502674047497_test_basic: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "list_VMart_test16660914502674047497_test_basic"} */
select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'table' as type
    from v_catalog.tables
    where table_schema ilike 'test16660914502674047497_test_basic'
    union all
    select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'view' as type
    from v_catalog.views
    where table_schema ilike 'test16660914502674047497_test_basic'
  
[0m11:10:51.142411 [debug] [ThreadPool]: SQL status: Code: [Column(name='database', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='schema', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='type', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.02 seconds
[0m11:10:51.143426 [debug] [ThreadPool]: On list_VMart_test16660914502674047497_test_basic: ROLLBACK
[0m11:10:51.150292 [debug] [ThreadPool]: On list_VMart_test16660914502674047497_test_basic: Close
[0m11:10:51.151130 [debug] [MainThread]: Using vertica connection "master"
[0m11:10:51.151435 [debug] [MainThread]: On master: BEGIN
[0m11:10:51.151629 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:10:51.169428 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:10:51.176314 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m11:10:51.176739 [debug] [MainThread]: On master: COMMIT
[0m11:10:51.176994 [debug] [MainThread]: Using vertica connection "master"
[0m11:10:51.177219 [debug] [MainThread]: On master: COMMIT
[0m11:10:51.182815 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:10:51.183264 [debug] [MainThread]: On master: Close
[0m11:10:51.184062 [info ] [MainThread]: Concurrency: 4 threads (target='default')
[0m11:10:51.184629 [info ] [MainThread]: 
[0m11:10:51.186609 [debug] [Thread-8 (]: Began running node model.base.swappable
[0m11:10:51.187057 [debug] [Thread-9 (]: Began running node model.base.table_model
[0m11:10:51.187294 [debug] [Thread-10 ]: Began running node model.base.view_model
[0m11:10:51.187821 [info ] [Thread-8 (]: 1 of 3 START sql table model test16660914502674047497_test_basic.swappable ..... [RUN]
[0m11:10:51.188307 [info ] [Thread-9 (]: 2 of 3 START sql table model test16660914502674047497_test_basic.table_model ... [RUN]
[0m11:10:51.188645 [info ] [Thread-10 ]: 3 of 3 START sql view model test16660914502674047497_test_basic.view_model ..... [RUN]
[0m11:10:51.189462 [debug] [Thread-8 (]: Acquiring new vertica connection "model.base.swappable"
[0m11:10:51.190291 [debug] [Thread-9 (]: Acquiring new vertica connection "model.base.table_model"
[0m11:10:51.191115 [debug] [Thread-10 ]: Acquiring new vertica connection "model.base.view_model"
[0m11:10:51.192239 [debug] [Thread-10 ]: Began compiling node model.base.view_model
[0m11:10:51.191982 [debug] [Thread-9 (]: Began compiling node model.base.table_model
[0m11:10:51.192458 [debug] [Thread-10 ]: Compiling model.base.view_model
[0m11:10:51.191415 [debug] [Thread-8 (]: Began compiling node model.base.swappable
[0m11:10:51.192679 [debug] [Thread-9 (]: Compiling model.base.table_model
[0m11:10:51.196665 [debug] [Thread-10 ]: Writing injected SQL for node "model.base.view_model"
[0m11:10:51.197161 [debug] [Thread-8 (]: Compiling model.base.swappable
[0m11:10:51.200903 [debug] [Thread-9 (]: Writing injected SQL for node "model.base.table_model"
[0m11:10:51.204911 [debug] [Thread-8 (]: Writing injected SQL for node "model.base.swappable"
[0m11:10:51.205561 [debug] [Thread-9 (]: finished collecting timing info
[0m11:10:51.205780 [debug] [Thread-10 ]: finished collecting timing info
[0m11:10:51.205977 [debug] [Thread-8 (]: finished collecting timing info
[0m11:10:51.206205 [debug] [Thread-9 (]: Began executing node model.base.table_model
[0m11:10:51.206452 [debug] [Thread-10 ]: Began executing node model.base.view_model
[0m11:10:51.206676 [debug] [Thread-8 (]: Began executing node model.base.swappable
[0m11:10:51.226067 [debug] [Thread-9 (]: Using vertica connection "model.base.table_model"
[0m11:10:51.265786 [debug] [Thread-9 (]: On model.base.table_model: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.base.table_model"} */
drop table if exists "VMart"."test16660914502674047497_test_basic"."table_model__dbt_tmp" cascade
[0m11:10:51.265417 [debug] [Thread-8 (]: Using vertica connection "model.base.swappable"
[0m11:10:51.266018 [debug] [Thread-9 (]: Opening a new connection, currently in state init
[0m11:10:51.260845 [debug] [Thread-10 ]: Writing runtime sql for node "model.base.view_model"
[0m11:10:51.266266 [debug] [Thread-8 (]: On model.base.swappable: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.base.swappable"} */
drop table if exists "VMart"."test16660914502674047497_test_basic"."swappable__dbt_tmp" cascade
[0m11:10:51.267060 [debug] [Thread-8 (]: Opening a new connection, currently in state closed
[0m11:10:51.267344 [debug] [Thread-10 ]: Using vertica connection "model.base.view_model"
[0m11:10:51.267987 [debug] [Thread-10 ]: On model.base.view_model: BEGIN
[0m11:10:51.268179 [debug] [Thread-10 ]: Opening a new connection, currently in state init
[0m11:10:51.286430 [debug] [Thread-8 (]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:10:51.286784 [debug] [Thread-10 ]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:10:51.287070 [debug] [Thread-9 (]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:10:51.295672 [debug] [Thread-8 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.03 seconds
[0m11:10:51.295879 [debug] [Thread-10 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.03 seconds
[0m11:10:51.296045 [debug] [Thread-9 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.03 seconds
[0m11:10:51.298399 [debug] [Thread-8 (]: Using vertica connection "model.base.swappable"
[0m11:10:51.298677 [debug] [Thread-10 ]: Using vertica connection "model.base.view_model"
[0m11:10:51.300844 [debug] [Thread-10 ]: On model.base.view_model: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.base.view_model"} */

  create view "VMart"."test16660914502674047497_test_basic"."view_model__dbt_tmp" as (
    

  select * from "VMart"."test16660914502674047497_test_basic"."base"
  );
[0m11:10:51.300688 [debug] [Thread-8 (]: On model.base.swappable: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.base.swappable"} */
drop table if exists "VMart"."test16660914502674047497_test_basic"."swappable__dbt_backup" cascade
[0m11:10:51.300457 [debug] [Thread-9 (]: Using vertica connection "model.base.table_model"
[0m11:10:51.301248 [debug] [Thread-9 (]: On model.base.table_model: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.base.table_model"} */
drop table if exists "VMart"."test16660914502674047497_test_basic"."table_model__dbt_backup" cascade
[0m11:10:51.311047 [debug] [Thread-8 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:10:51.316650 [debug] [Thread-10 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m11:10:51.319423 [debug] [Thread-8 (]: Writing runtime sql for node "model.base.swappable"
[0m11:10:51.320065 [debug] [Thread-9 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m11:10:51.325268 [debug] [Thread-10 ]: Using vertica connection "model.base.view_model"
[0m11:10:51.326685 [debug] [Thread-9 (]: Writing runtime sql for node "model.base.table_model"
[0m11:10:51.326963 [debug] [Thread-8 (]: Using vertica connection "model.base.swappable"
[0m11:10:51.327114 [debug] [Thread-10 ]: On model.base.view_model: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.base.view_model"} */
alter view "VMart"."test16660914502674047497_test_basic"."view_model__dbt_tmp" rename to "view_model"
[0m11:10:51.327376 [debug] [Thread-8 (]: On model.base.swappable: BEGIN
[0m11:10:51.327681 [debug] [Thread-9 (]: Using vertica connection "model.base.table_model"
[0m11:10:51.327901 [debug] [Thread-9 (]: On model.base.table_model: BEGIN
[0m11:10:51.334274 [debug] [Thread-9 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:10:51.334524 [debug] [Thread-9 (]: Using vertica connection "model.base.table_model"
[0m11:10:51.334664 [debug] [Thread-9 (]: On model.base.table_model: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.base.table_model"} */

  
    

  create  table
    "VMart"."test16660914502674047497_test_basic"."table_model__dbt_tmp"
    
  as (
    

  select * from "VMart"."test16660914502674047497_test_basic"."base"
  );

  
[0m11:10:51.339589 [debug] [Thread-10 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:10:51.339780 [debug] [Thread-8 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:10:51.348954 [debug] [Thread-10 ]: On model.base.view_model: COMMIT
[0m11:10:51.349254 [debug] [Thread-8 (]: Using vertica connection "model.base.swappable"
[0m11:10:51.349678 [debug] [Thread-8 (]: On model.base.swappable: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.base.swappable"} */

  
    

  create  table
    "VMart"."test16660914502674047497_test_basic"."swappable__dbt_tmp"
    
  as (
    

  select * from "VMart"."test16660914502674047497_test_basic"."base"
  );

  
[0m11:10:51.349511 [debug] [Thread-10 ]: Using vertica connection "model.base.view_model"
[0m11:10:51.349946 [debug] [Thread-10 ]: On model.base.view_model: COMMIT
[0m11:10:51.356057 [debug] [Thread-10 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:10:51.357827 [debug] [Thread-10 ]: Using vertica connection "model.base.view_model"
[0m11:10:51.358024 [debug] [Thread-10 ]: On model.base.view_model: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.base.view_model"} */
drop view if exists "VMart"."test16660914502674047497_test_basic"."view_model__dbt_backup" cascade
[0m11:10:51.368450 [debug] [Thread-10 ]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:10:51.369783 [debug] [Thread-10 ]: finished collecting timing info
[0m11:10:51.370070 [debug] [Thread-10 ]: On model.base.view_model: Close
[0m11:10:51.370923 [info ] [Thread-10 ]: 3 of 3 OK created sql view model test16660914502674047497_test_basic.view_model  [[32mCode: None, Rows: -1, Array Size: 1[0m in 0.18s]
[0m11:10:51.371567 [debug] [Thread-10 ]: Finished running node model.base.view_model
[0m11:10:51.386498 [debug] [Thread-9 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.05 seconds
[0m11:10:51.390173 [debug] [Thread-9 (]: Using vertica connection "model.base.table_model"
[0m11:10:51.390524 [debug] [Thread-9 (]: On model.base.table_model: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.base.table_model"} */
alter table "VMart"."test16660914502674047497_test_basic"."table_model__dbt_tmp" rename to "table_model"
[0m11:10:51.395642 [debug] [Thread-8 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.05 seconds
[0m11:10:51.397799 [debug] [Thread-8 (]: Using vertica connection "model.base.swappable"
[0m11:10:51.398022 [debug] [Thread-8 (]: On model.base.swappable: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.base.swappable"} */
alter table "VMart"."test16660914502674047497_test_basic"."swappable__dbt_tmp" rename to "swappable"
[0m11:10:51.406429 [debug] [Thread-9 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m11:10:51.407901 [debug] [Thread-9 (]: On model.base.table_model: COMMIT
[0m11:10:51.408344 [debug] [Thread-9 (]: Using vertica connection "model.base.table_model"
[0m11:10:51.408586 [debug] [Thread-9 (]: On model.base.table_model: COMMIT
[0m11:10:51.412145 [debug] [Thread-8 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:10:51.413772 [debug] [Thread-8 (]: On model.base.swappable: COMMIT
[0m11:10:51.414173 [debug] [Thread-8 (]: Using vertica connection "model.base.swappable"
[0m11:10:51.414434 [debug] [Thread-8 (]: On model.base.swappable: COMMIT
[0m11:10:51.414826 [debug] [Thread-9 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:10:51.417404 [debug] [Thread-9 (]: Using vertica connection "model.base.table_model"
[0m11:10:51.417708 [debug] [Thread-9 (]: On model.base.table_model: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.base.table_model"} */
drop table if exists "VMart"."test16660914502674047497_test_basic"."table_model__dbt_backup" cascade
[0m11:10:51.421123 [debug] [Thread-8 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:10:51.425605 [debug] [Thread-8 (]: Using vertica connection "model.base.swappable"
[0m11:10:51.425964 [debug] [Thread-9 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:10:51.426233 [debug] [Thread-8 (]: On model.base.swappable: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "model.base.swappable"} */
drop table if exists "VMart"."test16660914502674047497_test_basic"."swappable__dbt_backup" cascade
[0m11:10:51.427166 [debug] [Thread-9 (]: finished collecting timing info
[0m11:10:51.427510 [debug] [Thread-9 (]: On model.base.table_model: Close
[0m11:10:51.428090 [info ] [Thread-9 (]: 2 of 3 OK created sql table model test16660914502674047497_test_basic.table_model  [[32mCode: None, Rows: -1, Array Size: 1[0m in 0.24s]
[0m11:10:51.428489 [debug] [Thread-9 (]: Finished running node model.base.table_model
[0m11:10:51.435375 [debug] [Thread-8 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:10:51.436950 [debug] [Thread-8 (]: finished collecting timing info
[0m11:10:51.437268 [debug] [Thread-8 (]: On model.base.swappable: Close
[0m11:10:51.438111 [info ] [Thread-8 (]: 1 of 3 OK created sql table model test16660914502674047497_test_basic.swappable  [[32mCode: None, Rows: -1, Array Size: 1[0m in 0.25s]
[0m11:10:51.438710 [debug] [Thread-8 (]: Finished running node model.base.swappable
[0m11:10:51.439785 [debug] [MainThread]: Acquiring new vertica connection "master"
[0m11:10:51.440004 [debug] [MainThread]: Using vertica connection "master"
[0m11:10:51.440138 [debug] [MainThread]: On master: BEGIN
[0m11:10:51.440277 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:10:51.456778 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:10:51.462224 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m11:10:51.462591 [debug] [MainThread]: On master: COMMIT
[0m11:10:51.462826 [debug] [MainThread]: Using vertica connection "master"
[0m11:10:51.463023 [debug] [MainThread]: On master: COMMIT
[0m11:10:51.468132 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.0 seconds
[0m11:10:51.468488 [debug] [MainThread]: On master: Close
[0m11:10:51.469233 [info ] [MainThread]: 
[0m11:10:51.469651 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 0 minutes and 0.47 seconds (0.47s).
[0m11:10:51.470015 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:10:51.470196 [debug] [MainThread]: Connection 'model.base.swappable' was properly closed.
[0m11:10:51.470359 [debug] [MainThread]: Connection 'model.base.table_model' was properly closed.
[0m11:10:51.470531 [debug] [MainThread]: Connection 'model.base.view_model' was properly closed.
[0m11:10:51.477948 [info ] [MainThread]: 
[0m11:10:51.478416 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:10:51.478824 [info ] [MainThread]: 
[0m11:10:51.479162 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m11:10:51.479562 [debug] [MainThread]: Flushing usage events
[0m11:10:51.480337 [debug] [MainThread]: Acquiring new vertica connection "_test"
[0m11:10:51.487240 [debug] [MainThread]: Using vertica connection "_test"
[0m11:10:51.487569 [debug] [MainThread]: On _test: BEGIN
[0m11:10:51.487775 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:10:51.505976 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:10:51.511174 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m11:10:51.511560 [debug] [MainThread]: Using vertica connection "_test"
[0m11:10:51.511814 [debug] [MainThread]: On _test: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "_test"} */

    select
    column_name
    , data_type
    , character_maximum_length
    , numeric_precision
    , numeric_scale
    from (
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.columns
        where table_schema = 'test16660914502674047497_test_basic'
        and table_name = 'base'
        union all
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.view_columns
        where table_schema = 'test16660914502674047497_test_basic'
        and table_name = 'base'
    ) t
    order by ordinal_position
  
[0m11:10:51.541215 [debug] [MainThread]: SQL status: Code: [Column(name='column_name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='data_type', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='character_maximum_length', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_precision', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_scale', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.03 seconds
[0m11:10:51.544442 [debug] [MainThread]: Using vertica connection "_test"
[0m11:10:51.544734 [debug] [MainThread]: On _test: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "_test"} */
with diff_count as (
    SELECT
        1 as id,
        COUNT(*) as num_missing FROM (
            (SELECT "id", "name", "some_date" FROM "VMart"."test16660914502674047497_test_basic"."base" EXCEPT
             SELECT "id", "name", "some_date" FROM "VMart"."test16660914502674047497_test_basic"."view_model")
             UNION ALL
            (SELECT "id", "name", "some_date" FROM "VMart"."test16660914502674047497_test_basic"."view_model" EXCEPT
             SELECT "id", "name", "some_date" FROM "VMart"."test16660914502674047497_test_basic"."base")
        ) as a
), table_a as (
    SELECT COUNT(*) as num_rows FROM "VMart"."test16660914502674047497_test_basic"."base"
), table_b as (
    SELECT COUNT(*) as num_rows FROM "VMart"."test16660914502674047497_test_basic"."view_model"
), row_count_diff as (
    select
        1 as id,
        table_a.num_rows - table_b.num_rows as difference
    from table_a, table_b
)
select
    row_count_diff.difference as row_count_difference,
    diff_count.num_missing as num_mismatched
from row_count_diff
join diff_count using (id)
[0m11:10:51.597988 [debug] [MainThread]: SQL status: Code: [Column(name='row_count_difference', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='num_mismatched', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.05 seconds
[0m11:10:51.600245 [debug] [MainThread]: Using vertica connection "_test"
[0m11:10:51.600660 [debug] [MainThread]: On _test: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "_test"} */
with diff_count as (
    SELECT
        1 as id,
        COUNT(*) as num_missing FROM (
            (SELECT "id", "name", "some_date" FROM "VMart"."test16660914502674047497_test_basic"."base" EXCEPT
             SELECT "id", "name", "some_date" FROM "VMart"."test16660914502674047497_test_basic"."table_model")
             UNION ALL
            (SELECT "id", "name", "some_date" FROM "VMart"."test16660914502674047497_test_basic"."table_model" EXCEPT
             SELECT "id", "name", "some_date" FROM "VMart"."test16660914502674047497_test_basic"."base")
        ) as a
), table_a as (
    SELECT COUNT(*) as num_rows FROM "VMart"."test16660914502674047497_test_basic"."base"
), table_b as (
    SELECT COUNT(*) as num_rows FROM "VMart"."test16660914502674047497_test_basic"."table_model"
), row_count_diff as (
    select
        1 as id,
        table_a.num_rows - table_b.num_rows as difference
    from table_a, table_b
)
select
    row_count_diff.difference as row_count_difference,
    diff_count.num_missing as num_mismatched
from row_count_diff
join diff_count using (id)
[0m11:10:51.653826 [debug] [MainThread]: SQL status: Code: [Column(name='row_count_difference', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='num_mismatched', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.05 seconds
[0m11:10:51.656423 [debug] [MainThread]: On _test: ROLLBACK
[0m11:10:51.666366 [debug] [MainThread]: On _test: Close
[0m11:10:51.685596 [debug] [MainThread]: Connection '_test' was properly closed.


============================== 2022-10-18 11:10:51.692101 | 469d4fd0-7cfc-44a8-aa92-afa362fb0def ==============================
[0m11:10:51.692109 [info ] [MainThread]: Running with dbt=1.3.0
[0m11:10:51.692472 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/tmp/pytest-of-sachin/pytest-12/profile0', 'send_anonymous_usage_stats': False, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
[0m11:10:51.692587 [debug] [MainThread]: Tracking: do not track
[0m11:10:51.710746 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:10:51.710928 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:10:51.717988 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 296 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
[0m11:10:51.718694 [info ] [MainThread]: 
[0m11:10:51.719144 [debug] [MainThread]: Acquiring new vertica connection "master"
[0m11:10:51.719879 [debug] [ThreadPool]: Acquiring new vertica connection "list_VMart_test16660914502674047497_test_basic"
[0m11:10:51.721248 [debug] [ThreadPool]: Using vertica connection "list_VMart_test16660914502674047497_test_basic"
[0m11:10:51.721382 [debug] [ThreadPool]: On list_VMart_test16660914502674047497_test_basic: BEGIN
[0m11:10:51.721493 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:10:51.750319 [debug] [ThreadPool]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:10:51.756105 [debug] [ThreadPool]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.03 seconds
[0m11:10:51.756742 [debug] [ThreadPool]: Using vertica connection "list_VMart_test16660914502674047497_test_basic"
[0m11:10:51.757128 [debug] [ThreadPool]: On list_VMart_test16660914502674047497_test_basic: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "list_VMart_test16660914502674047497_test_basic"} */
select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'table' as type
    from v_catalog.tables
    where table_schema ilike 'test16660914502674047497_test_basic'
    union all
    select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'view' as type
    from v_catalog.views
    where table_schema ilike 'test16660914502674047497_test_basic'
  
[0m11:10:51.779716 [debug] [ThreadPool]: SQL status: Code: [Column(name='database', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='schema', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='type', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.02 seconds
[0m11:10:51.782665 [debug] [ThreadPool]: On list_VMart_test16660914502674047497_test_basic: ROLLBACK
[0m11:10:51.787749 [debug] [ThreadPool]: On list_VMart_test16660914502674047497_test_basic: Close
[0m11:10:51.790562 [info ] [MainThread]: Concurrency: 4 threads (target='default')
[0m11:10:51.791460 [info ] [MainThread]: 
[0m11:10:51.795527 [debug] [Thread-15 ]: Began running node model.base.swappable
[0m11:10:51.796001 [debug] [Thread-16 ]: Began running node model.base.table_model
[0m11:10:51.796530 [debug] [Thread-17 ]: Began running node model.base.view_model
[0m11:10:51.797554 [debug] [Thread-15 ]: Acquiring new vertica connection "model.base.swappable"
[0m11:10:51.798062 [debug] [Thread-18 ]: Began running node seed.base.base
[0m11:10:51.799353 [debug] [Thread-16 ]: Acquiring new vertica connection "model.base.table_model"
[0m11:10:51.800692 [debug] [Thread-17 ]: Acquiring new vertica connection "model.base.view_model"
[0m11:10:51.801307 [debug] [Thread-15 ]: Began compiling node model.base.swappable
[0m11:10:51.802626 [debug] [Thread-18 ]: Acquiring new vertica connection "seed.base.base"
[0m11:10:51.803306 [debug] [Thread-16 ]: Began compiling node model.base.table_model
[0m11:10:51.803917 [debug] [Thread-17 ]: Began compiling node model.base.view_model
[0m11:10:51.804402 [debug] [Thread-15 ]: Compiling model.base.swappable
[0m11:10:51.804857 [debug] [Thread-18 ]: Began compiling node seed.base.base
[0m11:10:51.805431 [debug] [Thread-16 ]: Compiling model.base.table_model
[0m11:10:51.806011 [debug] [Thread-17 ]: Compiling model.base.view_model
[0m11:10:51.814017 [debug] [Thread-15 ]: Writing injected SQL for node "model.base.swappable"
[0m11:10:51.814684 [debug] [Thread-18 ]: Compiling seed.base.base
[0m11:10:51.819963 [debug] [Thread-16 ]: Writing injected SQL for node "model.base.table_model"
[0m11:10:51.825063 [debug] [Thread-17 ]: Writing injected SQL for node "model.base.view_model"
[0m11:10:51.828302 [debug] [Thread-18 ]: Writing injected SQL for node "seed.base.base"
[0m11:10:51.829166 [debug] [Thread-15 ]: finished collecting timing info
[0m11:10:51.829883 [debug] [Thread-16 ]: finished collecting timing info
[0m11:10:51.830510 [debug] [Thread-17 ]: finished collecting timing info
[0m11:10:51.831022 [debug] [Thread-18 ]: finished collecting timing info
[0m11:10:51.831528 [debug] [Thread-15 ]: Began executing node model.base.swappable
[0m11:10:51.831982 [debug] [Thread-16 ]: Began executing node model.base.table_model
[0m11:10:51.832427 [debug] [Thread-17 ]: Began executing node model.base.view_model
[0m11:10:51.832922 [debug] [Thread-18 ]: Began executing node seed.base.base
[0m11:10:51.833436 [debug] [Thread-15 ]: finished collecting timing info
[0m11:10:51.833965 [debug] [Thread-16 ]: finished collecting timing info
[0m11:10:51.834438 [debug] [Thread-17 ]: finished collecting timing info
[0m11:10:51.834988 [debug] [Thread-18 ]: finished collecting timing info
[0m11:10:51.836338 [debug] [Thread-15 ]: Finished running node model.base.swappable
[0m11:10:51.837615 [debug] [Thread-16 ]: Finished running node model.base.table_model
[0m11:10:51.838912 [debug] [Thread-17 ]: Finished running node model.base.view_model
[0m11:10:51.840078 [debug] [Thread-18 ]: Finished running node seed.base.base
[0m11:10:51.842633 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:10:51.843036 [debug] [MainThread]: Connection 'model.base.swappable' was properly closed.
[0m11:10:51.843328 [debug] [MainThread]: Connection 'model.base.table_model' was properly closed.
[0m11:10:51.843599 [debug] [MainThread]: Connection 'model.base.view_model' was properly closed.
[0m11:10:51.843866 [debug] [MainThread]: Connection 'seed.base.base' was properly closed.
[0m11:10:51.853142 [info ] [MainThread]: Done.
[0m11:10:51.855107 [debug] [MainThread]: Acquiring new vertica connection "generate_catalog"
[0m11:10:51.855371 [info ] [MainThread]: Building catalog
[0m11:10:51.857018 [debug] [ThreadPool]: Acquiring new vertica connection "VMart.information_schema"
[0m11:10:51.864352 [debug] [ThreadPool]: Using vertica connection "VMart.information_schema"
[0m11:10:51.864646 [debug] [ThreadPool]: On VMart.information_schema: BEGIN
[0m11:10:51.864844 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:10:51.882996 [debug] [ThreadPool]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:10:51.888422 [debug] [ThreadPool]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m11:10:51.888911 [debug] [ThreadPool]: Using vertica connection "VMart.information_schema"
[0m11:10:51.889206 [debug] [ThreadPool]: On VMart.information_schema: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "VMart.information_schema"} */


    select
    'VMart' table_database
    , tab.table_schema
    , tab.table_name
    , 'TABLE' table_type
    , comment table_comment
    , tab.owner_name table_owner
    , col.column_name
    , col.ordinal_position column_index
    , col.data_type column_type
    , nullif('','') column_comment
    from v_catalog.tables tab
    join v_catalog.columns col on tab.table_id = col.table_id
    left join v_catalog.comments on tab.table_id = object_id
    where not(tab.is_system_table) and
        (lower(tab.table_schema) = lower('test16660914502674047497_test_basic'))
    union all
    select
    'VMart' table_database
    , vw.table_schema
    , vw.table_name
    , 'VIEW' table_type
    , comment table_comment
    , vw.owner_name table_owner
    , col.column_name
    , col.ordinal_position column_index
    , col.data_type column_type
    , nullif('','') column_comment
    from v_catalog.views vw
    join v_catalog.view_columns col on vw.table_id = col.table_id
    left join v_catalog.comments on vw.table_id = object_id
    where not(vw.is_system_view) and
        (lower(vw.table_schema) = lower('test16660914502674047497_test_basic'))
    order by table_schema, table_name, column_index

  
[0m11:10:52.508621 [debug] [ThreadPool]: SQL status: Code: [Column(name='table_database', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='table_schema', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='table_name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='table_type', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='table_comment', type_code=9, display_size=8192, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='table_owner', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='column_name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='column_index', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='column_type', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='column_comment', type_code=9, display_size=1, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.62 seconds
[0m11:10:52.512024 [debug] [ThreadPool]: On VMart.information_schema: ROLLBACK
[0m11:10:52.519055 [debug] [ThreadPool]: On VMart.information_schema: Close
[0m11:10:52.525374 [info ] [MainThread]: Catalog written to /tmp/pytest-of-sachin/pytest-12/project0/target/catalog.json
[0m11:10:52.525952 [debug] [MainThread]: Flushing usage events
[0m11:10:52.526143 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m11:10:52.526257 [debug] [MainThread]: Connection 'VMart.information_schema' was properly closed.
[0m11:10:52.526745 [debug] [MainThread]: Acquiring new vertica connection "_test"
[0m11:10:52.528080 [debug] [MainThread]: Using vertica connection "_test"
[0m11:10:52.528239 [debug] [MainThread]: On _test: BEGIN
[0m11:10:52.528354 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:10:52.551561 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:10:52.558427 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.03 seconds
[0m11:10:52.558617 [debug] [MainThread]: Using vertica connection "_test"
[0m11:10:52.558744 [debug] [MainThread]: On _test: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "_test"} */
select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'table' as type
    from v_catalog.tables
    where table_schema ilike 'test16660914502674047497_test_basic'
    union all
    select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'view' as type
    from v_catalog.views
    where table_schema ilike 'test16660914502674047497_test_basic'
  
[0m11:10:52.575497 [debug] [MainThread]: SQL status: Code: [Column(name='database', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='schema', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='type', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.02 seconds
[0m11:10:52.576562 [debug] [MainThread]: On _test: ROLLBACK
[0m11:10:52.581987 [debug] [MainThread]: On _test: Close
[0m11:10:52.582732 [debug] [MainThread]: Acquiring new vertica connection "_test"
[0m11:10:52.584144 [debug] [MainThread]: Using vertica connection "_test"
[0m11:10:52.584324 [debug] [MainThread]: On _test: BEGIN
[0m11:10:52.584434 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:10:52.603809 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:10:52.608818 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m11:10:52.609186 [debug] [MainThread]: Using vertica connection "_test"
[0m11:10:52.609479 [debug] [MainThread]: On _test: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "_test"} */
select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'table' as type
    from v_catalog.tables
    where table_schema ilike 'test16660914502674047497_test_basic'
    union all
    select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'view' as type
    from v_catalog.views
    where table_schema ilike 'test16660914502674047497_test_basic'
  
[0m11:10:52.632186 [debug] [MainThread]: SQL status: Code: [Column(name='database', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='schema', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='type', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.02 seconds
[0m11:10:52.634842 [debug] [MainThread]: On _test: ROLLBACK
[0m11:10:52.641995 [debug] [MainThread]: On _test: Close
[0m11:10:52.644092 [debug] [MainThread]: Acquiring new vertica connection "_test"
[0m11:10:52.648052 [debug] [MainThread]: Using vertica connection "_test"
[0m11:10:52.648500 [debug] [MainThread]: On _test: BEGIN
[0m11:10:52.648854 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:10:52.665050 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:10:52.674052 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.03 seconds
[0m11:10:52.674610 [debug] [MainThread]: Using vertica connection "_test"
[0m11:10:52.674979 [debug] [MainThread]: On _test: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "_test"} */
select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'table' as type
    from v_catalog.tables
    where table_schema ilike 'test16660914502674047497_test_basic'
    union all
    select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'view' as type
    from v_catalog.views
    where table_schema ilike 'test16660914502674047497_test_basic'
  
[0m11:10:52.699011 [debug] [MainThread]: SQL status: Code: [Column(name='database', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='schema', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='type', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.02 seconds
[0m11:10:52.701952 [debug] [MainThread]: On _test: ROLLBACK
[0m11:10:52.708280 [debug] [MainThread]: On _test: Close
[0m11:10:52.710461 [debug] [MainThread]: Acquiring new vertica connection "_test"
[0m11:10:52.714257 [debug] [MainThread]: Using vertica connection "_test"
[0m11:10:52.714666 [debug] [MainThread]: On _test: BEGIN
[0m11:10:52.715010 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:10:52.733201 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:10:52.739810 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m11:10:52.740417 [debug] [MainThread]: Using vertica connection "_test"
[0m11:10:52.740860 [debug] [MainThread]: On _test: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "_test"} */
select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'table' as type
    from v_catalog.tables
    where table_schema ilike 'test16660914502674047497_test_basic'
    union all
    select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'view' as type
    from v_catalog.views
    where table_schema ilike 'test16660914502674047497_test_basic'
  
[0m11:10:52.763383 [debug] [MainThread]: SQL status: Code: [Column(name='database', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='schema', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='type', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.02 seconds
[0m11:10:52.766037 [debug] [MainThread]: On _test: ROLLBACK
[0m11:10:52.773268 [debug] [MainThread]: On _test: Close
[0m11:10:52.830670 [debug] [MainThread]: Acquiring new vertica connection "_test"
[0m11:10:52.830980 [debug] [MainThread]: Dropping schema "_ReferenceKey(database='vmart', schema='test16660914502674047497_test_basic', identifier=None)".
[0m11:10:52.834620 [debug] [MainThread]: Using vertica connection "_test"
[0m11:10:52.834849 [debug] [MainThread]: On _test: BEGIN
[0m11:10:52.834971 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:10:52.859711 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m11:10:52.869250 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.03 seconds
[0m11:10:52.869488 [debug] [MainThread]: Using vertica connection "_test"
[0m11:10:52.869606 [debug] [MainThread]: On _test: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "_test"} */
drop schema if exists "test16660914502674047497_test_basic" cascade
  
[0m11:10:52.896723 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.03 seconds
[0m11:10:52.898391 [debug] [MainThread]: On _test: COMMIT
[0m11:10:52.898776 [debug] [MainThread]: Using vertica connection "_test"
[0m11:10:52.899067 [debug] [MainThread]: On _test: COMMIT
[0m11:10:52.905240 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m11:10:52.905627 [debug] [MainThread]: On _test: Close
[0m11:10:52.906632 [debug] [MainThread]: Connection '_test' was properly closed.
