[0m13:14:41.314391 [debug] [MainThread]: Acquiring new vertica connection "_test"
[0m13:14:41.314579 [debug] [MainThread]: Acquiring new vertica connection "_test"
[0m13:14:41.314744 [debug] [MainThread]: Creating schema "_ReferenceKey(database='vmart', schema='test16660988810247163670_test_basic', identifier=None)"
[0m13:14:41.321264 [debug] [MainThread]: Using vertica connection "_test"
[0m13:14:41.321443 [debug] [MainThread]: On _test: BEGIN
[0m13:14:41.321576 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:14:41.345774 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m13:14:41.355805 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.03 seconds
[0m13:14:41.356289 [debug] [MainThread]: Using vertica connection "_test"
[0m13:14:41.356602 [debug] [MainThread]: On _test: create schema if not exists "test16660988810247163670_test_basic"
  
[0m13:14:41.371293 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m13:14:41.373198 [debug] [MainThread]: On _test: COMMIT
[0m13:14:41.373659 [debug] [MainThread]: Using vertica connection "_test"
[0m13:14:41.374056 [debug] [MainThread]: On _test: COMMIT
[0m13:14:41.383213 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m13:14:41.383842 [debug] [MainThread]: On _test: Close
[0m13:14:41.400592 [debug] [MainThread]: Connection '_test' was properly closed.


============================== 2022-10-18 13:14:41.406299 | 37841367-1967-4dc5-b33c-7cfa1c23adb8 ==============================
[0m13:14:41.406308 [info ] [MainThread]: Running with dbt=1.3.0
[0m13:14:41.406572 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/tmp/pytest-of-sachin/pytest-40/profile0', 'send_anonymous_usage_stats': False, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'show': False, 'which': 'seed', 'rpc_method': 'seed', 'indirect_selection': 'eager'}
[0m13:14:41.406689 [debug] [MainThread]: Tracking: do not track
[0m13:14:41.412200 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
[0m13:14:41.420273 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m13:14:41.420915 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m13:14:41.421083 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m13:14:41.425362 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m13:14:41.426238 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m13:14:41.426830 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m13:14:41.429354 [debug] [MainThread]: Parsing macros/materializations/models/incremental/helpers.sql
[0m13:14:41.431071 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m13:14:41.434654 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m13:14:41.435542 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m13:14:41.439228 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m13:14:41.440490 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m13:14:41.447406 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m13:14:41.448455 [debug] [MainThread]: Parsing macros/materializations/snapshots/helper.sql
[0m13:14:41.448614 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m13:14:41.453688 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m13:14:41.457219 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m13:14:41.457765 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m13:14:41.458187 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m13:14:41.460082 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m13:14:41.461655 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m13:14:41.465679 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m13:14:41.466547 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m13:14:41.467234 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m13:14:41.468637 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m13:14:41.470945 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m13:14:41.471829 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m13:14:41.475060 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m13:14:41.476428 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m13:14:41.478412 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m13:14:41.487370 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m13:14:41.492423 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m13:14:41.493389 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m13:14:41.499628 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m13:14:41.503601 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m13:14:41.513915 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m13:14:41.516070 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m13:14:41.519429 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m13:14:41.527091 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m13:14:41.528099 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m13:14:41.535317 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m13:14:41.544863 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m13:14:41.545979 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m13:14:41.547063 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m13:14:41.549709 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m13:14:41.560491 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m13:14:41.564535 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m13:14:41.565460 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m13:14:41.566409 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m13:14:41.567853 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m13:14:41.569049 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m13:14:41.570620 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m13:14:41.576457 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m13:14:41.585037 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m13:14:41.589293 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m13:14:41.597202 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m13:14:41.598505 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m13:14:41.600538 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m13:14:41.603112 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m13:14:41.606641 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m13:14:41.607426 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m13:14:41.608090 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m13:14:41.608684 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m13:14:41.609434 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m13:14:41.610407 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m13:14:41.611005 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m13:14:41.611602 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m13:14:41.612249 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m13:14:41.613469 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m13:14:41.614005 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m13:14:41.614767 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m13:14:41.615445 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m13:14:41.619287 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m13:14:41.619872 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m13:14:41.620663 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m13:14:41.621337 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m13:14:41.622092 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m13:14:41.622762 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m13:14:41.624127 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m13:14:41.624733 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m13:14:41.625255 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m13:14:41.625917 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m13:14:41.626613 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m13:14:41.627703 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m13:14:41.628552 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m13:14:41.629104 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m13:14:41.629576 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m13:14:41.630191 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m13:14:41.633250 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m13:14:41.638249 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m13:14:41.855877 [info ] [MainThread]: Found 0 models, 0 tests, 3 snapshots, 0 analyses, 296 macros, 0 operations, 2 seed files, 0 sources, 0 exposures, 0 metrics
[0m13:14:41.856852 [info ] [MainThread]: 
[0m13:14:41.857352 [debug] [MainThread]: Acquiring new vertica connection "master"
[0m13:14:41.858143 [debug] [ThreadPool]: Acquiring new vertica connection "list_VMart"
[0m13:14:41.861610 [debug] [ThreadPool]: Using vertica connection "list_VMart"
[0m13:14:41.861773 [debug] [ThreadPool]: On list_VMart: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "list_VMart"} */

    select schema_name
    from v_catalog.schemata
  
[0m13:14:41.861890 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:14:41.882719 [debug] [ThreadPool]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m13:14:41.907211 [debug] [ThreadPool]: SQL status: Code: [Column(name='schema_name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.05 seconds
[0m13:14:41.910109 [debug] [ThreadPool]: On list_VMart: Close
[0m13:14:41.913494 [debug] [ThreadPool]: Acquiring new vertica connection "list_VMart_test16660988810247163670_test_basic"
[0m13:14:41.920547 [debug] [ThreadPool]: Using vertica connection "list_VMart_test16660988810247163670_test_basic"
[0m13:14:41.920697 [debug] [ThreadPool]: On list_VMart_test16660988810247163670_test_basic: BEGIN
[0m13:14:41.920806 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:14:41.938324 [debug] [ThreadPool]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m13:14:41.943771 [debug] [ThreadPool]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m13:14:41.944355 [debug] [ThreadPool]: Using vertica connection "list_VMart_test16660988810247163670_test_basic"
[0m13:14:41.944714 [debug] [ThreadPool]: On list_VMart_test16660988810247163670_test_basic: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "list_VMart_test16660988810247163670_test_basic"} */
select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'table' as type
    from v_catalog.tables
    where table_schema ilike 'test16660988810247163670_test_basic'
    union all
    select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'view' as type
    from v_catalog.views
    where table_schema ilike 'test16660988810247163670_test_basic'
  
[0m13:14:41.967528 [debug] [ThreadPool]: SQL status: Code: [Column(name='database', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='schema', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='type', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.02 seconds
[0m13:14:41.969912 [debug] [ThreadPool]: On list_VMart_test16660988810247163670_test_basic: ROLLBACK
[0m13:14:41.977090 [debug] [ThreadPool]: On list_VMart_test16660988810247163670_test_basic: Close
[0m13:14:41.978308 [debug] [MainThread]: Using vertica connection "master"
[0m13:14:41.978622 [debug] [MainThread]: On master: BEGIN
[0m13:14:41.978890 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:14:41.993169 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m13:14:41.998980 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m13:14:41.999198 [debug] [MainThread]: On master: COMMIT
[0m13:14:41.999324 [debug] [MainThread]: Using vertica connection "master"
[0m13:14:41.999438 [debug] [MainThread]: On master: COMMIT
[0m13:14:42.005341 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m13:14:42.005619 [debug] [MainThread]: On master: Close
[0m13:14:42.006188 [info ] [MainThread]: Concurrency: 4 threads (target='default')
[0m13:14:42.006606 [info ] [MainThread]: 
[0m13:14:42.009469 [debug] [Thread-1 (]: Began running node seed.snapshot_strategy_check_cols.added
[0m13:14:42.009624 [debug] [Thread-2 (]: Began running node seed.snapshot_strategy_check_cols.base
[0m13:14:42.009945 [info ] [Thread-1 (]: 1 of 2 START seed file test16660988810247163670_test_basic.added ............... [RUN]
[0m13:14:42.010243 [info ] [Thread-2 (]: 2 of 2 START seed file test16660988810247163670_test_basic.base ................ [RUN]
[0m13:14:42.010950 [debug] [Thread-1 (]: Acquiring new vertica connection "seed.snapshot_strategy_check_cols.added"
[0m13:14:42.011661 [debug] [Thread-2 (]: Acquiring new vertica connection "seed.snapshot_strategy_check_cols.base"
[0m13:14:42.011890 [debug] [Thread-1 (]: Began compiling node seed.snapshot_strategy_check_cols.added
[0m13:14:42.012083 [debug] [Thread-2 (]: Began compiling node seed.snapshot_strategy_check_cols.base
[0m13:14:42.012301 [debug] [Thread-1 (]: finished collecting timing info
[0m13:14:42.012470 [debug] [Thread-2 (]: finished collecting timing info
[0m13:14:42.012656 [debug] [Thread-1 (]: Began executing node seed.snapshot_strategy_check_cols.added
[0m13:14:42.012803 [debug] [Thread-2 (]: Began executing node seed.snapshot_strategy_check_cols.base
[0m13:14:42.041470 [debug] [Thread-1 (]: Writing runtime sql for node "seed.snapshot_strategy_check_cols.added"
[0m13:14:42.043240 [debug] [Thread-2 (]: Writing runtime sql for node "seed.snapshot_strategy_check_cols.base"
[0m13:14:42.043567 [debug] [Thread-1 (]: Using vertica connection "seed.snapshot_strategy_check_cols.added"
[0m13:14:42.043682 [debug] [Thread-2 (]: Using vertica connection "seed.snapshot_strategy_check_cols.base"
[0m13:14:42.043828 [debug] [Thread-1 (]: On seed.snapshot_strategy_check_cols.added: BEGIN
[0m13:14:42.043977 [debug] [Thread-2 (]: On seed.snapshot_strategy_check_cols.base: BEGIN
[0m13:14:42.044115 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:14:42.044262 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:14:42.061262 [debug] [Thread-1 (]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m13:14:42.065145 [debug] [Thread-2 (]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m13:14:42.066992 [debug] [Thread-1 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m13:14:42.067379 [debug] [Thread-1 (]: Using vertica connection "seed.snapshot_strategy_check_cols.added"
[0m13:14:42.067625 [debug] [Thread-1 (]: On seed.snapshot_strategy_check_cols.added: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "seed.snapshot_strategy_check_cols.added"} */

    
    create table "VMart"."test16660988810247163670_test_basic"."added" ("id" integer,"name" varchar(9),"some_date" timestamp without time zone)
  ;
    -- dbt seed --
    
        copy "VMart"."test16660988810247163670_test_basic"."added"
        ("id", "name", "some_date")
        from local '/tmp/pytest-of-sachin/pytest-40/project0/seeds/added.csv'
        delimiter ','
        enclosed by '"'
        skip 1
        abort on error
        rejected data as table "VMart"."test16660988810247163670_test_basic".seed_rejects;
    
  
[0m13:14:42.073858 [debug] [Thread-2 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.03 seconds
[0m13:14:42.074327 [debug] [Thread-2 (]: Using vertica connection "seed.snapshot_strategy_check_cols.base"
[0m13:14:42.074604 [debug] [Thread-2 (]: On seed.snapshot_strategy_check_cols.base: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "seed.snapshot_strategy_check_cols.base"} */

    
    create table "VMart"."test16660988810247163670_test_basic"."base" ("id" integer,"name" varchar(8),"some_date" timestamp without time zone)
  ;
    -- dbt seed --
    
        copy "VMart"."test16660988810247163670_test_basic"."base"
        ("id", "name", "some_date")
        from local '/tmp/pytest-of-sachin/pytest-40/project0/seeds/base.csv'
        delimiter ','
        enclosed by '"'
        skip 1
        abort on error
        rejected data as table "VMart"."test16660988810247163670_test_basic".seed_rejects;
    
  
[0m13:14:42.093892 [debug] [Thread-1 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.03 seconds
[0m13:14:42.112335 [debug] [Thread-1 (]: On seed.snapshot_strategy_check_cols.added: COMMIT
[0m13:14:42.112619 [debug] [Thread-1 (]: Using vertica connection "seed.snapshot_strategy_check_cols.added"
[0m13:14:42.112804 [debug] [Thread-1 (]: On seed.snapshot_strategy_check_cols.added: COMMIT
[0m13:14:42.167774 [debug] [Thread-2 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.09 seconds
[0m13:14:42.171819 [debug] [Thread-2 (]: On seed.snapshot_strategy_check_cols.base: COMMIT
[0m13:14:42.172345 [debug] [Thread-2 (]: Using vertica connection "seed.snapshot_strategy_check_cols.base"
[0m13:14:42.172727 [debug] [Thread-2 (]: On seed.snapshot_strategy_check_cols.base: COMMIT
[0m13:14:42.211242 [debug] [Thread-1 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.1 seconds
[0m13:14:42.212434 [debug] [Thread-1 (]: finished collecting timing info
[0m13:14:42.212968 [debug] [Thread-1 (]: On seed.snapshot_strategy_check_cols.added: Close
[0m13:14:42.214287 [info ] [Thread-1 (]: 1 of 2 OK loaded seed file test16660988810247163670_test_basic.added ........... [[32mCode: None, Rows: -1, Array Size: 1[0m in 0.20s]
[0m13:14:42.215220 [debug] [Thread-1 (]: Finished running node seed.snapshot_strategy_check_cols.added
[0m13:14:42.257440 [debug] [Thread-2 (]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.08 seconds
[0m13:14:42.257989 [debug] [Thread-2 (]: finished collecting timing info
[0m13:14:42.258178 [debug] [Thread-2 (]: On seed.snapshot_strategy_check_cols.base: Close
[0m13:14:42.258663 [info ] [Thread-2 (]: 2 of 2 OK loaded seed file test16660988810247163670_test_basic.base ............ [[32mCode: None, Rows: -1, Array Size: 1[0m in 0.25s]
[0m13:14:42.259010 [debug] [Thread-2 (]: Finished running node seed.snapshot_strategy_check_cols.base
[0m13:14:42.259882 [debug] [MainThread]: Acquiring new vertica connection "master"
[0m13:14:42.260139 [debug] [MainThread]: Using vertica connection "master"
[0m13:14:42.260269 [debug] [MainThread]: On master: BEGIN
[0m13:14:42.260385 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:14:42.277689 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m13:14:42.284218 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m13:14:42.284651 [debug] [MainThread]: On master: COMMIT
[0m13:14:42.284907 [debug] [MainThread]: Using vertica connection "master"
[0m13:14:42.285135 [debug] [MainThread]: On master: COMMIT
[0m13:14:42.292267 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m13:14:42.292851 [debug] [MainThread]: On master: Close
[0m13:14:42.294022 [info ] [MainThread]: 
[0m13:14:42.294705 [info ] [MainThread]: Finished running 2 seeds in 0 hours 0 minutes and 0.44 seconds (0.44s).
[0m13:14:42.295343 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:14:42.295651 [debug] [MainThread]: Connection 'seed.snapshot_strategy_check_cols.added' was properly closed.
[0m13:14:42.295954 [debug] [MainThread]: Connection 'seed.snapshot_strategy_check_cols.base' was properly closed.
[0m13:14:42.306749 [info ] [MainThread]: 
[0m13:14:42.307355 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:14:42.307778 [info ] [MainThread]: 
[0m13:14:42.308100 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m13:14:42.308493 [debug] [MainThread]: Flushing usage events


============================== 2022-10-18 13:14:42.321235 | 37841367-1967-4dc5-b33c-7cfa1c23adb8 ==============================
[0m13:14:42.321243 [info ] [MainThread]: Running with dbt=1.3.0
[0m13:14:42.321549 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/tmp/pytest-of-sachin/pytest-40/profile0', 'send_anonymous_usage_stats': False, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'snapshot', 'rpc_method': 'snapshot', 'indirect_selection': 'eager'}
[0m13:14:42.321673 [debug] [MainThread]: Tracking: do not track
[0m13:14:42.346730 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:14:42.346922 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:14:42.354195 [info ] [MainThread]: Found 0 models, 0 tests, 3 snapshots, 0 analyses, 296 macros, 0 operations, 2 seed files, 0 sources, 0 exposures, 0 metrics
[0m13:14:42.354904 [info ] [MainThread]: 
[0m13:14:42.355344 [debug] [MainThread]: Acquiring new vertica connection "master"
[0m13:14:42.355988 [debug] [ThreadPool]: Acquiring new vertica connection "list_VMart"
[0m13:14:42.387733 [debug] [ThreadPool]: Using vertica connection "list_VMart"
[0m13:14:42.387944 [debug] [ThreadPool]: On list_VMart: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "list_VMart"} */

    select schema_name
    from v_catalog.schemata
  
[0m13:14:42.388071 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:14:42.404800 [debug] [ThreadPool]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m13:14:42.418328 [debug] [ThreadPool]: SQL status: Code: [Column(name='schema_name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.03 seconds
[0m13:14:42.421513 [debug] [ThreadPool]: On list_VMart: Close
[0m13:14:42.425055 [debug] [ThreadPool]: Acquiring new vertica connection "list_VMart_test16660988810247163670_test_basic"
[0m13:14:42.429324 [debug] [ThreadPool]: Using vertica connection "list_VMart_test16660988810247163670_test_basic"
[0m13:14:42.429779 [debug] [ThreadPool]: On list_VMart_test16660988810247163670_test_basic: BEGIN
[0m13:14:42.430122 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:14:42.449596 [debug] [ThreadPool]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m13:14:42.459713 [debug] [ThreadPool]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.03 seconds
[0m13:14:42.460282 [debug] [ThreadPool]: Using vertica connection "list_VMart_test16660988810247163670_test_basic"
[0m13:14:42.460671 [debug] [ThreadPool]: On list_VMart_test16660988810247163670_test_basic: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "list_VMart_test16660988810247163670_test_basic"} */
select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'table' as type
    from v_catalog.tables
    where table_schema ilike 'test16660988810247163670_test_basic'
    union all
    select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'view' as type
    from v_catalog.views
    where table_schema ilike 'test16660988810247163670_test_basic'
  
[0m13:14:42.485204 [debug] [ThreadPool]: SQL status: Code: [Column(name='database', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='schema', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='type', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.02 seconds
[0m13:14:42.488050 [debug] [ThreadPool]: On list_VMart_test16660988810247163670_test_basic: ROLLBACK
[0m13:14:42.495468 [debug] [ThreadPool]: On list_VMart_test16660988810247163670_test_basic: Close
[0m13:14:42.497566 [debug] [MainThread]: Using vertica connection "master"
[0m13:14:42.498125 [debug] [MainThread]: On master: BEGIN
[0m13:14:42.498528 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:14:42.519153 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m13:14:42.525690 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.03 seconds
[0m13:14:42.526320 [debug] [MainThread]: On master: COMMIT
[0m13:14:42.526710 [debug] [MainThread]: Using vertica connection "master"
[0m13:14:42.527111 [debug] [MainThread]: On master: COMMIT
[0m13:14:42.533819 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m13:14:42.534442 [debug] [MainThread]: On master: Close
[0m13:14:42.535630 [info ] [MainThread]: Concurrency: 4 threads (target='default')
[0m13:14:42.536369 [info ] [MainThread]: 
[0m13:14:42.539986 [debug] [Thread-8 (]: Began running node snapshot.snapshot_strategy_check_cols.cc_all_snapshot
[0m13:14:42.540498 [debug] [Thread-9 (]: Began running node snapshot.snapshot_strategy_check_cols.cc_date_snapshot
[0m13:14:42.541214 [info ] [Thread-8 (]: 1 of 3 START snapshot test16660988810247163670_test_basic.cc_all_snapshot ...... [RUN]
[0m13:14:42.541753 [debug] [Thread-10 ]: Began running node snapshot.snapshot_strategy_check_cols.cc_name_snapshot
[0m13:14:42.542855 [info ] [Thread-9 (]: 2 of 3 START snapshot test16660988810247163670_test_basic.cc_date_snapshot ..... [RUN]
[0m13:14:42.544361 [debug] [Thread-8 (]: Acquiring new vertica connection "snapshot.snapshot_strategy_check_cols.cc_all_snapshot"
[0m13:14:42.544971 [info ] [Thread-10 ]: 3 of 3 START snapshot test16660988810247163670_test_basic.cc_name_snapshot ..... [RUN]
[0m13:14:42.546502 [debug] [Thread-9 (]: Acquiring new vertica connection "snapshot.snapshot_strategy_check_cols.cc_date_snapshot"
[0m13:14:42.547042 [debug] [Thread-8 (]: Began compiling node snapshot.snapshot_strategy_check_cols.cc_all_snapshot
[0m13:14:42.548520 [debug] [Thread-10 ]: Acquiring new vertica connection "snapshot.snapshot_strategy_check_cols.cc_name_snapshot"
[0m13:14:42.549096 [debug] [Thread-9 (]: Began compiling node snapshot.snapshot_strategy_check_cols.cc_date_snapshot
[0m13:14:42.549698 [debug] [Thread-8 (]: Compiling snapshot.snapshot_strategy_check_cols.cc_all_snapshot
[0m13:14:42.550147 [debug] [Thread-10 ]: Began compiling node snapshot.snapshot_strategy_check_cols.cc_name_snapshot
[0m13:14:42.550655 [debug] [Thread-9 (]: Compiling snapshot.snapshot_strategy_check_cols.cc_date_snapshot
[0m13:14:42.557840 [debug] [Thread-8 (]: finished collecting timing info
[0m13:14:42.558449 [debug] [Thread-10 ]: Compiling snapshot.snapshot_strategy_check_cols.cc_name_snapshot
[0m13:14:42.564391 [debug] [Thread-8 (]: Began executing node snapshot.snapshot_strategy_check_cols.cc_all_snapshot
[0m13:14:42.565402 [debug] [Thread-9 (]: finished collecting timing info
[0m13:14:42.571975 [debug] [Thread-10 ]: finished collecting timing info
[0m13:14:42.583005 [debug] [Thread-9 (]: Began executing node snapshot.snapshot_strategy_check_cols.cc_date_snapshot
[0m13:14:42.598536 [debug] [Thread-10 ]: Began executing node snapshot.snapshot_strategy_check_cols.cc_name_snapshot
[0m13:14:42.598775 [debug] [Thread-8 (]: Using vertica connection "snapshot.snapshot_strategy_check_cols.cc_all_snapshot"
[0m13:14:42.601542 [debug] [Thread-9 (]: Using vertica connection "snapshot.snapshot_strategy_check_cols.cc_date_snapshot"
[0m13:14:42.603692 [debug] [Thread-10 ]: Using vertica connection "snapshot.snapshot_strategy_check_cols.cc_name_snapshot"
[0m13:14:42.603970 [debug] [Thread-8 (]: On snapshot.snapshot_strategy_check_cols.cc_all_snapshot: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_all_snapshot"} */
select count(*)
        from v_catalog.schemata
        where schema_name='test16660988810247163670_test_basic'
[0m13:14:42.604197 [debug] [Thread-9 (]: On snapshot.snapshot_strategy_check_cols.cc_date_snapshot: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_date_snapshot"} */
select count(*)
        from v_catalog.schemata
        where schema_name='test16660988810247163670_test_basic'
[0m13:14:42.604397 [debug] [Thread-10 ]: On snapshot.snapshot_strategy_check_cols.cc_name_snapshot: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_name_snapshot"} */
select count(*)
        from v_catalog.schemata
        where schema_name='test16660988810247163670_test_basic'
[0m13:14:42.604619 [debug] [Thread-8 (]: Opening a new connection, currently in state closed
[0m13:14:42.604847 [debug] [Thread-9 (]: Opening a new connection, currently in state init
[0m13:14:42.605071 [debug] [Thread-10 ]: Opening a new connection, currently in state init
[0m13:14:42.624599 [debug] [Thread-10 ]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m13:14:42.625188 [debug] [Thread-8 (]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m13:14:42.629108 [debug] [Thread-9 (]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m13:14:42.870564 [debug] [Thread-10 ]: SQL status: Code: [Column(name='count', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.27 seconds
[0m13:14:42.877174 [debug] [Thread-8 (]: SQL status: Code: [Column(name='count', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.27 seconds
[0m13:14:42.882790 [debug] [Thread-9 (]: SQL status: Code: [Column(name='count', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.28 seconds
[0m13:14:42.986350 [debug] [Thread-9 (]: Writing runtime sql for node "snapshot.snapshot_strategy_check_cols.cc_date_snapshot"
[0m13:14:42.990136 [debug] [Thread-10 ]: Writing runtime sql for node "snapshot.snapshot_strategy_check_cols.cc_name_snapshot"
[0m13:14:42.993017 [debug] [Thread-8 (]: Writing runtime sql for node "snapshot.snapshot_strategy_check_cols.cc_all_snapshot"
[0m13:14:42.994564 [debug] [Thread-9 (]: Using vertica connection "snapshot.snapshot_strategy_check_cols.cc_date_snapshot"
[0m13:14:42.994982 [debug] [Thread-9 (]: On snapshot.snapshot_strategy_check_cols.cc_date_snapshot: BEGIN
[0m13:14:42.995363 [debug] [Thread-10 ]: Using vertica connection "snapshot.snapshot_strategy_check_cols.cc_name_snapshot"
[0m13:14:42.996004 [debug] [Thread-10 ]: On snapshot.snapshot_strategy_check_cols.cc_name_snapshot: BEGIN
[0m13:14:42.996562 [debug] [Thread-8 (]: Using vertica connection "snapshot.snapshot_strategy_check_cols.cc_all_snapshot"
[0m13:14:42.996983 [debug] [Thread-8 (]: On snapshot.snapshot_strategy_check_cols.cc_all_snapshot: BEGIN
[0m13:14:43.000404 [debug] [Thread-9 (]: SQL status: Code: [Column(name='count', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.0 seconds
[0m13:14:43.000783 [debug] [Thread-9 (]: Using vertica connection "snapshot.snapshot_strategy_check_cols.cc_date_snapshot"
[0m13:14:43.001053 [debug] [Thread-9 (]: On snapshot.snapshot_strategy_check_cols.cc_date_snapshot: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_date_snapshot"} */

      
  
    

  create  table
    "VMart"."test16660988810247163670_test_basic"."cc_date_snapshot"
    
  as (
    

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(current_timestamp as varchar ), '')
        ) as dbt_scd_id,
        current_timestamp as dbt_updated_at,
        current_timestamp as dbt_valid_from,
        nullif(current_timestamp, current_timestamp) as dbt_valid_to
    from (
        
    
    select * from "VMart"."test16660988810247163670_test_basic"."base"
    ) sbq



  );

  
  
[0m13:14:43.001511 [debug] [Thread-8 (]: SQL status: Code: [Column(name='count', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.0 seconds
[0m13:14:43.001872 [debug] [Thread-10 ]: SQL status: Code: [Column(name='count', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.01 seconds
[0m13:14:43.002292 [debug] [Thread-8 (]: Using vertica connection "snapshot.snapshot_strategy_check_cols.cc_all_snapshot"
[0m13:14:43.002632 [debug] [Thread-10 ]: Using vertica connection "snapshot.snapshot_strategy_check_cols.cc_name_snapshot"
[0m13:14:43.002950 [debug] [Thread-8 (]: On snapshot.snapshot_strategy_check_cols.cc_all_snapshot: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_all_snapshot"} */

      
  
    

  create  table
    "VMart"."test16660988810247163670_test_basic"."cc_all_snapshot"
    
  as (
    

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(current_timestamp as varchar ), '')
        ) as dbt_scd_id,
        current_timestamp as dbt_updated_at,
        current_timestamp as dbt_valid_from,
        nullif(current_timestamp, current_timestamp) as dbt_valid_to
    from (
        
    
    select * from "VMart"."test16660988810247163670_test_basic"."base"
    ) sbq



  );

  
  
[0m13:14:43.003271 [debug] [Thread-10 ]: On snapshot.snapshot_strategy_check_cols.cc_name_snapshot: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_name_snapshot"} */

      
  
    

  create  table
    "VMart"."test16660988810247163670_test_basic"."cc_name_snapshot"
    
  as (
    

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(current_timestamp as varchar ), '')
        ) as dbt_scd_id,
        current_timestamp as dbt_updated_at,
        current_timestamp as dbt_valid_from,
        nullif(current_timestamp, current_timestamp) as dbt_valid_to
    from (
        
    
    select * from "VMart"."test16660988810247163670_test_basic"."base"
    ) sbq



  );

  
  
[0m13:14:43.060167 [debug] [Thread-10 ]: SQL status: Code: [Column(name='count', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.06 seconds
[0m13:14:43.063742 [debug] [Thread-10 ]: On snapshot.snapshot_strategy_check_cols.cc_name_snapshot: COMMIT
[0m13:14:43.064197 [debug] [Thread-10 ]: Using vertica connection "snapshot.snapshot_strategy_check_cols.cc_name_snapshot"
[0m13:14:43.064553 [debug] [Thread-10 ]: On snapshot.snapshot_strategy_check_cols.cc_name_snapshot: COMMIT
[0m13:14:43.070198 [debug] [Thread-10 ]: SQL status: Code: [Column(name='count', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.01 seconds
[0m13:14:43.071375 [debug] [Thread-10 ]: finished collecting timing info
[0m13:14:43.071863 [debug] [Thread-10 ]: On snapshot.snapshot_strategy_check_cols.cc_name_snapshot: Close
[0m13:14:43.072449 [debug] [Thread-8 (]: SQL status: Code: [Column(name='count', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.07 seconds
[0m13:14:43.075782 [debug] [Thread-8 (]: On snapshot.snapshot_strategy_check_cols.cc_all_snapshot: COMMIT
[0m13:14:43.077089 [info ] [Thread-10 ]: 3 of 3 OK snapshotted test16660988810247163670_test_basic.cc_name_snapshot ..... [[32mCode: [Column(name='count', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1[0m in 0.53s]
[0m13:14:43.077645 [debug] [Thread-8 (]: Using vertica connection "snapshot.snapshot_strategy_check_cols.cc_all_snapshot"
[0m13:14:43.078791 [debug] [Thread-10 ]: Finished running node snapshot.snapshot_strategy_check_cols.cc_name_snapshot
[0m13:14:43.079379 [debug] [Thread-8 (]: On snapshot.snapshot_strategy_check_cols.cc_all_snapshot: COMMIT
[0m13:14:43.080556 [debug] [Thread-9 (]: SQL status: Code: [Column(name='count', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.08 seconds
[0m13:14:43.083665 [debug] [Thread-9 (]: On snapshot.snapshot_strategy_check_cols.cc_date_snapshot: COMMIT
[0m13:14:43.084063 [debug] [Thread-9 (]: Using vertica connection "snapshot.snapshot_strategy_check_cols.cc_date_snapshot"
[0m13:14:43.084390 [debug] [Thread-9 (]: On snapshot.snapshot_strategy_check_cols.cc_date_snapshot: COMMIT
[0m13:14:43.086935 [debug] [Thread-8 (]: SQL status: Code: [Column(name='count', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.01 seconds
[0m13:14:43.087955 [debug] [Thread-8 (]: finished collecting timing info
[0m13:14:43.088382 [debug] [Thread-8 (]: On snapshot.snapshot_strategy_check_cols.cc_all_snapshot: Close
[0m13:14:43.089708 [info ] [Thread-8 (]: 1 of 3 OK snapshotted test16660988810247163670_test_basic.cc_all_snapshot ...... [[32mCode: [Column(name='count', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1[0m in 0.55s]
[0m13:14:43.090676 [debug] [Thread-8 (]: Finished running node snapshot.snapshot_strategy_check_cols.cc_all_snapshot
[0m13:14:43.091878 [debug] [Thread-9 (]: SQL status: Code: [Column(name='count', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.01 seconds
[0m13:14:43.092849 [debug] [Thread-9 (]: finished collecting timing info
[0m13:14:43.093281 [debug] [Thread-9 (]: On snapshot.snapshot_strategy_check_cols.cc_date_snapshot: Close
[0m13:14:43.094567 [info ] [Thread-9 (]: 2 of 3 OK snapshotted test16660988810247163670_test_basic.cc_date_snapshot ..... [[32mCode: [Column(name='count', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1[0m in 0.55s]
[0m13:14:43.095451 [debug] [Thread-9 (]: Finished running node snapshot.snapshot_strategy_check_cols.cc_date_snapshot
[0m13:14:43.097612 [debug] [MainThread]: Acquiring new vertica connection "master"
[0m13:14:43.098094 [debug] [MainThread]: Using vertica connection "master"
[0m13:14:43.098407 [debug] [MainThread]: On master: BEGIN
[0m13:14:43.098683 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:14:43.120035 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m13:14:43.126241 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.03 seconds
[0m13:14:43.126771 [debug] [MainThread]: On master: COMMIT
[0m13:14:43.127098 [debug] [MainThread]: Using vertica connection "master"
[0m13:14:43.127389 [debug] [MainThread]: On master: COMMIT
[0m13:14:43.133972 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m13:14:43.134568 [debug] [MainThread]: On master: Close
[0m13:14:43.135796 [info ] [MainThread]: 
[0m13:14:43.136519 [info ] [MainThread]: Finished running 3 snapshots in 0 hours 0 minutes and 0.78 seconds (0.78s).
[0m13:14:43.137121 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:14:43.137429 [debug] [MainThread]: Connection 'snapshot.snapshot_strategy_check_cols.cc_all_snapshot' was properly closed.
[0m13:14:43.137748 [debug] [MainThread]: Connection 'snapshot.snapshot_strategy_check_cols.cc_date_snapshot' was properly closed.
[0m13:14:43.138057 [debug] [MainThread]: Connection 'snapshot.snapshot_strategy_check_cols.cc_name_snapshot' was properly closed.
[0m13:14:43.148345 [info ] [MainThread]: 
[0m13:14:43.148772 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:14:43.149156 [info ] [MainThread]: 
[0m13:14:43.149475 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m13:14:43.149881 [debug] [MainThread]: Flushing usage events
[0m13:14:43.150661 [debug] [MainThread]: Acquiring new vertica connection "_test"
[0m13:14:43.150904 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:14:43.171023 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m13:14:43.188882 [debug] [MainThread]: On _test: Close
[0m13:14:43.190978 [debug] [MainThread]: Acquiring new vertica connection "_test"
[0m13:14:43.191421 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:14:43.211676 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m13:14:43.230861 [debug] [MainThread]: On _test: Close
[0m13:14:43.232832 [debug] [MainThread]: Acquiring new vertica connection "_test"
[0m13:14:43.233274 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:14:43.250316 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m13:14:43.281569 [debug] [MainThread]: On _test: Close
[0m13:14:43.283750 [debug] [MainThread]: Acquiring new vertica connection "_test"
[0m13:14:43.284265 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:14:43.305086 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m13:14:43.322254 [debug] [MainThread]: On _test: Close
[0m13:14:43.341513 [debug] [MainThread]: Connection '_test' was properly closed.


============================== 2022-10-18 13:14:43.347366 | 37841367-1967-4dc5-b33c-7cfa1c23adb8 ==============================
[0m13:14:43.347374 [info ] [MainThread]: Running with dbt=1.3.0
[0m13:14:43.347647 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': False, 'static_parser': True, 'profiles_dir': '/tmp/pytest-of-sachin/pytest-40/profile0', 'send_anonymous_usage_stats': False, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'vars': 'seed_name: added', 'which': 'snapshot', 'rpc_method': 'snapshot', 'indirect_selection': 'eager'}
[0m13:14:43.347775 [debug] [MainThread]: Tracking: do not track
[0m13:14:43.353594 [debug] [MainThread]: Partial parsing not enabled
[0m13:14:43.362134 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m13:14:43.362396 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m13:14:43.362546 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m13:14:43.367303 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m13:14:43.368344 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m13:14:43.369002 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m13:14:43.371842 [debug] [MainThread]: Parsing macros/materializations/models/incremental/helpers.sql
[0m13:14:43.373950 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m13:14:43.377581 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m13:14:43.378554 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m13:14:43.382288 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m13:14:43.383561 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m13:14:43.390611 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m13:14:43.391626 [debug] [MainThread]: Parsing macros/materializations/snapshots/helper.sql
[0m13:14:43.391788 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m13:14:43.396887 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m13:14:43.400438 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m13:14:43.400970 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m13:14:43.401387 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m13:14:43.403289 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m13:14:43.404877 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m13:14:43.408943 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m13:14:43.409817 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m13:14:43.410552 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m13:14:43.411926 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m13:14:43.414188 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m13:14:43.415090 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m13:14:43.418322 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m13:14:43.419716 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m13:14:43.421766 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m13:14:43.430843 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m13:14:43.435726 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m13:14:43.436678 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m13:14:43.442892 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m13:14:43.446925 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m13:14:43.457252 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m13:14:43.459402 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m13:14:43.462689 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m13:14:43.470326 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m13:14:43.471350 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m13:14:43.478328 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m13:14:43.487891 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m13:14:43.488996 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m13:14:43.490121 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m13:14:43.492786 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m13:14:43.503509 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m13:14:43.507605 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m13:14:43.508560 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m13:14:43.509580 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m13:14:43.511325 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m13:14:43.512566 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m13:14:43.514201 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m13:14:43.519970 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m13:14:43.528576 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m13:14:43.532948 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m13:14:43.541451 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m13:14:43.542856 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m13:14:43.544956 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m13:14:43.547568 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m13:14:43.551208 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m13:14:43.551976 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m13:14:43.552656 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m13:14:43.553246 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m13:14:43.554010 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m13:14:43.554945 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m13:14:43.555560 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m13:14:43.556150 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m13:14:43.556792 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m13:14:43.558064 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m13:14:43.558584 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m13:14:43.559393 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m13:14:43.560095 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m13:14:43.564025 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m13:14:43.564674 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m13:14:43.565448 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m13:14:43.566118 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m13:14:43.566895 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m13:14:43.567552 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m13:14:43.568981 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m13:14:43.569593 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m13:14:43.570163 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m13:14:43.570843 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m13:14:43.571508 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m13:14:43.572602 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m13:14:43.573455 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m13:14:43.574010 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m13:14:43.574452 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m13:14:43.575255 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m13:14:43.578356 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m13:14:43.583413 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m13:14:43.781550 [info ] [MainThread]: Found 0 models, 0 tests, 3 snapshots, 0 analyses, 296 macros, 0 operations, 2 seed files, 0 sources, 0 exposures, 0 metrics
[0m13:14:43.782287 [info ] [MainThread]: 
[0m13:14:43.782755 [debug] [MainThread]: Acquiring new vertica connection "master"
[0m13:14:43.783449 [debug] [ThreadPool]: Acquiring new vertica connection "list_VMart"
[0m13:14:43.784708 [debug] [ThreadPool]: Using vertica connection "list_VMart"
[0m13:14:43.784845 [debug] [ThreadPool]: On list_VMart: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "list_VMart"} */

    select schema_name
    from v_catalog.schemata
  
[0m13:14:43.785055 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:14:43.808294 [debug] [ThreadPool]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m13:14:43.829293 [debug] [ThreadPool]: SQL status: Code: [Column(name='schema_name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.04 seconds
[0m13:14:43.832004 [debug] [ThreadPool]: On list_VMart: Close
[0m13:14:43.835263 [debug] [ThreadPool]: Acquiring new vertica connection "list_VMart_test16660988810247163670_test_basic"
[0m13:14:43.839520 [debug] [ThreadPool]: Using vertica connection "list_VMart_test16660988810247163670_test_basic"
[0m13:14:43.839976 [debug] [ThreadPool]: On list_VMart_test16660988810247163670_test_basic: BEGIN
[0m13:14:43.840327 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:14:43.857387 [debug] [ThreadPool]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m13:14:43.862655 [debug] [ThreadPool]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m13:14:43.863225 [debug] [ThreadPool]: Using vertica connection "list_VMart_test16660988810247163670_test_basic"
[0m13:14:43.863575 [debug] [ThreadPool]: On list_VMart_test16660988810247163670_test_basic: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "list_VMart_test16660988810247163670_test_basic"} */
select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'table' as type
    from v_catalog.tables
    where table_schema ilike 'test16660988810247163670_test_basic'
    union all
    select
      'VMart' as database,
      table_name as name,
      table_schema as schema,
      'view' as type
    from v_catalog.views
    where table_schema ilike 'test16660988810247163670_test_basic'
  
[0m13:14:43.878561 [debug] [ThreadPool]: SQL status: Code: [Column(name='database', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='schema', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='type', type_code=9, display_size=5, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.01 seconds
[0m13:14:43.881614 [debug] [ThreadPool]: On list_VMart_test16660988810247163670_test_basic: ROLLBACK
[0m13:14:43.888794 [debug] [ThreadPool]: On list_VMart_test16660988810247163670_test_basic: Close
[0m13:14:43.890896 [debug] [MainThread]: Using vertica connection "master"
[0m13:14:43.891398 [debug] [MainThread]: On master: BEGIN
[0m13:14:43.891775 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:14:43.906690 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m13:14:43.912670 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m13:14:43.913279 [debug] [MainThread]: On master: COMMIT
[0m13:14:43.913664 [debug] [MainThread]: Using vertica connection "master"
[0m13:14:43.914042 [debug] [MainThread]: On master: COMMIT
[0m13:14:43.919392 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.0 seconds
[0m13:14:43.920024 [debug] [MainThread]: On master: Close
[0m13:14:43.921231 [info ] [MainThread]: Concurrency: 4 threads (target='default')
[0m13:14:43.922008 [info ] [MainThread]: 
[0m13:14:43.925574 [debug] [Thread-15 ]: Began running node snapshot.snapshot_strategy_check_cols.cc_all_snapshot
[0m13:14:43.926091 [debug] [Thread-16 ]: Began running node snapshot.snapshot_strategy_check_cols.cc_date_snapshot
[0m13:14:43.926801 [info ] [Thread-15 ]: 1 of 3 START snapshot test16660988810247163670_test_basic.cc_all_snapshot ...... [RUN]
[0m13:14:43.927403 [debug] [Thread-17 ]: Began running node snapshot.snapshot_strategy_check_cols.cc_name_snapshot
[0m13:14:43.928034 [info ] [Thread-16 ]: 2 of 3 START snapshot test16660988810247163670_test_basic.cc_date_snapshot ..... [RUN]
[0m13:14:43.929713 [debug] [Thread-15 ]: Acquiring new vertica connection "snapshot.snapshot_strategy_check_cols.cc_all_snapshot"
[0m13:14:43.930342 [info ] [Thread-17 ]: 3 of 3 START snapshot test16660988810247163670_test_basic.cc_name_snapshot ..... [RUN]
[0m13:14:43.931875 [debug] [Thread-16 ]: Acquiring new vertica connection "snapshot.snapshot_strategy_check_cols.cc_date_snapshot"
[0m13:14:43.932497 [debug] [Thread-15 ]: Began compiling node snapshot.snapshot_strategy_check_cols.cc_all_snapshot
[0m13:14:43.933804 [debug] [Thread-17 ]: Acquiring new vertica connection "snapshot.snapshot_strategy_check_cols.cc_name_snapshot"
[0m13:14:43.934472 [debug] [Thread-16 ]: Began compiling node snapshot.snapshot_strategy_check_cols.cc_date_snapshot
[0m13:14:43.935127 [debug] [Thread-15 ]: Compiling snapshot.snapshot_strategy_check_cols.cc_all_snapshot
[0m13:14:43.935665 [debug] [Thread-17 ]: Began compiling node snapshot.snapshot_strategy_check_cols.cc_name_snapshot
[0m13:14:43.936109 [debug] [Thread-16 ]: Compiling snapshot.snapshot_strategy_check_cols.cc_date_snapshot
[0m13:14:43.942612 [debug] [Thread-17 ]: Compiling snapshot.snapshot_strategy_check_cols.cc_name_snapshot
[0m13:14:43.948637 [debug] [Thread-15 ]: finished collecting timing info
[0m13:14:43.953072 [debug] [Thread-17 ]: finished collecting timing info
[0m13:14:43.954103 [debug] [Thread-16 ]: finished collecting timing info
[0m13:14:43.954723 [debug] [Thread-15 ]: Began executing node snapshot.snapshot_strategy_check_cols.cc_all_snapshot
[0m13:14:43.955312 [debug] [Thread-17 ]: Began executing node snapshot.snapshot_strategy_check_cols.cc_name_snapshot
[0m13:14:43.955820 [debug] [Thread-16 ]: Began executing node snapshot.snapshot_strategy_check_cols.cc_date_snapshot
[0m13:14:43.961860 [debug] [Thread-15 ]: Using vertica connection "snapshot.snapshot_strategy_check_cols.cc_all_snapshot"
[0m13:14:43.973499 [debug] [Thread-17 ]: Using vertica connection "snapshot.snapshot_strategy_check_cols.cc_name_snapshot"
[0m13:14:43.973849 [debug] [Thread-16 ]: Using vertica connection "snapshot.snapshot_strategy_check_cols.cc_date_snapshot"
[0m13:14:43.974343 [debug] [Thread-15 ]: On snapshot.snapshot_strategy_check_cols.cc_all_snapshot: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_all_snapshot"} */
select count(*)
        from v_catalog.schemata
        where schema_name='test16660988810247163670_test_basic'
[0m13:14:43.974841 [debug] [Thread-17 ]: On snapshot.snapshot_strategy_check_cols.cc_name_snapshot: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_name_snapshot"} */
select count(*)
        from v_catalog.schemata
        where schema_name='test16660988810247163670_test_basic'
[0m13:14:43.975292 [debug] [Thread-16 ]: On snapshot.snapshot_strategy_check_cols.cc_date_snapshot: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_date_snapshot"} */
select count(*)
        from v_catalog.schemata
        where schema_name='test16660988810247163670_test_basic'
[0m13:14:43.975743 [debug] [Thread-15 ]: Opening a new connection, currently in state closed
[0m13:14:43.976216 [debug] [Thread-17 ]: Opening a new connection, currently in state init
[0m13:14:43.976673 [debug] [Thread-16 ]: Opening a new connection, currently in state init
[0m13:14:43.995375 [debug] [Thread-15 ]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m13:14:44.001518 [debug] [Thread-16 ]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m13:14:44.002393 [debug] [Thread-17 ]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m13:14:44.030521 [debug] [Thread-17 ]: SQL status: Code: [Column(name='count', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.05 seconds
[0m13:14:44.044282 [debug] [Thread-15 ]: SQL status: Code: [Column(name='count', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.07 seconds
[0m13:14:44.044822 [debug] [Thread-16 ]: SQL status: Code: [Column(name='count', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.07 seconds
[0m13:14:44.051789 [debug] [Thread-17 ]: Using vertica connection "snapshot.snapshot_strategy_check_cols.cc_name_snapshot"
[0m13:14:44.052668 [debug] [Thread-15 ]: Using vertica connection "snapshot.snapshot_strategy_check_cols.cc_all_snapshot"
[0m13:14:44.058752 [debug] [Thread-16 ]: Using vertica connection "snapshot.snapshot_strategy_check_cols.cc_date_snapshot"
[0m13:14:44.059339 [debug] [Thread-17 ]: On snapshot.snapshot_strategy_check_cols.cc_name_snapshot: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_name_snapshot"} */
select * from (
            select name from (
    
    select * from "VMart"."test16660988810247163670_test_basic"."added") subq
        ) as __dbt_sbq
        where false
        limit 0
    
[0m13:14:44.059946 [debug] [Thread-15 ]: On snapshot.snapshot_strategy_check_cols.cc_all_snapshot: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_all_snapshot"} */
select * from (
            
    
    select * from "VMart"."test16660988810247163670_test_basic"."added"
        ) as __dbt_sbq
        where false
        limit 0
    
[0m13:14:44.060498 [debug] [Thread-16 ]: On snapshot.snapshot_strategy_check_cols.cc_date_snapshot: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_date_snapshot"} */
select * from (
            select some_date from (
    
    select * from "VMart"."test16660988810247163670_test_basic"."added") subq
        ) as __dbt_sbq
        where false
        limit 0
    
[0m13:14:44.073436 [debug] [Thread-17 ]: SQL status: Code: [Column(name='name', type_code=9, display_size=9, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.01 seconds
[0m13:14:44.079283 [debug] [Thread-15 ]: SQL status: Code: [Column(name='id', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='name', type_code=9, display_size=9, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='some_date', type_code=12, display_size=29, internal_size=8, precision=6, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.02 seconds
[0m13:14:44.090080 [debug] [Thread-16 ]: SQL status: Code: [Column(name='some_date', type_code=12, display_size=29, internal_size=8, precision=6, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.03 seconds
[0m13:14:44.101855 [debug] [Thread-15 ]: Using vertica connection "snapshot.snapshot_strategy_check_cols.cc_all_snapshot"
[0m13:14:44.106519 [debug] [Thread-16 ]: Using vertica connection "snapshot.snapshot_strategy_check_cols.cc_date_snapshot"
[0m13:14:44.106994 [debug] [Thread-15 ]: On snapshot.snapshot_strategy_check_cols.cc_all_snapshot: BEGIN
[0m13:14:44.109757 [debug] [Thread-17 ]: Using vertica connection "snapshot.snapshot_strategy_check_cols.cc_name_snapshot"
[0m13:14:44.110165 [debug] [Thread-16 ]: On snapshot.snapshot_strategy_check_cols.cc_date_snapshot: BEGIN
[0m13:14:44.111041 [debug] [Thread-17 ]: On snapshot.snapshot_strategy_check_cols.cc_name_snapshot: BEGIN
[0m13:14:44.116138 [debug] [Thread-17 ]: SQL status: Code: [Column(name='name', type_code=9, display_size=9, internal_size=-1, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.0 seconds
[0m13:14:44.116745 [debug] [Thread-15 ]: SQL status: Code: [Column(name='id', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='name', type_code=9, display_size=9, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='some_date', type_code=12, display_size=29, internal_size=8, precision=6, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.01 seconds
[0m13:14:44.117166 [debug] [Thread-17 ]: Using vertica connection "snapshot.snapshot_strategy_check_cols.cc_name_snapshot"
[0m13:14:44.117611 [debug] [Thread-16 ]: SQL status: Code: [Column(name='some_date', type_code=12, display_size=29, internal_size=8, precision=6, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.01 seconds
[0m13:14:44.118119 [debug] [Thread-15 ]: Using vertica connection "snapshot.snapshot_strategy_check_cols.cc_all_snapshot"
[0m13:14:44.118636 [debug] [Thread-17 ]: On snapshot.snapshot_strategy_check_cols.cc_name_snapshot: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_name_snapshot"} */

    select
    column_name
    , data_type
    , character_maximum_length
    , numeric_precision
    , numeric_scale
    from (
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.columns
        where table_schema = 'test16660988810247163670_test_basic'
        and table_name = 'cc_name_snapshot'
        union all
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.view_columns
        where table_schema = 'test16660988810247163670_test_basic'
        and table_name = 'cc_name_snapshot'
    ) t
    order by ordinal_position
  
[0m13:14:44.119121 [debug] [Thread-16 ]: Using vertica connection "snapshot.snapshot_strategy_check_cols.cc_date_snapshot"
[0m13:14:44.119597 [debug] [Thread-15 ]: On snapshot.snapshot_strategy_check_cols.cc_all_snapshot: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_all_snapshot"} */

    select
    column_name
    , data_type
    , character_maximum_length
    , numeric_precision
    , numeric_scale
    from (
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.columns
        where table_schema = 'test16660988810247163670_test_basic'
        and table_name = 'cc_all_snapshot'
        union all
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.view_columns
        where table_schema = 'test16660988810247163670_test_basic'
        and table_name = 'cc_all_snapshot'
    ) t
    order by ordinal_position
  
[0m13:14:44.120409 [debug] [Thread-16 ]: On snapshot.snapshot_strategy_check_cols.cc_date_snapshot: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_date_snapshot"} */

    select
    column_name
    , data_type
    , character_maximum_length
    , numeric_precision
    , numeric_scale
    from (
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.columns
        where table_schema = 'test16660988810247163670_test_basic'
        and table_name = 'cc_date_snapshot'
        union all
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.view_columns
        where table_schema = 'test16660988810247163670_test_basic'
        and table_name = 'cc_date_snapshot'
    ) t
    order by ordinal_position
  
[0m13:14:44.164613 [debug] [Thread-16 ]: SQL status: Code: [Column(name='column_name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='data_type', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='character_maximum_length', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_precision', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_scale', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.04 seconds
[0m13:14:44.176400 [debug] [Thread-16 ]: Using vertica connection "snapshot.snapshot_strategy_check_cols.cc_date_snapshot"
[0m13:14:44.176846 [debug] [Thread-16 ]: On snapshot.snapshot_strategy_check_cols.cc_date_snapshot: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_date_snapshot"} */

    select
    column_name
    , data_type
    , character_maximum_length
    , numeric_precision
    , numeric_scale
    from (
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.columns
        where table_schema = 'test16660988810247163670_test_basic'
        and table_name = 'cc_date_snapshot'
        union all
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.view_columns
        where table_schema = 'test16660988810247163670_test_basic'
        and table_name = 'cc_date_snapshot'
    ) t
    order by ordinal_position
  
[0m13:14:44.177551 [debug] [Thread-17 ]: SQL status: Code: [Column(name='column_name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='data_type', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='character_maximum_length', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_precision', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_scale', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.06 seconds
[0m13:14:44.184736 [debug] [Thread-17 ]: Using vertica connection "snapshot.snapshot_strategy_check_cols.cc_name_snapshot"
[0m13:14:44.185237 [debug] [Thread-17 ]: On snapshot.snapshot_strategy_check_cols.cc_name_snapshot: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_name_snapshot"} */

    select
    column_name
    , data_type
    , character_maximum_length
    , numeric_precision
    , numeric_scale
    from (
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.columns
        where table_schema = 'test16660988810247163670_test_basic'
        and table_name = 'cc_name_snapshot'
        union all
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.view_columns
        where table_schema = 'test16660988810247163670_test_basic'
        and table_name = 'cc_name_snapshot'
    ) t
    order by ordinal_position
  
[0m13:14:44.185790 [debug] [Thread-15 ]: SQL status: Code: [Column(name='column_name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='data_type', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='character_maximum_length', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_precision', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_scale', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.06 seconds
[0m13:14:44.193768 [debug] [Thread-15 ]: Using vertica connection "snapshot.snapshot_strategy_check_cols.cc_all_snapshot"
[0m13:14:44.194221 [debug] [Thread-15 ]: On snapshot.snapshot_strategy_check_cols.cc_all_snapshot: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_all_snapshot"} */

    select
    column_name
    , data_type
    , character_maximum_length
    , numeric_precision
    , numeric_scale
    from (
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.columns
        where table_schema = 'test16660988810247163670_test_basic'
        and table_name = 'cc_all_snapshot'
        union all
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.view_columns
        where table_schema = 'test16660988810247163670_test_basic'
        and table_name = 'cc_all_snapshot'
    ) t
    order by ordinal_position
  
[0m13:14:44.230321 [debug] [Thread-15 ]: SQL status: Code: [Column(name='column_name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='data_type', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='character_maximum_length', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_precision', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_scale', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.04 seconds
[0m13:14:44.247405 [debug] [Thread-16 ]: SQL status: Code: [Column(name='column_name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='data_type', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='character_maximum_length', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_precision', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_scale', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.07 seconds
[0m13:14:44.268765 [debug] [Thread-16 ]: Using vertica connection "snapshot.snapshot_strategy_check_cols.cc_date_snapshot"
[0m13:14:44.269182 [debug] [Thread-17 ]: SQL status: Code: [Column(name='column_name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='data_type', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='character_maximum_length', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_precision', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_scale', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.08 seconds
[0m13:14:44.269557 [debug] [Thread-15 ]: Using vertica connection "snapshot.snapshot_strategy_check_cols.cc_all_snapshot"
[0m13:14:44.269813 [debug] [Thread-16 ]: On snapshot.snapshot_strategy_check_cols.cc_date_snapshot: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_date_snapshot"} */

        
  
    

  create local temporary table
    "cc_date_snapshot__dbt_tmp"
    on commit preserve rows
  as (
    with snapshot_query as (

        
    
    select * from "VMart"."test16660988810247163670_test_basic"."added"

    ),

    snapshotted_data as (

        select *,
            id as dbt_unique_key

        from "VMart"."test16660988810247163670_test_basic"."cc_date_snapshot"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            id as dbt_unique_key,
            current_timestamp as dbt_updated_at,
            current_timestamp as dbt_valid_from,
            nullif(current_timestamp, current_timestamp) as dbt_valid_to,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(current_timestamp as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            id as dbt_unique_key,
            current_timestamp as dbt_updated_at,
            current_timestamp as dbt_valid_from,
            current_timestamp as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data."some_date" != source_data."some_date"
        or
        (
            ((snapshotted_data."some_date" is null) and not (source_data."some_date" is null))
            or
            ((not snapshotted_data."some_date" is null) and (source_data."some_date" is null))
        ))
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data."some_date" != source_data."some_date"
        or
        (
            ((snapshotted_data."some_date" is null) and not (source_data."some_date" is null))
            or
            ((not snapshotted_data."some_date" is null) and (source_data."some_date" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

  );

  
    
[0m13:14:44.273253 [debug] [Thread-17 ]: Using vertica connection "snapshot.snapshot_strategy_check_cols.cc_name_snapshot"
[0m13:14:44.273677 [debug] [Thread-15 ]: On snapshot.snapshot_strategy_check_cols.cc_all_snapshot: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_all_snapshot"} */

        
  
    

  create local temporary table
    "cc_all_snapshot__dbt_tmp"
    on commit preserve rows
  as (
    with snapshot_query as (

        
    
    select * from "VMart"."test16660988810247163670_test_basic"."added"

    ),

    snapshotted_data as (

        select *,
            id as dbt_unique_key

        from "VMart"."test16660988810247163670_test_basic"."cc_all_snapshot"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            id as dbt_unique_key,
            current_timestamp as dbt_updated_at,
            current_timestamp as dbt_valid_from,
            nullif(current_timestamp, current_timestamp) as dbt_valid_to,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(current_timestamp as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            id as dbt_unique_key,
            current_timestamp as dbt_updated_at,
            current_timestamp as dbt_valid_from,
            current_timestamp as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."some_date" != source_data."some_date"
        or
        (
            ((snapshotted_data."some_date" is null) and not (source_data."some_date" is null))
            or
            ((not snapshotted_data."some_date" is null) and (source_data."some_date" is null))
        ))
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data."id" != source_data."id"
        or
        (
            ((snapshotted_data."id" is null) and not (source_data."id" is null))
            or
            ((not snapshotted_data."id" is null) and (source_data."id" is null))
        ) or snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ) or snapshotted_data."some_date" != source_data."some_date"
        or
        (
            ((snapshotted_data."some_date" is null) and not (source_data."some_date" is null))
            or
            ((not snapshotted_data."some_date" is null) and (source_data."some_date" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

  );

  
    
[0m13:14:44.274480 [debug] [Thread-17 ]: On snapshot.snapshot_strategy_check_cols.cc_name_snapshot: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_name_snapshot"} */

        
  
    

  create local temporary table
    "cc_name_snapshot__dbt_tmp"
    on commit preserve rows
  as (
    with snapshot_query as (

        
    
    select * from "VMart"."test16660988810247163670_test_basic"."added"

    ),

    snapshotted_data as (

        select *,
            id as dbt_unique_key

        from "VMart"."test16660988810247163670_test_basic"."cc_name_snapshot"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            id as dbt_unique_key,
            current_timestamp as dbt_updated_at,
            current_timestamp as dbt_valid_from,
            nullif(current_timestamp, current_timestamp) as dbt_valid_to,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(current_timestamp as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            id as dbt_unique_key,
            current_timestamp as dbt_updated_at,
            current_timestamp as dbt_valid_from,
            current_timestamp as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ))
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data."name" != source_data."name"
        or
        (
            ((snapshotted_data."name" is null) and not (source_data."name" is null))
            or
            ((not snapshotted_data."name" is null) and (source_data."name" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

  );

  
    
[0m13:14:44.506861 [debug] [Thread-17 ]: SQL status: Code: [Column(name='column_name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='data_type', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='character_maximum_length', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_precision', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_scale', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.23 seconds
[0m13:14:44.513205 [debug] [Thread-17 ]: Using vertica connection "snapshot.snapshot_strategy_check_cols.cc_name_snapshot"
[0m13:14:44.513566 [debug] [Thread-17 ]: On snapshot.snapshot_strategy_check_cols.cc_name_snapshot: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_name_snapshot"} */

    select
    column_name
    , data_type
    , character_maximum_length
    , numeric_precision
    , numeric_scale
    from (
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.columns
        where table_schema = 'None'
        and table_name = 'cc_name_snapshot__dbt_tmp'
        union all
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.view_columns
        where table_schema = 'None'
        and table_name = 'cc_name_snapshot__dbt_tmp'
    ) t
    order by ordinal_position
  
[0m13:14:44.513725 [debug] [Thread-16 ]: SQL status: Code: [Column(name='column_name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='data_type', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='character_maximum_length', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_precision', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_scale', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.24 seconds
[0m13:14:44.514199 [debug] [Thread-15 ]: SQL status: Code: [Column(name='column_name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='data_type', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='character_maximum_length', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_precision', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_scale', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.24 seconds
[0m13:14:44.517455 [debug] [Thread-16 ]: Using vertica connection "snapshot.snapshot_strategy_check_cols.cc_date_snapshot"
[0m13:14:44.522595 [debug] [Thread-15 ]: Using vertica connection "snapshot.snapshot_strategy_check_cols.cc_all_snapshot"
[0m13:14:44.523088 [debug] [Thread-16 ]: On snapshot.snapshot_strategy_check_cols.cc_date_snapshot: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_date_snapshot"} */

    select
    column_name
    , data_type
    , character_maximum_length
    , numeric_precision
    , numeric_scale
    from (
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.columns
        where table_schema = 'None'
        and table_name = 'cc_date_snapshot__dbt_tmp'
        union all
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.view_columns
        where table_schema = 'None'
        and table_name = 'cc_date_snapshot__dbt_tmp'
    ) t
    order by ordinal_position
  
[0m13:14:44.523497 [debug] [Thread-15 ]: On snapshot.snapshot_strategy_check_cols.cc_all_snapshot: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_all_snapshot"} */

    select
    column_name
    , data_type
    , character_maximum_length
    , numeric_precision
    , numeric_scale
    from (
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.columns
        where table_schema = 'None'
        and table_name = 'cc_all_snapshot__dbt_tmp'
        union all
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.view_columns
        where table_schema = 'None'
        and table_name = 'cc_all_snapshot__dbt_tmp'
    ) t
    order by ordinal_position
  
[0m13:14:44.582417 [debug] [Thread-17 ]: SQL status: Code: [Column(name='column_name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='data_type', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='character_maximum_length', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_precision', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_scale', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.07 seconds
[0m13:14:44.588857 [debug] [Thread-17 ]: Using vertica connection "snapshot.snapshot_strategy_check_cols.cc_name_snapshot"
[0m13:14:44.589783 [debug] [Thread-16 ]: SQL status: Code: [Column(name='column_name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='data_type', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='character_maximum_length', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_precision', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_scale', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.07 seconds
[0m13:14:44.590303 [debug] [Thread-15 ]: SQL status: Code: [Column(name='column_name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='data_type', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='character_maximum_length', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_precision', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_scale', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.07 seconds
[0m13:14:44.590838 [debug] [Thread-17 ]: On snapshot.snapshot_strategy_check_cols.cc_name_snapshot: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_name_snapshot"} */

    select
    column_name
    , data_type
    , character_maximum_length
    , numeric_precision
    , numeric_scale
    from (
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.columns
        where table_schema = 'test16660988810247163670_test_basic'
        and table_name = 'cc_name_snapshot'
        union all
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.view_columns
        where table_schema = 'test16660988810247163670_test_basic'
        and table_name = 'cc_name_snapshot'
    ) t
    order by ordinal_position
  
[0m13:14:44.599402 [debug] [Thread-16 ]: Using vertica connection "snapshot.snapshot_strategy_check_cols.cc_date_snapshot"
[0m13:14:44.639986 [debug] [Thread-15 ]: Using vertica connection "snapshot.snapshot_strategy_check_cols.cc_all_snapshot"
[0m13:14:44.640444 [debug] [Thread-16 ]: On snapshot.snapshot_strategy_check_cols.cc_date_snapshot: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_date_snapshot"} */

    select
    column_name
    , data_type
    , character_maximum_length
    , numeric_precision
    , numeric_scale
    from (
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.columns
        where table_schema = 'test16660988810247163670_test_basic'
        and table_name = 'cc_date_snapshot'
        union all
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.view_columns
        where table_schema = 'test16660988810247163670_test_basic'
        and table_name = 'cc_date_snapshot'
    ) t
    order by ordinal_position
  
[0m13:14:44.640611 [debug] [Thread-15 ]: On snapshot.snapshot_strategy_check_cols.cc_all_snapshot: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_all_snapshot"} */

    select
    column_name
    , data_type
    , character_maximum_length
    , numeric_precision
    , numeric_scale
    from (
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.columns
        where table_schema = 'test16660988810247163670_test_basic'
        and table_name = 'cc_all_snapshot'
        union all
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.view_columns
        where table_schema = 'test16660988810247163670_test_basic'
        and table_name = 'cc_all_snapshot'
    ) t
    order by ordinal_position
  
[0m13:14:44.689253 [debug] [Thread-15 ]: SQL status: Code: [Column(name='column_name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='data_type', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='character_maximum_length', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_precision', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_scale', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.05 seconds
[0m13:14:44.696114 [debug] [Thread-15 ]: Using vertica connection "snapshot.snapshot_strategy_check_cols.cc_all_snapshot"
[0m13:14:44.696748 [debug] [Thread-16 ]: SQL status: Code: [Column(name='column_name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='data_type', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='character_maximum_length', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_precision', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_scale', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.06 seconds
[0m13:14:44.697151 [debug] [Thread-15 ]: On snapshot.snapshot_strategy_check_cols.cc_all_snapshot: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_all_snapshot"} */

    select
    column_name
    , data_type
    , character_maximum_length
    , numeric_precision
    , numeric_scale
    from (
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.columns
        where table_schema = 'None'
        and table_name = 'cc_all_snapshot__dbt_tmp'
        union all
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.view_columns
        where table_schema = 'None'
        and table_name = 'cc_all_snapshot__dbt_tmp'
    ) t
    order by ordinal_position
  
[0m13:14:44.697780 [debug] [Thread-17 ]: SQL status: Code: [Column(name='column_name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='data_type', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='character_maximum_length', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_precision', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_scale', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.06 seconds
[0m13:14:44.704119 [debug] [Thread-16 ]: Using vertica connection "snapshot.snapshot_strategy_check_cols.cc_date_snapshot"
[0m13:14:44.708717 [debug] [Thread-17 ]: Using vertica connection "snapshot.snapshot_strategy_check_cols.cc_name_snapshot"
[0m13:14:44.709243 [debug] [Thread-16 ]: On snapshot.snapshot_strategy_check_cols.cc_date_snapshot: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_date_snapshot"} */

    select
    column_name
    , data_type
    , character_maximum_length
    , numeric_precision
    , numeric_scale
    from (
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.columns
        where table_schema = 'None'
        and table_name = 'cc_date_snapshot__dbt_tmp'
        union all
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.view_columns
        where table_schema = 'None'
        and table_name = 'cc_date_snapshot__dbt_tmp'
    ) t
    order by ordinal_position
  
[0m13:14:44.709689 [debug] [Thread-17 ]: On snapshot.snapshot_strategy_check_cols.cc_name_snapshot: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_name_snapshot"} */

    select
    column_name
    , data_type
    , character_maximum_length
    , numeric_precision
    , numeric_scale
    from (
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.columns
        where table_schema = 'None'
        and table_name = 'cc_name_snapshot__dbt_tmp'
        union all
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.view_columns
        where table_schema = 'None'
        and table_name = 'cc_name_snapshot__dbt_tmp'
    ) t
    order by ordinal_position
  
[0m13:14:44.751968 [debug] [Thread-17 ]: SQL status: Code: [Column(name='column_name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='data_type', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='character_maximum_length', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_precision', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_scale', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.04 seconds
[0m13:14:44.758115 [debug] [Thread-17 ]: Using vertica connection "snapshot.snapshot_strategy_check_cols.cc_name_snapshot"
[0m13:14:44.758587 [debug] [Thread-17 ]: On snapshot.snapshot_strategy_check_cols.cc_name_snapshot: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_name_snapshot"} */

    select
    column_name
    , data_type
    , character_maximum_length
    , numeric_precision
    , numeric_scale
    from (
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.columns
        where table_schema = 'test16660988810247163670_test_basic'
        and table_name = 'cc_name_snapshot'
        union all
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.view_columns
        where table_schema = 'test16660988810247163670_test_basic'
        and table_name = 'cc_name_snapshot'
    ) t
    order by ordinal_position
  
[0m13:14:44.763775 [debug] [Thread-15 ]: SQL status: Code: [Column(name='column_name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='data_type', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='character_maximum_length', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_precision', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_scale', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.06 seconds
[0m13:14:44.764349 [debug] [Thread-16 ]: SQL status: Code: [Column(name='column_name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='data_type', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='character_maximum_length', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_precision', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_scale', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.05 seconds
[0m13:14:44.770370 [debug] [Thread-15 ]: Using vertica connection "snapshot.snapshot_strategy_check_cols.cc_all_snapshot"
[0m13:14:44.775826 [debug] [Thread-16 ]: Using vertica connection "snapshot.snapshot_strategy_check_cols.cc_date_snapshot"
[0m13:14:44.776293 [debug] [Thread-15 ]: On snapshot.snapshot_strategy_check_cols.cc_all_snapshot: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_all_snapshot"} */

    select
    column_name
    , data_type
    , character_maximum_length
    , numeric_precision
    , numeric_scale
    from (
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.columns
        where table_schema = 'test16660988810247163670_test_basic'
        and table_name = 'cc_all_snapshot'
        union all
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.view_columns
        where table_schema = 'test16660988810247163670_test_basic'
        and table_name = 'cc_all_snapshot'
    ) t
    order by ordinal_position
  
[0m13:14:44.776664 [debug] [Thread-16 ]: On snapshot.snapshot_strategy_check_cols.cc_date_snapshot: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_date_snapshot"} */

    select
    column_name
    , data_type
    , character_maximum_length
    , numeric_precision
    , numeric_scale
    from (
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.columns
        where table_schema = 'test16660988810247163670_test_basic'
        and table_name = 'cc_date_snapshot'
        union all
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.view_columns
        where table_schema = 'test16660988810247163670_test_basic'
        and table_name = 'cc_date_snapshot'
    ) t
    order by ordinal_position
  
[0m13:14:44.803926 [debug] [Thread-17 ]: SQL status: Code: [Column(name='column_name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='data_type', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='character_maximum_length', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_precision', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_scale', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.04 seconds
[0m13:14:44.804659 [debug] [Thread-15 ]: SQL status: Code: [Column(name='column_name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='data_type', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='character_maximum_length', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_precision', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_scale', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.03 seconds
[0m13:14:44.824648 [debug] [Thread-17 ]: Using vertica connection "snapshot.snapshot_strategy_check_cols.cc_name_snapshot"
[0m13:14:44.826686 [debug] [Thread-15 ]: Using vertica connection "snapshot.snapshot_strategy_check_cols.cc_all_snapshot"
[0m13:14:44.827263 [debug] [Thread-16 ]: SQL status: Code: [Column(name='column_name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='data_type', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='character_maximum_length', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_precision', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_scale', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.05 seconds
[0m13:14:44.827758 [debug] [Thread-17 ]: On snapshot.snapshot_strategy_check_cols.cc_name_snapshot: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_name_snapshot"} */

    select
    column_name
    , data_type
    , character_maximum_length
    , numeric_precision
    , numeric_scale
    from (
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.columns
        where table_schema = 'None'
        and table_name = 'cc_name_snapshot__dbt_tmp'
        union all
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.view_columns
        where table_schema = 'None'
        and table_name = 'cc_name_snapshot__dbt_tmp'
    ) t
    order by ordinal_position
  
[0m13:14:44.828346 [debug] [Thread-15 ]: On snapshot.snapshot_strategy_check_cols.cc_all_snapshot: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_all_snapshot"} */

    select
    column_name
    , data_type
    , character_maximum_length
    , numeric_precision
    , numeric_scale
    from (
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.columns
        where table_schema = 'None'
        and table_name = 'cc_all_snapshot__dbt_tmp'
        union all
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.view_columns
        where table_schema = 'None'
        and table_name = 'cc_all_snapshot__dbt_tmp'
    ) t
    order by ordinal_position
  
[0m13:14:44.836798 [debug] [Thread-16 ]: Using vertica connection "snapshot.snapshot_strategy_check_cols.cc_date_snapshot"
[0m13:14:44.837649 [debug] [Thread-16 ]: On snapshot.snapshot_strategy_check_cols.cc_date_snapshot: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_date_snapshot"} */

    select
    column_name
    , data_type
    , character_maximum_length
    , numeric_precision
    , numeric_scale
    from (
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.columns
        where table_schema = 'None'
        and table_name = 'cc_date_snapshot__dbt_tmp'
        union all
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.view_columns
        where table_schema = 'None'
        and table_name = 'cc_date_snapshot__dbt_tmp'
    ) t
    order by ordinal_position
  
[0m13:14:44.881483 [debug] [Thread-15 ]: SQL status: Code: [Column(name='column_name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='data_type', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='character_maximum_length', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_precision', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_scale', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.04 seconds
[0m13:14:44.882097 [debug] [Thread-16 ]: SQL status: Code: [Column(name='column_name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='data_type', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='character_maximum_length', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_precision', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_scale', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.04 seconds
[0m13:14:44.896647 [debug] [Thread-15 ]: Using vertica connection "snapshot.snapshot_strategy_check_cols.cc_all_snapshot"
[0m13:14:44.899406 [debug] [Thread-16 ]: Using vertica connection "snapshot.snapshot_strategy_check_cols.cc_date_snapshot"
[0m13:14:44.899771 [debug] [Thread-17 ]: SQL status: Code: [Column(name='column_name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='data_type', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='character_maximum_length', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_precision', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_scale', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.06 seconds
[0m13:14:44.900118 [debug] [Thread-15 ]: On snapshot.snapshot_strategy_check_cols.cc_all_snapshot: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_all_snapshot"} */

    select
    column_name
    , data_type
    , character_maximum_length
    , numeric_precision
    , numeric_scale
    from (
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.columns
        where table_schema = 'test16660988810247163670_test_basic'
        and table_name = 'cc_all_snapshot'
        union all
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.view_columns
        where table_schema = 'test16660988810247163670_test_basic'
        and table_name = 'cc_all_snapshot'
    ) t
    order by ordinal_position
  
[0m13:14:44.900348 [debug] [Thread-16 ]: On snapshot.snapshot_strategy_check_cols.cc_date_snapshot: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_date_snapshot"} */

    select
    column_name
    , data_type
    , character_maximum_length
    , numeric_precision
    , numeric_scale
    from (
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.columns
        where table_schema = 'test16660988810247163670_test_basic'
        and table_name = 'cc_date_snapshot'
        union all
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.view_columns
        where table_schema = 'test16660988810247163670_test_basic'
        and table_name = 'cc_date_snapshot'
    ) t
    order by ordinal_position
  
[0m13:14:44.902619 [debug] [Thread-17 ]: Using vertica connection "snapshot.snapshot_strategy_check_cols.cc_name_snapshot"
[0m13:14:44.903360 [debug] [Thread-17 ]: On snapshot.snapshot_strategy_check_cols.cc_name_snapshot: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_name_snapshot"} */

    select
    column_name
    , data_type
    , character_maximum_length
    , numeric_precision
    , numeric_scale
    from (
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.columns
        where table_schema = 'test16660988810247163670_test_basic'
        and table_name = 'cc_name_snapshot'
        union all
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.view_columns
        where table_schema = 'test16660988810247163670_test_basic'
        and table_name = 'cc_name_snapshot'
    ) t
    order by ordinal_position
  
[0m13:14:44.949751 [debug] [Thread-16 ]: SQL status: Code: [Column(name='column_name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='data_type', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='character_maximum_length', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_precision', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_scale', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.05 seconds
[0m13:14:44.955838 [debug] [Thread-15 ]: SQL status: Code: [Column(name='column_name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='data_type', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='character_maximum_length', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_precision', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_scale', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.05 seconds
[0m13:14:44.961133 [debug] [Thread-16 ]: Using vertica connection "snapshot.snapshot_strategy_check_cols.cc_date_snapshot"
[0m13:14:44.964907 [debug] [Thread-15 ]: Using vertica connection "snapshot.snapshot_strategy_check_cols.cc_all_snapshot"
[0m13:14:44.965546 [debug] [Thread-17 ]: SQL status: Code: [Column(name='column_name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='data_type', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='character_maximum_length', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_precision', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_scale', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.06 seconds
[0m13:14:44.966015 [debug] [Thread-16 ]: On snapshot.snapshot_strategy_check_cols.cc_date_snapshot: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_date_snapshot"} */

    select
    column_name
    , data_type
    , character_maximum_length
    , numeric_precision
    , numeric_scale
    from (
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.columns
        where table_schema = 'test16660988810247163670_test_basic'
        and table_name = 'cc_date_snapshot'
        union all
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.view_columns
        where table_schema = 'test16660988810247163670_test_basic'
        and table_name = 'cc_date_snapshot'
    ) t
    order by ordinal_position
  
[0m13:14:44.966417 [debug] [Thread-15 ]: On snapshot.snapshot_strategy_check_cols.cc_all_snapshot: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_all_snapshot"} */

    select
    column_name
    , data_type
    , character_maximum_length
    , numeric_precision
    , numeric_scale
    from (
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.columns
        where table_schema = 'test16660988810247163670_test_basic'
        and table_name = 'cc_all_snapshot'
        union all
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.view_columns
        where table_schema = 'test16660988810247163670_test_basic'
        and table_name = 'cc_all_snapshot'
    ) t
    order by ordinal_position
  
[0m13:14:44.969276 [debug] [Thread-17 ]: Using vertica connection "snapshot.snapshot_strategy_check_cols.cc_name_snapshot"
[0m13:14:44.970440 [debug] [Thread-17 ]: On snapshot.snapshot_strategy_check_cols.cc_name_snapshot: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_name_snapshot"} */

    select
    column_name
    , data_type
    , character_maximum_length
    , numeric_precision
    , numeric_scale
    from (
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.columns
        where table_schema = 'test16660988810247163670_test_basic'
        and table_name = 'cc_name_snapshot'
        union all
        select
        column_name
        , data_type
        , character_maximum_length
        , numeric_precision
        , numeric_scale
        , ordinal_position
        from v_catalog.view_columns
        where table_schema = 'test16660988810247163670_test_basic'
        and table_name = 'cc_name_snapshot'
    ) t
    order by ordinal_position
  
[0m13:14:44.998196 [debug] [Thread-16 ]: SQL status: Code: [Column(name='column_name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='data_type', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='character_maximum_length', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_precision', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_scale', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.03 seconds
[0m13:14:45.002051 [debug] [Thread-16 ]: Writing runtime sql for node "snapshot.snapshot_strategy_check_cols.cc_date_snapshot"
[0m13:14:45.002830 [debug] [Thread-16 ]: Using vertica connection "snapshot.snapshot_strategy_check_cols.cc_date_snapshot"
[0m13:14:45.003232 [debug] [Thread-16 ]: On snapshot.snapshot_strategy_check_cols.cc_date_snapshot: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_date_snapshot"} */

      
  

  merge into "VMart"."test16660988810247163670_test_basic"."cc_date_snapshot" as DBT_INTERNAL_DEST
  using "cc_date_snapshot__dbt_tmp" as DBT_INTERNAL_SOURCE
  on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

  when matched
    and DBT_INTERNAL_DEST.dbt_valid_to is null
    and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
      then update
      set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

  when not matched
    and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
      then insert ("id", "name", "some_date", "dbt_scd_id", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to")
      values (
        DBT_INTERNAL_SOURCE.id, DBT_INTERNAL_SOURCE.name, DBT_INTERNAL_SOURCE.some_date, DBT_INTERNAL_SOURCE.dbt_scd_id, DBT_INTERNAL_SOURCE.dbt_updated_at, DBT_INTERNAL_SOURCE.dbt_valid_from, DBT_INTERNAL_SOURCE.dbt_valid_to
      )


  
[0m13:14:45.019424 [debug] [Thread-15 ]: SQL status: Code: [Column(name='column_name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='data_type', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='character_maximum_length', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_precision', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_scale', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.05 seconds
[0m13:14:45.023148 [debug] [Thread-15 ]: Writing runtime sql for node "snapshot.snapshot_strategy_check_cols.cc_all_snapshot"
[0m13:14:45.023943 [debug] [Thread-15 ]: Using vertica connection "snapshot.snapshot_strategy_check_cols.cc_all_snapshot"
[0m13:14:45.024333 [debug] [Thread-15 ]: On snapshot.snapshot_strategy_check_cols.cc_all_snapshot: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_all_snapshot"} */

      
  

  merge into "VMart"."test16660988810247163670_test_basic"."cc_all_snapshot" as DBT_INTERNAL_DEST
  using "cc_all_snapshot__dbt_tmp" as DBT_INTERNAL_SOURCE
  on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

  when matched
    and DBT_INTERNAL_DEST.dbt_valid_to is null
    and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
      then update
      set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

  when not matched
    and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
      then insert ("id", "name", "some_date", "dbt_scd_id", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to")
      values (
        DBT_INTERNAL_SOURCE.id, DBT_INTERNAL_SOURCE.name, DBT_INTERNAL_SOURCE.some_date, DBT_INTERNAL_SOURCE.dbt_scd_id, DBT_INTERNAL_SOURCE.dbt_updated_at, DBT_INTERNAL_SOURCE.dbt_valid_from, DBT_INTERNAL_SOURCE.dbt_valid_to
      )


  
[0m13:14:45.058790 [debug] [Thread-17 ]: SQL status: Code: [Column(name='column_name', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='data_type', type_code=9, display_size=128, internal_size=-1, precision=None, scale=None, null_ok=True), Column(name='character_maximum_length', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_precision', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True), Column(name='numeric_scale', type_code=6, display_size=20, internal_size=8, precision=None, scale=None, null_ok=True)], Rows: -1, Array Size: 1 in 0.09 seconds
[0m13:14:45.062477 [debug] [Thread-17 ]: Writing runtime sql for node "snapshot.snapshot_strategy_check_cols.cc_name_snapshot"
[0m13:14:45.063216 [debug] [Thread-17 ]: Using vertica connection "snapshot.snapshot_strategy_check_cols.cc_name_snapshot"
[0m13:14:45.063612 [debug] [Thread-17 ]: On snapshot.snapshot_strategy_check_cols.cc_name_snapshot: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_name_snapshot"} */

      
  

  merge into "VMart"."test16660988810247163670_test_basic"."cc_name_snapshot" as DBT_INTERNAL_DEST
  using "cc_name_snapshot__dbt_tmp" as DBT_INTERNAL_SOURCE
  on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

  when matched
    and DBT_INTERNAL_DEST.dbt_valid_to is null
    and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
      then update
      set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

  when not matched
    and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
      then insert ("id", "name", "some_date", "dbt_scd_id", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to")
      values (
        DBT_INTERNAL_SOURCE.id, DBT_INTERNAL_SOURCE.name, DBT_INTERNAL_SOURCE.some_date, DBT_INTERNAL_SOURCE.dbt_scd_id, DBT_INTERNAL_SOURCE.dbt_updated_at, DBT_INTERNAL_SOURCE.dbt_valid_from, DBT_INTERNAL_SOURCE.dbt_valid_to
      )


  
[0m13:14:45.091221 [debug] [Thread-15 ]: vertica adapter: :P Database error: Severity: ERROR, Message: String of 9 octets is too long for type Varchar(8), Sqlstate: 22001, Routine: Char_Resize, File: /data/jenkins/workspace/RE-ReleaseBuilds/RE-Knuckleboom/server/vertica/EE/Functions/Chars.cpp, Line: 221, Error Code: 4800, SQL: '/* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_all_snapshot"} */             merge into "VMart"."test16660988810247163670_test_basic"."cc_all_snapshot" as DBT_INTERNAL_DEST   using "cc_all_snapshot__dbt_tmp" as DBT_INTERNAL_SOURCE   on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id   when matched     and DBT_INTERNAL_DEST.dbt_valid_to is null     and DBT_INTERNAL_SOURCE.dbt_change_type in (\'update\', \'delete\')       then update       set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to   when not matched     and DBT_INTERNAL_SOURCE.dbt_change_type = \'insert\'       then insert ("id", "name", "some_date", "dbt_scd_id", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to")       values (         DBT_INTERNAL_SOURCE.id, DBT_INTERNAL_SOURCE.name, DBT_INTERNAL_SOURCE.some_date, DBT_INTERNAL_SOURCE.dbt_scd_id, DBT_INTERNAL_SOURCE.dbt_updated_at, DBT_INTERNAL_SOURCE.dbt_valid_from, DBT_INTERNAL_SOURCE.dbt_valid_to       )   '
[0m13:14:45.091876 [debug] [Thread-16 ]: vertica adapter: :P Database error: Severity: ERROR, Message: String of 9 octets is too long for type Varchar(8), Sqlstate: 22001, Routine: Char_Resize, File: /data/jenkins/workspace/RE-ReleaseBuilds/RE-Knuckleboom/server/vertica/EE/Functions/Chars.cpp, Line: 221, Error Code: 4800, SQL: '/* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_date_snapshot"} */             merge into "VMart"."test16660988810247163670_test_basic"."cc_date_snapshot" as DBT_INTERNAL_DEST   using "cc_date_snapshot__dbt_tmp" as DBT_INTERNAL_SOURCE   on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id   when matched     and DBT_INTERNAL_DEST.dbt_valid_to is null     and DBT_INTERNAL_SOURCE.dbt_change_type in (\'update\', \'delete\')       then update       set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to   when not matched     and DBT_INTERNAL_SOURCE.dbt_change_type = \'insert\'       then insert ("id", "name", "some_date", "dbt_scd_id", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to")       values (         DBT_INTERNAL_SOURCE.id, DBT_INTERNAL_SOURCE.name, DBT_INTERNAL_SOURCE.some_date, DBT_INTERNAL_SOURCE.dbt_scd_id, DBT_INTERNAL_SOURCE.dbt_updated_at, DBT_INTERNAL_SOURCE.dbt_valid_from, DBT_INTERNAL_SOURCE.dbt_valid_to       )   '
[0m13:14:45.092477 [debug] [Thread-15 ]: On snapshot.snapshot_strategy_check_cols.cc_all_snapshot: ROLLBACK
[0m13:14:45.092971 [debug] [Thread-16 ]: On snapshot.snapshot_strategy_check_cols.cc_date_snapshot: ROLLBACK
[0m13:14:45.097833 [debug] [Thread-17 ]: vertica adapter: :P Database error: Severity: ERROR, Message: String of 9 octets is too long for type Varchar(8), Sqlstate: 22001, Routine: Char_Resize, File: /data/jenkins/workspace/RE-ReleaseBuilds/RE-Knuckleboom/server/vertica/EE/Functions/Chars.cpp, Line: 221, Error Code: 4800, SQL: '/* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_name_snapshot"} */             merge into "VMart"."test16660988810247163670_test_basic"."cc_name_snapshot" as DBT_INTERNAL_DEST   using "cc_name_snapshot__dbt_tmp" as DBT_INTERNAL_SOURCE   on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id   when matched     and DBT_INTERNAL_DEST.dbt_valid_to is null     and DBT_INTERNAL_SOURCE.dbt_change_type in (\'update\', \'delete\')       then update       set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to   when not matched     and DBT_INTERNAL_SOURCE.dbt_change_type = \'insert\'       then insert ("id", "name", "some_date", "dbt_scd_id", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to")       values (         DBT_INTERNAL_SOURCE.id, DBT_INTERNAL_SOURCE.name, DBT_INTERNAL_SOURCE.some_date, DBT_INTERNAL_SOURCE.dbt_scd_id, DBT_INTERNAL_SOURCE.dbt_updated_at, DBT_INTERNAL_SOURCE.dbt_valid_from, DBT_INTERNAL_SOURCE.dbt_valid_to       )   '
[0m13:14:45.098403 [debug] [Thread-17 ]: On snapshot.snapshot_strategy_check_cols.cc_name_snapshot: ROLLBACK
[0m13:14:45.100538 [debug] [Thread-16 ]: On snapshot.snapshot_strategy_check_cols.cc_date_snapshot: Close
[0m13:14:45.100890 [debug] [Thread-15 ]: On snapshot.snapshot_strategy_check_cols.cc_all_snapshot: Close
[0m13:14:45.101889 [debug] [Thread-16 ]: finished collecting timing info
[0m13:14:45.103144 [debug] [Thread-16 ]: Database Error in snapshot cc_date_snapshot (snapshots/cc_date_snapshot.sql)
  Severity: ERROR, Message: String of 9 octets is too long for type Varchar(8), Sqlstate: 22001, Routine: Char_Resize, File: /data/jenkins/workspace/RE-ReleaseBuilds/RE-Knuckleboom/server/vertica/EE/Functions/Chars.cpp, Line: 221, Error Code: 4800, SQL: '/* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_date_snapshot"} */             merge into "VMart"."test16660988810247163670_test_basic"."cc_date_snapshot" as DBT_INTERNAL_DEST   using "cc_date_snapshot__dbt_tmp" as DBT_INTERNAL_SOURCE   on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id   when matched     and DBT_INTERNAL_DEST.dbt_valid_to is null     and DBT_INTERNAL_SOURCE.dbt_change_type in (\'update\', \'delete\')       then update       set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to   when not matched     and DBT_INTERNAL_SOURCE.dbt_change_type = \'insert\'       then insert ("id", "name", "some_date", "dbt_scd_id", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to")       values (         DBT_INTERNAL_SOURCE.id, DBT_INTERNAL_SOURCE.name, DBT_INTERNAL_SOURCE.some_date, DBT_INTERNAL_SOURCE.dbt_scd_id, DBT_INTERNAL_SOURCE.dbt_updated_at, DBT_INTERNAL_SOURCE.dbt_valid_from, DBT_INTERNAL_SOURCE.dbt_valid_to       )   '
  compiled Code at target/run/snapshot_strategy_check_cols/snapshots/cc_date_snapshot.sql
[0m13:14:45.103717 [debug] [Thread-15 ]: finished collecting timing info
[0m13:14:45.104535 [error] [Thread-16 ]: 2 of 3 ERROR snapshotting test16660988810247163670_test_basic.cc_date_snapshot . [[31mERROR[0m in 1.17s]
[0m13:14:45.105027 [debug] [Thread-17 ]: On snapshot.snapshot_strategy_check_cols.cc_name_snapshot: Close
[0m13:14:45.106154 [debug] [Thread-15 ]: Database Error in snapshot cc_all_snapshot (snapshots/cc_all_snapshot.sql)
  Severity: ERROR, Message: String of 9 octets is too long for type Varchar(8), Sqlstate: 22001, Routine: Char_Resize, File: /data/jenkins/workspace/RE-ReleaseBuilds/RE-Knuckleboom/server/vertica/EE/Functions/Chars.cpp, Line: 221, Error Code: 4800, SQL: '/* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_all_snapshot"} */             merge into "VMart"."test16660988810247163670_test_basic"."cc_all_snapshot" as DBT_INTERNAL_DEST   using "cc_all_snapshot__dbt_tmp" as DBT_INTERNAL_SOURCE   on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id   when matched     and DBT_INTERNAL_DEST.dbt_valid_to is null     and DBT_INTERNAL_SOURCE.dbt_change_type in (\'update\', \'delete\')       then update       set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to   when not matched     and DBT_INTERNAL_SOURCE.dbt_change_type = \'insert\'       then insert ("id", "name", "some_date", "dbt_scd_id", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to")       values (         DBT_INTERNAL_SOURCE.id, DBT_INTERNAL_SOURCE.name, DBT_INTERNAL_SOURCE.some_date, DBT_INTERNAL_SOURCE.dbt_scd_id, DBT_INTERNAL_SOURCE.dbt_updated_at, DBT_INTERNAL_SOURCE.dbt_valid_from, DBT_INTERNAL_SOURCE.dbt_valid_to       )   '
  compiled Code at target/run/snapshot_strategy_check_cols/snapshots/cc_all_snapshot.sql
[0m13:14:45.107160 [debug] [Thread-16 ]: Finished running node snapshot.snapshot_strategy_check_cols.cc_date_snapshot
[0m13:14:45.108266 [error] [Thread-15 ]: 1 of 3 ERROR snapshotting test16660988810247163670_test_basic.cc_all_snapshot .. [[31mERROR[0m in 1.18s]
[0m13:14:45.109006 [debug] [Thread-17 ]: finished collecting timing info
[0m13:14:45.110412 [debug] [Thread-15 ]: Finished running node snapshot.snapshot_strategy_check_cols.cc_all_snapshot
[0m13:14:45.111654 [debug] [Thread-17 ]: Database Error in snapshot cc_name_snapshot (snapshots/cc_name_snapshot.sql)
  Severity: ERROR, Message: String of 9 octets is too long for type Varchar(8), Sqlstate: 22001, Routine: Char_Resize, File: /data/jenkins/workspace/RE-ReleaseBuilds/RE-Knuckleboom/server/vertica/EE/Functions/Chars.cpp, Line: 221, Error Code: 4800, SQL: '/* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_name_snapshot"} */             merge into "VMart"."test16660988810247163670_test_basic"."cc_name_snapshot" as DBT_INTERNAL_DEST   using "cc_name_snapshot__dbt_tmp" as DBT_INTERNAL_SOURCE   on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id   when matched     and DBT_INTERNAL_DEST.dbt_valid_to is null     and DBT_INTERNAL_SOURCE.dbt_change_type in (\'update\', \'delete\')       then update       set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to   when not matched     and DBT_INTERNAL_SOURCE.dbt_change_type = \'insert\'       then insert ("id", "name", "some_date", "dbt_scd_id", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to")       values (         DBT_INTERNAL_SOURCE.id, DBT_INTERNAL_SOURCE.name, DBT_INTERNAL_SOURCE.some_date, DBT_INTERNAL_SOURCE.dbt_scd_id, DBT_INTERNAL_SOURCE.dbt_updated_at, DBT_INTERNAL_SOURCE.dbt_valid_from, DBT_INTERNAL_SOURCE.dbt_valid_to       )   '
  compiled Code at target/run/snapshot_strategy_check_cols/snapshots/cc_name_snapshot.sql
[0m13:14:45.112877 [error] [Thread-17 ]: 3 of 3 ERROR snapshotting test16660988810247163670_test_basic.cc_name_snapshot . [[31mERROR[0m in 1.18s]
[0m13:14:45.113887 [debug] [Thread-17 ]: Finished running node snapshot.snapshot_strategy_check_cols.cc_name_snapshot
[0m13:14:45.116439 [debug] [MainThread]: Acquiring new vertica connection "master"
[0m13:14:45.116982 [debug] [MainThread]: Using vertica connection "master"
[0m13:14:45.117333 [debug] [MainThread]: On master: BEGIN
[0m13:14:45.117651 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:14:45.139767 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m13:14:45.147257 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.03 seconds
[0m13:14:45.147868 [debug] [MainThread]: On master: COMMIT
[0m13:14:45.148281 [debug] [MainThread]: Using vertica connection "master"
[0m13:14:45.148627 [debug] [MainThread]: On master: COMMIT
[0m13:14:45.155285 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m13:14:45.155889 [debug] [MainThread]: On master: Close
[0m13:14:45.157193 [info ] [MainThread]: 
[0m13:14:45.157984 [info ] [MainThread]: Finished running 3 snapshots in 0 hours 0 minutes and 1.37 seconds (1.37s).
[0m13:14:45.158603 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:14:45.158851 [debug] [MainThread]: Connection 'snapshot.snapshot_strategy_check_cols.cc_all_snapshot' was properly closed.
[0m13:14:45.159089 [debug] [MainThread]: Connection 'snapshot.snapshot_strategy_check_cols.cc_date_snapshot' was properly closed.
[0m13:14:45.159323 [debug] [MainThread]: Connection 'snapshot.snapshot_strategy_check_cols.cc_name_snapshot' was properly closed.
[0m13:14:45.167107 [info ] [MainThread]: 
[0m13:14:45.167574 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m13:14:45.167954 [info ] [MainThread]: 
[0m13:14:45.168272 [error] [MainThread]: [33mDatabase Error in snapshot cc_date_snapshot (snapshots/cc_date_snapshot.sql)[0m
[0m13:14:45.168590 [error] [MainThread]:   Severity: ERROR, Message: String of 9 octets is too long for type Varchar(8), Sqlstate: 22001, Routine: Char_Resize, File: /data/jenkins/workspace/RE-ReleaseBuilds/RE-Knuckleboom/server/vertica/EE/Functions/Chars.cpp, Line: 221, Error Code: 4800, SQL: '/* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_date_snapshot"} */             merge into "VMart"."test16660988810247163670_test_basic"."cc_date_snapshot" as DBT_INTERNAL_DEST   using "cc_date_snapshot__dbt_tmp" as DBT_INTERNAL_SOURCE   on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id   when matched     and DBT_INTERNAL_DEST.dbt_valid_to is null     and DBT_INTERNAL_SOURCE.dbt_change_type in (\'update\', \'delete\')       then update       set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to   when not matched     and DBT_INTERNAL_SOURCE.dbt_change_type = \'insert\'       then insert ("id", "name", "some_date", "dbt_scd_id", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to")       values (         DBT_INTERNAL_SOURCE.id, DBT_INTERNAL_SOURCE.name, DBT_INTERNAL_SOURCE.some_date, DBT_INTERNAL_SOURCE.dbt_scd_id, DBT_INTERNAL_SOURCE.dbt_updated_at, DBT_INTERNAL_SOURCE.dbt_valid_from, DBT_INTERNAL_SOURCE.dbt_valid_to       )   '
[0m13:14:45.168925 [error] [MainThread]:   compiled Code at target/run/snapshot_strategy_check_cols/snapshots/cc_date_snapshot.sql
[0m13:14:45.169237 [info ] [MainThread]: 
[0m13:14:45.169547 [error] [MainThread]: [33mDatabase Error in snapshot cc_all_snapshot (snapshots/cc_all_snapshot.sql)[0m
[0m13:14:45.169869 [error] [MainThread]:   Severity: ERROR, Message: String of 9 octets is too long for type Varchar(8), Sqlstate: 22001, Routine: Char_Resize, File: /data/jenkins/workspace/RE-ReleaseBuilds/RE-Knuckleboom/server/vertica/EE/Functions/Chars.cpp, Line: 221, Error Code: 4800, SQL: '/* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_all_snapshot"} */             merge into "VMart"."test16660988810247163670_test_basic"."cc_all_snapshot" as DBT_INTERNAL_DEST   using "cc_all_snapshot__dbt_tmp" as DBT_INTERNAL_SOURCE   on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id   when matched     and DBT_INTERNAL_DEST.dbt_valid_to is null     and DBT_INTERNAL_SOURCE.dbt_change_type in (\'update\', \'delete\')       then update       set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to   when not matched     and DBT_INTERNAL_SOURCE.dbt_change_type = \'insert\'       then insert ("id", "name", "some_date", "dbt_scd_id", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to")       values (         DBT_INTERNAL_SOURCE.id, DBT_INTERNAL_SOURCE.name, DBT_INTERNAL_SOURCE.some_date, DBT_INTERNAL_SOURCE.dbt_scd_id, DBT_INTERNAL_SOURCE.dbt_updated_at, DBT_INTERNAL_SOURCE.dbt_valid_from, DBT_INTERNAL_SOURCE.dbt_valid_to       )   '
[0m13:14:45.170191 [error] [MainThread]:   compiled Code at target/run/snapshot_strategy_check_cols/snapshots/cc_all_snapshot.sql
[0m13:14:45.170514 [info ] [MainThread]: 
[0m13:14:45.170824 [error] [MainThread]: [33mDatabase Error in snapshot cc_name_snapshot (snapshots/cc_name_snapshot.sql)[0m
[0m13:14:45.171128 [error] [MainThread]:   Severity: ERROR, Message: String of 9 octets is too long for type Varchar(8), Sqlstate: 22001, Routine: Char_Resize, File: /data/jenkins/workspace/RE-ReleaseBuilds/RE-Knuckleboom/server/vertica/EE/Functions/Chars.cpp, Line: 221, Error Code: 4800, SQL: '/* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "node_id": "snapshot.snapshot_strategy_check_cols.cc_name_snapshot"} */             merge into "VMart"."test16660988810247163670_test_basic"."cc_name_snapshot" as DBT_INTERNAL_DEST   using "cc_name_snapshot__dbt_tmp" as DBT_INTERNAL_SOURCE   on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id   when matched     and DBT_INTERNAL_DEST.dbt_valid_to is null     and DBT_INTERNAL_SOURCE.dbt_change_type in (\'update\', \'delete\')       then update       set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to   when not matched     and DBT_INTERNAL_SOURCE.dbt_change_type = \'insert\'       then insert ("id", "name", "some_date", "dbt_scd_id", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to")       values (         DBT_INTERNAL_SOURCE.id, DBT_INTERNAL_SOURCE.name, DBT_INTERNAL_SOURCE.some_date, DBT_INTERNAL_SOURCE.dbt_scd_id, DBT_INTERNAL_SOURCE.dbt_updated_at, DBT_INTERNAL_SOURCE.dbt_valid_from, DBT_INTERNAL_SOURCE.dbt_valid_to       )   '
[0m13:14:45.171388 [error] [MainThread]:   compiled Code at target/run/snapshot_strategy_check_cols/snapshots/cc_name_snapshot.sql
[0m13:14:45.171589 [info ] [MainThread]: 
[0m13:14:45.171790 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=0 TOTAL=3
[0m13:14:45.172052 [debug] [MainThread]: Flushing usage events
[0m13:14:45.217854 [debug] [MainThread]: Acquiring new vertica connection "_test"
[0m13:14:45.218172 [debug] [MainThread]: Dropping schema "_ReferenceKey(database='vmart', schema='test16660988810247163670_test_basic', identifier=None)".
[0m13:14:45.222162 [debug] [MainThread]: Using vertica connection "_test"
[0m13:14:45.222475 [debug] [MainThread]: On _test: BEGIN
[0m13:14:45.222619 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:14:45.241039 [debug] [MainThread]: vertica adapter: :P Connected to database: VMart at 159.65.150.255
[0m13:14:45.246429 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.02 seconds
[0m13:14:45.246601 [debug] [MainThread]: Using vertica connection "_test"
[0m13:14:45.246726 [debug] [MainThread]: On _test: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "test", "target_name": "default", "connection_name": "_test"} */
drop schema if exists "test16660988810247163670_test_basic" cascade
  
[0m13:14:45.260816 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m13:14:45.261897 [debug] [MainThread]: On _test: COMMIT
[0m13:14:45.262150 [debug] [MainThread]: Using vertica connection "_test"
[0m13:14:45.262361 [debug] [MainThread]: On _test: COMMIT
[0m13:14:45.268846 [debug] [MainThread]: SQL status: Code: None, Rows: -1, Array Size: 1 in 0.01 seconds
[0m13:14:45.269578 [debug] [MainThread]: On _test: Close
[0m13:14:45.271020 [debug] [MainThread]: Connection '_test' was properly closed.
